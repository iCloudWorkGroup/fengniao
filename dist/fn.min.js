!function(a,b){var c,d={},e=function(a,b){var c,d,e;if("string"==typeof a)return h(a);for(c=[],d=a.length,e=0;e<d;e++)c.push(h(a[e]));return b.apply(null,c)},f=function(a,b,c){2===arguments.length&&(c=b,b=null),e(b||[],function(){g(a,c,arguments)})},g=function(a,b,c){var f,g={exports:b};"function"==typeof b&&(c.length||(c=[e,g.exports,g]),void 0!==(f=b.apply(null,c))&&(g.exports=f)),d[a]=g.exports},h=function(b){var c=d[b]||a[b];if(!c)throw new Error("`"+b+"` is undefined");return c},i=function(a){var b,c,e,f,g,h;h=function(a){return a&&a.charAt(0).toUpperCase()+a.substr(1)};for(b in d)if(c=a,d.hasOwnProperty(b)){for(e=b.split("/"),g=h(e.pop());f=h(e.shift());)c[f]=c[f]||{},c=c[f];c[g]=d[b]}return a},j=function(c){return a.__dollar=c,i(b(a,f,e))};"object"==typeof module&&"object"==typeof module.exports?module.exports=j():"function"==typeof define&&define.amd?define(["jquery"],j):(c=a.SpreadSheet,a.SpreadSheet=j(),a.SpreadSheet.noConflict=function(){a.SpreadSheet=c})}(window,function(a,b,c){return b("lib/jquery",function(){return function(a,c){function d(a){var b=a.length,c=aa.type(a);return"function"!==c&&!aa.isWindow(a)&&(!(1!==a.nodeType||!b)||("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a))}function e(a,b,c){if(aa.isFunction(b))return aa.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return aa.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(fa.test(b))return aa.filter(b,a,c);b=aa.filter(b,a)}return aa.grep(a,function(a){return W.call(b,a)>=0!==c})}function g(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function h(a){var b=la[a]={};return aa.each(a.match(ka)||[],function(a,c){b[c]=!0}),b}function i(){_.removeEventListener("DOMContentLoaded",i,!1),a.removeEventListener("load",i,!1),aa.ready()}function j(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=aa.expando+j.uid++}function k(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(ra,"-$1").toLowerCase(),"string"==typeof(c=a.getAttribute(d))){try{c="true"===c||"false"!==c&&("null"===c?null:+c+""===c?+c:qa.test(c)?aa.parseJSON(c):c)}catch(a){}pa.set(a,b,c)}else c=void 0;return c}function l(){return!0}function m(){return!1}function n(){try{return _.activeElement}catch(a){}}function o(a,b){return aa.nodeName(a,"table")&&aa.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function p(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function q(a){var b=Ga.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function r(a,b){for(var c=0,d=a.length;c<d;c++)oa.set(a[c],"globalEval",!b||oa.get(b[c],"globalEval"))}function s(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(oa.hasData(a)&&(f=oa.access(a),g=oa.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;c<d;c++)aa.event.add(b,e,j[e][c])}pa.hasData(a)&&(h=pa.access(a),i=aa.extend({},h),pa.set(b,i))}}function t(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&aa.nodeName(a,b)?aa.merge([a],c):c}function u(a,b){var c=b.nodeName.toLowerCase();"input"===c&&va.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function v(b,c){var d,e=aa(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:aa.css(e[0],"display");return e.detach(),f}function w(a){var b=_,c=Ja[a];return c||(c=v(a,b),"none"!==c&&c||(Ia=(Ia||aa("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Ia[0].contentDocument,b.write(),b.close(),c=v(a,b),Ia.detach()),Ja[a]=c),c}function x(a,b,c){var d,e,f,g,h=a.style;return c=c||Ma(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||aa.contains(a.ownerDocument,a)||(g=aa.style(a,b)),La.test(g)&&Ka.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function y(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function z(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=Sa.length;e--;)if((b=Sa[e]+c)in a)return b;return d}function A(a,b,c){var d=Oa.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function B(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;f<4;f+=2)"margin"===c&&(g+=aa.css(a,c+ta[f],!0,e)),d?("content"===c&&(g-=aa.css(a,"padding"+ta[f],!0,e)),"margin"!==c&&(g-=aa.css(a,"border"+ta[f]+"Width",!0,e))):(g+=aa.css(a,"padding"+ta[f],!0,e),"padding"!==c&&(g+=aa.css(a,"border"+ta[f]+"Width",!0,e)));return g}function C(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ma(a),g="border-box"===aa.css(a,"boxSizing",!1,f);if(e<=0||null==e){if(e=x(a,b,f),(e<0||null==e)&&(e=a.style[b]),La.test(e))return e;d=g&&($.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+B(a,b,c||(g?"border":"content"),d,f)+"px"}function D(a,b){for(var c,d,e,f=[],g=0,h=a.length;g<h;g++)d=a[g],d.style&&(f[g]=oa.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&ua(d)&&(f[g]=oa.access(d,"olddisplay",w(d.nodeName)))):(e=ua(d),"none"===c&&e||oa.set(d,"olddisplay",e?c:aa.css(d,"display"))));for(g=0;g<h;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function E(a,b,c,d,e){return new E.prototype.init(a,b,c,d,e)}function F(){return setTimeout(function(){Ta=void 0}),Ta=aa.now()}function G(a,b){var c,d=0,e={height:a};for(b=b?1:0;d<4;d+=2-b)c=ta[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function H(a,b,c){for(var d,e=(Za[b]||[]).concat(Za["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function I(a,b,c){var d,e,f,g,h,i,j,k=this,l={},m=a.style,n=a.nodeType&&ua(a),o=oa.get(a,"fxshow");c.queue||(h=aa._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,k.always(function(){k.always(function(){h.unqueued--,aa.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[m.overflow,m.overflowX,m.overflowY],j=aa.css(a,"display"),"inline"===("none"===j?oa.get(a,"olddisplay")||w(a.nodeName):j)&&"none"===aa.css(a,"float")&&(m.display="inline-block")),c.overflow&&(m.overflow="hidden",k.always(function(){m.overflow=c.overflow[0],m.overflowX=c.overflow[1],m.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Va.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(n?"hide":"show")){if("show"!==e||!o||void 0===o[d])continue;n=!0}l[d]=o&&o[d]||aa.style(a,d)}else j=void 0;if(aa.isEmptyObject(l))"inline"===("none"===j?w(a.nodeName):j)&&(m.display=j);else{o?"hidden"in o&&(n=o.hidden):o=oa.access(a,"fxshow",{}),f&&(o.hidden=!n),n?aa(a).show():k.done(function(){aa(a).hide()}),k.done(function(){var b;oa.remove(a,"fxshow");for(b in l)aa.style(a,b,l[b])});for(d in l)g=H(n?o[d]:0,d,k),d in o||(o[d]=g.start,n&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function J(a,b){var c,d,e,f,g;for(c in a)if(d=aa.camelCase(c),e=b[d],f=a[c],aa.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=aa.cssHooks[d])&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function K(a,b,c){var d,e,f=0,g=Ya.length,h=aa.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Ta||F(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:aa.extend({},b),opts:aa.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Ta||F(),duration:c.duration,tweens:[],createTween:function(b,c){var d=aa.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(J(k,j.opts.specialEasing);f<g;f++)if(d=Ya[f].call(j,a,k,j.opts))return d;return aa.map(k,H,j),aa.isFunction(j.opts.start)&&j.opts.start.call(a,j),aa.fx.timer(aa.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function L(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(ka)||[];if(aa.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function M(a,b,c,d){function e(h){var i;return f[h]=!0,aa.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===jb;return e(b.dataTypes[0])||!f["*"]&&e("*")}function N(a,b){var c,d,e=aa.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&aa.extend(!0,a,d),a}function O(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}if(f)return f!==i[0]&&i.unshift(f),c[f]}function P(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(!(g=j[i+" "+f]||j["* "+f]))for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){!0===g?g=j[e]:!0!==j[e]&&(f=h[0],k.unshift(h[1]));break}if(!0!==g)if(g&&a.throws)b=g(b);else try{b=g(b)}catch(a){return{state:"parsererror",error:g?a:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function Q(a,b,c,d){var e;if(aa.isArray(b))aa.each(b,function(b,e){c||nb.test(a)?d(a,e):Q(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==aa.type(b))d(a,b);else for(e in b)Q(a+"["+e+"]",b[e],c,d)}function R(a){return aa.isWindow(a)?a:9===a.nodeType&&a.defaultView}var S=[],T=S.slice,U=S.concat,V=S.push,W=S.indexOf,X={},Y=X.toString,Z=X.hasOwnProperty,$={},_=a.document,aa=function(a,b){return new aa.fn.init(a,b)},ba=function(a,b){return b.toUpperCase()};aa.fn=aa.prototype={jquery:"2.1.3",constructor:aa,selector:"",length:0,toArray:function(){return T.call(this)},get:function(a){return null!=a?a<0?this[a+this.length]:this[a]:T.call(this)},pushStack:function(a){var b=aa.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return aa.each(this,a,b)},map:function(a){return this.pushStack(aa.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(T.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:V,sort:S.sort,splice:S.splice},aa.extend=aa.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||aa.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(aa.isPlainObject(d)||(e=aa.isArray(d)))?(e?(e=!1,f=c&&aa.isArray(c)?c:[]):f=c&&aa.isPlainObject(c)?c:{},g[b]=aa.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},aa.extend({expando:"jQuery"+("2.1.3"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===aa.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!aa.isArray(a)&&a-parseFloat(a)+1>=0},isPlainObject:function(a){return"object"===aa.type(a)&&!a.nodeType&&!aa.isWindow(a)&&!(a.constructor&&!Z.call(a.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?X[Y.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;(a=aa.trim(a))&&(1===a.indexOf("use strict")?(b=_.createElement("script"),b.text=a,_.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,ba)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var e=0,f=a.length,g=d(a);if(c){if(g)for(;e<f&&!1!==b.apply(a[e],c);e++);else for(e in a)if(!1===b.apply(a[e],c))break}else if(g)for(;e<f&&!1!==b.call(a[e],e,a[e]);e++);else for(e in a)if(!1===b.call(a[e],e,a[e]))break;return a},trim:function(a){return null==a?"":(a+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(d(Object(a))?aa.merge(c,"string"==typeof a?[a]:a):V.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:W.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d=[],e=0,f=a.length,g=!c;e<f;e++)!b(a[e],e)!==g&&d.push(a[e]);return d},map:function(a,b,c){var e,f=0,g=a.length,h=d(a),i=[];if(h)for(;f<g;f++)null!=(e=b(a[f],f,c))&&i.push(e);else for(f in a)null!=(e=b(a[f],f,c))&&i.push(e);return U.apply([],i)},guid:1,proxy:function(a,b){var c,d,e;if("string"==typeof b&&(c=a[b],b=a,a=c),aa.isFunction(a))return d=T.call(arguments,2),e=function(){return a.apply(b||this,d.concat(T.call(arguments)))},e.guid=a.guid=a.guid||aa.guid++,e},now:Date.now,support:$}),aa.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){X["[object "+b+"]"]=b.toLowerCase()});var ca=function(a){function b(a,b,c,d){var e,f,g,h,j,l,m,n,o,p;if((b?b.ownerDocument||b:M)!==E&&D(b),b=b||E,c=c||[],h=b.nodeType,"string"!=typeof a||!a||1!==h&&9!==h&&11!==h)return c;if(!d&&G){if(11!==h&&(e=qa.exec(a)))if(g=e[1]){if(9===h){if(!(f=b.getElementById(g))||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&K(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return Y.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&t.getElementsByClassName)return Y.apply(c,b.getElementsByClassName(g)),c}if(t.qsa&&(!H||!H.test(a))){if(n=m=L,o=b,p=1!==h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(l=x(a),(m=b.getAttribute("id"))?n=m.replace(sa,"\\$&"):b.setAttribute("id",n),n="[id='"+n+"'] ",j=l.length;j--;)l[j]=n+k(l[j]);o=ra.test(a)&&i(b.parentNode)||b,p=l.join(",")}if(p)try{return Y.apply(c,o.querySelectorAll(p)),c}catch(a){}finally{m||b.removeAttribute("id")}}}return z(a.replace(ga,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>u.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[L]=!0,a}function e(a){var b=E.createElement("div");try{return!!a(b)}catch(a){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)u.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||T)-(~a.sourceIndex||T);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function i(a){return a&&void 0!==a.getElementsByTagName&&a}function j(){}function k(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function l(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=O++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[N,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[L]||(b[L]={}),(h=i[d])&&h[0]===N&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function m(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function n(a,c,d){for(var e=0,f=c.length;e<f;e++)b(a,c[e],d);return d}function o(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function p(a,b,c,e,f,g){return e&&!e[L]&&(e=p(e)),f&&!f[L]&&(f=p(f,g)),d(function(d,g,h,i){var j,k,l,m=[],p=[],q=g.length,r=d||n(b||"*",h.nodeType?[h]:h,[]),s=!a||!d&&b?r:o(r,m,a,h,i),t=c?f||(d?a:q||e)?[]:g:s;if(c&&c(s,t,h,i),e)for(j=o(t,p),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(t[p[k]]=!(s[p[k]]=l));if(d){if(f||a){if(f){for(j=[],k=t.length;k--;)(l=t[k])&&j.push(s[k]=l);f(null,t=[],j,i)}for(k=t.length;k--;)(l=t[k])&&(j=f?$(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else t=o(t===g?t.splice(q,t.length):t),f?f(null,g,t,i):Y.apply(g,t)})}function q(a){for(var b,c,d,e=a.length,f=u.relative[a[0].type],g=f||u.relative[" "],h=f?1:0,i=l(function(a){return a===b},g,!0),j=l(function(a){return $(b,a)>-1},g,!0),n=[function(a,c,d){var e=!f&&(d||c!==A)||((b=c).nodeType?i(a,c,d):j(a,c,d));return b=null,e}];h<e;h++)if(c=u.relative[a[h].type])n=[l(m(n),c)];else{if(c=u.filter[a[h].type].apply(null,a[h].matches),c[L]){for(d=++h;d<e&&!u.relative[a[d].type];d++);return p(h>1&&m(n),h>1&&k(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ga,"$1"),c,h<d&&q(a.slice(h,d)),d<e&&q(a=a.slice(d)),d<e&&k(a))}n.push(c)}return m(n)}function r(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,p="0",q=d&&[],r=[],s=A,t=d||f&&u.find.TAG("*",j),v=N+=null==s?1:Math.random()||.1,w=t.length;for(j&&(A=g!==E&&g);p!==w&&null!=(k=t[p]);p++){if(f&&k){for(l=0;m=a[l++];)if(m(k,g,h)){i.push(k);break}j&&(N=v)}e&&((k=!m&&k)&&n--,d&&q.push(k))}if(n+=p,e&&p!==n){for(l=0;m=c[l++];)m(q,r,g,h);if(d){if(n>0)for(;p--;)q[p]||r[p]||(r[p]=W.call(i));r=o(r)}Y.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(N=v,A=s),q};return e?d(g):g}var s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L="sizzle"+1*new Date,M=a.document,N=0,O=0,P=c(),Q=c(),R=c(),S=function(a,b){return a===b&&(C=!0),0},T=1<<31,U={}.hasOwnProperty,V=[],W=V.pop,X=V.push,Y=V.push,Z=V.slice,$=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},_="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",aa="[\\x20\\t\\r\\n\\f]",ba="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ca=ba.replace("w","w#"),da="\\["+aa+"*("+ba+")(?:"+aa+"*([*^$|!~]?=)"+aa+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ca+"))|)"+aa+"*\\]",ea=":("+ba+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+da+")*)|.*)\\)|)",fa=new RegExp(aa+"+","g"),ga=new RegExp("^"+aa+"+|((?:^|[^\\\\])(?:\\\\.)*)"+aa+"+$","g"),ha=new RegExp("^"+aa+"*,"+aa+"*"),ia=new RegExp("^"+aa+"*([>+~]|"+aa+")"+aa+"*"),ja=new RegExp("="+aa+"*([^\\]'\"]*?)"+aa+"*\\]","g"),ka=new RegExp(ea),la=new RegExp("^"+ca+"$"),ma={ID:new RegExp("^#("+ba+")"),CLASS:new RegExp("^\\.("+ba+")"),TAG:new RegExp("^("+ba.replace("w","w*")+")"),ATTR:new RegExp("^"+da),PSEUDO:new RegExp("^"+ea),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+aa+"*(even|odd|(([+-]|)(\\d*)n|)"+aa+"*(?:([+-]|)"+aa+"*(\\d+)|))"+aa+"*\\)|)","i"),bool:new RegExp("^(?:"+_+")$","i"),needsContext:new RegExp("^"+aa+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+aa+"*((?:-\\d)?\\d*)"+aa+"*\\)|)(?=[^-]|$)","i")},na=/^(?:input|select|textarea|button)$/i,oa=/^h\d$/i,pa=/^[^{]+\{\s*\[native \w/,qa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ra=/[+~]/,sa=/'|\\/g,ta=new RegExp("\\\\([\\da-f]{1,6}"+aa+"?|("+aa+")|.)","ig"),ua=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},va=function(){D()};try{Y.apply(V=Z.call(M.childNodes),M.childNodes),V[M.childNodes.length].nodeType}catch(a){Y={apply:V.length?function(a,b){X.apply(a,Z.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}t=b.support={},w=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},D=b.setDocument=function(a){var b,c,d=a?a.ownerDocument||a:M;return d!==E&&9===d.nodeType&&d.documentElement?(E=d,F=d.documentElement,c=d.defaultView,c&&c!==c.top&&(c.addEventListener?c.addEventListener("unload",va,!1):c.attachEvent&&c.attachEvent("onunload",va)),G=!w(d),t.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),t.getElementsByTagName=e(function(a){return a.appendChild(d.createComment("")),!a.getElementsByTagName("*").length}),t.getElementsByClassName=pa.test(d.getElementsByClassName),t.getById=e(function(a){return F.appendChild(a).id=L,!d.getElementsByName||!d.getElementsByName(L).length}),t.getById?(u.find.ID=function(a,b){if(void 0!==b.getElementById&&G){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},u.filter.ID=function(a){var b=a.replace(ta,ua);return function(a){return a.getAttribute("id")===b}}):(delete u.find.ID,u.filter.ID=function(a){var b=a.replace(ta,ua);return function(a){var c=void 0!==a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),u.find.TAG=t.getElementsByTagName?function(a,b){return void 0!==b.getElementsByTagName?b.getElementsByTagName(a):t.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},u.find.CLASS=t.getElementsByClassName&&function(a,b){if(G)return b.getElementsByClassName(a)},I=[],H=[],(t.qsa=pa.test(d.querySelectorAll))&&(e(function(a){F.appendChild(a).innerHTML="<a id='"+L+"'></a><select id='"+L+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&H.push("[*^$]="+aa+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||H.push("\\["+aa+"*(?:value|"+_+")"),a.querySelectorAll("[id~="+L+"-]").length||H.push("~="),a.querySelectorAll(":checked").length||H.push(":checked"),a.querySelectorAll("a#"+L+"+*").length||H.push(".#.+[+~]")}),e(function(a){var b=d.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&H.push("name"+aa+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||H.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),H.push(",.*:")})),(t.matchesSelector=pa.test(J=F.matches||F.webkitMatchesSelector||F.mozMatchesSelector||F.oMatchesSelector||F.msMatchesSelector))&&e(function(a){t.disconnectedMatch=J.call(a,"div"),J.call(a,"[s!='']:x"),I.push("!=",ea)}),H=H.length&&new RegExp(H.join("|")),I=I.length&&new RegExp(I.join("|")),b=pa.test(F.compareDocumentPosition),K=b||pa.test(F.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},S=b?function(a,b){if(a===b)return C=!0,0;var c=!a.compareDocumentPosition-!b.compareDocumentPosition;return c||(c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&c||!t.sortDetached&&b.compareDocumentPosition(a)===c?a===d||a.ownerDocument===M&&K(M,a)?-1:b===d||b.ownerDocument===M&&K(M,b)?1:B?$(B,a)-$(B,b):0:4&c?-1:1)}:function(a,b){if(a===b)return C=!0,0;var c,e=0,f=a.parentNode,h=b.parentNode,i=[a],j=[b];if(!f||!h)return a===d?-1:b===d?1:f?-1:h?1:B?$(B,a)-$(B,b):0;if(f===h)return g(a,b);for(c=a;c=c.parentNode;)i.unshift(c);for(c=b;c=c.parentNode;)j.unshift(c);for(;i[e]===j[e];)e++;return e?g(i[e],j[e]):i[e]===M?-1:j[e]===M?1:0},d):E},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==E&&D(a),c=c.replace(ja,"='$1']"),t.matchesSelector&&G&&(!I||!I.test(c))&&(!H||!H.test(c)))try{var d=J.call(a,c);if(d||t.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(a){}return b(c,E,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==E&&D(a),K(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==E&&D(a);var c=u.attrHandle[b.toLowerCase()],d=c&&U.call(u.attrHandle,b.toLowerCase())?c(a,b,!G):void 0;return void 0!==d?d:t.attributes||!G?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(C=!t.detectDuplicates,B=!t.sortStable&&a.slice(0),a.sort(S),C){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return B=null,a},v=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=v(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=v(b);return c},u=b.selectors={cacheLength:50,createPseudo:d,match:ma,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ta,ua),a[3]=(a[3]||a[4]||a[5]||"").replace(ta,ua),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return ma.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&ka.test(c)&&(b=x(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ta,ua).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=P[a+" "];return b||(b=new RegExp("(^|"+aa+")"+a+"("+aa+"|$)"))&&P(a,function(a){return b.test("string"==typeof a.className&&a.className||void 0!==a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:!c||(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f.replace(fa," ")+" ").indexOf(d)>-1:"|="===c&&(f===d||f.slice(0,d.length+1)===d+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[L]||(q[L]={}),j=k[a]||[],n=j[0]===N&&j[1],m=j[0]===N&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[N,n,m];break}}else if(s&&(j=(b[L]||(b[L]={}))[a])&&j[0]===N)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[L]||(l[L]={}))[a]=[N,m]),l!==b)););return(m-=e)===d||m%d==0&&m/d>=0}}},PSEUDO:function(a,c){var e,f=u.pseudos[a]||u.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[L]?f(c):f.length>1?(e=[a,a,"",c],u.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=$(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=y(a.replace(ga,"$1"));return e[L]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),b[0]=null,!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return a=a.replace(ta,ua),function(b){return(b.textContent||b.innerText||v(b)).indexOf(a)>-1}}),lang:d(function(a){return la.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(ta,ua).toLowerCase(),function(b){var c;do{if(c=G?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return(c=c.toLowerCase())===a||0===c.indexOf(a+"-")}while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===F},focus:function(a){return a===E.activeElement&&(!E.hasFocus||E.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!u.pseudos.empty(a)},header:function(a){return oa.test(a.nodeName)},input:function(a){return na.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:h(function(){return[0]}),last:h(function(a,b){return[b-1]}),eq:h(function(a,b,c){return[c<0?c+b:c]}),even:h(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:h(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:h(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:h(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},u.pseudos.nth=u.pseudos.eq;for(s in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})u.pseudos[s]=function(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}(s);for(s in{submit:!0,reset:!0})u.pseudos[s]=function(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}(s);return j.prototype=u.filters=u.pseudos,u.setFilters=new j,x=b.tokenize=function(a,c){var d,e,f,g,h,i,j,k=Q[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=u.preFilter;h;){d&&!(e=ha.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=ia.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ga," ")}),h=h.slice(d.length));for(g in u.filter)!(e=ma[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):Q(a,i).slice(0)},y=b.compile=function(a,b){var c,d=[],e=[],f=R[a+" "];if(!f){for(b||(b=x(a)),c=b.length;c--;)f=q(b[c]),f[L]?d.push(f):e.push(f);f=R(a,r(e,d)),f.selector=a}return f},z=b.select=function(a,b,c,d){var e,f,g,h,j,l="function"==typeof a&&a,m=!d&&x(a=l.selector||a);if(c=c||[],1===m.length){if(f=m[0]=m[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&t.getById&&9===b.nodeType&&G&&u.relative[f[1].type]){if(!(b=(u.find.ID(g.matches[0].replace(ta,ua),b)||[])[0]))return c;l&&(b=b.parentNode),a=a.slice(f.shift().value.length)}for(e=ma.needsContext.test(a)?0:f.length;e--&&(g=f[e],!u.relative[h=g.type]);)if((j=u.find[h])&&(d=j(g.matches[0].replace(ta,ua),ra.test(f[0].type)&&i(b.parentNode)||b))){if(f.splice(e,1),!(a=d.length&&k(f)))return Y.apply(c,d),c;break}}return(l||y(a,m))(d,b,!G,c,ra.test(a)&&i(b.parentNode)||b),c},t.sortStable=L.split("").sort(S).join("")===L,t.detectDuplicates=!!C,D(),t.sortDetached=e(function(a){return 1&a.compareDocumentPosition(E.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),t.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){
if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(_,function(a,b,c){var d;if(!c)return!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(a);aa.find=ca,aa.expr=ca.selectors,aa.expr[":"]=aa.expr.pseudos,aa.unique=ca.uniqueSort,aa.text=ca.getText,aa.isXMLDoc=ca.isXML,aa.contains=ca.contains;var da=aa.expr.match.needsContext,ea=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,fa=/^.[^:#\[\.,]*$/;aa.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?aa.find.matchesSelector(d,a)?[d]:[]:aa.find.matches(a,aa.grep(b,function(a){return 1===a.nodeType}))},aa.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(aa(a).filter(function(){for(b=0;b<c;b++)if(aa.contains(e[b],this))return!0}));for(b=0;b<c;b++)aa.find(a,e[b],d);return d=this.pushStack(c>1?aa.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(e(this,a||[],!1))},not:function(a){return this.pushStack(e(this,a||[],!0))},is:function(a){return!!e(this,"string"==typeof a&&da.test(a)?aa(a):a||[],!1).length}});var ga,ha=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(aa.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(!(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:ha.exec(a))||!c[1]&&b)return!b||b.jquery?(b||ga).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof aa?b[0]:b,aa.merge(this,aa.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:_,!0)),ea.test(c[1])&&aa.isPlainObject(b))for(c in b)aa.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=_.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=_,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):aa.isFunction(a)?void 0!==ga.ready?ga.ready(a):a(aa):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),aa.makeArray(a,this))}).prototype=aa.fn,ga=aa(_);var ia=/^(?:parents|prev(?:Until|All))/,ja={children:!0,contents:!0,next:!0,prev:!0};aa.extend({dir:function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&aa(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),aa.fn.extend({has:function(a){var b=aa(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(aa.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=da.test(a)||"string"!=typeof a?aa(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&aa.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?aa.unique(f):f)},index:function(a){return a?"string"==typeof a?W.call(aa(a),this[0]):W.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(aa.unique(aa.merge(this.get(),aa(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),aa.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return aa.dir(a,"parentNode")},parentsUntil:function(a,b,c){return aa.dir(a,"parentNode",c)},next:function(a){return g(a,"nextSibling")},prev:function(a){return g(a,"previousSibling")},nextAll:function(a){return aa.dir(a,"nextSibling")},prevAll:function(a){return aa.dir(a,"previousSibling")},nextUntil:function(a,b,c){return aa.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return aa.dir(a,"previousSibling",c)},siblings:function(a){return aa.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return aa.sibling(a.firstChild)},contents:function(a){return a.contentDocument||aa.merge([],a.childNodes)}},function(a,b){aa.fn[a]=function(c,d){var e=aa.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=aa.filter(d,e)),this.length>1&&(ja[a]||aa.unique(e),ia.test(a)&&e.reverse()),this.pushStack(e)}});var ka=/\S+/g,la={};aa.Callbacks=function(a){a="string"==typeof a?la[a]||h(a):aa.extend({},a);var b,c,d,e,f,g,i=[],j=!a.once&&[],k=function(h){for(b=a.memory&&h,c=!0,g=e||0,e=0,f=i.length,d=!0;i&&g<f;g++)if(!1===i[g].apply(h[0],h[1])&&a.stopOnFalse){b=!1;break}d=!1,i&&(j?j.length&&k(j.shift()):b?i=[]:l.disable())},l={add:function(){if(i){var c=i.length;!function b(c){aa.each(c,function(c,d){var e=aa.type(d);"function"===e?a.unique&&l.has(d)||i.push(d):d&&d.length&&"string"!==e&&b(d)})}(arguments),d?f=i.length:b&&(e=c,k(b))}return this},remove:function(){return i&&aa.each(arguments,function(a,b){for(var c;(c=aa.inArray(b,i,c))>-1;)i.splice(c,1),d&&(c<=f&&f--,c<=g&&g--)}),this},has:function(a){return a?aa.inArray(a,i)>-1:!(!i||!i.length)},empty:function(){return i=[],f=0,this},disable:function(){return i=j=b=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,b||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||c&&!j||(b=b||[],b=[a,b.slice?b.slice():b],d?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!c}};return l},aa.extend({Deferred:function(a){var b=[["resolve","done",aa.Callbacks("once memory"),"resolved"],["reject","fail",aa.Callbacks("once memory"),"rejected"],["notify","progress",aa.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return aa.Deferred(function(c){aa.each(b,function(b,f){var g=aa.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&aa.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?aa.extend(a,d):d}},e={};return d.pipe=d.then,aa.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=T.call(arguments),g=f.length,h=1!==g||a&&aa.isFunction(a.promise)?g:0,i=1===h?a:aa.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?T.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);e<g;e++)f[e]&&aa.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var ma;aa.fn.ready=function(a){return aa.ready.promise().done(a),this},aa.extend({isReady:!1,readyWait:1,holdReady:function(a){a?aa.readyWait++:aa.ready(!0)},ready:function(a){(!0===a?--aa.readyWait:aa.isReady)||(aa.isReady=!0,!0!==a&&--aa.readyWait>0||(ma.resolveWith(_,[aa]),aa.fn.triggerHandler&&(aa(_).triggerHandler("ready"),aa(_).off("ready"))))}}),aa.ready.promise=function(b){return ma||(ma=aa.Deferred(),"complete"===_.readyState?setTimeout(aa.ready):(_.addEventListener("DOMContentLoaded",i,!1),a.addEventListener("load",i,!1))),ma.promise(b)},aa.ready.promise();var na=aa.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===aa.type(c)){e=!0;for(h in c)aa.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,aa.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(aa(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};aa.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType},j.uid=1,j.accepts=aa.acceptData,j.prototype={key:function(a){if(!j.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=j.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,aa.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),g=this.cache[e];if("string"==typeof b)g[b]=c;else if(aa.isEmptyObject(g))f(this.cache[e],b);else for(d in b)g[d]=b[d];return g},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,aa.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{aa.isArray(b)?d=b.concat(b.map(aa.camelCase)):(e=aa.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(ka)||[])),c=d.length;for(;c--;)delete g[d[c]]}},hasData:function(a){return!aa.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var oa=new j,pa=new j,qa=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ra=/([A-Z])/g;aa.extend({hasData:function(a){return pa.hasData(a)||oa.hasData(a)},data:function(a,b,c){return pa.access(a,b,c)},removeData:function(a,b){pa.remove(a,b)},_data:function(a,b,c){return oa.access(a,b,c)},_removeData:function(a,b){oa.remove(a,b)}}),aa.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=pa.get(f),1===f.nodeType&&!oa.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=aa.camelCase(d.slice(5)),k(f,d,e[d])));oa.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){pa.set(this,a)}):na(this,function(b){var c,d=aa.camelCase(a);if(f&&void 0===b){if(void 0!==(c=pa.get(f,a)))return c;if(void 0!==(c=pa.get(f,d)))return c;if(void 0!==(c=k(f,d,void 0)))return c}else this.each(function(){var c=pa.get(this,d);pa.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&pa.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){pa.remove(this,a)})}}),aa.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=oa.get(a,b),c&&(!d||aa.isArray(c)?d=oa.access(a,b,aa.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=aa.queue(a,b),d=c.length,e=c.shift(),f=aa._queueHooks(a,b),g=function(){aa.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return oa.get(a,c)||oa.access(a,c,{empty:aa.Callbacks("once memory").add(function(){oa.remove(a,[b+"queue",c])})})}}),aa.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?aa.queue(this[0],a):void 0===b?this:this.each(function(){var c=aa.queue(this,a,b);aa._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&aa.dequeue(this,a)})},dequeue:function(a){return this.each(function(){aa.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=aa.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)(c=oa.get(f[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var sa=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ta=["Top","Right","Bottom","Left"],ua=function(a,b){return a=b||a,"none"===aa.css(a,"display")||!aa.contains(a.ownerDocument,a)},va=/^(?:checkbox|radio)$/i;!function(){var a=_.createDocumentFragment(),b=a.appendChild(_.createElement("div")),c=_.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),$.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",$.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();$.focusinBubbles="onfocusin"in a;var wa=/^key/,xa=/^(?:mouse|pointer|contextmenu)|click/,ya=/^(?:focusinfocus|focusoutblur)$/,za=/^([^.]*)(?:\.(.+)|)$/;aa.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=oa.get(a);if(q)for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=aa.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return void 0!==aa&&aa.event.triggered!==b.type?aa.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(ka)||[""],j=b.length;j--;)h=za.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=aa.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=aa.event.special[n]||{},k=aa.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&aa.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&!1!==l.setup.call(a,d,o,g)||a.addEventListener&&a.addEventListener(n,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),aa.event.global[n]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=oa.hasData(a)&&oa.get(a);if(q&&(i=q.events)){for(b=(b||"").match(ka)||[""],j=b.length;j--;)if(h=za.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=aa.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&!1!==l.teardown.call(a,o,q.handle)||aa.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)aa.event.remove(a,n+b[j],c,d,!0);aa.isEmptyObject(i)&&(delete q.handle,oa.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,j,k,l,m=[d||_],n=Z.call(b,"type")?b.type:b,o=Z.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||_,3!==d.nodeType&&8!==d.nodeType&&!ya.test(n+aa.event.triggered)&&(n.indexOf(".")>=0&&(o=n.split("."),n=o.shift(),o.sort()),j=n.indexOf(":")<0&&"on"+n,b=b[aa.expando]?b:new aa.Event(n,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=o.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:aa.makeArray(c,[b]),l=aa.event.special[n]||{},e||!l.trigger||!1!==l.trigger.apply(d,c))){if(!e&&!l.noBubble&&!aa.isWindow(d)){for(i=l.delegateType||n,ya.test(i+n)||(g=g.parentNode);g;g=g.parentNode)m.push(g),h=g;h===(d.ownerDocument||_)&&m.push(h.defaultView||h.parentWindow||a)}for(f=0;(g=m[f++])&&!b.isPropagationStopped();)b.type=f>1?i:l.bindType||n,k=(oa.get(g,"events")||{})[b.type]&&oa.get(g,"handle"),k&&k.apply(g,c),(k=j&&g[j])&&k.apply&&aa.acceptData(g)&&(b.result=k.apply(g,c),!1===b.result&&b.preventDefault());return b.type=n,e||b.isDefaultPrevented()||l._default&&!1!==l._default.apply(m.pop(),c)||!aa.acceptData(d)||j&&aa.isFunction(d[n])&&!aa.isWindow(d)&&(h=d[j],h&&(d[j]=null),aa.event.triggered=n,d[n](),aa.event.triggered=void 0,h&&(d[j]=h)),b.result}},dispatch:function(a){a=aa.event.fix(a);var b,c,d,e,f,g=[],h=T.call(arguments),i=(oa.get(this,"events")||{})[a.type]||[],j=aa.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||!1!==j.preDispatch.call(this,a)){for(g=aa.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(f=e.handlers[c++])&&!a.isImmediatePropagationStopped();)a.namespace_re&&!a.namespace_re.test(f.namespace)||(a.handleObj=f,a.data=f.data,void 0!==(d=((aa.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,h))&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(!0!==i.disabled||"click"!==a.type){for(d=[],c=0;c<h;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?aa(e,this).index(i)>=0:aa.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||_,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[aa.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=xa.test(e)?this.mouseHooks:wa.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new aa.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=_),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==n()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===n()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&aa.nodeName(this,"input"))return this.click(),!1},_default:function(a){return aa.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=aa.extend(new aa.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?aa.event.trigger(e,null,b):aa.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},aa.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},aa.Event=function(a,b){if(!(this instanceof aa.Event))return new aa.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?l:m):this.type=a,b&&aa.extend(this,b),this.timeStamp=a&&a.timeStamp||aa.now(),this[aa.expando]=!0},aa.Event.prototype={isDefaultPrevented:m,isPropagationStopped:m,isImmediatePropagationStopped:m,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=l,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=l,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=l,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},aa.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){aa.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||aa.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),$.focusinBubbles||aa.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){aa.event.simulate(b,a.target,aa.event.fix(a),!0)};aa.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=oa.access(d,b);e||d.addEventListener(a,c,!0),oa.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=oa.access(d,b)-1;e?oa.access(d,b,e):(d.removeEventListener(a,c,!0),oa.remove(d,b))}}}),aa.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),!1===d)d=m;else if(!d)return this;return 1===e&&(f=d,d=function(a){return aa().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=aa.guid++)),this.each(function(){aa.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,aa(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return!1!==b&&"function"!=typeof b||(c=b,b=void 0),!1===c&&(c=m),this.each(function(){aa.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){aa.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return aa.event.trigger(a,b,c,!0)}});var Aa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ba=/<([\w:]+)/,Ca=/<|&#?\w+;/,Da=/<(?:script|style|link)/i,Ea=/checked\s*(?:[^=]|=\s*.checked.)/i,Fa=/^$|\/(?:java|ecma)script/i,Ga=/^true\/(.*)/,Ha={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ha.optgroup=Ha.option,Ha.tbody=Ha.tfoot=Ha.colgroup=Ha.caption=Ha.thead,Ha.th=Ha.td,aa.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=aa.contains(a.ownerDocument,a);if(!($.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||aa.isXMLDoc(a)))for(g=t(h),f=t(a),d=0,e=f.length;d<e;d++)u(f[d],g[d]);if(b)if(c)for(f=f||t(a),g=g||t(h),d=0,e=f.length;d<e;d++)s(f[d],g[d]);else s(a,h);return g=t(h,"script"),g.length>0&&r(g,!i&&t(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,n=a.length;m<n;m++)if((e=a[m])||0===e)if("object"===aa.type(e))aa.merge(l,e.nodeType?[e]:e);else if(Ca.test(e)){for(f=f||k.appendChild(b.createElement("div")),g=(Ba.exec(e)||["",""])[1].toLowerCase(),h=Ha[g]||Ha._default,f.innerHTML=h[1]+e.replace(Aa,"<$1></$2>")+h[2],j=h[0];j--;)f=f.lastChild;aa.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));for(k.textContent="",m=0;e=l[m++];)if((!d||-1===aa.inArray(e,d))&&(i=aa.contains(e.ownerDocument,e),f=t(k.appendChild(e),"script"),i&&r(f),c))for(j=0;e=f[j++];)Fa.test(e.type||"")&&c.push(e);return k},cleanData:function(a){for(var b,c,d,e,f=aa.event.special,g=0;void 0!==(c=a[g]);g++){if(aa.acceptData(c)&&(e=c[oa.expando])&&(b=oa.cache[e])){if(b.events)for(d in b.events)f[d]?aa.event.remove(c,d):aa.removeEvent(c,d,b.handle);oa.cache[e]&&delete oa.cache[e]}delete pa.cache[c[pa.expando]]}}}),aa.fn.extend({text:function(a){return na(this,function(a){return void 0===a?aa.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){o(this,a).appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=o(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?aa.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||aa.cleanData(t(c)),c.parentNode&&(b&&aa.contains(c.ownerDocument,c)&&r(t(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(aa.cleanData(t(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return aa.clone(this,a,b)})},html:function(a){return na(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Da.test(a)&&!Ha[(Ba.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Aa,"<$1></$2>");try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(aa.cleanData(t(b,!1)),b.innerHTML=a);b=0}catch(a){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,aa.cleanData(t(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=U.apply([],a);var c,d,e,f,g,h,i=0,j=this.length,k=this,l=j-1,m=a[0],n=aa.isFunction(m);if(n||j>1&&"string"==typeof m&&!$.checkClone&&Ea.test(m))return this.each(function(c){var d=k.eq(c);n&&(a[0]=m.call(this,c,d.html())),d.domManip(a,b)});if(j&&(c=aa.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(e=aa.map(t(c,"script"),p),f=e.length;i<j;i++)g=c,i!==l&&(g=aa.clone(g,!0,!0),f&&aa.merge(e,t(g,"script"))),b.call(this[i],g,i);if(f)for(h=e[e.length-1].ownerDocument,aa.map(e,q),i=0;i<f;i++)g=e[i],Fa.test(g.type||"")&&!oa.access(g,"globalEval")&&aa.contains(h,g)&&(g.src?aa._evalUrl&&aa._evalUrl(g.src):aa.globalEval(g.textContent.replace(/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,"")))}return this}}),aa.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){aa.fn[a]=function(a){for(var c,d=[],e=aa(a),f=e.length-1,g=0;g<=f;g++)c=g===f?this:this.clone(!0),aa(e[g])[b](c),V.apply(d,c.get());return this.pushStack(d)}});var Ia,Ja={},Ka=/^margin/,La=new RegExp("^("+sa+")(?!px)[a-z%]+$","i"),Ma=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)};!function(){function b(){g.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",g.innerHTML="",e.appendChild(f);var b=a.getComputedStyle(g,null);c="1%"!==b.top,d="4px"===b.width,e.removeChild(f)}var c,d,e=_.documentElement,f=_.createElement("div"),g=_.createElement("div");g.style&&(g.style.backgroundClip="content-box",g.cloneNode(!0).style.backgroundClip="",$.clearCloneStyle="content-box"===g.style.backgroundClip,f.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",f.appendChild(g),a.getComputedStyle&&aa.extend($,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return null==d&&b(),d},reliableMarginRight:function(){var b,c=g.appendChild(_.createElement("div"));return c.style.cssText=g.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",g.style.width="1px",e.appendChild(f),b=!parseFloat(a.getComputedStyle(c,null).marginRight),e.removeChild(f),g.removeChild(c),b}}))}(),aa.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Na=/^(none|table(?!-c[ea]).+)/,Oa=new RegExp("^("+sa+")(.*)$","i"),Pa=new RegExp("^([+-])=("+sa+")","i"),Qa={position:"absolute",visibility:"hidden",display:"block"},Ra={letterSpacing:"0",fontWeight:"400"},Sa=["Webkit","O","Moz","ms"];aa.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=x(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=aa.camelCase(b),i=a.style;if(b=aa.cssProps[h]||(aa.cssProps[h]=z(i,h)),g=aa.cssHooks[b]||aa.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];f=typeof c,"string"===f&&(e=Pa.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(aa.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||aa.cssNumber[h]||(c+="px"),$.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c))}},css:function(a,b,c,d){var e,f,g,h=aa.camelCase(b);return b=aa.cssProps[h]||(aa.cssProps[h]=z(a.style,h)),g=aa.cssHooks[b]||aa.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=x(a,b,d)),"normal"===e&&b in Ra&&(e=Ra[b]),""===c||c?(f=parseFloat(e),!0===c||aa.isNumeric(f)?f||0:e):e}}),aa.each(["height","width"],function(a,b){aa.cssHooks[b]={get:function(a,c,d){if(c)return Na.test(aa.css(a,"display"))&&0===a.offsetWidth?aa.swap(a,Qa,function(){return C(a,b,d)}):C(a,b,d)},set:function(a,c,d){var e=d&&Ma(a);return A(a,c,d?B(a,b,d,"border-box"===aa.css(a,"boxSizing",!1,e),e):0)}}}),aa.cssHooks.marginRight=y($.reliableMarginRight,function(a,b){if(b)return aa.swap(a,{display:"inline-block"},x,[a,"marginRight"])}),aa.each({margin:"",padding:"",border:"Width"},function(a,b){aa.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+ta[d]+b]=f[d]||f[d-2]||f[0];return e}},Ka.test(a)||(aa.cssHooks[a+b].set=A)}),aa.fn.extend({css:function(a,b){return na(this,function(a,b,c){var d,e,f={},g=0;if(aa.isArray(b)){for(d=Ma(a),e=b.length;g<e;g++)f[b[g]]=aa.css(a,b[g],!1,d);return f}return void 0!==c?aa.style(a,b,c):aa.css(a,b)},a,b,arguments.length>1)},show:function(){return D(this,!0)},hide:function(){return D(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){ua(this)?aa(this).show():aa(this).hide()})}}),aa.Tween=E,E.prototype={constructor:E,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(aa.cssNumber[c]?"":"px")},cur:function(){var a=E.propHooks[this.prop];return a&&a.get?a.get(this):E.propHooks._default.get(this)},run:function(a){var b,c=E.propHooks[this.prop];return this.options.duration?this.pos=b=aa.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):E.propHooks._default.set(this),this}},E.prototype.init.prototype=E.prototype,E.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=aa.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){aa.fx.step[a.prop]?aa.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[aa.cssProps[a.prop]]||aa.cssHooks[a.prop])?aa.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},E.propHooks.scrollTop=E.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},aa.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},aa.fx=E.prototype.init,aa.fx.step={};var Ta,Ua,Va=/^(?:toggle|show|hide)$/,Wa=new RegExp("^(?:([+-])=|)("+sa+")([a-z%]*)$","i"),Xa=/queueHooks$/,Ya=[I],Za={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Wa.exec(b),f=e&&e[3]||(aa.cssNumber[a]?"":"px"),g=(aa.cssNumber[a]||"px"!==f&&+d)&&Wa.exec(aa.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do{h=h||".5",g/=h,aa.style(c.elem,a,g+f)}while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};aa.Animation=aa.extend(K,{tweener:function(a,b){aa.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],Za[c]=Za[c]||[],Za[c].unshift(b)},prefilter:function(a,b){b?Ya.unshift(a):Ya.push(a)}}),aa.speed=function(a,b,c){var d=a&&"object"==typeof a?aa.extend({},a):{complete:c||!c&&b||aa.isFunction(a)&&a,duration:a,easing:c&&b||b&&!aa.isFunction(b)&&b};return d.duration=aa.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in aa.fx.speeds?aa.fx.speeds[d.duration]:aa.fx.speeds._default,null!=d.queue&&!0!==d.queue||(d.queue="fx"),d.old=d.complete,d.complete=function(){aa.isFunction(d.old)&&d.old.call(this),d.queue&&aa.dequeue(this,d.queue)},d},aa.fn.extend({fadeTo:function(a,b,c,d){
return this.filter(ua).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=aa.isEmptyObject(a),f=aa.speed(b,c,d),g=function(){var b=K(this,aa.extend({},a),f);(e||oa.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||!1===f.queue?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=aa.timers,g=oa.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Xa.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||aa.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,c=oa.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=aa.timers,g=d?d.length:0;for(c.finish=!0,aa.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),aa.each(["toggle","show","hide"],function(a,b){var c=aa.fn[b];aa.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(G(b,!0),a,d,e)}}),aa.each({slideDown:G("show"),slideUp:G("hide"),slideToggle:G("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){aa.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),aa.timers=[],aa.fx.tick=function(){var a,b=0,c=aa.timers;for(Ta=aa.now();b<c.length;b++)(a=c[b])()||c[b]!==a||c.splice(b--,1);c.length||aa.fx.stop(),Ta=void 0},aa.fx.timer=function(a){aa.timers.push(a),a()?aa.fx.start():aa.timers.pop()},aa.fx.interval=13,aa.fx.start=function(){Ua||(Ua=setInterval(aa.fx.tick,aa.fx.interval))},aa.fx.stop=function(){clearInterval(Ua),Ua=null},aa.fx.speeds={slow:600,fast:200,_default:400},aa.fn.delay=function(a,b){return a=aa.fx?aa.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=_.createElement("input"),b=_.createElement("select"),c=b.appendChild(_.createElement("option"));a.type="checkbox",$.checkOn=""!==a.value,$.optSelected=c.selected,b.disabled=!0,$.optDisabled=!c.disabled,a=_.createElement("input"),a.value="t",a.type="radio",$.radioValue="t"===a.value}();var $a,_a=aa.expr.attrHandle;aa.fn.extend({attr:function(a,b){return na(this,aa.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){aa.removeAttr(this,a)})}}),aa.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return void 0===a.getAttribute?aa.prop(a,b,c):(1===f&&aa.isXMLDoc(a)||(b=b.toLowerCase(),d=aa.attrHooks[b]||(aa.expr.match.bool.test(b)?$a:void 0)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=aa.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void aa.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(ka);if(f&&1===a.nodeType)for(;c=f[e++];)d=aa.propFix[c]||c,aa.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!$.radioValue&&"radio"===b&&aa.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),$a={set:function(a,b,c){return!1===b?aa.removeAttr(a,c):a.setAttribute(c,c),c}},aa.each(aa.expr.match.bool.source.match(/\w+/g),function(a,b){var c=_a[b]||aa.find.attr;_a[b]=function(a,b,d){var e,f;return d||(f=_a[b],_a[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,_a[b]=f),e}});var ab=/^(?:input|select|textarea|button)$/i;aa.fn.extend({prop:function(a,b){return na(this,aa.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[aa.propFix[a]||a]})}}),aa.extend({propFix:{for:"htmlFor",class:"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!aa.isXMLDoc(a),f&&(b=aa.propFix[b]||b,e=aa.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||ab.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),$.optSelected||(aa.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),aa.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){aa.propFix[this.toLowerCase()]=this});aa.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(aa.isFunction(a))return this.each(function(b){aa(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(ka)||[];i<j;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(/[\t\r\n\f]/g," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=aa.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(aa.isFunction(a))return this.each(function(b){aa(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(ka)||[];i<j;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(/[\t\r\n\f]/g," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");g=a?aa.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):aa.isFunction(a)?this.each(function(c){aa(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=aa(this),f=a.match(ka)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else"undefined"!==c&&"boolean"!==c||(this.className&&oa.set(this,"__className__",this.className),this.className=this.className||!1===a?"":oa.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;c<d;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(/[\t\r\n\f]/g," ").indexOf(b)>=0)return!0;return!1}});aa.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=aa.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,aa(this).val()):a,null==e?e="":"number"==typeof e?e+="":aa.isArray(e)&&(e=aa.map(e,function(a){return null==a?"":a+""})),(b=aa.valHooks[this.type]||aa.valHooks[this.nodeName.toLowerCase()])&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return(b=aa.valHooks[e.type]||aa.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(/\r/g,""):null==c?"":c)}}}),aa.extend({valHooks:{option:{get:function(a){var b=aa.find.attr(a,"value");return null!=b?b:aa.trim(aa.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?null:[],h=f?e+1:d.length,i=e<0?h:f?e:0;i<h;i++)if(c=d[i],(c.selected||i===e)&&($.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!aa.nodeName(c.parentNode,"optgroup"))){if(b=aa(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=aa.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=aa.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),aa.each(["radio","checkbox"],function(){aa.valHooks[this]={set:function(a,b){if(aa.isArray(b))return a.checked=aa.inArray(aa(a).val(),b)>=0}},$.checkOn||(aa.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),aa.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){aa.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),aa.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var bb=aa.now(),cb=/\?/;aa.parseJSON=function(a){return JSON.parse(a+"")},aa.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(a){b=void 0}return b&&!b.getElementsByTagName("parsererror").length||aa.error("Invalid XML: "+a),b};var db=/([?&])_=[^&]*/,eb=/^(.*?):[ \t]*([^\r\n]*)$/gm,fb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,gb=/^(?:GET|HEAD)$/,hb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,ib={},jb={},kb="*/".concat("*"),lb=a.location.href,mb=hb.exec(lb.toLowerCase())||[];aa.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:lb,type:"GET",isLocal:fb.test(mb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":kb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":aa.parseJSON,"text xml":aa.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?N(N(a,aa.ajaxSettings),b):N(aa.ajaxSettings,a)},ajaxPrefilter:L(ib),ajaxTransport:L(jb),ajax:function(a,b){function c(a,b,c,g){var i,k,r,s,u,w=b;2!==t&&(t=2,h&&clearTimeout(h),d=void 0,f=g||"",v.readyState=a>0?4:0,i=a>=200&&a<300||304===a,c&&(s=O(l,v,c)),s=P(l,s,v,i),i?(l.ifModified&&(u=v.getResponseHeader("Last-Modified"),u&&(aa.lastModified[e]=u),(u=v.getResponseHeader("etag"))&&(aa.etag[e]=u)),204===a||"HEAD"===l.type?w="nocontent":304===a?w="notmodified":(w=s.state,k=s.data,r=s.error,i=!r)):(r=w,!a&&w||(w="error",a<0&&(a=0))),v.status=a,v.statusText=(b||w)+"",i?o.resolveWith(m,[k,w,v]):o.rejectWith(m,[v,w,r]),v.statusCode(q),q=void 0,j&&n.trigger(i?"ajaxSuccess":"ajaxError",[v,l,i?k:r]),p.fireWith(m,[v,w]),j&&(n.trigger("ajaxComplete",[v,l]),--aa.active||aa.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,f,g,h,i,j,k,l=aa.ajaxSetup({},b),m=l.context||l,n=l.context&&(m.nodeType||m.jquery)?aa(m):aa.event,o=aa.Deferred(),p=aa.Callbacks("once memory"),q=l.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!g)for(g={};b=eb.exec(f);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(l.mimeType=a),this},statusCode:function(a){var b;if(a)if(t<2)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return d&&d.abort(b),c(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,l.url=((a||l.url||lb)+"").replace(/#.*$/,"").replace(/^\/\//,mb[1]+"//"),l.type=b.method||b.type||l.method||l.type,l.dataTypes=aa.trim(l.dataType||"*").toLowerCase().match(ka)||[""],null==l.crossDomain&&(i=hb.exec(l.url.toLowerCase()),l.crossDomain=!(!i||i[1]===mb[1]&&i[2]===mb[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(mb[3]||("http:"===mb[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=aa.param(l.data,l.traditional)),M(ib,l,b,v),2===t)return v;j=aa.event&&l.global,j&&0==aa.active++&&aa.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!gb.test(l.type),e=l.url,l.hasContent||(l.data&&(e=l.url+=(cb.test(e)?"&":"?")+l.data,delete l.data),!1===l.cache&&(l.url=db.test(e)?e.replace(db,"$1_="+bb++):e+(cb.test(e)?"&":"?")+"_="+bb++)),l.ifModified&&(aa.lastModified[e]&&v.setRequestHeader("If-Modified-Since",aa.lastModified[e]),aa.etag[e]&&v.setRequestHeader("If-None-Match",aa.etag[e])),(l.data&&l.hasContent&&!1!==l.contentType||b.contentType)&&v.setRequestHeader("Content-Type",l.contentType),v.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+kb+"; q=0.01":""):l.accepts["*"]);for(k in l.headers)v.setRequestHeader(k,l.headers[k]);if(l.beforeSend&&(!1===l.beforeSend.call(m,v,l)||2===t))return v.abort();u="abort";for(k in{success:1,error:1,complete:1})v[k](l[k]);if(d=M(jb,l,b,v)){v.readyState=1,j&&n.trigger("ajaxSend",[v,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){v.abort("timeout")},l.timeout));try{t=1,d.send(r,c)}catch(a){if(!(t<2))throw a;c(-1,a)}}else c(-1,"No Transport");return v},getJSON:function(a,b,c){return aa.get(a,b,c,"json")},getScript:function(a,b){return aa.get(a,void 0,b,"script")}}),aa.each(["get","post"],function(a,b){aa[b]=function(a,c,d,e){return aa.isFunction(c)&&(e=e||d,d=c,c=void 0),aa.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),aa._evalUrl=function(a){return aa.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},aa.fn.extend({wrapAll:function(a){var b;return aa.isFunction(a)?this.each(function(b){aa(this).wrapAll(a.call(this,b))}):(this[0]&&(b=aa(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return aa.isFunction(a)?this.each(function(b){aa(this).wrapInner(a.call(this,b))}):this.each(function(){var b=aa(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=aa.isFunction(a);return this.each(function(c){aa(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){aa.nodeName(this,"body")||aa(this).replaceWith(this.childNodes)}).end()}}),aa.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},aa.expr.filters.visible=function(a){return!aa.expr.filters.hidden(a)};var nb=/\[\]$/,ob=/^(?:submit|button|image|reset|file)$/i,pb=/^(?:input|select|textarea|keygen)/i;aa.param=function(a,b){var c,d=[],e=function(a,b){b=aa.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=aa.ajaxSettings&&aa.ajaxSettings.traditional),aa.isArray(a)||a.jquery&&!aa.isPlainObject(a))aa.each(a,function(){e(this.name,this.value)});else for(c in a)Q(c,a[c],b,e);return d.join("&").replace(/%20/g,"+")},aa.fn.extend({serialize:function(){return aa.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=aa.prop(this,"elements");return a?aa.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!aa(this).is(":disabled")&&pb.test(this.nodeName)&&!ob.test(a)&&(this.checked||!va.test(a))}).map(function(a,b){var c=aa(this).val();return null==c?null:aa.isArray(c)?aa.map(c,function(a){return{name:b.name,value:a.replace(/\r?\n/g,"\r\n")}}):{name:b.name,value:c.replace(/\r?\n/g,"\r\n")}}).get()}}),aa.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var qb=0,rb={},sb={0:200,1223:204},tb=aa.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in rb)rb[a]()}),$.cors=!!tb&&"withCredentials"in tb,$.ajax=tb=!!tb,aa.ajaxTransport(function(a){var b;if($.cors||tb&&!a.crossDomain)return{send:function(c,d){var e,f=a.xhr(),g=++qb;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete rb[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(sb[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=rb[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(a){if(b)throw a}},abort:function(){b&&b()}}}),aa.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return aa.globalEval(a),a}}}),aa.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),aa.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=aa("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),_.head.appendChild(b[0])},abort:function(){c&&c()}}}});var ub=[],vb=/(=)\?(?=&|$)|\?\?/;aa.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=ub.pop()||aa.expando+"_"+bb++;return this[a]=!0,a}}),aa.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=!1!==b.jsonp&&(vb.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&vb.test(b.data)&&"data");if(h||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=aa.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(vb,"$1"+e):!1!==b.jsonp&&(b.url+=(cb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||aa.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,ub.push(e)),g&&aa.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),aa.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||_;var d=ea.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=aa.buildFragment([a],b,e),e&&e.length&&aa(e).remove(),aa.merge([],d.childNodes))};var wb=aa.fn.load;aa.fn.load=function(a,b,c){if("string"!=typeof a&&wb)return wb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=aa.trim(a.slice(h)),a=a.slice(0,h)),aa.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&aa.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?aa("<div>").append(aa.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},aa.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){aa.fn[b]=function(a){return this.on(b,a)}}),aa.expr.filters.animated=function(a){return aa.grep(aa.timers,function(b){return a===b.elem}).length};var xb=a.document.documentElement;aa.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=aa.css(a,"position"),l=aa(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=aa.css(a,"top"),i=aa.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),aa.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},aa.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){aa.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,aa.contains(b,d)?(void 0!==d.getBoundingClientRect&&(e=d.getBoundingClientRect()),c=R(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===aa.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),aa.nodeName(a[0],"html")||(d=a.offset()),d.top+=aa.css(a[0],"borderTopWidth",!0),d.left+=aa.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-aa.css(c,"marginTop",!0),left:b.left-d.left-aa.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||xb;a&&!aa.nodeName(a,"html")&&"static"===aa.css(a,"position");)a=a.offsetParent;return a||xb})}}),aa.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;aa.fn[b]=function(e){return na(this,function(b,e,f){var g=R(b);if(void 0===f)return g?g[c]:b[e];g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f},b,e,arguments.length,null)}}),aa.each(["top","left"],function(a,b){aa.cssHooks[b]=y($.pixelPosition,function(a,c){if(c)return c=x(a,b),La.test(c)?aa(a).position()[b]+"px":c})}),aa.each({Height:"height",Width:"width"},function(a,b){aa.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){aa.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(!0===d||!0===e?"margin":"border");return na(this,function(b,c,d){var e;return aa.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?aa.css(b,c,g):aa.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),aa.fn.size=function(){return this.length},aa.fn.andSelf=aa.fn.addBack,"function"==typeof b&&b.amd&&b("jquery",[],function(){return aa});var yb=a.jQuery,zb=a.$;return aa.noConflict=function(b){return a.$===aa&&(a.$=zb),b&&a.jQuery===aa&&(a.jQuery=yb),aa},aa}(a)}),b("spreadsheet/config",function(){return{User:{initRowNum:100,initColNum:26,cellWidth:72,cellHeight:20,maxColNum:100,maxRowNum:9999,commentWidth:150,commentHeight:150},System:{outerLeft:37,outerTop:20,outerBottom:30,effectDistanceCol:10,effectDistanceRow:5,prestrainHeight:200,prestrainWidth:100,maxRowNum:9999},mouseOperateState:{select:"operation",dataSource:"datasource",drag:"drag",highlight:"highlight"},dateFormatType:{frist:"yyyy/MM/dd",second:"yyyy/MM",third:"yyyy",fourth:"yyyy年MM月dd日",fifth:"yyyy年MM月",sixth:"yyyy年"},defaultNumberFormat:{decimal:6},keyboard:{backspace:8,deleteKey:46,enter:13,escape:27,pageUp:33,pageDown:34,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40},shortcuts:{cut:!0,copy:!0,paste:!0,altEnter:!0,enter:!0},version:"0.8.0",rootPath:"ocalhost:8080/pubexcel/"}}),b("basic/tools/cache",function(){return{sendQueueStep:0,containerId:"",CurrentRule:{},FrozenRules:{main:[],row:[],col:[]},scrollBufferHeight:600,CellsPosition:{strandX:{},strandY:{}},clipState:"null",UserView:{colAlias:"1",rowAlias:"1",colEndAlias:"1",rowEndAlias:"1"},highlightDirection:"null",mouseOperateState:c("spreadsheet/config").mouseOperateState.select,listenerList:{},localRowPosi:0,localColPosi:0,aliasRowCounter:"100",aliasColCounter:"26",loadCol:{startSort:0,endSort:0},TempProp:{isFrozen:!1,colAlias:"1",rowAlias:"1",rowFrozen:!1,colFrozen:!1},rowRegionPosi:[],colRegionPosi:[],cellRegionPosi:{transverse:[],vertical:[]},viewRegion:{top:0,bottom:0,left:0,right:0},commentEidtState:!1,cachePosition:function(a,b,c){var d,e;d=this.CellsPosition.strandX,d[b]||(d[b]={}),d[b][a]||(d[b][a]={}),e=this.CellsPosition.strandY,e[a]||(e[a]={}),e[a][b]||(e[a][b]={}),d[b][a]=c,e[a][b]=c},deletePosi:function(a,b){var c=this.CellsPosition,d=c.strandX,e=c.strandY;void 0!==d[b]&&void 0!==d[b][a]&&(delete d[b][a],Object.getOwnPropertyNames(d[b]).length||delete d[b]),void 0!==e[a]&&void 0!==e[a][b]&&(delete e[a][b],Object.getOwnPropertyNames(e[a]).length||delete e[a])},aliasGenerator:function(a){var b,c;return b="col"===a?this.aliasColCounter:this.aliasRowCounter,c=parseInt(b),b=(c+1).toString(),"col"===a?this.aliasColCounter=b:this.aliasRowCounter=b,b}}}),b("basic/tools/point",function(){return function(a){var b=/^[A-Z]+$/,c=/^[1-9]+[0-9]*$/;if("object"!=typeof a)throw new Error("Parameter format error");if(this.startCol=a.startCol,this.startRow=a.startRow,this.endCol=a.endCol||a.startCol,this.endRow=a.endRow||a.startRow,this.success=a.success,this.error=a.error,void 0===this.startRow&&void 0===this.startCol)throw new Error("Parameter format error");if(void 0!==this.startCol&&!b.test(this.startCol))throw new Error("Parameter format error");if(void 0!==this.startRow&&!c.test(this.startRow))throw new Error("Parameter format error");if(void 0!==this.endCol&&!b.test(this.endCol))throw new Error("Parameter format error");if(void 0!==this.endRow&&!c.test(this.endRow))throw new Error("Parameter format error");if(!this.success&&"function"==typeof this.success)throw new Error("Parameter format error");if(!this.error&&"function"==typeof this.error)throw new Error("Parameter format error")}}),b("basic/util/binary",function(){return{modelBinary:function(a,b,c,d,e,f){var g,h,i,j,k,l=e||0,m=Math.floor(a);if(h=void 0===f?b.length-1:f,l<=h){if(b[l].get(c)===m)return l;if(b[h].get(c)===m)return h;if(g=h+l>>>1,k=b[g],i=k.get(c),j=k.get(d),i<=m&&i+j>=m)return g;if(i>m)return this.modelBinary(m,b,c,d,l,g-1);if(i+j<m)return this.modelBinary(m,b,c,d,g+1,h)}return-1},newModelBinary:function(a,b,c,d,e,f){for(var g,h,i,j,k=e||0,l=f||b.length,m=Math.floor(a);k<l;)g=l+k>>>1,j=b[g],h=j.get(c),i=j.get(d),h+i<m?k=g+1:l=g;return k},indexModelBinary:function(a,b,c,d,e,f){if(0===b.length)return 0;var g,h,i,j,k=e||0,l=f||b.length-1,m=Math.floor(a);if(1===b.length)return b[0].get(c)+b[0].get(d)>=m?0:1;for(;k<l;){if(b[k].get(c)+b[k].get(d)>=m)return k;if(b[l].get(c)+b[l].get(d)===m)return l;if(b[l].get(c)+b[l].get(d)<m)return l+1;g=l+k>>>1,j=b[g],h=j.get(c),i=j.get(d),h+i<m?k=g+1:l=g}return k},existArrayBinary:function(a,b,c,d,e,f){var g,h=e||0,i=f||b.length-1,j=Math.floor(a);if(0===b.length)return!1;if(1===b.length)return b[0][d]>=j&&b[0][c]<=j;for(;h<i;){if(b[h][c]<=j&&b[h][d]>=j)return!0;if(b[i][c]<=j&&b[i][d]>=j)return!0;if(g=i+h>>>1,b[i][c]<=j&&b[i][d]>=j)return!0;b[g][d]<j?h=g+1:i=g}return!1},indexArrayBinary:function(a,b,c,d,e,f){var g,h=e||0,i=f||b.length-1,j=Math.floor(a);if(0===b.length)return 0;if(1===b.length)return b[h][d]<j?1:0;for(;h<i;){if(b[h][c]>=j)return h;if(b[i][d]<j)return i+1;if(g=i+h>>>1,b[g][c]<=j&&b[g][d]>=j)return g;b[g][d]<j?h=g+1:i=g}return h},indexAttrBinary:function(a,b,c,d,e){var f;if(d=d||0,e=e||b.length-1,b[d].get(c)>a)return-1;if(b[e].get(c)<a)return-1;for(;d<e;){if(b[d].get(c)===a)return d;if(b[e].get(c)===a)return e;if(f=e+d>>>1,b[f].get(c)===a)return f;b[f].get(c)<a?d=f+1:e=f}return-1}}}),b("basic/tools/send",function(){var b=c("lib/jquery"),d=c("basic/tools/cache"),e=c("spreadsheet/config");return{PackAjax:function(c){var f=this,g={},h=function(){},i=d.containerId;c.url&&(g={url:"string"==typeof c.url?e.rootPath+c.url:void 0,type:c.type||"post",contentType:c.contentType||"application/json; charset=UTF-8",dataType:c.dataType||"json",data:c.data||"",async:void 0!==c.async&&c.async,timeout:c.timeout||5e3,success:c.success||h,error:c.error||h,complete:c.complete||h,isPublic:void 0===c.isPublic||c.isPublic},!0===g.isPublic&&d.sendQueueStep++,b.ajax({url:g.url,beforeSend:function(b){var c=d.sendQueueStep;!0===g.isPublic?b.setRequestHeader("step",c):-1!==g.url.indexOf("openexcel")&&b.setRequestHeader("step",c),b.setRequestHeader("excelId",a.SPREADSHEET_AUTHENTIC_KEY),b.setRequestHeader("sheetId","1")},type:g.type,contentType:g.contentType,dataType:g.dataType,async:g.async,data:g.data,timeout:g.timeout,success:function(a){g.async||-1===a.returncode?(0===b("#"+i+" .loadmark").length&&b("#"+i).append('<div class="loadmark"></div>'),setTimeout(function(){f.PackAjax(c)},500)):(g.success(a),b("#"+i+" .loadmark").length>0&&b("#"+i+" .loadmark").remove())},error:g.error,complete:g.complete}))}}}),b("basic/tools/loadrecorder",function(){var a=c("basic/util/binary");return{insertPosi:function(b,c,d){var e,f,g,h,i,j,k,l,m,n;if(b>c&&(e=b,b=c,c=e),f=a.indexArrayBinary(b,d,"start","end"),g=a.indexArrayBinary(c,d,"start","end"),h=a.existArrayBinary(b,d,"start","end"),i=a.existArrayBinary(c,d,"start","end"),l=!1===h?b:d[f].start,m=!1===i?c:d[g].end,j=a.existArrayBinary(l-1,d,"start","end"),k=a.existArrayBinary(m+1,d,"start","end"),!0===j&&(f=a.indexArrayBinary(l-1,d,"start","end"),l=d[f].start,h=!0),!0===k&&(g=a.indexArrayBinary(m+1,d,"start","end"),m=d[g].end,i=!0),f===g){if(!0===h&&!0===i)return;n=!0===h||!0===i?1:0}else n=g-f,!0===i&&n++;d.splice(f,n,{start:l,end:m})},adaptPosi:function(b,c,d){var e,f;if(e=a.indexArrayBinary(b,d,"start","end"),!0===a.existArrayBinary(b,d,"start","end"))for(d[e].end=d[e].end+c,d[e].end<d[e].start?(f=e,d.splice(e,1)):f=e+1,f=e+1;f<d.length;f++)d[f].start+=c,d[f].end+=c;else for(f=e;f<d.length;f++)d[f].start+=c,d[f].end+=c},isUnloadPosi:function(b,c,d){var e,f,g,h;return e=a.indexArrayBinary(b,d,"start","end"),f=a.existArrayBinary(b,d,"start","end"),g=a.indexArrayBinary(c,d,"start","end"),h=a.existArrayBinary(c,d,"start","end"),!1===f||!1===h||e!==g}}}),b("basic/tools/buildalias",function(){return{buildColAlias:function(a){var b,c,d=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],e="";for(b=a%d.length,c=Math.floor(a/d.length),e=d[b]+e;c>0;)a=c-1,b=a%d.length,c=Math.floor(a/d.length),e=d[b]+e;return e},buildRowAlias:function(a){return(a+1).toString()}}}),b("lib/underscore",function(){var a="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this,b=a._,c=Array.prototype,d=Object.prototype,e="undefined"!=typeof Symbol?Symbol.prototype:null,f=c.push,g=c.slice,h=d.toString,i=d.hasOwnProperty,j=Array.isArray,k=Object.keys,l=Object.create,m=function(){},n=function(a){return a instanceof n?a:this instanceof n?void(this._wrapped=a):new n(a)};"undefined"==typeof exports||exports.nodeType?a._=n:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=n),exports._=n),n.VERSION="1.8.3";var o,p=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},q=function(a,b,c){return n.iteratee!==o?n.iteratee(a,b):null==a?n.identity:n.isFunction(a)?p(a,b,c):n.isObject(a)?n.matcher(a):n.property(a)};n.iteratee=o=function(a,b){return q(a,b,1/0)};var r=function(a,b){return b=null==b?a.length-1:+b,function(){for(var c=Math.max(arguments.length-b,0),d=Array(c),e=0;e<c;e++)d[e]=arguments[e+b];switch(b){case 0:return a.call(this,d);case 1:return a.call(this,arguments[0],d);case 2:return a.call(this,arguments[0],arguments[1],d)}var f=Array(b+1);for(e=0;e<b;e++)f[e]=arguments[e];return f[b]=d,a.apply(this,f)}},s=function(a){if(!n.isObject(a))return{};if(l)return l(a);m.prototype=a;var b=new m;return m.prototype=null,b},t=function(a){return function(b){return null==b?void 0:b[a]}},u=Math.pow(2,53)-1,v=t("length"),w=function(a){var b=v(a);return"number"==typeof b&&b>=0&&b<=u};n.each=n.forEach=function(a,b,c){b=p(b,c);var d,e;if(w(a))for(d=0,e=a.length;d<e;d++)b(a[d],d,a);else{var f=n.keys(a);for(d=0,e=f.length;d<e;d++)b(a[f[d]],f[d],a)}return a},n.map=n.collect=function(a,b,c){b=q(b,c);for(var d=!w(a)&&n.keys(a),e=(d||a).length,f=Array(e),g=0;g<e;g++){var h=d?d[g]:g;f[g]=b(a[h],h,a)}return f};var x=function(a){var b=function(b,c,d,e){var f=!w(b)&&n.keys(b),g=(f||b).length,h=a>0?0:g-1;for(e||(d=b[f?f[h]:h],h+=a);h>=0&&h<g;h+=a){var i=f?f[h]:h;d=c(d,b[i],i,b)}return d};return function(a,c,d,e){var f=arguments.length>=3;return b(a,p(c,e,4),d,f)}};n.reduce=n.foldl=n.inject=x(1),n.reduceRight=n.foldr=x(-1),n.find=n.detect=function(a,b,c){var d=w(a)?n.findIndex:n.findKey,e=d(a,b,c);if(void 0!==e&&-1!==e)return a[e]},n.filter=n.select=function(a,b,c){var d=[];return b=q(b,c),n.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d},n.reject=function(a,b,c){return n.filter(a,n.negate(q(b)),c)},n.every=n.all=function(a,b,c){b=q(b,c);for(var d=!w(a)&&n.keys(a),e=(d||a).length,f=0;f<e;f++){var g=d?d[f]:f;if(!b(a[g],g,a))return!1}return!0},n.some=n.any=function(a,b,c){b=q(b,c);for(var d=!w(a)&&n.keys(a),e=(d||a).length,f=0;f<e;f++){var g=d?d[f]:f;if(b(a[g],g,a))return!0}return!1},n.contains=n.includes=n.include=function(a,b,c,d){return w(a)||(a=n.values(a)),("number"!=typeof c||d)&&(c=0),n.indexOf(a,b,c)>=0},
n.invoke=r(function(a,b,c){var d=n.isFunction(b);return n.map(a,function(a){var e=d?b:a[b];return null==e?e:e.apply(a,c)})}),n.pluck=function(a,b){return n.map(a,n.property(b))},n.where=function(a,b){return n.filter(a,n.matcher(b))},n.findWhere=function(a,b){return n.find(a,n.matcher(b))},n.max=function(a,b,c){var d,e,f=-1/0,g=-1/0;if(null==b||"number"==typeof b&&"object"!=typeof a[0]&&null!=a){a=w(a)?a:n.values(a);for(var h=0,i=a.length;h<i;h++)null!=(d=a[h])&&d>f&&(f=d)}else b=q(b,c),n.each(a,function(a,c,d){((e=b(a,c,d))>g||e===-1/0&&f===-1/0)&&(f=a,g=e)});return f},n.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b||"number"==typeof b&&"object"!=typeof a[0]&&null!=a){a=w(a)?a:n.values(a);for(var h=0,i=a.length;h<i;h++)null!=(d=a[h])&&d<f&&(f=d)}else b=q(b,c),n.each(a,function(a,c,d){((e=b(a,c,d))<g||e===1/0&&f===1/0)&&(f=a,g=e)});return f},n.shuffle=function(a){return n.sample(a,1/0)},n.sample=function(a,b,c){if(null==b||c)return w(a)||(a=n.values(a)),a[n.random(a.length-1)];var d=w(a)?n.clone(a):n.values(a),e=v(d);b=Math.max(Math.min(b,e),0);for(var f=e-1,g=0;g<b;g++){var h=n.random(g,f),i=d[g];d[g]=d[h],d[h]=i}return d.slice(0,b)},n.sortBy=function(a,b,c){var d=0;return b=q(b,c),n.pluck(n.map(a,function(a,c,e){return{value:a,index:d++,criteria:b(a,c,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index-b.index}),"value")};var y=function(a,b){return function(c,d,e){var f=b?[[],[]]:{};return d=q(d,e),n.each(c,function(b,e){var g=d(b,e,c);a(f,b,g)}),f}};n.groupBy=y(function(a,b,c){n.has(a,c)?a[c].push(b):a[c]=[b]}),n.indexBy=y(function(a,b,c){a[c]=b}),n.countBy=y(function(a,b,c){n.has(a,c)?a[c]++:a[c]=1});n.toArray=function(a){return a?n.isArray(a)?g.call(a):n.isString(a)?a.match(/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g):w(a)?n.map(a,n.identity):n.values(a):[]},n.size=function(a){return null==a?0:w(a)?a.length:n.keys(a).length},n.partition=y(function(a,b,c){a[c?0:1].push(b)},!0),n.first=n.head=n.take=function(a,b,c){if(!(null==a||a.length<1))return null==b||c?a[0]:n.initial(a,a.length-b)},n.initial=function(a,b,c){return g.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},n.last=function(a,b,c){if(!(null==a||a.length<1))return null==b||c?a[a.length-1]:n.rest(a,Math.max(0,a.length-b))},n.rest=n.tail=n.drop=function(a,b,c){return g.call(a,null==b||c?1:b)},n.compact=function(a){return n.filter(a,Boolean)};var z=function(a,b,c,d){d=d||[];for(var e=d.length,f=0,g=v(a);f<g;f++){var h=a[f];if(w(h)&&(n.isArray(h)||n.isArguments(h)))if(b)for(var i=0,j=h.length;i<j;)d[e++]=h[i++];else z(h,b,c,d),e=d.length;else c||(d[e++]=h)}return d};n.flatten=function(a,b){return z(a,b,!1)},n.without=r(function(a,b){return n.difference(a,b)}),n.uniq=n.unique=function(a,b,c,d){n.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=q(c,d));for(var e=[],f=[],g=0,h=v(a);g<h;g++){var i=a[g],j=c?c(i,g,a):i;b?(g&&f===j||e.push(i),f=j):c?n.contains(f,j)||(f.push(j),e.push(i)):n.contains(e,i)||e.push(i)}return e},n.union=r(function(a){return n.uniq(z(a,!0,!0))}),n.intersection=function(a){for(var b=[],c=arguments.length,d=0,e=v(a);d<e;d++){var f=a[d];if(!n.contains(b,f)){var g;for(g=1;g<c&&n.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},n.difference=r(function(a,b){return b=z(b,!0,!0),n.filter(a,function(a){return!n.contains(b,a)})}),n.unzip=function(a){for(var b=a&&n.max(a,v).length||0,c=Array(b),d=0;d<b;d++)c[d]=n.pluck(a,d);return c},n.zip=r(n.unzip),n.object=function(a,b){for(var c={},d=0,e=v(a);d<e;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c};var A=function(a){return function(b,c,d){c=q(c,d);for(var e=v(b),f=a>0?0:e-1;f>=0&&f<e;f+=a)if(c(b[f],f,b))return f;return-1}};n.findIndex=A(1),n.findLastIndex=A(-1),n.sortedIndex=function(a,b,c,d){c=q(c,d,1);for(var e=c(b),f=0,g=v(a);f<g;){var h=Math.floor((f+g)/2);c(a[h])<e?f=h+1:g=h}return f};var B=function(a,b,c){return function(d,e,f){var h=0,i=v(d);if("number"==typeof f)a>0?h=f>=0?f:Math.max(f+i,h):i=f>=0?Math.min(f+1,i):f+i+1;else if(c&&f&&i)return f=c(d,e),d[f]===e?f:-1;if(e!==e)return f=b(g.call(d,h,i),n.isNaN),f>=0?f+h:-1;for(f=a>0?h:i-1;f>=0&&f<i;f+=a)if(d[f]===e)return f;return-1}};n.indexOf=B(1,n.findIndex,n.sortedIndex),n.lastIndexOf=B(-1,n.findLastIndex),n.range=function(a,b,c){null==b&&(b=a||0,a=0),c||(c=b<a?-1:1);for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;f<d;f++,a+=c)e[f]=a;return e},n.chunk=function(a,b){if(null==b||b<1)return[];for(var c=[],d=0,e=a.length;d<e;)c.push(g.call(a,d,d+=b));return c};var C=function(a,b,c,d,e){if(!(d instanceof b))return a.apply(c,e);var f=s(a.prototype),g=a.apply(f,e);return n.isObject(g)?g:f};n.bind=r(function(a,b,c){if(!n.isFunction(a))throw new TypeError("Bind must be called on a function");var d=r(function(e){return C(a,d,b,this,c.concat(e))});return d}),n.partial=r(function(a,b){var c=n.partial.placeholder,d=function(){for(var e=0,f=b.length,g=Array(f),h=0;h<f;h++)g[h]=b[h]===c?arguments[e++]:b[h];for(;e<arguments.length;)g.push(arguments[e++]);return C(a,d,this,this,g)};return d}),n.partial.placeholder=n,n.bindAll=r(function(a,b){b=z(b,!1,!1);var c=b.length;if(c<1)throw new Error("bindAll must be passed function names");for(;c--;){var d=b[c];a[d]=n.bind(a[d],a)}}),n.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);return n.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},n.delay=r(function(a,b,c){return setTimeout(function(){return a.apply(null,c)},b)}),n.defer=n.partial(n.delay,n,1),n.throttle=function(a,b,c){var d,e,f,g,h=0;c||(c={});var i=function(){h=!1===c.leading?0:n.now(),d=null,g=a.apply(e,f),d||(e=f=null)},j=function(){var j=n.now();h||!1!==c.leading||(h=j);var k=b-(j-h);return e=this,f=arguments,k<=0||k>b?(d&&(clearTimeout(d),d=null),h=j,g=a.apply(e,f),d||(e=f=null)):d||!1===c.trailing||(d=setTimeout(i,k)),g};return j.cancel=function(){clearTimeout(d),h=0,d=e=f=null},j},n.debounce=function(a,b,c){var d,e,f=function(b,c){d=null,c&&(e=a.apply(b,c))},g=r(function(g){if(d&&clearTimeout(d),c){var h=!d;d=setTimeout(f,b),h&&(e=a.apply(this,g))}else d=n.delay(f,b,this,g);return e});return g.cancel=function(){clearTimeout(d),d=null},g},n.wrap=function(a,b){return n.partial(b,a)},n.negate=function(a){return function(){return!a.apply(this,arguments)}},n.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},n.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}},n.before=function(a,b){var c;return function(){return--a>0&&(c=b.apply(this,arguments)),a<=1&&(b=null),c}},n.once=n.partial(n.before,2),n.restArgs=r;var D=!{toString:null}.propertyIsEnumerable("toString"),E=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],F=function(a,b){var c=E.length,e=a.constructor,f=n.isFunction(e)&&e.prototype||d,g="constructor";for(n.has(a,g)&&!n.contains(b,g)&&b.push(g);c--;)(g=E[c])in a&&a[g]!==f[g]&&!n.contains(b,g)&&b.push(g)};n.keys=function(a){if(!n.isObject(a))return[];if(k)return k(a);var b=[];for(var c in a)n.has(a,c)&&b.push(c);return D&&F(a,b),b},n.allKeys=function(a){if(!n.isObject(a))return[];var b=[];for(var c in a)b.push(c);return D&&F(a,b),b},n.values=function(a){for(var b=n.keys(a),c=b.length,d=Array(c),e=0;e<c;e++)d[e]=a[b[e]];return d},n.mapObject=function(a,b,c){b=q(b,c);for(var d=n.keys(a),e=d.length,f={},g=0;g<e;g++){var h=d[g];f[h]=b(a[h],h,a)}return f},n.pairs=function(a){for(var b=n.keys(a),c=b.length,d=Array(c),e=0;e<c;e++)d[e]=[b[e],a[b[e]]];return d},n.invert=function(a){for(var b={},c=n.keys(a),d=0,e=c.length;d<e;d++)b[a[c[d]]]=c[d];return b},n.functions=n.methods=function(a){var b=[];for(var c in a)n.isFunction(a[c])&&b.push(c);return b.sort()};var G=function(a,b){return function(c){var d=arguments.length;if(b&&(c=Object(c)),d<2||null==c)return c;for(var e=1;e<d;e++)for(var f=arguments[e],g=a(f),h=g.length,i=0;i<h;i++){var j=g[i];b&&void 0!==c[j]||(c[j]=f[j])}return c}};n.extend=G(n.allKeys),n.extendOwn=n.assign=G(n.keys),n.findKey=function(a,b,c){b=q(b,c);for(var d,e=n.keys(a),f=0,g=e.length;f<g;f++)if(d=e[f],b(a[d],d,a))return d};var H=function(a,b,c){return b in c};n.pick=r(function(a,b){var c={},d=b[0];if(null==a)return c;n.isFunction(d)?(b.length>1&&(d=p(d,b[1])),b=n.allKeys(a)):(d=H,b=z(b,!1,!1),a=Object(a));for(var e=0,f=b.length;e<f;e++){var g=b[e],h=a[g];d(h,g,a)&&(c[g]=h)}return c}),n.omit=r(function(a,b){var c,d=b[0];return n.isFunction(d)?(d=n.negate(d),b.length>1&&(c=b[1])):(b=n.map(z(b,!1,!1),String),d=function(a,c){return!n.contains(b,c)}),n.pick(a,d,c)}),n.defaults=G(n.allKeys,!0),n.create=function(a,b){var c=s(a);return b&&n.extendOwn(c,b),c},n.clone=function(a){return n.isObject(a)?n.isArray(a)?a.slice():n.extend({},a):a},n.tap=function(a,b){return b(a),a},n.isMatch=function(a,b){var c=n.keys(b),d=c.length;if(null==a)return!d;for(var e=Object(a),f=0;f<d;f++){var g=c[f];if(b[g]!==e[g]||!(g in e))return!1}return!0};var I,J;I=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;if(a!==a)return b!==b;var e=typeof a;return("function"===e||"object"===e||"object"==typeof b)&&J(a,b,c,d)},J=function(a,b,c,d){a instanceof n&&(a=a._wrapped),b instanceof n&&(b=b._wrapped);var f=h.call(a);if(f!==h.call(b))return!1;switch(f){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!=+a?+b!=+b:0==+a?1/+a==1/b:+a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object Symbol]":return e.valueOf.call(a)===e.valueOf.call(b)}var g="[object Array]"===f;if(!g){if("object"!=typeof a||"object"!=typeof b)return!1;var i=a.constructor,j=b.constructor;if(i!==j&&!(n.isFunction(i)&&i instanceof i&&n.isFunction(j)&&j instanceof j)&&"constructor"in a&&"constructor"in b)return!1}c=c||[],d=d||[];for(var k=c.length;k--;)if(c[k]===a)return d[k]===b;if(c.push(a),d.push(b),g){if((k=a.length)!==b.length)return!1;for(;k--;)if(!I(a[k],b[k],c,d))return!1}else{var l,m=n.keys(a);if(k=m.length,n.keys(b).length!==k)return!1;for(;k--;)if(l=m[k],!n.has(b,l)||!I(a[l],b[l],c,d))return!1}return c.pop(),d.pop(),!0},n.isEqual=function(a,b){return I(a,b)},n.isEmpty=function(a){return null==a||(w(a)&&(n.isArray(a)||n.isString(a)||n.isArguments(a))?0===a.length:0===n.keys(a).length)},n.isElement=function(a){return!(!a||1!==a.nodeType)},n.isArray=j||function(a){return"[object Array]"===h.call(a)},n.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},n.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(a){n["is"+a]=function(b){return h.call(b)==="[object "+a+"]"}}),n.isArguments(arguments)||(n.isArguments=function(a){return n.has(a,"callee")});var K=a.document&&a.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof K&&(n.isFunction=function(a){return"function"==typeof a||!1}),n.isFinite=function(a){return!n.isSymbol(a)&&isFinite(a)&&!isNaN(parseFloat(a))},n.isNaN=function(a){return n.isNumber(a)&&isNaN(a)},n.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"===h.call(a)},n.isNull=function(a){return null===a},n.isUndefined=function(a){return void 0===a},n.has=function(a,b){return null!=a&&i.call(a,b)},n.noConflict=function(){return a._=b,this},n.identity=function(a){return a},n.constant=function(a){return function(){return a}},n.noop=function(){},n.property=t,n.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}},n.matcher=n.matches=function(a){return a=n.extendOwn({},a),function(b){return n.isMatch(b,a)}},n.times=function(a,b,c){var d=Array(Math.max(0,a));b=p(b,c,1);for(var e=0;e<a;e++)d[e]=b(e);return d},n.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},n.now=Date.now||function(){return(new Date).getTime()};var L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},M=n.invert(L),N=function(a){var b=function(b){return a[b]},c="(?:"+n.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};n.escape=N(L),n.unescape=N(M),n.result=function(a,b,c){var d=null==a?void 0:a[b];return void 0===d&&(d=c),n.isFunction(d)?d.call(a):d};var O=0;n.uniqueId=function(a){var b=++O+"";return a?a+b:b},n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Q=function(a){return"\\"+P[a]};n.template=function(a,b,c){!b&&c&&(b=c),b=n.defaults({},b,n.templateSettings);var d=RegExp([(b.escape||/(.)^/).source,(b.interpolate||/(.)^/).source,(b.evaluate||/(.)^/).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(/\\|'|\r|\n|\u2028|\u2029/g,Q),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";var g;try{g=new Function(b.variable||"obj","_",f)}catch(a){throw a.source=f,a}var h=function(a){return g.call(this,a,n)};return h.source="function("+(b.variable||"obj")+"){\n"+f+"}",h},n.chain=function(a){var b=n(a);return b._chain=!0,b};var R=function(a,b){return a._chain?n(b).chain():b};return n.mixin=function(a){return n.each(n.functions(a),function(b){var c=n[b]=a[b];n.prototype[b]=function(){var a=[this._wrapped];return f.apply(a,arguments),R(this,c.apply(n,a))}}),n},n.mixin(n),n.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=c[a];n.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],R(this,c)}}),n.each(["concat","join","slice"],function(a){var b=c[a];n.prototype[a]=function(){return R(this,b.apply(this._wrapped,arguments))}}),n.prototype.value=function(){return this._wrapped},n.prototype.valueOf=n.prototype.toJSON=n.prototype.value,n.prototype.toString=function(){return String(this._wrapped)},n}),b("lib/backbone",function(){var b=c("lib/underscore"),d=c("lib/jquery"),e=a,f={},g=e.Backbone,h=[],i=h.slice;f.VERSION="1.1.2",f.$=d,f.noConflict=function(){return e.Backbone=g,this},f.emulateHTTP=!1,f.emulateJSON=!1;var j=f.Events={on:function(a,b,c){return l(this,"on",a,[b,c])&&b?(this._events||(this._events={}),(this._events[a]||(this._events[a]=[])).push({callback:b,context:c,ctx:c||this}),this):this},once:function(a,c,d){if(!l(this,"once",a,[c,d])||!c)return this;var e=this,f=b.once(function(){e.off(a,f),c.apply(this,arguments)});return f._callback=c,this.on(a,f,d)},off:function(a,c,d){var e,f,g,h,i,j,k,m;if(!this._events||!l(this,"off",a,[c,d]))return this;if(!a&&!c&&!d)return this._events=void 0,this;for(h=a?[a]:b.keys(this._events),i=0,j=h.length;i<j;i++)if(a=h[i],g=this._events[a]){if(this._events[a]=e=[],c||d)for(k=0,m=g.length;k<m;k++)f=g[k],(c&&c!==f.callback&&c!==f.callback._callback||d&&d!==f.context)&&e.push(f);e.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=i.call(arguments,1);if(!l(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&m(c,b),d&&m(d,arguments),this},stopListening:function(a,c,d){var e=this._listeningTo;if(!e)return this;var f=!c&&!d;d||"object"!=typeof c||(d=this),a&&((e={})[a._listenId]=a);for(var g in e)a=e[g],a.off(c,d,this),(f||b.isEmpty(a._events))&&delete this._listeningTo[g];return this}},k=/\s+/,l=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(k.test(c)){for(var f=c.split(k),g=0,h=f.length;g<h;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},m=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b);return}},n={listenTo:"on",listenToOnce:"once"};b.each(n,function(a,c){j[c]=function(c,d,e){return(this._listeningTo||(this._listeningTo={}))[c._listenId||(c._listenId=b.uniqueId("l"))]=c,e||"object"!=typeof d||(e=this),c[a](d,e,this),this}}),j.bind=j.on,j.unbind=j.off,b.extend(f,j);var o=f.Model=function(a,c){var d=a||{};c||(c={}),this.cid=b.uniqueId("c"),this.attributes={},c.collection&&(this.collection=c.collection),c.parse&&(d=this.parse(d,c)||{}),d=b.defaults({},d,b.result(this,"defaults")),this.set(d,c),this.changed={},this.initialize.apply(this,arguments)};b.extend(o.prototype,j,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(a){return b.clone(this.attributes)},sync:function(){return f.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return b.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,c,d){var e,f,g,h,i,j,k,l;if(null==a)return this;if("object"==typeof a?(f=a,d=c):(f={})[a]=c,d||(d={}),!this._validate(f,d))return!1;g=d.unset,i=d.silent,h=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=b.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in f&&(this.id=f[this.idAttribute]);for(e in f)c=f[e],b.isEqual(l[e],c)||h.push(e),b.isEqual(k[e],c)?delete this.changed[e]:this.changed[e]=c,g?delete l[e]:l[e]=c;if(!i){h.length&&(this._pending=d);for(var m=0,n=h.length;m<n;m++)this.trigger("change:"+h[m],this,l[h[m]],d)}if(j)return this;if(!i)for(;this._pending;)d=this._pending,this._pending=!1,this.trigger("change",this,d);return this._pending=!1,this._changing=!1,this},unset:function(a,c){return this.set(a,void 0,b.extend({},c,{unset:!0}))},clear:function(a){var c={};for(var d in this.attributes)c[d]=void 0;return this.set(c,b.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!b.isEmpty(this.changed):b.has(this.changed,a)},changedAttributes:function(a){if(!a)return!!this.hasChanged()&&b.clone(this.changed);var c,d=!1,e=this._changing?this._previousAttributes:this.attributes;for(var f in a)b.isEqual(e[f],c=a[f])||((d||(d={}))[f]=c);return d},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return b.clone(this._previousAttributes)},fetch:function(a){a=a?b.clone(a):{},void 0===a.parse&&(a.parse=!0);var c=this,d=a.success;return a.success=function(b){if(!c.set(c.parse(b,a),a))return!1;d&&d(c,b,a),c.trigger("sync",c,b,a)},E(this,a),this.sync("read",this,a)},save:function(a,c,d){var e,f,g,h=this.attributes;if(null==a||"object"==typeof a?(e=a,d=c):(e={})[a]=c,d=b.extend({validate:!0},d),e&&!d.wait){if(!this.set(e,d))return!1}else if(!this._validate(e,d))return!1;e&&d.wait&&(this.attributes=b.extend({},h,e)),void 0===d.parse&&(d.parse=!0);var i=this,j=d.success;return d.success=function(a){i.attributes=h;var c=i.parse(a,d);if(d.wait&&(c=b.extend(e||{},c)),b.isObject(c)&&!i.set(c,d))return!1;j&&j(i,a,d),i.trigger("sync",i,a,d)},E(this,d),f=this.isNew()?"create":d.patch?"patch":"update","patch"===f&&(d.attrs=e),g=this.sync(f,this,d),e&&d.wait&&(this.attributes=h),g},destroy:function(a){a=a?b.clone(a):{};var c=this,d=a.success,e=function(){c.trigger("destroy",c,c.collection,a)};if(a.success=function(b){(a.wait||c.isNew())&&e(),d&&d(c,b,a),c.isNew()||c.trigger("sync",c,b,a)},this.isNew())return a.success(),!1;E(this,a);var f=this.sync("delete",this,a);return a.wait||e(),f},url:function(){var a=b.result(this,"urlRoot")||b.result(this.collection,"url")||D();return this.isNew()?a:a.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},b.extend(a||{},{validate:!0}))},_validate:function(a,c){if(!c.validate||!this.validate)return!0;a=b.extend({},this.attributes,a);var d=this.validationError=this.validate(a,c)||null;return!d||(this.trigger("invalid",this,d,b.extend(c,{validationError:d})),!1)}});var p=["keys","values","pairs","invert","pick","omit"];b.each(p,function(a){o.prototype[a]=function(){var c=i.call(arguments);return c.unshift(this.attributes),b[a].apply(b,c)}});var q=f.Collection=function(a,c){c||(c={}),c.model&&(this.model=c.model),void 0!==c.comparator&&(this.comparator=c.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,b.extend({silent:!0},c))},r={add:!0,remove:!0,merge:!0},s={add:!0,remove:!1};b.extend(q.prototype,j,{model:o,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return f.sync.apply(this,arguments)},add:function(a,c){return this.set(a,b.extend({merge:!1},c,s))},remove:function(a,c){var d=!b.isArray(a);a=d?[a]:b.clone(a),c||(c={});var e,f,g,h;for(e=0,f=a.length;e<f;e++)(h=a[e]=this.get(a[e]))&&(delete this._byId[h.id],delete this._byId[h.cid],g=this.indexOf(h),this.models.splice(g,1),this.length--,c.silent||(c.index=g,h.trigger("remove",h,this,c)),this._removeReference(h,c));return d?a[0]:a},set:function(a,c){c=b.defaults({},c,r),c.parse&&(a=this.parse(a,c));var d=!b.isArray(a);a=d?a?[a]:[]:b.clone(a);var e,f,g,h,i,j,k,l=c.at,m=this.model,n=this.comparator&&null==l&&!1!==c.sort,p=b.isString(this.comparator)?this.comparator:null,q=[],s=[],t={},u=c.add,v=c.merge,w=c.remove,x=!(n||!u||!w)&&[];for(e=0,f=a.length;e<f;e++){if(i=a[e]||{},g=i instanceof o?h=i:i[m.prototype.idAttribute||"id"],j=this.get(g))w&&(t[j.cid]=!0),v&&(i=i===h?h.attributes:i,c.parse&&(i=j.parse(i,c)),j.set(i,c),n&&!k&&j.hasChanged(p)&&(k=!0)),a[e]=j;else if(u){if(!(h=a[e]=this._prepareModel(i,c)))continue;q.push(h),this._addReference(h,c)}h=j||h,!x||!h.isNew()&&t[h.id]||x.push(h),t[h.id]=!0}if(w){for(e=0,f=this.length;e<f;++e)t[(h=this.models[e]).cid]||s.push(h);s.length&&this.remove(s,c)}if(q.length||x&&x.length)if(n&&(k=!0),this.length+=q.length,null!=l)for(e=0,f=q.length;e<f;e++)this.models.splice(l+e,0,q[e]);else{x&&(this.models.length=0);var y=x||q;for(e=0,f=y.length;e<f;e++)this.models.push(y[e])}if(k&&this.sort({silent:!0}),!c.silent){for(e=0,f=q.length;e<f;e++)(h=q[e]).trigger("add",h,this,c);(k||x&&x.length)&&this.trigger("sort",this,c)}return d?a[0]:a},reset:function(a,c){c||(c={});for(var d=0,e=this.models.length;d<e;d++)this._removeReference(this.models[d],c);return c.previousModels=this.models,this._reset(),a=this.add(a,b.extend({silent:!0},c)),c.silent||this.trigger("reset",this,c),a},push:function(a,c){return this.add(a,b.extend({at:this.length},c))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,c){return this.add(a,b.extend({at:0},c))},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(){return i.apply(this.models,arguments)},get:function(a){if(null!=a)return this._byId[a]||this._byId[a.id]||this._byId[a.cid]},at:function(a){return this.models[a]},where:function(a,c){return b.isEmpty(a)?c?void 0:[]:this[c?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),b.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(b.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return b.invoke(this.models,"get",a)},fetch:function(a){a=a?b.clone(a):{},void 0===a.parse&&(a.parse=!0);var c=a.success,d=this;return a.success=function(b){var e=a.reset?"reset":"set";d[e](b,a),c&&c(d,b,a),d.trigger("sync",d,b,a)},E(this,a),this.sync("read",this,a)},create:function(a,c){if(c=c?b.clone(c):{},!(a=this._prepareModel(a,c)))return!1;c.wait||this.add(a,c);var d=this,e=c.success;return c.success=function(a,b){c.wait&&d.add(a,c),e&&e(a,b,c)},a.save(null,c),a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,c){if(a instanceof o)return a;c=c?b.clone(c):{},c.collection=this;var d=new this.model(a,c);return d.validationError?(this.trigger("invalid",this,d.validationError,c),!1):d},_addReference:function(a,b){this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a),a.collection||(a.collection=this),a.on("all",this._onModelEvent,this)},_removeReference:function(a,b){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var t=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];b.each(t,function(a){q.prototype[a]=function(){var c=i.call(arguments);return c.unshift(this.models),b[a].apply(b,c)}});var u=["groupBy","countBy","sortBy","indexBy"];b.each(u,function(a){q.prototype[a]=function(c,d){var e=b.isFunction(c)?c:function(a){return a.get(c)};return b[a](this.models,e,d)}});var v=f.View=function(a){this.cid=b.uniqueId("view"),a||(a={}),b.extend(this,b.pick(a,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=["model","collection","el","id","attributes","className","tagName","events"];b.extend(v.prototype,j,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,b){return this.$el&&this.undelegateEvents(),this.$el=a instanceof f.$?a:f.$(a),this.el=this.$el[0],!1!==b&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=b.result(this,"events")))return this;this.undelegateEvents();for(var c in a){var d=a[c];if(b.isFunction(d)||(d=this[a[c]]),d){var e=c.match(/^(\S+)\s*(.*)$/),f=e[1],g=e[2];d=b.bind(d,this),f+=".delegateEvents"+this.cid,""===g?this.$el.on(f,d):this.$el.on(f,g,d)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(b.result(this,"el"),!1);else{var a=b.extend({},b.result(this,"attributes"));this.id&&(a.id=b.result(this,"id")),this.className&&(a.class=b.result(this,"className"));var c=f.$("<"+b.result(this,"tagName")+">").attr(a);this.setElement(c,!1)}}}),f.sync=function(a,c,d){var e=y[a];b.defaults(d||(d={}),{emulateHTTP:f.emulateHTTP,emulateJSON:f.emulateJSON});var g={type:e,dataType:"json"};if(d.url||(g.url=b.result(c,"url")||D()),null!=d.data||!c||"create"!==a&&"update"!==a&&"patch"!==a||(g.contentType="application/json",g.data=JSON.stringify(d.attrs||c.toJSON(d))),d.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),d.emulateHTTP&&("PUT"===e||"DELETE"===e||"PATCH"===e)){g.type="POST",d.emulateJSON&&(g.data._method=e);var h=d.beforeSend;d.beforeSend=function(a){if(a.setRequestHeader("X-HTTP-Method-Override",e),h)return h.apply(this,arguments)}}"GET"===g.type||d.emulateJSON||(g.processData=!1),"PATCH"===g.type&&x&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=d.xhr=f.ajax(b.extend(g,d));return c.trigger("request",c,i,d),i};var x=!(void 0===a||!a.ActiveXObject||a.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),y={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};f.ajax=function(){return f.$.ajax.apply(f.$,arguments)};var z=f.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};b.extend(z.prototype,j,{initialize:function(){},route:function(a,c,d){b.isRegExp(a)||(a=this._routeToRegExp(a)),b.isFunction(c)&&(d=c,c=""),d||(d=this[c]);var e=this;return f.history.route(a,function(b){var g=e._extractParameters(a,b);e.execute(d,g),e.trigger.apply(e,["route:"+c].concat(g)),e.trigger("route",c,g),f.history.trigger("route",e,c,g)}),this},execute:function(a,b){a&&a.apply(this,b)},navigate:function(a,b){return f.history.navigate(a,b),this},_bindRoutes:function(){if(this.routes){this.routes=b.result(this,"routes");for(var a,c=b.keys(this.routes);null!=(a=c.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(/[\-{}\[\]+?.,\\\^$|#\s]/g,"\\$&").replace(/\((.*?)\)/g,"(?:$1)?").replace(/(\(\?)?:\w+/g,function(a,b){return b?a:"([^/?]+)"}).replace(/\*\w+/g,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,c){var d=a.exec(c).slice(1);return b.map(d,function(a,b){return b===d.length-1?a||null:a?decodeURIComponent(a):null})}});var A=f.History=function(){this.handlers=[],b.bindAll(this,"checkUrl"),void 0!==a&&(this.location=a.location,this.history=a.history)},B=/msie [\w.]+/;A.started=!1,b.extend(A.prototype,j,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=decodeURI(this.location.pathname+this.location.search);var c=this.root.replace(/\/$/,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(/^[#\/]|\s+$/g,"")},start:function(c){if(A.started)throw new Error("Backbone.history has already been started");A.started=!0,this.options=b.extend({root:"/"},this.options,c),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var d=this.getFragment(),e=document.documentMode,g=B.exec(navigator.userAgent.toLowerCase())&&(!e||e<=7);if(this.root=("/"+this.root+"/").replace(/^\/+|\/+$/g,"/"),g&&this._wantsHashChange){var h=f.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=h.hide().appendTo("body")[0].contentWindow,this.navigate(d)}this._hasPushState?f.$(a).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in a&&!g?f.$(a).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=d;var i=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&i.hash&&(this.fragment=this.getHash().replace(/^[#\/]|\s+$/g,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){f.$(a).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),A.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();if(b===this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe))),b===this.fragment)return!1;this.iframe&&this.navigate(b),this.loadUrl()},loadUrl:function(a){return a=this.fragment=this.getFragment(a),b.any(this.handlers,function(b){if(b.route.test(a))return b.callback(a),!0})},navigate:function(a,b){if(!A.started)return!1;b&&!0!==b||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));if(a=a.replace(/#.*$/,""),this.fragment!==a){if(this.fragment=a,
""===a&&"/"!==c&&(c=c.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),f.history=new A;var C=function(a,c){var d,e=this;d=a&&b.has(a,"constructor")?a.constructor:function(){return e.apply(this,arguments)},b.extend(d,e,c);var f=function(){this.constructor=d};return f.prototype=e.prototype,d.prototype=new f,a&&b.extend(d.prototype,a),d.__super__=e.prototype,d};o.extend=q.extend=z.extend=v.extend=A.extend=C;var D=function(){throw new Error('A "url" property or function must be specified')},E=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}};return e.Backbone=f,f}),b("lib/backbone.nested",function(){var a,b=c("lib/underscore"),d=c("lib/jquery"),e=c("lib/backbone"),f=[];return e.NestedModel=e.Model.extend({get:function(a){return e.NestedModel.walkThenGet(this.attributes,a)},previous:function(a){return e.NestedModel.walkThenGet(this._previousAttributes,a)},has:function(a){var c=this.get(a);return!(null===c||b.isUndefined(c))},set:function(c,d,f){var g,h,i,j=e.NestedModel.deepClone(this.attributes);if(b.isString(c)?g=e.NestedModel.attrPath(c):b.isArray(c)&&(g=c),g)f=f||{},this._setAttr(j,g,d,f);else{f=d||{};var k=c;for(var l in k)k.hasOwnProperty(l)&&this._setAttr(j,e.NestedModel.attrPath(l),f.unset?void 0:k[l],f)}return a=e.NestedModel.__super__.changedAttributes.call(this),f.unset&&g&&1===g.length?(h={},h[c]=void 0,a=b.omit(a,b.keys(h)),i=e.NestedModel.__super__.set.call(this,h,f)):(h=j,f.unset&&g?(f=b.extend({},f),delete f.unset):f.unset&&b.isObject(c)&&(h=c),a=b.omit(a,b.keys(h)),i=e.NestedModel.__super__.set.call(this,h,f)),i?(this._runDelayedTriggers(),this):(this.changed={},a={},!1)},unset:function(a,c){return this.set(a,void 0,b.extend({},c,{unset:!0}))},clear:function(c){a={},c=c||{};var d=b.clone(this.attributes);if(!c.silent&&this.validate&&!this.validate(d,c))return!1;var e=this.changed={},f=this,g=function(a,c,d){b.each(a,function(h,i){var j=c;b.isArray(a)?j+="["+i+"]":c?j+="."+i:j=i,h=a[i],b.isObject(h)&&g(h,j,d),d.silent||f._delayedChange(j,null,d),e[j]=null})};return g(this.attributes,"",c),this.attributes={},c.silent||this._delayedTrigger("change"),this._runDelayedTriggers(),this},add:function(a,c,d){var e=this.get(a);if(!b.isArray(e))throw new Error("current value is not an array");return this.set(a+"["+e.length+"]",c,d)},remove:function(a,c){c=c||{};var d=e.NestedModel.attrPath(a),f=b.initial(d),g=this.get(f),h=b.last(d);if(!b.isArray(g))throw new Error("remove() must be called on a nested array");var i=!c.silent&&g.length>=h+1,j=g[h];if(g.splice(h,1),c.silent=!0,this.set(f,g,c),i){a=e.NestedModel.createAttrStr(f),this.trigger("remove:"+a,this,j);for(var k=f.length;k>=1;k--)a=e.NestedModel.createAttrStr(b.first(f,k)),this.trigger("change:"+a,this,j);this.trigger("change",this,j)}return this},changedAttributes:function(c){var d=e.NestedModel.__super__.changedAttributes.call(this,c);return!!b.isObject(d)&&b.extend({},a,d)},toJSON:function(){return e.NestedModel.deepClone(this.attributes)},_delayedTrigger:function(){f.push(arguments)},_delayedChange:function(a,b,c){this._delayedTrigger("change:"+a,this,b,c),this.changed||(this.changed={}),this.changed[a]=b},_runDelayedTriggers:function(){for(;f.length>0;)this.trigger.apply(this,f.shift())},_setAttr:function(a,c,d,f){f=f||{};var g=c.length,h=this;e.NestedModel.walkPath(a,c,function(a,i,j){var k=b.last(i),l=e.NestedModel.createAttrStr(i),m=!b.isEqual(a[k],d);if(i.length===g){if(f.unset){if(delete a[k],b.isArray(a)){var n=e.NestedModel.createAttrStr(b.initial(c));h._delayedTrigger("remove:"+n,h,a[k])}}else a[k]=d;if(!f.silent&&b.isObject(d)&&m){var o=[],p=function(a,c){if(!(b.indexOf(o,a)>-1)){o.push(a);var d,e;for(var g in a)a.hasOwnProperty(g)&&(d=c+"."+g,e=a[g],b.isEqual(h.get(d),e)||h._delayedChange(d,e,f),b.isObject(e)&&p(e,d))}};p(d,l)}}else a[k]||(b.isNumber(j)?a[k]=[]:a[k]={});f.silent||(i.length>1&&m&&h._delayedChange(l,a[k],f),b.isArray(a[k])&&h._delayedTrigger("add:"+l,h,a[k]))})}},{attrPath:function(a){var c;return b.isString(a)?(c=""===a?[""]:a.match(/[^\.\[\]]+/g),c=b.map(c,function(a){return a.match(/^\d+$/)?parseInt(a,10):a})):c=a,c},createAttrStr:function(a){var c=a[0];return b.each(b.rest(a),function(a){c+=b.isNumber(a)?"["+a+"]":"."+a}),c},deepClone:function(a){return d.extend(!0,{},a)},walkPath:function(a,b,c,d){for(var e,f=a,g=0;g<b.length&&(c.call(d||this,f,b.slice(0,g+1),b[g+1]),e=b[g],f=f[e]);g++);},walkThenGet:function(a,c){var d,f=e.NestedModel.attrPath(c);return e.NestedModel.walkPath(a,f,function(a,c){var e=b.last(c);c.length===f.length&&(d=a[e])}),d}}),e}),b("models/lineRow",function(){var a=c("lib/backbone.nested");return a.NestedModel.extend({defaults:{sort:0,alias:"",top:0,height:19,displayName:"",activeState:!1,isView:!0,operProp:{}},destroyView:function(){this.set("isView",!1)}})}),b("models/lineCol",function(){var a=c("lib/backbone.nested");return a.NestedModel.extend({defaults:{sort:0,alias:"",left:0,width:71,originalWidth:71,isRightAjacentHide:!1,isleftAjacentHide:!1,displayName:"",activeState:!1,hidden:!1,isView:!0,operProp:{}},destoryView:function(){this.set("isView",!1)}})}),b("models/cell",function(){var a=c("lib/backbone.nested");return a.NestedModel.extend({defaults:{physicsBox:{top:0,left:0,width:71,height:19},occupy:{x:[],y:[]},content:{size:"11",family:"SimSun",bd:!1,italic:!1,color:"rgb(0, 0, 0)",alignRow:"",alignCol:"middle",texts:"",displayTexts:""},wordWrap:!1,border:{top:!1,right:!1,bottom:!1,left:!1},format:{type:"normal",isValid:!0,decimal:null,thousands:null,dateFormat:null,currencySign:null,currencyValid:!0},customProp:{background:"rgb(255, 255, 255)",comment:null},showState:!0,hidden:!1,isDestroy:!1,highlight:!1,commentShowState:!1},hide:function(){this.set("showState",!1)}})}),b("models/selectRegion",function(){var a=c("lib/backbone.nested");return a.NestedModel.extend({defaults:{initPosi:{startX:0,startY:0},mousePosi:{mouseX:0,mouseY:0},physicsPosi:{top:0,left:0},physicsBox:{width:71,height:19},wholePosi:{startX:0,startY:0,endX:0,endY:0},selectType:"operation"}})}),b("collections/selectRegion",function(){var a=c("lib/backbone"),b=c("spreadsheet/config"),d=c("models/selectRegion");return new(a.Collection.extend({model:d,url:"select",getAdjacent:function(a){var c=this.models[0].get("initPosi"),d=this.models[0].get("physicsPosi"),e=this.models[0].get("wholePosi"),f=c.startX,g=e.startX,h=e.endX,i={};switch(a){case"LEFT":i.initPosi={},i.wholePosi={},i.physicsPosi={},i.physicsBox={},i.initPosi.startX=f-1,i.wholePosi.startX=g-1,i.wholePosi.endX=h-1,i.physicsPosi.left=d.left-b.User.cellWidth,this.models[0].set(i);break;case"RIGHT":i.initPosi={},i.wholePosi={},i.physicsPosi={},i.physicsBox={},i.initPosi.startX=f+1,i.wholePosi.startX=g+1,i.wholePosi.endX=h+1,i.physicsPosi.left=d.left+b.User.cellWidth,this.models[0].set(i)}},getModelByType:function(a){return this.where({selectType:a})}}))}),b("collections/headItemCol",function(){var a=c("lib/underscore"),b=c("lib/backbone"),d=c("basic/util/binary"),e=c("models/lineCol"),f=c("collections/selectRegion");return new(b.Collection.extend({model:e,url:"itemcol",getModelInitSelectRegion:function(){return this.models[f.models[0].toJSON().initPosi.startX]},getModelListByWholeSelectRegion:function(){var a,b,c,d,e=[],g=0;for(a=f.models[0],c=a.get("wholePosi").startX,d=a.get("wholePosi").endX,b=d-c+1;g<b;g++)e.push(this.models[c+g]);return e},getIndexByDisplayname:function(b){var c=this.findWhere({displayName:b});return a.indexOf(this.models,c)},getModelListByIndex:function(a,b){var c,d=[];for(c=a;c<b+1;c++)d.push(this.models[c]);return d},getMaxDistanceWidth:function(){var a=this.models[this.models.length-1];return a.get("left")+a.get("width")},getIndexByAlias:function(b){return"MAX"===b?"MAX":a.findIndex(this.toJSON(),{alias:b})},getModelByAlias:function(a){return this.findWhere({alias:a})},getModelByPosition:function(a){var b=d.newModelBinary(a,this.models,"left","width",0,this.models.length-1);return this.models[b]},getNeighborModelByAlias:function(a,b){var c,d=this.models,e=d.length;return"RIGHT"===b?(c=this.getIndexByAlias(a),c===e-1?null:d[c+1]):"LEFT"===b?(c=this.getIndexByAlias(a),0===c?null:d[c-1]):null}}))}),b("collections/headItemRow",function(){var a=c("lib/underscore"),b=c("lib/backbone"),d=c("basic/util/binary"),e=c("models/lineRow"),f=c("spreadsheet/config"),g=c("basic/tools/buildalias"),h=c("collections/selectRegion");return new(b.Collection.extend({model:e,url:"itemrow",getModelInitSelectRegion:function(){return this.models[h.models[0].toJSON().initPosi.startY]},getModelListByIndex:function(a,b){var c,d=[];for(c=a;c<b+1;c++)d.push(this.models[c]);return d},getModelListByWholeSelectRegion:function(){var a,b,c,d,e=[],f=0;for(a=h.models[0],c=a.get("wholePosi").startY,d=a.get("wholePosi").endY,b=d-c+1;f<b;f++)e.push(this.models[c+f]);return e},getIndexByDisplayname:function(b){return a.findIndex(this.toJSON(),{displayName:b})},getMaxDistanceHeight:function(){var a=this.models[this.models.length-1];return a.get("top")+a.get("height")},getModelByAlias:function(a){return this.findWhere({alias:a})},getModelByPosition:function(a){var b=d.newModelBinary(a,this.models,"top","height",0,this.models.length-1);return this.models[b]},getIndexByAlias:function(b){return"MAX"===b?"MAX":a.findIndex(this.toJSON(),{alias:b})},getNextAliasByAlias:function(b){var c,d;return d=this.findWhere({alias:b}),c=a.indexOf(this.models,d),this.models[c+1].get("alias")},getNeighborModelByAlias:function(a,b){var c,d=this.models,e=d.length;return"RIGHT"===b?(c=this.getIndexByAlias(a),c===e-1?null:d[c+1]):"LEFT"===b?(c=this.getIndexByAlias(a),0===c?null:d[c-1]):null},generate:function(a){var b,c,d,e;for(void 0===a&&(a=1),b=this.models[this.length-1],d=b.get("sort")+1,c=b.get("height")+b.get("top")+1,e=0;e<a&&!(d+2>f.User.maxRowNum);e++)this.add({sort:d,alias:(d+1).toString(),top:c,height:f.User.cellHeight-1,displayName:g.buildRowAlias(d)}),d++,c+=f.User.cellHeight}}))}),b("models/siderLineCol",function(){var a=c("lib/backbone.nested");return a.NestedModel.extend({defaults:{left:0,width:69}})}),b("collections/siderLineCol",function(){var a=c("lib/backbone"),b=c("models/siderLineCol");return new(a.Collection.extend({model:b,url:"sidercol"}))}),b("models/siderLineRow",function(){var a=c("lib/backbone.nested");return a.NestedModel.extend({defaults:{top:0,height:17}})}),b("collections/siderLineRow",function(){var a=c("lib/backbone"),b=c("models/siderLineRow");return new(a.Collection.extend({model:b,url:"siderrow"}))}),b("models/sheet",function(){var a=c("lib/backbone");return a.Model.extend({defaults:{name:"book",sort:0}})}),b("collections/sheets",function(){var a=c("lib/backbone"),b=c("models/sheet");return new(a.Collection.extend({model:b}))}),b("collections/cells",function(){var a=c("lib/backbone"),b=c("basic/tools/cache"),d=c("basic/util/binary"),e=c("models/cell"),f=c("collections/headItemCol"),g=c("collections/headItemRow"),h=c("collections/selectRegion");return new(a.Collection.extend({model:e,url:"/cell.htm",createCellModel:function(a,c,d,h,i){var j,k,l,m,n,o,p,q=0,r=0,s=[],t=[],u=0,v=0;for(void 0===d?d=a:"object"==typeof d&&(i=d,d=a),void 0===h&&(h=c),j=f.models,k=g.models,p=j[a].get("left"),o=k[c].get("top"),l=h-c+1,m=d-a+1,q=0;q<m;q++)s.push(j[a+q].get("alias")),u+=j[a+q].get("width")+1;for(q=0;q<l;q++)t.push(k[c+q].get("alias")),v+=k[c+q].get("height")+1;for(q=0;q<l;q++)for(r=0;r<m;r++)b.cachePosition(k[c+q].get("alias"),j[a+r].get("alias"),this.length);return n=new e,n.set("occupy",{x:s,y:t}),n.set("physicsBox",{top:o,left:p,width:u-1,height:v-1}),void 0!==i&&function(a,b){var c,d;for(c in b)if("object"==typeof b[c])for(d in b[c])a.set(c+"."+d,b[c][d])}(n,i),this.add(n),n},getCellByVertical:function(a,c,d,e){var h,i,j,k,l,m,n,o,p=[],q={};for(void 0===e&&(e=c),void 0===d&&(d=a),"MAX"===e&&(e=g.length-1),"MAX"===d&&(d=f.length-1),h=b.CellsPosition.strandX,j=a,l=d+1;j<l;j++)if(o=f.models[j].get("alias"),void 0!==h[o])for(k=c,m=e+1;k<m;k++)n=g.models[k].get("alias"),void 0!==h[o][n]&&(i=h[o][n],q[i]||(p.push(this.at(i)),q[i]=1));return p},getCellByTransverse:function(a,c,d,e){var h,i,j,k,l,m,n,o,p=[],q={};for(void 0===d&&(d=a),void 0===e&&(e=c),"MAX"===d&&(d=g.length-1),"MAX"===e&&(e=f.length-1),h=b.CellsPosition.strandY,j=a,l=d+1;j<l;j++)if(n=g.models[j].get("alias"),void 0!==h[n])for(k=c,m=e+1;k<m;k++)o=f.models[k].get("alias"),void 0!==h[n][o]&&(i=h[n][o],q[i]||(p.push(this.at(i)),q[i]=1));return p},getCellByRow:function(a,c){var d,e,f,h,i,j,k,l,m,n={};for(h=[],j=this.models,f=g.models,i=b.CellsPosition.strandY,m=a;m<c+1;m++)if(l=f[m].get("alias"),void 0!==(d=i[l]))for(e in d)k=d[e],void 0===n[k]&&(h.push(j[k]),n[k]=0);return h},getRegionCells:function(a,c,d,e){void 0===d&&(d=a),void 0===e&&(e=c);for(var h,i,j=[],k=0,l=0,m=e-c+1,n=d-a+1,o=g.models,p=f.models,q=b.CellsPosition.strandX;k<m;k++)for(l=0;l<n;l++)i=o[c+k].get("alias"),h=p[a+l].get("alias"),void 0!==q[h]&&void 0!==q[h][i]?j.push(this.models[q[h][i]]):j.push(null);return j},getCellsByWholeSelectRegion:function(){var a,c,d,e,i,j,k,l,m,n,o=[],p=h.models[0].get("wholePosi"),q=g.models,r=f.models,s=b.CellsPosition.strandX;for(i=f.getIndexByAlias(p.startX),j=g.getIndexByAlias(p.startY),k=f.getIndexByAlias(p.endX),l=g.getIndexByAlias(p.endY),d=k-i+1,e=l-j+1,a=0;a<d;a++)for(c=0;c<e;c++)m=q[j+a].get("alias"),n=r[i+c].get("alias"),void 0!==s[n]&&void 0!==s[n][m]?o.push(this.models[s[n][m]]):o.push(null);return o},getCellsBySiderSelectRegion:function(){var a,b,c={};return a=this.getCellsByVerticalSiderSelectRegion(),b=this.getCellsByTransverSiderSelectRegion(),c.vertical=a,c.transver=b,c},getCellsByVerticalSiderSelectRegion:function(){var a,c,d,e,h,i,j,k,l,m={left:[],right:[]};for(l=b.CellsPosition.strandX,d=f.getModelListByWholeSelectRegion(),e=g.getModelListByWholeSelectRegion(),h=d.length,i=e.length,j=0;j<i;j++)for(k=0;k<h;k++)0===k&&(c=e[j].get("alias"),a=d[k].get("alias"),void 0!==l[a]&&void 0!==l[a][c]?m.left.push(this.models[l[a][c]]):m.left.push(null)),k===h-1&&(c=e[j].get("alias"),a=d[k].get("alias"),void 0!==l[a]&&void 0!==l[a][c]?m.right.push(this.models[l[a][c]]):m.right.push(null));return m},getCellsByTransverSiderSelectRegion:function(){var a,c,d,e,h,i,j,k,l,m={top:[],bottom:[]};for(l=b.CellsPosition.strandX,d=f.getModelListByWholeSelectRegion(),e=g.getModelListByWholeSelectRegion(),h=d.length,i=e.length,j=0;j<h;j++)for(k=0;k<i;k++)0===k&&(c=e[k].get("alias"),a=d[j].get("alias"),void 0!==l[a]&&void 0!==l[a][c]?m.top.push(this.models[l[a][c]]):m.top.push(null)),k===i-1&&(c=e[k].get("alias"),a=d[j].get("alias"),void 0!==l[a]&&void 0!==l[a][c]?m.bottom.push(this.models[l[a][c]]):m.bottom.push(null));return m},getHeadModelByWholeSelectRegion:function(){var a,b,c,d,e,i,j,k=[];for(b=f.getModelListByWholeSelectRegion(),c=g.getModelListByWholeSelectRegion(),d=b.length,e=c.length,i=0;i<e;i++)for(j=0;j<d;j++)a={wholePosi:{startX:h.models[0].get("wholePosi").startX+j,startY:h.models[0].get("wholePosi").startY+i},occupy:{x:b[j].get("alias"),y:c[i].get("alias")},physicsBox:{top:c[i].get("top"),left:b[j].get("left"),width:b[j].get("width"),height:c[i].get("height")}},k.push(a);return k},getHeadModelBySiderSelectRegion:function(){var a,b,c={};return a=this.getHeadModelByVerticalSiderSelectRegion(),b=this.getHeadModelByTransverSiderSelectRegion(),c.vertical=a,c.transverse=b,c},getHeadModelByVerticalSiderSelectRegion:function(){var a,b,c,d,e,i,j,k={left:[],right:[]};for(b=f.getModelListByWholeSelectRegion(),c=g.getModelListByWholeSelectRegion(),d=b.length,e=c.length,i=0;i<e;i++)for(j=0;j<d;j++)0===j&&(a={wholePosi:{startX:h.models[0].get("wholePosi").startX+j,startY:h.models[0].get("wholePosi").startY+i},occupy:{x:b[j].get("alias"),y:c[i].get("alias")},physicsBox:{top:c[i].get("top"),left:b[j].get("left"),width:b[j].get("width"),height:c[i].get("height")}},k.left.push(a)),j===d-1&&(a={wholePosi:{startX:h.models[0].get("wholePosi").startX+j,startY:h.models[0].get("wholePosi").startY+i},occupy:{x:b[j].get("alias"),y:c[i].get("alias")},physicsBox:{top:c[i].get("top"),left:b[j].get("left"),width:b[j].get("width"),height:c[i].get("height")}},k.right.push(a));return k},getHeadModelByTransverSiderSelectRegion:function(){var a,b,c,d,e,i,j,k={top:[],bottom:[]};for(b=f.getModelListByWholeSelectRegion(),c=g.getModelListByWholeSelectRegion(),d=b.length,e=c.length,i=0;i<d;i++)for(j=0;j<e;j++)0===j&&(a={wholePosi:{startX:h.models[0].get("wholePosi").startX+i,startY:h.models[0].get("wholePosi").startY+j},occupy:{x:b[i].get("alias"),y:c[j].get("alias")},physicsBox:{top:c[j].get("top"),left:b[i].get("left"),width:b[i].get("width"),height:c[j].get("height")}},k.top.push(a)),j===e-1&&(a={wholePosi:{startX:h.models[0].get("wholePosi").startX+i,startY:h.models[0].get("wholePosi").startY+j},occupy:{x:b[i].get("alias"),y:c[j].get("alias")},physicsBox:{top:c[j].get("top"),left:b[i].get("left"),width:b[i].get("width"),height:c[j].get("height")}},k.bottom.push(a));return k},getLeftHeadModelByIndex:function(a,c,d,e){var h,i,j,k,l,m,n,o,p=[];for(void 0===d&&(d=a),void 0===e&&(e=c),i=g.models,h=f.models,d-a+1,l=e-c+1,j=b.CellsPosition.strandX,m=h[a].get("alias"),o=0;o<l;o++)n=i[c+o].get("alias"),k=void 0!==j[m]&&void 0!==j[m][n]?this.models[j[m][n]]:this.createCellModel(a,c+o),p.push(k);return p},getRightHeadModelByIndex:function(a,c,d,e){var h,i,j,k,l,m,n,o,p=[];for(void 0===d&&(d=a),void 0===e&&(e=c),i=g.models,h=f.models,d-a+1,l=e-c+1,j=b.CellsPosition.strandX,m=h[d].get("alias"),o=0;o<l;o++)n=i[c+o].get("alias"),k=void 0!==j[m]&&void 0!==j[m][n]?this.models[j[m][n]]:this.createCellModel(d,c+o),p.push(k);return p},getTopHeadModelByIndex:function(a,c,d,e){var h,i,j,k,l,m,n,o,p=[];for(void 0===d&&(d=a),void 0===e&&(e=c),i=g.models,h=f.models,l=d-a+1,e-c+1,j=b.CellsPosition.strandX,n=i[c].get("alias"),o=0;o<l;o++)m=h[a+o].get("alias"),k=void 0!==j[m]&&void 0!==j[m][n]?this.models[j[m][n]]:this.createCellModel(a+o,c),p.push(k);return p},getBottomHeadModelByIndex:function(a,c,d,e){var h,i,j,k,l,m,n,o=[];for(void 0===d&&(d=a),void 0===e&&(e=c),g.models,h=f.models,k=d-a+1,e-c+1,i=b.CellsPosition.strandX,m=h[e].get("alias"),n=0;n<k;n++)l=h[a+n].get("alias"),j=void 0!==i[l]&&void 0!==i[l][m]?this.models[i[l][m]]:this.createCellModel(a+n,e),o.push(j);return o},getAdjacent:function(a,b){var c,e,h,i,j,k=a.toJSON();switch(e=f.models,c=g.models,h=d.modelBinary(k.physicsBox.top,c,"top","height",0,c.length-1),i=d.modelBinary(k.physicsBox.left,e,"left","width",0,e.length-1),b){case"LEFT":j=this.getSelectRegionCells(i-1,h);break;case"RIGHT":j=this.getSelectRegionCells(i+1,h);break;case"UP":j=this.getSelectRegionCells(i,h-1);break;case"DOWN":j=this.getSelectRegionCells(i,h+1)}return j[0]},getFillCellsByRegion:function(a,c,d,e){void 0===e&&(e=c),void 0===d&&(d=a);for(var h,i,j=[],k=0,l=0,m=d-a+1,n=e-c+1,o=g.models,p=f.models,q=b.CellsPosition.strandX;k<m;k++)for(l=0;l<n;l++)i=o[a+k].get("alias"),h=p[c+l].get("alias"),void 0!==q[h]&&void 0!==q[h][i]?j.push(this.models[q[h][i]]):j.push(this.createCellModel(c+l,a+k));return j},getInitCellBySelectRegion:function(){var a,c,d,e,i,j,k,l;return d=h.models[0],e=d.toJSON(),a=f.models,c=g.models,i=c[e.initPosi.startY].get("alias"),j=a[e.initPosi.startX].get("alias"),l=b.CellsPosition.strandX,k=void 0===l[j]||void 0===l[j][i]?-1:l[j][i],-1!==k?this.models[k]:null},getCellsByColIndex:function(a,c){var d,e,g,h,i,j,k;for(g=[],i=this.models,h=b.CellsPosition.strandX,k=a;k<c+1;k++)if(void 0!==f.models[k]&&(j=f.models[k].get("alias"),void 0!==h[j])){d=h[j];for(e in d)-1===g.indexOf(i[d[e]])&&g.push(i[d[e]])}return g},getCellByAlias:function(a,c){var d;return void 0===b.CellsPosition.strandY[c]||void 0===b.CellsPosition.strandY[c][a]?null:(d=b.CellsPosition.strandY[c][a],this.models[d])},getCellsInStartRowRegion:function(a,c){var d,e,f,h,i,j,k,l=0;for(f=[],i=this.models,h=b.CellsPosition.strandY,l=a;l<c+1;l++)if(void 0!==g.models[l]&&(j=g.models[l].get("alias"),void 0!==h[j])){d=h[j];for(e in d)k=i[d[e]],g.getIndexByAlias(k.get("occupy").y[0])>=a&&-1===f.indexOf(k)&&f.push(k)}return f},getCellsInStartColRegion:function(a,c){var d,e,g,h,i,j,k,l=0;for(g=[],i=this.models,h=b.CellsPosition.strandX;l<c-a+1;l++)if(void 0!==f.models[a+l]&&(j=f.models[a+l].get("alias"),void 0!==h[j])){d=h[j];for(e in d)k=i[d[e]],f.getIndexByAlias(k.get("occupy").x[0])>=a&&-1===g.indexOf(k)&&g.push(k)}return g},operateCellsByRegion:function(a,c){var d,e,h,i,j,k,l=g.models,m=f.models,n=b.CellsPosition.strandX,o=a.startColIndex,p=a.startRowIndex,q=a.endColIndex,r=a.endRowIndex,s=0;for(void 0!==q&&null!==q||(q=o),void 0!==r&&null!==r||(r=p),h=q-o,e=r-p;s<e+1;s++)for(k=0;k<h+1;k++)i=l[p+s].get("alias"),j=m[o+k].get("alias"),d=void 0!==n[j]&&void 0!==n[j][i]?this.models[n[j][i]]:this.createCellModel(o+k,p+s),c(d)},getFullOperationRegion:function(a){var b,c,e,h,i,j,k=g.models,l=f.models,m=a.startColIndex,n=a.startRowIndex,o=a.endColIndex,p=a.endRowIndex,q=!0,r=0;for(m>o&&(j=m,m=o,o=j),n>p&&(j=n,n=p,p=j);q;)for(q=!1,b=this.getCellByVertical(m,n,o,p);r<b.length;r++){if(e=d.modelBinary(b[r].get("physicsBox").top,k,"top","height",0,k.length-1),c=d.modelBinary(b[r].get("physicsBox").left,l,"left","width",0,l.length-1),i=d.modelBinary(b[r].get("physicsBox").top+b[r].get("physicsBox").height,k,"top","height",0,k.length-1),h=d.modelBinary(b[r].get("physicsBox").left+b[r].get("physicsBox").width,l,"left","width",0,l.length-1),c<m){m=c,q=!0;break}if(e<n){n=e,q=!0;break}if(i>p){p=i,q=!0;break}if(h>o){o=h,q=!0;break}}return a.startRowIndex=n,a.startColIndex=m,a.endRowIndex=p,a.endColIndex=o,a}}))}),b("basic/tools/original",function(){var b=c("lib/jquery"),d=c("spreadsheet/config"),e=c("basic/util/binary"),f=c("basic/tools/cache"),g=c("basic/tools/send"),h=c("basic/tools/loadrecorder"),i=c("basic/tools/buildalias"),j=c("models/lineRow"),k=c("models/lineCol"),l=c("models/cell"),m=c("collections/headItemCol"),n=c("collections/headItemRow"),o=c("collections/siderLineCol"),p=c("collections/siderLineRow"),q=c("collections/selectRegion"),r=c("collections/sheets"),s=c("collections/cells");return{bulidNewExcel:function(){var a,b,c,e,f;for(c=d.User.initColNum,e=d.User.initRowNum,a=0;a<c;a++)f={sort:a,alias:(a+1).toString(),left:a*d.User.cellWidth,width:d.User.cellWidth-1,displayName:i.buildColAlias(a)},m.add(f);for(b=0;b<e;b++)f={sort:b,alias:(b+1).toString(),top:b*d.User.cellHeight,height:d.User.cellHeight-1,displayName:i.buildRowAlias(b)},n.add(f);this.restoreSelectRegion()},analysisRowData:function(a,b){var c,d,f;for(f=0;f<a.length;f++)d=e.indexModelBinary(a[f].top,n.models,"top","height"),-1===n.getIndexByAlias(a[f].aliasY)?(c=new j,c.set("sort",b+f),c.set("top",a[f].top),c.set("height",a[f].height),c.set("alias",a[f].aliasY),c.set("operProp",a[f].operProp),c.set("displayName",i.buildRowAlias(b+f)),n.push(c,{at:d})):d++},analysisColData:function(a,b){function c(a){var b;for(b in a)return!1;return!0}var e,f,g,h,j;for(f=0;f<a.length;f++)-1===m.getIndexByAlias(a[f].aliasY)&&(e=new k,e.set("sort",b+f),e.set("left",a[f].left),e.set("width",a[f].width),e.set("alias",a[f].aliasX),e.set("hidden",a[f].hidden),e.set("originalWidth",a[f].originWidth),c(a[f].operProp.content)||e.set("operProp.content",a[f].operProp.content),c(a[f].operProp.customProp)||e.set("operProp.customProp",a[f].operProp.customProp),c(a[f].operProp.border)||e.set("operProp.border",a[f].operProp.border),e.set("displayName",i.buildColAlias(b+f)),a[f].hidden&&f>0&&m.models[f-1].set("isRightAjacentHide",!0),f>0&&a[f-1].hidden&&e.set("isLeftAjacentHide",!0),m.add(e));if(m.length<d.User.initColNum)for(h=d.User.initColNum-m.length,j=m.length,g=0;g<h;g++)e=new k,e.set("sort",j+g),e.set("left",m.models[j+g-1].get("left")+m.models[j+g-1].get("width")+1),e.set("width",71),e.set("alias",(m.length+1).toString()),e.set("displayName",i.buildColAlias(j+g)),m.add(e)},analysisCellData:function(a){var b,c,d,e,g,h,i,j,k,o,p,q,r,t,u,v,w=null,x={};for(d=m.models,e=n.models,u=0;u<a.length;u++)if(null!==(g=a[u])){for(h=g.occupy.x,i=g.occupy.y,r=0,t=0,b=0;b<i.length;b++)if(-1!==n.getIndexByAlias(i[b])){j=n.getIndexByAlias(i[b]);break}for(b=i.length-1;b>-1;b--)if(-1!==n.getIndexByAlias(i[b])){o=n.getIndexByAlias(i[b]);break}if(-1!==j&&-1!==o){for(k=m.getIndexByAlias(h[0]),p=m.getIndexByAlias(h[h.length-1]),q=f.CellsPosition.strandX,void 0!==q[h[0]]&&void 0!==q[h[0]][i[0]]&&(w=s.models[q[h[0]][i[0]]]),b=k;b<p+1;b++)v=d[b],v.get("hidden")||(r+=v.get("width")+1);for(b=j;b<o+1;b++)v=e[b],t+=v.get("height")+1;if(x={top:e[j].get("top"),left:d[k].get("left"),width:r-1,height:t-1},null!==w)w.set("physicsBox",x);else for(w=new l(g),w.set("physicsBox",x),s.add(w),b=0;b<h.length;b++)for(c=0;c<i.length;c++)f.cachePosition(i[c],h[b],s.length-1);w=null}}},analysisSheetData:function(a){var b;for(b=0;b<a.length;b++)r.add({name:a[b],sort:b})},restoreSelectRegion:function(){var a,b,c,d,e,g,h,i,j,k,l,r,t,u,v,w;for(c=f.UserView.rowAlias,d=f.UserView.colAlias,a=n.getModelByAlias(c),e=m.getIndexByAlias(d),b=m.models[e],u=m.length,v=e;v<u&&b.get("hidden");v++)b=m.models[++e],d=b.get("alias");if(r=f.CellsPosition.strandX,void 0!==r[d]&&void 0!==r[d][c]&&(t=s.models[r[d][c]]),void 0!==t){for(g=t.get("occupy").y,g=g[g.length-1],h=t.get("occupy").x,h=h[h.length-1],i=m.getIndexByAlias(h),j=n.getIndexByAlias(g),k=m.getIndexByAlias(d),l=n.getIndexByAlias(c),w={physicsPosi:{top:t.get("physicsBox").top,left:t.get("physicsBox").left},physicsBox:{width:t.get("physicsBox").width,height:t.get("physicsBox").height},wholePosi:{startX:d,startY:c,endX:h,endY:g}},q.add(w),o.add({left:t.get("physicsBox").left,width:t.get("physicsBox").width}),p.add({top:t.get("physicsBox").top,height:t.get("physicsBox").height}),u=n.length,v=0;v<u;v++)n.models[v].set({activeState:!1});for(u=m.length,v=0;v<u;v++)m.models[v].set({activeState:!1});for(v=0;v<i-k+1;v++)m.models[k+v].set({activeState:!0});for(v=0;v<j-l+1;v++)n.models[l+v].set({activeState:!0})}else w={physicsPosi:{top:a.get("top"),left:b.get("left")},physicsBox:{width:b.get("width"),height:a.get("height")},wholePosi:{startX:d,startY:c,endX:d,endY:c}},q.add(w),o.add({left:b.get("left"),width:b.get("width")}),p.add({top:a.get("top"),height:a.get("height")})},restoreExcel:function(c){var e,i,j,k=a.SPREADSHEET_BUILD_STATE,l=[],o=this;if("true"===k||void 0===k)return this.bulidNewExcel(),void(f.localRowPosi=0);g.PackAjax({url:"excel.htm?m=position",async:!1,isPublic:!1,data:JSON.stringify({containerHeight:b("#"+c).height()+d.System.prestrainHeight}),dataType:"json",success:function(a){if(""!==a){for(f.UserView.rowAlias=a.displayRowStartAlias,f.UserView.colAlias=a.displayColStartAlias,f.aliasRowCounter,f.aliasColCounter,"1"===a.returndata.spreadSheet[0].sheet.frozen.state&&(f.TempProp={isFrozen:!0,colAlias:a.returndata.spreadSheet[0].sheet.frozen.colIndex,rowAlias:a.returndata.spreadSheet[0].sheet.frozen.rowIndex,rowFrozen:!0,colFrozen:!0}),j=0;j<a.returndata.spreadSheet.length;j++)l.push(a.returndata.spreadSheet[j].name);f.localRowPosi=a.maxPixel,e=a.dataRowStartIndex,i=a.dataColStartIndex,a=a.returndata;var b=a.spreadSheet[0].sheet.cells,c=a.spreadSheet[0].sheet.glY,d=a.spreadSheet[0].sheet.glX;o.analysisSheetData(l),o.analysisRowData(c,e),o.analysisColData(d,i),o.analysisCellData(b),o.restoreSelectRegion(),h.insertPosi(n.models[0].get("top"),n.models[n.length-1].get("top")+n.models[n.length-1].get("height"),f.rowRegionPosi),h.insertPosi(n.models[0].get("top"),n.models[n.length-1].get("top")+n.models[n.length-1].get("height"),f.cellRegionPosi.vertical),f.loadCol.startSort=m.models[0].get("sort"),f.loadCol.endSort=m.models[m.length-1].get("sort")}}})}}}),b("basic/tools/template",function(){var a=c("lib/jquery");return function(b){var c="",d="";c+='<div class="main-layout">',c+='<table class="cui-grid" cellspacing="0" cellpadding="0" id="tableContainer">',c+='<tbody><tr><td><div class="left-corner"></div></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody>',c+='</table><div class="input"></div></div>',c+='<div class="sheet-layout"><div class="sheet-body">',c+='<div class="sheet-cf-box glyphicons glyphicon-plus"></div>',c+='<div class="sheet-cf-box active glyphicons glyphicon-th-list"></div>',c+='<div class="sheet-cf-list">',c+="</div></div>",d+='<script type="text/x-handlebars-template" id="colsPanelContainer"><\/script>',d+='<script type="text/x-handlebars-template" id="rowsPanelContainer"><\/script>',d+='<script type="text/x-handlebars-template" id="mainContainer"><\/script>',d+='<script type="text/x-handlebars-template" id="contentList"><\/script>',d+='<script type="text/x-handlebars-template" id="tempSheetContainer"><span>{{name}}</span><\/script>',d+='<script type="text/x-handlebars-template" id="tempRowHeadItem"><div class="item">{{displayName}}</div><\/script>',d+='<script type="text/x-handlebars-template" id="tempColHeadItem"><div class="item">{{displayName}}</div><\/script>',d+='<script type="text/x-handlebars-template" id="multiselect"><div class="dragItem" style="top:{{top}}px;left:{{left}}px;width:{{width}}px;height:{{height}}px;"></div><\/script>',d+='<script type="text/x-handlebars-template" id="data">{{content.text}}<\/script>',d+='<script type="text/x-handlebars-template" id="textarea"><div class="textarea"><textarea class="input-container"></textarea><div><\/script>',d+='<script type="text/x-handlebars-template" id="tempSelectContainer"><div class="box"><div class="expand"></div><div class="bg"></div></div><\/script>',d+='<script type="text/x-handlebars-template" id="tempItemCell"><div class="bg" style="display:table-cell">{{cotent.texts}}</div><\/script>',d+='<script type="text/x-handlebars-template" id="comment"><div></div><\/script>',d+='<script type="text/x-handlebars-template" id="coltemp"><div class="col" style="left:{{left}}px;"></div><\/script>',d+='<script type="text/x-handlebars-template" id="rowtemp"><div class="row" style="top:{{top}}px;"></div><\/script>',a("#"+b)[0].innerHTML=c,a("#"+b).after(d)}}),b("basic/util/listener",function(){var a=c("basic/tools/cache"),b=a.listenerList;return{addEventListener:function(a,c){var d;0!==a.indexOf("on")&&(a="on"+a),b=b||{},b[a]=b[a]||{},void 0===c.listener&&(c.listener=[]),"function"==typeof c&&(d=Object.getOwnPropertyNames(b[a]).length,c.listener.push(d),b[a][d]=c)},removeEventListener:function(a,c){if(0!==a.indexOf("on")&&(a="on"+a),void 0===c)return void delete b[a];if(void 0!==c.listener&&void 0!==b[a])for(var d in c.listener)void 0!==b[a][d]&&delete b[a][d]},excute:function(a,c){if(0!==a.indexOf("on")&&(a="on"+a),void 0!==b[a])for(var d in b[a])b[a][d](c)}}}),b("basic/tools/analysislabel",function(){return function(a){function b(a,b){var c="",d=0;return/[A-Z]/i.test(a)&&(d=a.match(/[A-Z]/gi).length),"col"===b?c=a.substring(0,d):"row"===b&&(c=a.substring(d)),c}function c(a){for(var b,c=0,d=0,e=a.length,f=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];c<e;c++)b=f.indexOf(a[c])+1,d+=b*Math.pow(26,e-c-1);return d-1}function d(a){return parseInt(a)-1}var e,f,g,h,i,j,k,l,m,n=/^[A-Z]+[1-9]+[0-9]*$/;if(a instanceof Array){if(2!==a.length)throw new Error("Parameter format error");if(!n.test(a[0])&&!n.test(a[1]))throw new Error("Parameter format error");j=b(a[0],"col"),k=b(a[0],"row"),l=b(a[1],"col"),m=b(a[1],"row"),f=c(j),g=c(l),h=d(k),i=d(m)}else if(/^[A-Z]+$/.test(a))h=0,i=-1,f=g=c(a);else if(/^[1-9]+[0-9]*$/.test(a))f=0,g=-1,h=i=d(a);else{if(!n.test(a))throw new Error("Parameter format error");k=b(a,"row"),j=b(a,"col"),f=g=c(j),h=i=d(k)}return h>i&&-1!==i&&(e=h,h=i,i=e),f>g&&-1!==g&&(e=f,f=i,i=e),{startRowSort:h,endRowSort:i,startColSort:f,endColSort:g}}}),
b("basic/tools/getoperregion",function(){var a=c("basic/util/binary"),b=c("basic/tools/analysislabel"),d=c("collections/headItemCol"),e=c("collections/headItemRow"),f=c("collections/selectRegion");return function(c){var g,h,i,j,k,l,m,n,o,p,q=d.models,r=e.models;return void 0===c?(g=f.getModelByType("operation")[0],j=d.getIndexByAlias(g.get("wholePosi").startX),l=d.getIndexByAlias(g.get("wholePosi").endX),i=e.getIndexByAlias(g.get("wholePosi").startY),k=e.getIndexByAlias(g.get("wholePosi").endY),n=q[j].get("sort"),m=r[i].get("sort"),o="MAX"===k?-1:r[k].get("sort"),p="MAX"===l?-1:q[l].get("sort")):(h=b(c),n=h.startColSort,m=h.startRowSort,o=h.endRowSort,p=h.endColSort,j=a.indexAttrBinary(n,q,"sort"),i=a.indexAttrBinary(m,r,"sort"),l=-1!==p?a.indexAttrBinary(p,q,"sort"):"MAX",k=-1!==o?a.indexAttrBinary(o,r,"sort"):"MAX",-1===k&&(k=e.length-1),-1===l&&(l=d.length-1)),{sendRegion:{startSortX:n,endSortX:p,startSortY:m,endSortY:o},operRegion:{startColIndex:j,startRowIndex:i,endRowIndex:k,endColIndex:l}}}}),b("entrance/row/rowoperation",function(){var a=c("models/cell"),b=c("basic/tools/cache"),d=c("collections/headItemRow"),e=c("collections/headItemCol"),f=c("collections/cells");return{rowPropOper:function(c,g,h,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;for(v=g.split("."),v.length>1&&(k=v[1]),j=v[0],l=d.models[c],m=l.get("operProp"),n=(new a).toJSON(),void 0!==m[j]&&void 0!==m[j][k]?n[j][k]===h?(delete m[j][k],Object.getOwnPropertyNames(m[j]).length||delete m[j]):m[j][k]=h:n[j][k]!==h&&(m[j]||(m[j]={}),m[j][k]=h),l.set("operProp",m),s=f.getCellByTransverse(c,0,c,e.length-1),w=s.length,x=0;x<w;x++)1===s[x].get("occupy").y.length&&(s[x].set(g,h),"function"==typeof i&&i(s[x]));for(o=0,p=e.length-1,x=o,u=b.CellsPosition.strandX;x<p+1;x++)q=d.models[c].get("alias"),r=e.models[x].get("alias"),void 0!==u[r]&&void 0!==u[r][q]||(t=f.createCellModel(x,c),t.set(g,h))}}}),b("entrance/col/coloperation",function(){var a=c("models/cell"),b=c("basic/tools/cache"),d=c("basic/util/binary"),e=c("collections/headItemRow"),f=c("collections/headItemCol"),g=c("collections/cells");return{colPropOper:function(c,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;for(x=h.split("."),x.length>1&&(m=x[1]),l=x[0],p=f.models[c],q=p.toJSON().operProp,r=(new a).toJSON(),void 0!==q[l]&&void 0!==q[l][m]?r[l][m]===i?(delete q[l][m],Object.getOwnPropertyNames(q[l]).length||delete q[l]):q[l][m]=i:r[l][m]!==i&&(q[l]||(q[l]={}),q[l][m]=i),p.set("operProp",q),f.models,k=e.models,n=k[c].get("alias"),s=d.indexModelBinary(b.viewRegion.top,k,"top","height"),t=d.indexModelBinary(b.viewRegion.bottom,k,"top","height"),w=b.CellsPosition.strandX,v=g.getCellByTransverse(0,c,e.length-1,c),y=v.length,z=0;z<y;z++)v[z].set(h,i),"function"==typeof j&&j(v[z]);for(z=s;z<t+1;z++)o=k[z].get("alias"),void 0!==w[n]&&void 0!==w[n][o]||(u=g.createCellModel(c,z),u.set(h,i))}}}),b("entrance/tool/setfontcolor",function(){var a=c("basic/tools/send"),b=c("basic/tools/cache"),d=c("collections/selectRegion"),e=c("basic/tools/getoperregion"),f=c("collections/cells"),g=c("entrance/row/rowoperation"),h=c("entrance/col/coloperation");return function(c,i,j){function k(){a.PackAjax({url:"text.htm?m=font_color",data:JSON.stringify({coordinate:o,color:i})})}var l,m,n,o;if(l=d.getModelByType("clip")[0],void 0!==l&&(b.clipState="null",l.destroy()),m=e(j),n=m.operRegion,o=m.sendRegion,-1===n.startColIndex||-1===n.startRowIndex)return void k();"MAX"===n.endColIndex?g.rowPropOper(n.startRowIndex,"content.color",i):"MAX"===n.endRowIndex?h.colPropOper(n.startColIndex,"content.color",i):f.operateCellsByRegion(n,function(a){a.set("content.color",i)}),k()}}),b("entrance/tool/setfillcolor",function(){var a=c("basic/tools/send"),b=c("basic/util/binary"),d=c("basic/tools/cache"),e=c("collections/cells"),f=c("basic/tools/point"),g=c("collections/headItemCol"),h=c("collections/headItemRow"),i=c("collections/selectRegion"),j=c("basic/tools/getoperregion"),k=c("entrance/row/rowoperation"),l=c("entrance/col/coloperation");return function(c,m,n){function o(a,c){function d(a){a.set("customProp.background",m)}var f,i,j,o,p,q,r,s=0,t={};for(q=g.models,r=h.models,f=a.length;s<f;s++)t[a[s].index]=a[s].errorMessage;for(f=n.length,s=0;s<f;s++)if(t[s]&&n[s].error)n[s].error();else if(-1===c[s].endColSort)j=b.indexAttrBinary(c[s].startSortY,r,"sort"),k.rowPropOper(j,"customProp.background",m);else if(-1===c[s].endRowIndex)i=b.indexAttrBinary(c[s].startSortX,q,"sort"),l.colPropOper(i,"customProp.background",m);else{if(j=b.indexAttrBinary(c[s].startSortY,r,"sort"),i=b.indexAttrBinary(c[s].startSortX,q,"sort"),p=b.indexAttrBinary(c[s].endSortY,r,"sort"),o=b.indexAttrBinary(c[s].endSortX,q,"sort"),-1===j||-1===i){n[s].success&&n[s].success();continue}-1===p&&(p=h.length-1),-1===o&&(o=g.length-1),e.operateCellsByRegion({startRowIndex:j,endRowIndex:p,startColIndex:i,endColIndex:o},d),n[s].success&&n[s].success()}}function p(a){for(var b,c=0,d=0,e=a.length,f=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];c<e;c++)b=f.indexOf(a[c])+1,d+=b*Math.pow(26,e-c-1);return d-1}function q(a){return parseInt(a)-1}var r,s,t,u,v;if(r=i.getModelByType("clip")[0],void 0!==r&&(d.clipState="null",r.destroy()),g.models,h.models,void 0!==n){if(n.constructor!==Array)throw new Error("Parameter format error");for(u=n.length,v=0;v<u;v++)if(!(n[v]instanceof f))throw new Error("Parameter format error");!function(){for(var b,c,d,e,f,g=0,h=n.length,i=[];g<h;g++)n[g].startCol?n[g].startRow?(c=p(n[g].startCol),d=q(n[g].startRow),e=p(n[g].endCol),f=q(n[g].endRow),e<c&&(b=c,c=e,e=b),f<d&&(b=d,d=f,f=b),i.push({startSortX:c,startSortY:d,endSortX:e,endSortY:f})):(c=q(n[g].startCol),i.push({startSortX:c,startSortY:0,endSortX:c,endSortY:-1})):(d=q(n[g].startRow),i.push({startSortX:0,startSortY:d,endSortX:-1,endSortY:d}));a.PackAjax({url:"text.htm?m=batchcolorset",data:JSON.stringify({coordinates:i,bgcolor:m}),success:function(a){a=a.returndata,o(a,i)}})}()}else s=j().operRegion,t=j().sendRegion,function(b,c){"MAX"===b.endColIndex?k.rowPropOper(b.startRowIndex,"customProp.background",m):"MAX"===b.endRowIndex?l.colPropOper(b.startColIndex,"customProp.background",m):e.operateCellsByRegion(b,function(a){a.set("customProp.background",m)}),a.PackAjax({url:"text.htm?m=fill_bgcolor",data:JSON.stringify({coordinate:c,bgcolor:m})})}(s,t)}}),b("entrance/tool/setfontfamily",function(){var a=c("basic/tools/send"),b=c("collections/cells"),d=c("basic/tools/cache"),e=c("collections/selectRegion"),f=c("basic/tools/getoperregion"),g=c("entrance/col/coloperation"),h=c("entrance/row/rowoperation");return function(c,i,j){function k(){a.PackAjax({url:"text.htm?m=font_family",data:JSON.stringify({coordinate:o,family:i})})}var l,m,n,o;if(l=e.getModelByType("clip")[0],void 0!==l&&(d.clipState="null",l.destroy()),m=f(j),n=m.operRegion,o=m.sendRegion,-1===n.startColIndex||-1===n.startRowIndex)return void k();"MAX"===n.endColIndex?h.rowPropOper(n.startRowIndex,"content.family",i):"MAX"===n.endRowIndex?g.colPropOper(n.startColIndex,"content.family",i):b.operateCellsByRegion(n,function(a){a.set("content.family",i)}),k()}}),b("entrance/cell/setcellheight",function(){var a=c("lib/backbone"),b=c("collections/headItemRow");return function(c,d,e){var f;(f=b.getIndexByDisplayname(d))>-1&&a.trigger("event:rowHeightAdjust",f,e)}}),b("entrance/cell/setcellwidth",function(){var a=c("lib/backbone"),b=c("collections/headItemCol");return function(c,d,e){var f;(f=b.getIndexByDisplayname(d))>-1&&a.trigger("event:colWidthAdjust",f,e)}}),b("entrance/cell/selectcell",function(){var a=c("collections/selectRegion"),b=c("collections/siderLineRow"),d=c("collections/siderLineCol"),e=c("collections/headItemCol"),f=c("collections/headItemRow"),g=c("basic/tools/analysislabel"),h=c("collections/cells");return function(c,i){var j,k,l,m,n,o,p,q={},r=e.models,s=f.models,t=0,u=0;if(void 0!==i?(q=g(i),q=h.getFullOperationRegion(q)):(j=a.getModelByType("operation")[0],q.startColIndex=e.getIndexByAlias(j.get("wholePosi").startX),q.startRowIndex=f.getIndexByAlias(j.get("wholePosi").startY)),!(q.startColIndex<0||q.startRowIndex<0||q.endColIndex<0||q.endRowIndex<0)){for(k=q.startColIndex,l=q.startRowIndex,m=q.endColIndex,n=q.endRowIndex,t=r[m].get("width")+r[m].get("left")-r[k].get("left"),u=s[n].get("height")+s[n].get("top")-s[l].get("top"),a.models[0].set({initPosi:{startX:k,startY:l},mousePosi:{mouseX:m,mouseY:n},physicsPosi:{top:s[l].get("top"),left:r[k].get("left")},physicsBox:{width:t-1,height:u-1},wholePosi:{startX:k,startY:l,endX:m,endY:n}}),b.models[0].set({top:s[l].get("top"),height:u-1}),d.models[0].set({left:r[k].get("left"),width:t-1}),o=s.length,p=0;p<o;p++)s[p].set({activeState:!1});for(o=r.length,p=0;p<o;p++)r[p].set({activeState:!1});for(p=0;p<m-k+1;p++)r[k+p].set({activeState:!0});for(p=0;p<n-l+1;p++)s[l+p].set({activeState:!0})}}}),b("entrance/tool/mergecell",function(){var a=c("basic/tools/send"),b=c("basic/tools/cache"),d=c("collections/selectRegion"),e=c("collections/cells"),f=c("models/cell"),g=c("collections/headItemCol"),h=c("collections/headItemRow"),i=c("basic/tools/getoperregion");return function(c,j){function k(){a.PackAjax({url:"cells.htm?m=merge",data:JSON.stringify({coordinate:r})})}var l,m,n,o,p,q,r,s,t,u,v,w,x,y=g.models,z=h.models,A=[],B=[],C=0,D=0,E=0,F=0;if(s=d.getModelByType("clip")[0],void 0!==s&&(b.clipState="null",s.destroy()),p=i(j),q=p.operRegion,r=p.sendRegion,-1===q.startColIndex||-1===q.startRowIndex)return void k();if("MAX"!==q.endColIndex&&"MAX"!==q.endRowIndex){for(l=q.startRowIndex,m=q.startColIndex,n=q.endRowIndex,o=q.endColIndex,u=e.getCellByTransverse(l,m,n,o),x=u.length,E=0;E<x;E++)if(""!==u[E].get("content").texts){t=u[E].clone();break}if(void 0===t&&void 0!==(t=e.getCellByTransverse(l,m)[0])&&(t=t.clone()),void 0===t&&(t=new f),x)for(E=0;E<x;E++)u[E].set("isDestroy",!0);for(E=m;E<o+1;E++)for(F=l;F<n+1;F++)v=y[E].get("alias"),w=z[F].get("alias"),b.deletePosi(w,v);for(E=0;E<o-m+1;E++)A.push(y[m+E].get("alias")),C+=y[m+E].get("width")+1;for(E=0;E<n-l+1;E++)B.push(z[l+E].get("alias")),D+=z[l+E].get("height")+1;for(t.set("physicsBox",{top:z[l].get("top"),left:y[m].get("left"),width:C-1,height:D-1}),t.set("occupy",{x:A,y:B}),e.add(t),E=0;E<o-m+1;E++)for(F=0;F<n-l+1;F++)v=y[m+E].get("alias"),w=z[l+F].get("alias"),b.cachePosition(w,v,e.length-1);k()}}}),b("entrance/tool/splitcell",function(){function a(a){var b,c,e,f,j,k,l=a.get("occupy");b=l.x[0],c=l.y[0],e=h.getIndexByAlias(b),f=i.getIndexByAlias(c),k=i.models[f].get("height"),j=h.models[e].get("width"),a.set("occupy",{x:b,y:c}),a.set("physicsBox.width",j),a.set("physicsBox.height",k),d.cachePosition(c,b,g.length),g.add(a)}var b=c("basic/tools/send"),d=c("basic/tools/cache"),e=c("collections/selectRegion"),f=c("basic/tools/getoperregion"),g=c("collections/cells"),h=c("collections/headItemCol"),i=c("collections/headItemRow");return function(c,j){function k(){b.PackAjax({url:"cells.htm?m=merge_delete",data:JSON.stringify({coordinate:n})})}var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;if(u=e.getModelByType("clip")[0],void 0!==u&&(d.clipState="null",u.destroy()),l=f(j),m=l.operRegion,n=l.sendRegion,"MAX"!==m.endColIndex&&"MAX"!==m.endRowIndex){if(-1===m.startColIndex||-1===m.startRowIndex)return void k();for(o=m.startColIndex,p=m.startRowIndex,q=m.endColIndex,r=m.endRowIndex,s=g.getCellByVertical(o,p,q,r),v=h.models,w=i.models,x=0;x<q-o+1;x++)for(y=0;y<r-p+1;y++)A=v[o+x].get("alias"),B=w[p+y].get("alias"),d.deletePosi(B,A);for(z=s.length,x=0;x<z;x++)t=s[x].clone(),s[x].set("isDestroy",!0),a(t);k()}}}),b("entrance/tool/setcellcontent",function(){var a=c("basic/tools/send"),b=c("basic/tools/cache"),d=c("collections/selectRegion"),e=c("collections/cells"),f=c("basic/tools/getoperregion");return function(c,g,h){function i(){a.PackAjax({url:"text.htm?m=data",data:JSON.stringify({coordinate:{startSortX:m.startSortX,startSortY:m.startSortY},content:g})})}var j,k,l,m;if(j=d.getModelByType("clip")[0],void 0!==j&&(b.clipState="null",j.destroy()),k=f(h),l=k.operRegion,m=k.sendRegion,-1===l.startColIndex||-1===l.startRowIndex)return void i();l.endColIndex=l.startColIndex,l.endRowIndex=l.startRowIndex,e.operateCellsByRegion(l,function(a){a.set("content.texts",g)}),i()}}),b("entrance/cell/selectcellcols",function(){var a=c("basic/tools/cache"),b=c("spreadsheet/config"),d=c("basic/util/listener"),e=c("collections/selectRegion"),f=c("models/selectRegion"),g=c("collections/headItemCol"),h=c("collections/headItemRow"),i=c("collections/siderLineCol"),j=c("collections/siderLineRow");return function(c,k,l){var m,n,o,p,q,r,s,t,u,v,w,x,y,z=[],A=[],B={};if(m=null!==k?h.getIndexByDisplayname(k):l,p=h.models,o=g.models,n=p[m],x=o.length,v=o[x-1].get("left")+o[x-1].get("width"),u=n.toJSON().top,w=n.toJSON().height,t=0,z.push("A"),z.push(o[x-1].get("displayName")),A.push(p[m].get("displayName")),B.point={col:z,row:A},d.excute("regionChange",B),a.mouseOperateState===b.mouseOperateState.dataSource)q=e.getModelByType("dataSource")[0],void 0===q&&(q=new f,q.set("selectType","dataSource"),e.add(q)),q.set({physicsPosi:{left:t,top:u},physicsBox:{width:v,height:w}}),e.add(q),e.getModelByType("dataSource")[0].set({physicsPosi:{left:t,top:u},physicsBox:{width:v,height:w}}),B.point=void 0,d.excute("dataSourceRegionChange",B),d.excute("regionChange",B);else{for(x=p.length,y=0;y<x;y++)y!==m?p[y].set({activeState:!1}):p[y].set({activeState:!0});for(x=o.length,y=0;y<x;y++)o[y].set({activeState:!0});r=n.get("alias"),s=o[0].get("alias"),e.models[0].set({physicsPosi:{left:t,top:u},physicsBox:{width:v,height:w},wholePosi:{startX:s,startY:r,endX:"MAX",endY:r}}),i.models[0].set({left:t,width:v}),j.models[0].set({top:u,height:w})}}}),b("entrance/cell/selectcellrows",function(){var a=c("basic/tools/cache"),b=c("spreadsheet/config"),d=c("basic/util/listener"),e=c("collections/selectRegion"),f=c("models/selectRegion"),g=c("collections/headItemCol"),h=c("collections/headItemRow"),i=c("collections/siderLineCol"),j=c("collections/siderLineRow");return function(c,k,l,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=[],D=[];if(n=null!==k?g.getIndexByDisplayname(k):l,q=h.models,p=g.models,o=p[n],A=q.length,v=o.toJSON().left,w=0,x=o.toJSON().width,y=q[A-1].get("top")+q[A-1].get("height"),D.push("1"),D.push(q[A-1].get("displayName")),C.push(p[n].get("displayName")),z={col:C,row:D},a.mouseOperateState===b.mouseOperateState.dataSource)r=e.getModelByType("dataSource")[0],void 0===r&&(r=new f,r.set("selectType","dataSource"),e.add(r)),r.set({physicsPosi:{left:v,top:w},physicsBox:{width:x,height:y}}),void 0!==m&&(m={},m.point=z,d.excute("dataSourceRegionChange",m),d.excute("regionChange",m),d.excute("mousedown",m));else{for(u=e.getModelByType("operation")[0],B=0;B<A;B++)q[B].set({activeState:!0});for(A=p.length,B=0;B<A;B++)B!==n?p[B].set({activeState:!1}):p[B].set({activeState:!0});s=q[0].get("alias"),t=p[n].get("alias"),u.set({physicsPosi:{left:v,top:w},physicsBox:{width:x,height:y},wholePosi:{startX:t,startY:s,endX:t,endY:"MAX"}}),i.models[0].set({left:v,width:x}),j.models[0].set({top:w,height:y}),void 0!==m&&(m={},m.point=z,d.excute("selectRegionChange",m),d.excute("regionChange",m),d.excute("mousedown",m))}}}),b("entrance/tool/setcellborder",function(){var a=c("basic/tools/send"),b=c("collections/cells"),d=c("basic/tools/cache"),e=c("collections/selectRegion"),f=c("basic/tools/getoperregion"),g=c("entrance/row/rowoperation"),h=c("entrance/col/coloperation");return function(c,i,j){function k(){a.PackAjax({url:"cells.htm?m=frame",data:JSON.stringify({coordinate:s,frameStyle:i})})}function l(){var a,c;if("MAX"===r.endColIndex)g.rowPropOper(r.startRowIndex,"border.top",!0);else if("MAX"===r.endRowIndex)h.colPropOper(r.startColIndex,"border.top",!0);else{a=b.getTopHeadModelByIndex(r.startColIndex,r.startRowIndex,r.endColIndex,r.endRowIndex);for(c in a)a[c].set("border.top",!0)}}function m(){var a,c;if("MAX"===r.endColIndex)g.rowPropOper(r.startRowIndex,"border.left",!0);else if("MAX"===r.endRowIndex)h.colPropOper(r.startColIndex,"border.left",!0);else{a=b.getLeftHeadModelByIndex(r.startColIndex,r.startRowIndex,r.endColIndex,r.endRowIndex);for(c in a)a[c].set("border.left",!0)}}function n(){var a,c;if("MAX"===r.endColIndex)g.rowPropOper(r.startRowIndex,"border.bottom",!0);else if("MAX"===r.endRowIndex)h.colPropOper(r.startColIndex,"border.bottom",!0);else{a=b.getBottomHeadModelByIndex(r.startColIndex,r.startRowIndex,r.endColIndex,r.endRowIndex);for(c in a)a[c].set("border.bottom",!0)}}function o(){var a,c;if("MAX"===r.endColIndex)g.rowPropOper(r.startRowIndex,"border.right",!0);else if("MAX"===r.endRowIndex)h.colPropOper(r.startColIndex,"border.right",!0);else{a=b.getRightHeadModelByIndex(r.startColIndex,r.startRowIndex,r.endColIndex,r.endRowIndex);for(c in a)a[c].set("border.right",!0)}}var p,q,r,s;if(p=e.getModelByType("clip")[0],void 0!==p&&(d.clipState="null",p.destroy()),q=f(j),r=q.operRegion,s=q.sendRegion,-1===r.startColIndex||-1===r.startRowIndex)return void k();switch(i){case"bottom":n(!0);break;case"top":l(!0);break;case"left":m(!0);break;case"right":o(!0);break;case"none":!function(){"MAX"===r.endColIndex?(g.rowPropOper(r.startRowIndex,"border.left",!1),g.rowPropOper(r.startRowIndex,"border.right",!1),g.rowPropOper(r.startRowIndex,"border.top",!1),g.rowPropOper(r.startRowIndex,"border.bottom",!1)):"MAX"===r.endRowIndex?(h.colPropOper(r.startColIndex,"border.left",!1),h.colPropOper(r.startColIndex,"border.right",!1),h.colPropOper(r.startColIndex,"border.top",!1),h.colPropOper(r.startColIndex,"border.bottom",!1)):b.operateCellsByRegion(r,function(a){a.set("border.left",!1),a.set("border.right",!1),a.set("border.top",!1),a.set("border.bottom",!1)})}();break;case"all":!function(){"MAX"===r.endColIndex?(g.rowPropOper(r.startRowIndex,"border.left",!0),g.rowPropOper(r.startRowIndex,"border.right",!0),g.rowPropOper(r.startRowIndex,"border.top",!0),g.rowPropOper(r.startRowIndex,"border.bottom",!0)):"MAX"===r.endRowIndex?(h.colPropOper(r.startColIndex,"border.left",!0),h.colPropOper(r.startColIndex,"border.right",!0),h.colPropOper(r.startColIndex,"border.top",!0),h.colPropOper(r.startColIndex,"border.bottom",!0)):b.operateCellsByRegion(r,function(a){a.set("border.left",!0),a.set("border.right",!0),a.set("border.top",!0),a.set("border.bottom",!0)})}();break;case"outer":!function(){"MAX"!==q.endRowIndex&&(l(q),n(q)),"MAX"!==q.endColIndex&&(m(q),o(q))}()}k()}}),b("entrance/tool/setfontfamilysize",function(){var a=c("basic/tools/send"),b=c("collections/cells"),d=c("basic/tools/cache"),e=c("collections/selectRegion"),f=c("basic/tools/getoperregion"),g=c("entrance/row/rowoperation"),h=c("entrance/col/coloperation");return function(c,i,j){function k(){a.PackAjax({url:"text.htm?m=font_size",data:JSON.stringify({coordinate:o,size:i})})}var l,m,n,o;if(l=e.getModelByType("clip")[0],void 0!==l&&(d.clipState="null",l.destroy()),m=f(j),n=m.operRegion,o=m.sendRegion,-1===n.startColIndex||-1===n.startRowIndex)return void k();"MAX"===n.endRowIndex?h.colPropOper(n.startColIndex,"content.size",i):"MAX"===n.endColIndex?g.rowPropOper(n.startRowIndex,"content.size",i):b.operateCellsByRegion(n,function(a){a.set("content.size",i)}),k()}}),b("entrance/tool/setfontweight",function(){var a=c("basic/tools/send"),b=c("basic/tools/cache"),d=c("collections/selectRegion"),e=c("basic/tools/getoperregion"),f=c("collections/cells"),g=c("entrance/col/coloperation"),h=c("entrance/row/rowoperation");return function(c,i,j){function k(){a.PackAjax({url:"text.htm?m=font_weight",data:JSON.stringify({coordinate:o,isBold:i||!0})})}var l,m,n,o,p;if(l=d.getModelByType("clip")[0],void 0!==l&&(b.clipState="null",l.destroy()),m=e(j),n=m.operRegion,o=m.sendRegion,-1===n.startColIndex||-1===n.startRowIndex)return void k();l=d.getModelByType("clip")[0],void 0!==l&&(b.clipState="null",l.destroy()),"bold"===i?i=!0:"normal"===i?i=!1:(p=f.getCellByVertical(n.startColIndex,n.startRowIndex,n.endColIndex,n.endRowIndex),i=0===p.length||!p[0].get("content").bd),"MAX"===n.endRowIndex?g.colPropOper(n.startColIndex,"content.bd",i):"MAX"===n.endColIndex?h.rowPropOper(n.startRowIndex,"content.bd",i):f.operateCellsByRegion(n,function(a){a.set("content.bd",i)}),k()}}),b("entrance/tool/setfontstyle",function(){var a=c("basic/tools/send"),b=c("basic/tools/cache"),d=c("collections/selectRegion"),e=c("collections/cells"),f=c("basic/tools/getoperregion"),g=c("entrance/row/rowoperation"),h=c("entrance/col/coloperation");return function(c,i,j){function k(){a.PackAjax({url:"text.htm?m=font_italic",data:JSON.stringify({coordinate:o,italic:i})})}var l,m,n,o,p;if(l=d.getModelByType("clip")[0],void 0!==l&&(b.clipState="null",l.destroy()),m=f(j),n=m.operRegion,o=m.sendRegion,-1===n.startColIndex||-1===n.startRowIndex)return void k();"italic"===i?i=!0:"normal"===i?i=!1:(p=e.getCellByVertical(n.startColIndex,n.startRowIndex,n.endColIndex,n.endRowIndex),i=null===p||void 0===p||0===p.length||!p[0].get("content").italic),"MAX"===n.endColIndex?g.rowPropOper(n.startRowIndex,"content.italic",i):"MAX"===n.endRowIndex?h.colPropOper(n.startColIndex,"content.italic",i):e.operateCellsByRegion(n,function(a){a.set("content.italic",i)}),k()}}),b("entrance/sheet/setfrozen",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("basic/tools/cache"),e=c("collections/selectRegion"),f=c("collections/headItemCol"),g=c("collections/headItemRow"),h=c("basic/tools/getoperregion"),i=function(b,c,f){var g,i,j,o;if(g=e.getModelByType("clip")[0],void 0!==g&&(d.clipState="null",g.destroy()),i=h(f),j=i.operRegion,o=i.sendRegion,-1!==j.startColIndex&&-1!==j.startRowIndex&&100!==o.endColIndex&&1e4!==o.endRowIndex){switch(c){case"custom":k(j);break;case"row":m();break;case"col":l();break;case"unfrozen":n();break;default:k(j)}a.trigger("event:bodyContainer:executiveFrozen")}},j=function(a){var b=f.getIndexByAlias(d.UserView.colAlias),c=g.getIndexByAlias(d.UserView.rowAlias),e=f.getIndexByAlias(d.UserView.colEndAlias),h=g.getIndexByAlias(d.UserView.rowEndAlias);return c!==h&&(a.startColIndex<b||a.startRowIndex<c||a.startColIndex>e||a.startRowIndex>h)},k=function(a){var b=g.models,c=f.models,e=c[a.startColIndex].get("alias"),h=b[a.startRowIndex].get("alias"),i=c[a.startColIndex].get("sort"),k=b[a.startRowIndex].get("sort");j(a)||(d.TempProp={isFrozen:!0,colAlias:e,rowAlias:h,rowFrozen:!0,colFrozen:!0},o(i,k))},l=function(){var a=f.getNeighborModelByAlias(d.UserView.colAlias,"RIGHT");d.TempProp={isFrozen:!0,colAlias:a.get("alias"),rowAlias:"1",colFrozen:!0},d.UserView.rowAlias="1",o(a.get("sort"),0)},m=function(){var a=g.getNeighborModelByAlias(d.UserView.rowAlias,"RIGHT");d.TempProp={isFrozen:!0,colAlias:"1",rowAlias:a.get("alias"),rowFrozen:!0},d.UserView.colAlias="1",o(0,a.get("sort"))},n=function(){d.TempProp={isFrozen:!1,colAlias:"1",rowAlias:"1"},p()},o=function(a,c){var e=f.getModelByAlias(d.UserView.colAlias).get("sort"),h=g.getModelByAlias(d.UserView.rowAlias).get("sort");b.PackAjax({url:"sheet.htm?m=frozen",data:JSON.stringify({frozenSortX:a,frozenSortY:c,startSortX:e,startSortY:h})})},p=function(){b.PackAjax({url:"sheet.htm?m=unFrozen"})};return i}),b("entrance/tool/setalign",function(){var a=c("basic/tools/send"),b=c("collections/selectRegion"),d=c("collections/cells"),e=c("basic/tools/cache"),f=c("basic/tools/getoperregion"),g=c("entrance/row/rowoperation"),h=c("entrance/col/coloperation");return function(c,i,j){function k(){a.PackAjax({url:l,data:JSON.stringify({coordinate:s,alignStyle:m})})}var l,m,n,o,p,q,r,s;switch(p=b.getModelByType("clip")[0],void 0!==p&&(e.clipState="null",p.destroy()),q=f(j),r=q.operRegion,s=q.sendRegion,i){case"left":l="cells.htm?m=align_level",n="left";break;case"center":l="cells.htm?m=align_level",n="center";break;case"right":l="cells.htm?m=align_level",n="right";break;case"top":l="cells.htm?m=align_vertical",o="top";break;case"middle":l="cells.htm?m=align_vertical",o="middle";break;case"bottom":l="cells.htm?m=align_vertical",o="bottom";break;default:return}if(-1===r.startColIndex||-1===r.startRowIndex)return void k();"MAX"===r.endColIndex?void 0!==n?g.rowPropOper(r.startRowIndex,"content.alignRow",n):g.rowPropOper(r.startRowIndex,"content.alignCol",o):"MAX"===r.endRowIndex?void 0!==n?h.colPropOper(r.startColIndex,"content.alignRow",n):h.colPropOper(r.startColIndex,"content.alignCol",o):d.operateCellsByRegion(r,function(a){void 0!==n?a.set("content.alignRow",n):a.set("content.alignCol",o)}),m=n||o,k()}}),b("entrance/selectregion/datasourceregionoperation",function(){var a=c("basic/tools/cache"),b=c("spreadsheet/config"),d=c("collections/selectRegion");return{setDataSourceRegion:function(){a.mouseOperateState=b.mouseOperateState.dataSource},setSelectRegion:function(){a.mouseOperateState=b.mouseOperateState.select},destroyDataSoureRegion:function(){void 0!==d.getModelByType("dataSource")[0]&&d.getModelByType("dataSource")[0].destroy()}}}),b("entrance/sheet/getpointbyposi",function(){var a=c("lib/backbone");return function(b,c,d){var e={};return a.trigger("event:cellsContainer:getCoordinate",function(){return function(a){e.point=a}}(),c,d),void 0===e.point?(e.point={col:"",row:""},e):e}}),b("entrance/tool/setwordwrap",function(){var a=c("basic/tools/send"),b=c("collections/selectRegion"),d=c("collections/cells"),e=c("basic/tools/cache"),f=c("basic/tools/getoperregion"),g=c("entrance/col/coloperation"),h=c("entrance/row/rowoperation");return function(c,i,j){function k(){a.PackAjax({url:"text.htm?m=wordwrap",data:JSON.stringify({coordinate:o,wordWrap:i||"true"})})}var l,m,n,o,p;if(l=b.getModelByType("clip")[0],void 0!==l&&(e.clipState="null",l.destroy()),m=f(j),n=m.operRegion,o=m.sendRegion,-1===n.startColIndex||-1===n.startRowIndex)return void k();void 0===i&&("MAX"===n.endColIndex||"MAX"===n.endRowIndex?i=!0:(p=d.getCellByVertical(n.startColIndex,n.startRowIndex,n.endColIndex,n.endRowIndex),i=null===p||void 0===p||0===p.length||!p[0].get("wordWrap"))),"MAX"===n.endColIndex?h.rowPropOper(m.startRowIndex,"wordWrap",i):"MAX"===n.endColIndex?g.colPropOper(m.startColIndex,"wordWrap",i):d.operateCellsByRegion(n,function(a){a.set("wordWrap",i)}),k()}}),b("entrance/cell/gettextbycoordinate",function(){var a=c("basic/tools/cache"),b=c("collections/cells"),d=c("collections/headItemCol"),e=c("collections/headItemRow"),f=c("basic/tools/getoperregion");return function(c,g){var h,i,j,k,l,m,n=d.models,o=e.models;return h=f(g),i=h.operRegion,k=n[i.startColIndex].get("alias"),j=o[i.startRowIndex].get("alias"),l=a.CellsPosition.strandX,void 0!==l[k]&&void 0!==l[k][j]?(m=b.models[l[k][j]],m.get("content").texts):""}}),b("entrance/sheet/adaptscreen",function(){var a=c("lib/backbone");return function(b){a.trigger("call:screenContainer:adaptScreen")}}),b("entrance/sheet/getfrozenstate",function(){var a=c("basic/tools/cache");return function(b){return a.TempProp.isFrozen}}),b("entrance/sheet/getselectregion",function(){var a=c("collections/selectRegion"),b=c("collections/headItemCol"),d=c("collections/headItemRow");return function(c){var e,f,g,h,i,j,k,l,m,n,o={},p=[],q=[];for(e=a.findWhere({selectType:"operation"}),f=e.get("wholePosi").startX,g=e.get("wholePosi").startY,h=e.get("wholePosi").endX,i=e.get("wholePosi").endY,k=d.getIndexByAlias(g),j=b.getIndexByAlias(f),m=d.getIndexByAlias(i),l=b.getIndexByAlias(h),n=j;n<l+1;n++)p.push(b.models[n].get("displayName"));for(n=k;n<m+1;n++)q.push(d.models[n].get("displayName"));return o.col=p,o.row=q,o}}),b("entrance/extention/highlight",function(){var a=c("lib/backbone"),b=c("basic/tools/cache");return{startHighlight:function(){a.trigger("event:cellsContainer:startHighlight")},stopHighlight:function(){a.trigger("event:cellsContainer:stopHighlight")},getHighlightDirection:function(){return b.highlightDirection}}}),b("entrance/cell/reloadcells",function(){function a(){b.trigger("event:contentCellsContainer:reloadCells"),b.trigger("event:cellsContainer:adaptSelectRegion")}var b=c("lib/backbone");return a}),b("entrance/tool/settexttype",function(){var b,d=c("basic/tools/send"),e=c("collections/cells"),f=c("spreadsheet/config"),g=c("basic/tools/getoperregion"),h=c("collections/selectRegion"),i=c("entrance/row/rowoperation"),j=c("entrance/col/coloperation"),k=c("basic/tools/cache");return b={typeRecognize:function(a){var b=a.get("content").texts;"normal"===a.get("format").type&&this.isDate(b)&&(a.set("format.dateFormat",this.getDateFormat(b)),a.set("format.type","date"),this.generateDisplayText(a))},setNormal:function(a,b){var c,d,f,l,m,n;if(c=this,d=h.getModelByType("clip")[0],void 0!==d&&(k.clipState="null",d.destroy()),f=g(b),l=f.operRegion,m=f.sendRegion,n={type:"normal",isValid:!1,decimal:null,thousands:null,dateFormat:null,currencySign:null,currencyValid:!1},-1===l.startColIndex||-1===l.startRowIndex)return void this.sendData(n,m);"MAX"===l.endColIndex?i.rowPropOper(l.startRowIndex,"format",n,function(a){c.typeRecognize(a),c.generateDisplayText(a)}):"MAX"===l.endRowIndex?j.colPropOper(l.startColIndex,"format",n,function(a){c.typeRecognize(a),c.generateDisplayText(a)}):e.operateCellsByRegion(l,function(a){a.set("format",n),c.typeRecognize(a),c.generateDisplayText(a)}),this.sendData(n,m)},setText:function(a,b){var c,d,f,l,m,n=this;if(c=h.getModelByType("clip")[0],void 0!==c&&(k.clipState="null",c.destroy()),d=g(b),f=d.operRegion,l=d.sendRegion,m={type:"text",isValid:!1,decimal:null,thousands:null,dateFormat:null,currencySign:null,currencyValid:!1},-1===f.startColIndex||-1===f.startRowIndex)return void this.sendData(m,l);"MAX"===f.endColIndex?i.rowPropOper(f.startRowIndex,"format",m,function(a){n.generateDisplayText(a)}):"MAX"===f.endRowIndex?j.colPropOper(f.startColIndex,"format",m,function(a){n.generateDisplayText(a)}):e.operateCellsByRegion(f,function(a){a.set("format",m),n.generateDisplayText(a)}),this.sendData(m,l)},setNum:function(a,b,c,d){var f,l,m,n,o,p;if(l=h.getModelByType("clip")[0],void 0!==l&&(k.clipState="null",l.destroy()),f=this,m=g(d),n=m.operRegion,o=m.sendRegion,p={type:"number",isValid:!1,decimal:c,thousands:b,dateFormat:null,currencySign:null,currencyValid:!1},-1===n.startColIndex||-1===n.startRowIndex)return void this.sendData(p,o);"MAX"===n.endColIndex?i.rowPropOper(n.startRowIndex,"format",p,function(a){f.generateDisplayText(a)}):"MAX"===n.endRowIndex?j.colPropOper(n.startColIndex,"format",p,function(a){f.generateDisplayText(a)}):e.operateCellsByRegion(n,function(a){a.set("format",p),f.generateDisplayText(a)}),this.sendData(p,o)},setDate:function(a,b,c){var d,f,l,m,n,o;if(f=h.getModelByType("clip")[0],void 0!==f&&(k.clipState="null",f.destroy()),o={type:"date",isValid:!1,decimal:null,thousands:null,dateFormat:b,currencySign:null,currencyValid:!1},l=g(c),m=l.operRegion,n=l.sendRegion,d=this,-1===m.startColIndex||-1===m.startRowIndex)return void this.sendData(o,n);"MAX"===m.endColIndex?i.rowPropOper(m.startRowIndex,"format",o,function(a){d.generateDisplayText(a)}):"MAX"===m.endRowIndex?j.colPropOper(m.startColIndex,"format",o,function(a){d.generateDisplayText(a)}):e.operateCellsByRegion(m,function(a){a.set("format",o),d.generateDisplayText(a)}),this.sendData(o,n)},setPercent:function(a,b,c){var d,f,l,m,n,o;if(d=this,f=h.getModelByType("clip")[0],void 0!==f&&(k.clipState="null",f.destroy()),o={type:"percent",isValid:!1,decimal:b,thousands:!1,dateFormat:null,currencySign:null,currencyValid:!1},l=g(c),m=l.operRegion,n=l.sendRegion,d=this,-1===m.startColIndex||-1===m.startRowIndex)return void this.sendData(o,n);"MAX"===m.endColIndex?i.rowPropOper(m.startRowIndex,"format",o,function(a){d.generateDisplayText(a)}):"MAX"===m.endRowIndex?j.colPropOper(m.startColIndex,"format",o,function(a){d.generateDisplayText(a)}):e.operateCellsByRegion(m,function(a){a.set("format",o),d.generateDisplayText(a)}),this.sendData(o,n)},setCurrency:function(a,b,c,d){var f,l,m,n,o,p;if(f=h.getModelByType("clip")[0],void 0!==f&&(k.clipState="null",f.destroy()),n=g(d),o=n.operRegion,p=n.sendRegion,l=this,m={type:"currency",isValid:!1,decimal:b,thousands:!1,dateFormat:null,currencySign:c,currencyValid:!1},-1===o.startColIndex||-1===o.startRowIndex)return void this.sendData(m,p)
;"MAX"===o.endColIndex?i.rowPropOper(o.startRowIndex,"format",m,function(a){l.generateDisplayText(a)}):"MAX"===o.endRowIndex?j.colPropOper(o.startColIndex,"format",m,function(a){l.generateDisplayText(a)}):e.operateCellsByRegion(o,function(a){a.set("format",m),l.generateDisplayText(a)}),this.sendData(m,p)},sendData:function(b,c){var e;switch(e={excelId:a.SPREADSHEET_AUTHENTIC_KEY,sheetId:"1",coordinate:c,format:b.type},b.type){case"number":e.decimalPoint=b.decimal||0,e.thousandPoint=b.thousands||!1;break;case"date":e.dateFormat=b.dateFormat||"";break;case"currency":e.decimalPoint=b.decimal||0,e.currencySymbol=b.currencySign;break;case"percent":e.decimalPoint=b.decimal||0}d.PackAjax({url:"text.htm?m=data_format",data:JSON.stringify(e)})},isNum:function(a){var b;return""!==a&&(b=-1===a.indexOf(",")?/^(\-|\+)?[0-9]+(\.[0-9]+)?$/:/^(\-|\+)?([1-9][0-9]{0,2})+(,\d{3})*(\.[0-9]+)?$/,b.test(a))},trimZero:function(a){var b,c,d;return this.isNum(a)?(d=a.split("."),b=d[0],c=d[1],b=b.replace(/^0*/,""),b=""===b?"0":b,void 0!==c&&(c=c.replace(/0*$/,""),0!==c.length&&(b+="."),b+=c),b):a},getFormatNumber:function(a,b,c){var d,e,f,g,h,i,j,k,l="";if(!this.isNum(a))return a;if(a=this.trimZero(a),a=a.replace(/,/g,""),d=parseFloat(a),d*=Math.pow(10,c),d=Math.round(d),a=(d/Math.pow(10,c)).toString(),b){for(e=a.split("."),g=e[0],"-"!==g.charAt(0)&&0!==g.indexOf("+")||(l=g.charAt(0),g=g.substring(1,g.length)),j=Math.ceil(g.length/3),f=g.length%3>0?g.length%3:3,i=g,g="",k=j-1;k>-1;k--)g=0===k?i.substring(0,f)+g:","+i.substring(3*(k-1)+f,3*k+f)+g;a=l+g,void 0!==e[1]&&(a+="."+e[1])}if(e=a.split("."),c&&(void 0===e[1]||e[1].length<c)){for(g=e[0],h=e[1]||"",k=0,j=c-h.length;k<j;k++)h+="0";a=g+"."+h}return a},isDate:function(a){var b,c,d,e,f=/^\d{4}\/\d{1,2}\/\d{1,2}$/,g=/^\d{4}\u5e74\d{1,2}\u6708(\d{1,2}\u65e5)?$/;return""!==a&&(!(!f.test(a)&&!g.test(a))&&(b=a.match(/\d{4}/)[0],c=a.match(/(\/|\u5e74)\d{1,2}(\/|\u6708)/),null!==c&&(c=c[0].substring(1,c[0].length-1)),d=a.match(/\d{1,2}\u65e5/),null===d&&(d=a.match(/\d{1,2}$/)),null!==d&&(d=d[0].substring(0,d[0].length)),null!==d&&-1!==d.indexOf("日")&&(d=d.substring(0,d.length-1)),e=new Date(b+"/"+(c||"01")+"/"+(d||"01")),parseInt(b)===e.getFullYear()&&((null===c||parseInt(c)===e.getMonth()+1)&&(null===d||parseInt(d)===e.getDate()))))},getFormatDate:function(a,b){var c,d,e,g;if(!this.isDate(a)||""===a)return a;switch(c=a.match(/\d{4}/)[0],d=a.match(/(\/|\u5e74)\d{1,2}(\/|\u6708)/),d=null!==d?d[0].substring(1,d[0].length-1):"01",e=a.match(/\d{1,2}\u65e5/),null===e&&(e=a.match(/\d{1,2}$/)),null!==e&&(e=e[0].substring(0,e[0].length)),null!==e&&-1!==e.indexOf("日")&&(e=e.substring(0,e.length-1)),null===e&&(e="01"),b){case f.dateFormatType.frist:g=c+"/"+d+"/"+e;break;case f.dateFormatType.second:g=c+"/"+d;break;case f.dateFormatType.third:g=c;break;case f.dateFormatType.fourth:g=c+"年"+d+"月"+e+"日";break;case f.dateFormatType.fifth:g=c+"年"+d+"月";break;case f.dateFormatType.sixth:g=c+"年";break;default:g=a}return g},getDateFormat:function(a){var b=/^\d{4}\/\d{1,2}\/\d{1,2}$/,c=/^\d{4}\u5e74\d{1,2}\u6708$/,d=/^\d{4}\u5e74\d{1,2}\u6708\d{1,2}\u65e5$/;return b.test(a)?f.dateFormatType.frist:c.test(a)?f.dateFormatType.fifth:d.test(a)?f.dateFormatType.fourth:null},isCurrency:function(a){return"¥"!==a.charAt(0)&&"$"!==a.charAt(0)||(a=a.substring(1,a.length)),this.isNum(a)},isLossCurrency:function(a){return"¥"!==a.charAt(0)&&"$"!==a.charAt(0)||(a=a.substring(1,a.length)),"-"===a.charAt(0)},getFormatCurrency:function(a,b,c){var d=a;return""===a?a:this.isCurrency(a)?("¥"!==a.charAt(0)&&"$"!==a.charAt(0)||(a=a.substring(1,a.length)),c=c||"$",c+this.getFormatNumber(a,!0,b)):d},isPercent:function(a){return"%"===a.charAt(a.length-1)&&(a=a.substring(0,a.length-1)),this.isNum(a)},getFormatPercent:function(a,b){var c=a;if(""===a)return a;if("%"===a.charAt(a.length-1)){if(a=a.substring(0,a.length-1),this.isNum(a))return(a=this.getFormatNumber(a,!1,b))+"%"}else if(this.isNum(a))return a=a.replace(/,/g,""),a=(100*Number(a)).toString(),(a=this.getFormatNumber(a,!1,b))+"%";return c},generateDisplayText:function(a){var c,d,e=a.get("content.texts"),g=a.get("format"),h=g.type,i=g.decimal,j=g.thousands,k=g.dateFormat,l=g.currencySign;switch(h){case"normal":this.isNum(e)?(d=!0,-1!==e.indexOf(",")&&(j=!0,a.set("content.texts",e.replace(/,/g,""))),c=this.getFormatNumber(e,j,f.defaultNumberFormat.decimal),c=this.trimZero(c),a.set("content.displayTexts",c),a.set("format.thousands",j)):a.set("content.displayTexts",e);break;case"date":d=this.isDate(e),d?a.set("content.displayTexts",b.getFormatDate(e,k)):a.set("content.displayTexts",e);break;case"number":d=this.isNum(e),d?(-1!==e.indexOf(",")&&(j=!0,a.set("content.texts",e.replace(/,/g,""))),a.set("content.displayTexts",b.getFormatNumber(e,j,i))):a.set("content.displayTexts",e);break;case"currency":d=this.isCurrency(e),d?(-1!==e.indexOf(",")&&(j=!0,a.set("content.texts",e.replace(/,/g,""))),-1===e.indexOf("$")&&-1===e.indexOf("¥")||a.set("content.texts",e.replace(/¥/g,"")),a.set("content.displayTexts",b.getFormatCurrency(e,i,l))):a.set("content.displayTexts",e);break;case"percent":d=this.isPercent(e),d?(-1!==e.indexOf(",")&&(j=!0,a.set("content.texts",e.replace(/,/g,""))),-1!==e.indexOf("%")&&(e=e.replace(/%/g,""),e=(parseInt(e)/100).toString(),a.set("content.texts",e)),a.set("content.displayTexts",b.getFormatPercent(e,i))):a.set("content.displayTexts",e);break;default:a.set("content.displayTexts",e),d=!0}a.set("format.isValid",d)}}}),b("entrance/tool/addrow",function(){var a=c("lib/backbone"),b=c("spreadsheet/config"),d=c("basic/tools/cache"),e=c("collections/headItemRow"),f=c("collections/headItemCol"),g=c("basic/tools/getoperregion"),h=c("collections/cells"),i=c("collections/selectRegion"),j=c("collections/siderLineRow"),k=c("basic/tools/send");return{addRow:function(c,f){var h,j,l,m,n,o;h=i.getModelByType("clip")[0],void 0!==h&&(d.clipState="null",h.destroy()),j=g(f),l=j.operRegion,m=j.sendRegion,-1!==l.startColIndex&&-1!==l.startRowIndex&&(o=l.startRowIndex,n=e.models[o].get("top"),e.models[o].get("height"),this._adaptHeadRowItem(o),this._adaptSelectRegion(o),this._adaptCells(o),this._fillCells(o),this._frozenHandle(o),a.trigger("event:mainContainer:adaptRowHeightChange",n,b.User.cellHeight),k.PackAjax({url:"cells.htm?m=rows_insert",data:JSON.stringify({rowSort:m.startSortY})}))},_adaptHeadRowItem:function(a){var c,f,g,h,i,j=a+1;for(c=e.models[a],e.add({sort:c.get("sort"),alias:d.aliasGenerator(),top:c.get("top"),displayName:c.get("displayName")},{at:a}),f=b.User.cellHeight,i=e.length;j<i;j++)c=e.models[j],h=c.get("top")+f,g=c.get("sort")+1,c.set("top",h),c.set("displayName",(g+1).toString()),c.set("sort",g)},_adaptSelectRegion:function(a){var c,d,f,g,h,k,l;c=i.getModelByType("operation")[0],d=c.get("wholePosi").startY,f=c.get("wholePosi").endY,g=e.getIndexByAlias(d),(l=e.getIndexByAlias(f))<a||(g>=a&&(k=c.get("physicsPosi").top,k+=b.User.cellHeight,c.set("physicsPosi.top",k),j.models[0].set("top",k),g++),g<a&&l>=a&&(h=c.get("physicsBox").height,h+=b.User.cellHeight,c.set("physicsBox.height",h),j.models[0].set("height",h),e.models[a].set("activeState",!0)))},_adaptCells:function(a){var c,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u=0;for(n=h.getCellByRow(a+1,e.length-1),q=n.length;u<q;u++)if(s=n[u],f=s.get("occupy").y,i=f[0],(m=e.getIndexByAlias(i))>=a)t=s.get("physicsBox").top,t+=b.User.cellHeight,s.set("physicsBox.top",t);else{for(c=s.get("physicsBox").height,c+=b.User.cellHeight,s.set("physicsBox.height",c),l=s.get("occupy").x[0],j=s.get("occupy").x,k=j[0],g=e.models[a].get("alias"),p=j.length,o=d.CellsPosition.strandX[l][k],r=0;r<p;r++)d.cachePosition(g,j[r],o);f.splice(a-m,0,g),s.set("occupy.y",f)}},_fillCells:function(a){var b,c,g,i,j,k,l,m=0;for(b=f.models,l=f.length,i=e.models[a].get("alias"),g=d.CellsPosition.strandX;m<l;m++)c=b[m],k=c.get("operProp"),function(a){var b;for(b in a)return!1;return!0}(k)||(j=c.get("alias"),void 0!==g[j]&&void 0!==g[j][i]||h.createCellModel(m,a,k))},_frozenHandle:function(b){var c,f,g,h;!0===d.TempProp.isFrozen&&(c=d.UserView.rowAlias,g=d.TempProp.rowAlias,f=e.getIndexByAlias(c),h=e.getIndexByAlias(g),f>b&&(c=e.models[b].get("alias"),d.UserView.rowAlias=c),b+1===h&&(g=e.models[b].get("alias"),d.TempProp.rowAlias=g),a.trigger("event:bodyContainer:executiveFrozen"))}}}),b("entrance/tool/addcol",function(){var a=c("lib/backbone"),b=c("spreadsheet/config"),d=c("basic/tools/cache"),e=c("collections/headItemCol"),f=c("basic/tools/buildalias"),g=c("basic/tools/getoperregion"),h=c("collections/cells"),i=c("collections/selectRegion"),j=c("collections/siderLineCol"),k=c("basic/tools/send");return{addCol:function(a,b){var c,e,f,h;c=i.getModelByType("clip")[0],void 0!==c&&(d.clipState="null",c.destroy()),this._isAbleAdd()&&(e=g(b),f=e.operRegion,h=e.sendRegion,-1!==f.startColIndex&&-1!==f.startRowIndex&&(this._adaptHeadColItem(f.startColIndex),this._adaptSelectRegion(f.startColIndex),this._adaptCells(f.startColIndex),this._removeLastColItem(),this._frozenHandle(f.startColIndex),k.PackAjax({url:"cells.htm?m=cols_insert",data:JSON.stringify({colSort:h.startSortX})})))},_isAbleAdd:function(){var a,b=e.length-1;return a=h.getCellsByColIndex(b,b),!(a.length>0)},_removeLastColItem:function(){var a,b=e.length-1;a=e.models[b],e.remove(a),a.destroy()},_adaptHeadColItem:function(a){var c,g,h,i,j,k=a+1;for(c=e.models[a],g=b.User.cellWidth,e.add({sort:c.get("sort"),alias:d.aliasGenerator("col"),left:c.get("left"),width:g-1,displayName:c.get("displayName")},{at:a}),j=e.length;k<j;k++)c=e.models[k],i=c.get("left")+g,h=c.get("sort")+1,c.set("left",i),c.set("displayName",f.buildColAlias(h)),c.set("sort",h)},_adaptSelectRegion:function(a){var c,d,f,g,h,k,l,m,n;if(c=i.getModelByType("operation")[0],f=c.get("wholePosi").startX,g=c.get("wholePosi").endX,h=e.getIndexByAlias(f),k=e.getIndexByAlias(g),d=e.models[a],l=e.length-1,!(k<a)){if(l===k)return void(h===k?(n=d.get("left"),m=d.get("width"),f=d.get("alias"),c.set("physicsPosi.left",n),c.set("physicsBox.width",m),c.set("wholePosi.startX",f),c.set("wholePosi.endX",f),j.models[0].set("left",n),j.models[0].set("width",m),e.models[l-1].set("activeState",!0)):(n=c.get("physicsPosi").left,n+=b.User.cellWidth,m=c.get("physicsBox").width,m-=e.models[l].get("width"),g=d.get("alias"),c.set("physicsPosi.left",n),c.set("physicsBox.width",m),g=e.models[k-1].get("alias"),c.set("wholePosi.endX",g),j.models[0].set("left",n),j.models[0].set("width",m)));n=c.get("physicsPosi").left,n+=b.User.cellWidth,c.set("physicsPosi.left",n),j.models[0].set("left",n)}},_adaptCells:function(a){var c,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u=0;for(o=h.getCellsByColIndex(a+1,e.length-1),r=o.length;u<r;u++)if(t=o[u],g=t.get("occupy").x,j=g[0],(n=e.getIndexByAlias(j))>=a)c=t.get("physicsBox").left,c+=b.User.cellWidth,t.set("physicsBox.left",c);else{for(f=t.get("physicsBox").width,f+=b.User.cellWidth,t.set("physicsBox.width",f),k=t.get("occupy").y,m=t.get("occupy").x[0],l=k[0],i=e.models[a].get("alias"),q=k.length,p=d.CellsPosition.strandX[m][l],s=0;s<q;s++)d.cachePosition(k[s],i,p);g.splice(a-n,0,i),t.set("occupy.x",g)}},_frozenHandle:function(b){var c,f,g,h;!0===d.TempProp.isFrozen&&(c=d.UserView.colAlias,g=d.TempProp.colAlias,f=e.getIndexByAlias(c),h=e.getIndexByAlias(g),f>b&&(c=e.models[b].get("alias"),d.UserView.colAlias=c),b+1===h&&(g=e.models[b].get("alias"),d.TempProp.colAlias=g),a.trigger("event:bodyContainer:executiveFrozen"))}}}),b("entrance/tool/deleterow",function(){var a=c("lib/backbone"),b=c("basic/tools/cache"),d=c("collections/headItemRow"),e=c("collections/cells"),f=c("basic/tools/getoperregion"),g=c("collections/selectRegion"),h=c("collections/siderLineRow"),i=c("basic/tools/send");return{deleteRow:function(c,e){function h(){i.PackAjax({url:"cells.htm?m=rows_delete",data:JSON.stringify({rowSort:m.startSortY})})}var j,k,l,m,n,o,p;if(j=g.getModelByType("clip")[0],void 0!==j&&(b.clipState="null",j.destroy()),k=f(e),l=k.operRegion,m=k.sendRegion,"MAX"!==l.endColIndex){if(-1===l.startRowIndex)return void h();n=l.startRowIndex,o=d.models[n].get("top"),p=d.models[n].get("height"),this._adaptCells(n),this._adaptSelectRegion(n),this._frozenHandle(n),this._adaptHeadRowItem(n),!0===b.TempProp.isFrozen&&a.trigger("event:bodyContainer:executiveFrozen"),a.trigger("event:mainContainer:adaptRowHeightChange",o,-p-1),h()}},_adaptHeadRowItem:function(a){var b,c,e,f,g,h=a;for(b=d.models[a],c=b.get("height"),d.remove(b),b.destroy(),g=d.length;h<g;h++)b=d.models[h],f=b.get("top")-c-1,e=b.get("sort")-1,b.set("top",f),b.set("displayName",(e+1).toString()),b.set("sort",e)},_adaptSelectRegion:function(a){var b,c,e,f,i,j,k;b=g.getModelByType("operation")[0],c=b.get("wholePosi").startY,e=b.get("wholePosi").endY,j=b.get("physicsPosi").top,i=b.get("physicsBox").height,f=d.getIndexByAlias(c),(k=d.getIndexByAlias(e))<a||(f===a&&(k===f?(i=d.models[a+1].get("height"),e=d.models[a+1].get("alias"),b.set("wholePosi.endY",e),b.set("wholePosi.startY",e),d.models[a+1].set("activeState",!0)):i=i-d.models[a].get("height")-1,c=d.models[a+1].get("alias"),b.set("wholePosi.startY",c),b.set("physicsBox.height",i)),k!==f&&k===a&&(i=b.get("physicsBox").height,i=i-d.models[a].get("height")-1,e=d.models[a-1].get("alias"),b.set("wholePosi.endY",e)),f<a&&k>a&&(i=b.get("physicsBox").height,i=i-d.models[a].get("height")-1,b.set("physicsBox.height",i)),f>a&&(j=j-d.models[a].get("height")-1,b.set("physicsPosi.top",j)),h.models[0].set("height",i))},_adaptCells:function(a){var c,f,g,h,i,j,k,l,m,n,o,p,q=0;for(k=e.getCellByRow(a,d.length-1),f=d.models[a].get("alias"),m=k.length;q<m;q++)for(o=k[q],h=o.get("occupy").y,i=o.get("occupy").x,l=i.length,g=h[0],j=d.getIndexByAlias(g),j===a&&1===h.length?o.set("isDestroy",!0):j<=a?(c=o.get("physicsBox").height,c-=d.models[a].get("height"),o.set("physicsBox.height",c-1),h.splice(a-j,1),o.set("occupy.y",h)):j>a&&(p=o.get("physicsBox").top,p=p-d.models[a].get("height")-1,o.set("physicsBox.top",p)),n=0;n<l;n++)b.deletePosi(f,i[n])},_frozenHandle:function(a){var c,e,f,g;!0===b.TempProp.isFrozen&&(c=b.UserView.rowAlias,f=b.TempProp.rowAlias,e=d.getIndexByAlias(c),g=d.getIndexByAlias(f),e===a&&(b.UserView.rowAlias=d.models[a+1].get("alias")),g===a&&(b.TempProp.rowAlias=0===a?d.models[1].get("alias"):d.models[a+1].get("alias")))}}}),b("entrance/tool/deletecol",function(){var a=c("lib/backbone"),b=c("basic/tools/cache"),d=c("spreadsheet/config"),e=(c("collections/headItemRow"),c("collections/headItemCol")),f=c("basic/tools/getoperregion"),g=c("basic/tools/buildalias"),h=c("collections/cells"),i=c("collections/selectRegion"),j=c("collections/siderLineCol"),k=c("basic/tools/send");return{deleteCol:function(c,d){function e(){k.PackAjax({url:"cells.htm?m=cols_delete",data:JSON.stringify({colSort:l.startSortX})})}var g,h,j,l,m;if(g=i.getModelByType("clip")[0],void 0!==g&&(b.clipState="null",g.destroy()),h=f(d),j=h.operRegion,l=h.sendRegion,"MAX"!==j.endRowIndex){if(-1===j.startRowIndex)return void e();m=j.startColIndex,this._addColItem(),this._adaptCells(m),this._adaptSelectRegion(m),this._frozenHandle(m),this._adaptHeadColItem(m),!0===b.TempProp.isFrozen&&a.trigger("event:bodyContainer:executiveFrozen"),e()}},_addColItem:function(){var a=e.length,c=(d.User.cellWidth,e.models[a-1]);e.add({sort:c.get("sort")+1,alias:b.aliasGenerator("col"),left:c.get("left")+c.get("width")+1})},_adaptHeadColItem:function(a){var b,c,d,f,h,i=a;for(b=e.models[a],c=b.get("width"),e.remove(b),b.destroy(),h=e.length;i<h;i++)b=e.models[i],f=b.get("left")-c-1,d=b.get("sort")-1,b.set("left",f),b.set("displayName",g.buildColAlias(i)),b.set("sort",d)},_adaptSelectRegion:function(a){var b,c,d,f,g,h,k;b=i.getModelByType("operation")[0],c=b.get("wholePosi").startX,d=b.get("wholePosi").endX,f=e.getIndexByAlias(c),g=e.getIndexByAlias(d),k=b.get("physicsPosi").left,h=b.get("physicsBox").width,g<a||(f===a&&(g===f?(h=e.models[a+1].get("width"),d=e.models[a+1].get("alias"),b.set("wholePosi.endX",d),b.set("wholePosi.startX",d),e.models[a+1].set("activeState",!0)):h=h-e.models[a].get("width")-1,c=e.models[a+1].get("alias"),b.set("wholePosi.startX",c),b.set("physicsBox.width",h)),g!==f&&g===a&&(h=b.get("physicsBox").width,h=h-e.models[a].get("width")-1,d=e.models[a-1].get("alias"),b.set("wholePosi.endX",d)),f<a&&g>a&&(h=b.get("physicsBox").width,h=h-e.models[a].get("width")-1,b.set("physicsBox.width",h)),f>a&&(k=k-e.models[a].get("width")-1,b.set("physicsPosi.left",k)),j.models[0].set("width",h))},_adaptCells:function(a){var c,d,f,g,i,j,k,l,m,n,o,p,q=0;for(l=h.getCellsByColIndex(a,e.length-1),f=e.models[a].get("alias"),n=l.length;q<n;q++)for(p=l[q],i=p.get("occupy").y,j=p.get("occupy").x,m=i.length,g=j[0],k=e.getIndexByAlias(g),k===a&&1===j.length?p.set("isDestroy",!0):k<=a?(c=p.get("physicsBox").width,c-=e.models[a].get("width"),p.set("physicsBox.width",c-1),j.splice(a-k,1),p.set("occupy.x",j)):k>a&&(d=p.get("physicsBox").left,d=d-e.models[a].get("width")-1,p.set("physicsBox.left",d)),o=0;o<m;o++)b.deletePosi(i[o],f)},_frozenHandle:function(a){var c,d,f,g;!0===b.TempProp.isFrozen&&(c=b.UserView.colAlias,f=b.TempProp.colAlias,d=e.getIndexByAlias(c),g=e.getIndexByAlias(f),d===a&&(b.UserView.colAlias=e.models[a+1].get("alias")),g===a&&(b.TempProp.colAlias=0===a?e.models[1].get("alias"):e.models[a+1].get("alias")))}}}),b("entrance/tool/regiondel",function(){var a=c("basic/tools/send"),b=c("collections/selectRegion"),d=c("basic/tools/getoperregion"),e=c("basic/tools/cache"),f=c("collections/cells");return function(c,g){function h(){a.PackAjax({url:"text.htm?m=data_del",data:JSON.stringify({coordinate:l})})}var i,j,k,l;if(i=b.getModelByType("clip")[0],void 0!==i&&(e.clipState="null",i.destroy()),j=d(g),k=j.operRegion,l=j.sendRegion,-1===k.startColIndex||-1===k.startRowIndex)return void h();f.operateCellsByRegion(k,function(a){a.set("content.texts",""),a.set("content.displayTexts","")}),h()}}),b("entrance/col/colhide",function(){var a=c("basic/tools/send"),b=c("collections/selectRegion"),d=c("collections/headItemCol"),e=c("collections/headItemRow"),f=c("collections/siderLineCol"),g=c("lib/backbone"),h=c("collections/cells"),i=c("basic/tools/cache"),j=c("basic/tools/getoperregion");return{hide:function(c,e){var f,h,k,l,m,n;f=b.getModelByType("clip")[0],void 0!==f&&(i.clipState="null",f.destroy()),h=j(e),"MAX"===h.operRegion.endRowIndex&&(m=d.models,n=m.length,k=h.operRegion.startColIndex,h.sendRegion.startColSort,l=m[k].get("width"),0===m[n-1].get("left")||m[n-1].get("left")===l+1&&m[n-1].get("hidden")||(this._adjustHideHeadItemCols(k,l),this._adjustHideCells(k,l),this._adjustHideSelectRegion(k,l),g.trigger("event:cellsContainer:adaptWidth"),a.PackAjax({url:"cells.htm?m=cols_hide",data:JSON.stringify({colSort:m[k].get("sort"),hide:!0})})))},_adjustHideCells:function(a){var b,c,e,f,g,i,j,k,l;for(b=h.getCellByVertical(a,0,"MAX","MAX"),i=d.models[a].get("alias"),g=d.models[a].get("originalWidth"),l=b.length,k=0;k<l;k++)c=b[k],e=c.get("occupy").x,1===e.length?e[0]===i?(c.set("physicsBox.width",0),c.set("hidden",!0)):(j=c.get("physicsBox").left,c.set("physicsBox.left",j-g-1)):-1!==e.indexOf(i)?(f=c.get("physicsBox").width,f===g?(c.set("physicsBox.width",0),c.set("hidden",!0)):c.set("physicsBox.width",f-g-1)):(j=c.get("physicsBox").left,c.set("physicsBox.left",j-g-1))},_adjustHideSelectRegion:function(a){var c,g,h,i,j,k,l,m,n,o=d.models,p=e.models,q=o.length,r=p.length;if(h=b.getModelByType("operation")[0],g=o[q-1].get("left"),(m=o[a].get("left"))<g)for(n=a+1;o[n].get("hidden");)n++;else for(n=a-1;n>-1&&o[n].get("hidden");)n--;if(-1===n)for(n=a+1;o[n].get("hidden");)n++;c=o[n],c.set("activeState",!0),i=c.get("alias"),j=p[0].get("alias"),l=p[r-1].get("top")+p[r-1].get("height"),k=c.get("width"),m=c.get("left"),h.set({initPosi:{startX:n,startY:0},mousePosi:{mouseX:n,mouseY:0},physicsPosi:{top:0,left:m},physicsBox:{width:k,height:l},wholePosi:{startX:i,startY:j,endX:i,endY:"MAX"},selectType:"operation"}),f.models[0].set("left",m),f.models[0].set("width",k-1)},_adjustHideHeadItemCols:function(a){var b,c,e,f=d.models,g=f.length;for(a>0&&f[a-1].set("isRightAjacentHide",!0),b=f[a].get("width"),f[a].set("hidden",!0),f[a].set("width",0),f[a].set("activeState",!1),c=f[a].get("left"),f[g-1].get("left"),a<g-1&&(c=f[a+1].get("left"),f[a+1].set("left",c-b-1),f[a+1].set("isLeftAjacentHide",!0)),e=a+2;e<g;e++)c=f[e].get("left"),f[e].set("left",c-b-1)},cancelHide:function(b,c){var e,f,j,k,l,m,n,o,p,q=d.models,r=q.length,s=0,t=0;if(!i.TempProp.isFrozen){for(g.trigger("event:restoreHideCellView"),g.trigger("event:restoreHideCols");t<r;t++)if(n=q[t].get("alias"),q[t].get("hidden")){for(t>0&&q[t-1].set("isRightAjacentHide",!1),t<r-1&&q[t+1].set("isLeftAjacentHide",!1),o=q[t].get("originalWidth"),f=h.getCellByVertical(t,0,t,"MAX"),j=f.length,q[t].set("width",o),m=q[t].get("left"),q[t].set("left",m+s),q[t].set("hidden",!1),p=0;p<j;p++)k=f[p].get("physicsBox").width,e=f[p].get("hidden"),e?(f[p].set("physicsBox.width",k+o),f[p].set("hidden",!1)):f[p].set("physicsBox.width",k+o+1),n===f[p].get("occupy").x[0]&&(l=f[p].get("physicsBox").left,f[p].set("physicsBox.left",l+s));s+=o+1}else if(0!==s){for(f=h.getCellByVertical(t,0,t,"MAX"),j=f.length,p=0;p<j;p++)n===f[p].get("occupy").x[0]&&(l=f[p].get("physicsBox").left,f[p].set("physicsBox.left",l+s));m=q[t].get("left"),q[t].set("left",m+s)}this._adjustCancelHideSelectRegion(),g.trigger("event:cellsContainer:adaptWidth"),g.trigger("event:colsAllHeadContainer:adaptWidth"),a.PackAjax({url:"sheet.htm?m=cols_cancelhide"})}},_adjustCancelHideSelectRegion:function(){var a,c,e,g,h=d.models,i=0;e=b.getModelByType("operation")[0],a=d.getIndexByAlias(e.get("wholePosi").startX),c=d.getIndexByAlias(e.get("wholePosi").endX),g=h[a].get("left");for(var j=a;j<c+1;j++)i+=h[j].get("width")+1;e.set("physicsBox.width",i-1),e.set("physicsPosi.left",g),f.models[0].set("left",g),f.models[0].set("width",i-1)}}}),b("entrance/tool/clipselectoperate",function(){function b(b,c){var i,j,k,l,m,n,o,p,q,r,s,t="";if(o=f.getModelByType("clip")[0],void 0!==o&&o.destroy(),j=f.getModelByType("operation")[0],"MAX"!==j.get("wholePosi").endX&&"MAX"!==j.get("wholePosi").endY){if(o=j.clone(),o.set("selectType","clip"),f.add(o),"copy"===b)h.clipState="copy";else{if("cut"!==b)return;h.clipState="cut"}for(k=d.getIndexByAlias(o.get("wholePosi").startX),l=e.getIndexByAlias(o.get("wholePosi").startY),m=d.getIndexByAlias(o.get("wholePosi").endX),n=e.getIndexByAlias(o.get("wholePosi").endY),r=l;r<n+1;r++)for(s=k;s<m+1;s++)p=d.models[s].get("alias"),q=e.models[r].get("alias"),i=g.getCellByAlias(p,q),null!==i&&(t+=function(a){var b,c='"',d='"';if(b=a.get("content").texts,-1===b.indexOf("\n"))return b;for(;;){if(0!==b.indexOf('"'))break;b=b.substring(1),c+='""'}for(;;){if(!(b.lastIndexOf('"')===b.length-1&&b.length>1))break;b=b.substring(0,b.length-1),d+='""'}return b=c+b+d}(i)),t+=s!==m?"\t":"\r\n";void 0!==c&&(c.preventDefault(),a.clipboardData?a.clipboardData.setData("Text",t):c.originalEvent.clipboardData.setData("Text",t))}}var d=c("collections/headItemCol"),e=c("collections/headItemRow"),f=c("collections/selectRegion"),g=c("collections/cells"),h=c("basic/tools/cache");return b}),b("entrance/tool/clippasteoperate",function(){function b(a){"copy"===k.clipState?d("copy"):"cut"===k.clipState?d("cut"):h(a)}function d(b){var c,d,h,i,m,r,s,t,u,v,w,x,y,z,A,B,C,D,E;c=q.getModelByType("clip")[0],d=q.getModelByType("operation")[0],C=p.models,B=o.models,h=o.getIndexByAlias(c.get("wholePosi").startX),i=p.getIndexByAlias(c.get("wholePosi").startY),m=o.getIndexByAlias(c.get("wholePosi").endX),r=p.getIndexByAlias(c.get("wholePosi").endY),w=h-o.getIndexByAlias(d.get("wholePosi").startX),x=i-p.getIndexByAlias(d.get("wholePosi").startY),n.PackAjax({url:"plate.htm?m="+b,async:!1,data:JSON.stringify({excelId:a.SPREADSHEET_AUTHENTIC_KEY,sheetId:"1",orignal:{startColSort:B[h].get("sort"),endColSort:B[m].get("sort"),startRowSort:C[i].get("sort"),endRowSort:C[r].get("sort")},target:{colSort:B[h-w].get("sort"),rowSort:C[i-x].get("sort")}}),success:function(a){if(a.returndata){for(D=i;D<r+1;D++)for(E=h;E<m+1;E++)E-w>o.models.length-1||D-x>p.models.length-1||(u=o.models[E-w].get("alias"),v=p.models[D-x].get("alias"),null!==(z=l.getCellByAlias(u,v))&&(z.set("isDestroy",!0),g(u,v)));for(D=i;D<r+1;D++)for(E=h;E<m+1;E++)s=o.models[E].get("alias"),t=p.models[D].get("alias"),E-w>o.models.length-1||D-x>p.models.length-1||(A=l.getCellByAlias(s,t),"cut"===b&&g(s,t),null!==A&&A.get("occupy").x[0]===s&&A.get("occupy").y[0]===t&&(y=A.clone(),"cut"===b&&A.set("isDestroy",!0),f(y,w,x),e(y),l.add(y)));j.trigger("event:cellsContainer:adjustSelectRegion",{initColIndex:h-w,initRowIndex:i-x,mouseColIndex:m-w<o.models.length-1?m-w:o.models.length-1,mouseRowIndex:r-x<p.models.length-1?r-x:p.models.length-1}),"cut"===b&&(k.clipState="null",c.destroy()),h-w>m||m-w<h||i-x>r||r-x<i||(k.clipState="null",c.destroy())}}})}function e(a){var b,c,d,e=a.get("occupy").x,f=a.get("occupy").y,g=0;for(b=f.length,c=e.length;g<b;g++)for(d=0;d<c;d++)k.cachePosition(f[g],e[d],l.length)}function f(a,b,c){var d,e,f,g,h,i,j,k,l,m=[],n=[],q=0,r=0;for(d=a.get("occupy").x,e=a.get("occupy").y,j=e.length,k=d.length,l=0;l<j;l++)g=p.getIndexByAlias(e[l])-c,n.push(p.models[g].get("alias")),r+=p.models[g].get("height")+1,0===l&&(i=p.models[g].get("top"));for(l=0;l<k;l++)f=o.getIndexByAlias(d[l])-b,m.push(o.models[f].get("alias")),q+=o.models[f].get("width")+1,0===l&&(h=o.models[f].get("left"));a.set("occupy",{x:m,y:n}),a.set("physicsBox",{top:i,left:h,width:q-1,height:r-1})}function g(a,b){var c=k.CellsPosition,d=c.strandX,e=c.strandY;void 0!==d[a]&&void 0!==d[a][b]&&(delete d[a][b],Object.getOwnPropertyNames(d[a]).length||delete d[a]),void 0!==e[b]&&void 0!==e[b][a]&&(delete e[b][a],Object.getOwnPropertyNames(e[b]).length||delete e[b])}function h(b){function c(a){var b="",c="";if(-1===a.indexOf("%0A"))return a;for(a=a.substring(3,a.length-3);;){if(0!==a.indexOf("%22%22"))break;a=a.substring(6),b+="%22"}for(;;){if(!(a.lastIndexOf("%22%22")===a.length-6&&a.length>6))break;a=a.substring(0,a.length-6),c+="%22"}return a=b+a+c}var d,e,f,g,h,j,m,r,s,t,u,v,w,x,y,z,A,B,C=[],D=[],E=[],F=[];u=q.getModelByType("clip")[0],null!==u&&void 0!==u&&u.destroy(),k.clipState="null",f=encodeURI(b),C=f.split("%0D%0A"),z=C.length-1,""!==C[z]&&z++,d=o.models,e=p.models,A=C[0].split("%09").length,t=q.getModelByType("operation")[0],g=t.get("wholePosi").startY,h=t.get("wholePosi").startX,j=p.getIndexByAlias(g),m=o.getIndexByAlias(h),r=e[j].get("sort"),s=d[m].get("sort"),y=r,x=s;for(var G=0;G<z;G++){D=C[G].split("%09");for(var H=0;H<D.length;H++)""!==D[H]&&(F.push({colSort:x,rowSort:y,text:decodeURI(c(D[H]))}),E.push({colIndex:m+H,rowIndex:j+G,text:decodeURI(c(D[H]))}),x++);x=s,y++}n.PackAjax({url:"plate.htm?m=paste",async:!1,data:JSON.stringify({excelId:a.SPREADSHEET_AUTHENTIC_KEY,sheetId:"1",startColSort:s,startRowSort:r,colLen:A,rowLen:z,pasteData:F}),success:function(a){if(!0===a.returndata){for(G=0;G<z;G++)for(H=0;H<A;H++)v=e[j+G].get("alias"),w=d[m+H].get("alias"),B=l.getCellByVertical(m+H,j+G)[0],void 0!==B&&!1===B.get("isDestroy")&&B.set("isDestroy",!0),k.deletePosi(v,w);for(G=0;G<E.length;G++)i(E[G])}}})}function i(a){var b,c,d,e,f,g,h;if(g=o.models,h=p.models,c=a.colIndex,d=a.rowIndex,!(c>o.length-1||d>p.length-1)){var i,j,n,q;i=h[d].get("top"),j=g[c].get("left"),n=g[c].get("width"),q=h[d].get("height"),b=new m,e=g[c].get("alias"),f=h[d].get("alias"),b.set("occupy",{x:[e],y:[f]}),b.set("physicsBox",{top:i,left:j,width:n,height:q}),b.set("content.texts",a.text),r.typeRecognize(b),r.generateDisplayText(b),k.cachePosition(f,e,l.length),l.add(b)}}var j=c("lib/backbone"),k=c("basic/tools/cache"),l=c("collections/cells"),m=c("models/cell"),n=c("basic/tools/send"),o=c("collections/headItemCol"),p=c("collections/headItemRow"),q=c("collections/selectRegion"),r=c("entrance/tool/settexttype");return b}),b("entrance/tool/comment",function(){var a=c("basic/tools/send"),b=c("collections/cells"),d=c("lib/backbone"),e=c("collections/selectRegion"),f=c("basic/tools/getoperregion"),g=c("entrance/row/rowoperation"),h=c("entrance/col/coloperation"),i=c("basic/tools/cache");return{modifyComment:function(a,c,d){var j,k,l,m;if(j=e.getModelByType("clip")[0],void 0!==j&&(i.clipState="null",j.destroy()),k=f(d),l=k.operRegion,m=k.sendRegion,-1===l.startColIndex||-1===l.startRowIndex)return void this.sendData(m,c,"text.htm?m=comment_set");"MAX"===l.endColIndex?g.rowPropOper(l.startRowIndex,"customProp.comment",c):"MAX"===l.endRowIndex?h.colPropOper(l.startColIndex,"customProp.comment",c):b.operateCellsByRegion(l,function(a){a.set("customProp.comment",c)}),this.sendData(m,c,"text.htm?m=comment_set")},createAddCommentView:function(a){var b=e.getModelByType("clip")[0];void 0!==b&&(i.clipState="null",b.destroy()),d.trigger("event:commentContainer:show",{state:"add"})},createEditComment:function(a){var b=e.getModelByType("clip")[0];void 0!==b&&(i.clipState="null",b.destroy()),d.trigger("event:commentContainer:show",{state:"edit"})},deleteComment:function(a,b){this.modifyComment("1",null,b)},sendData:function(b,c,d){var e={coordinate:b};null!==c&&(e.comment=c),a.PackAjax({url:d,data:JSON.stringify(e)})}}}),b("basic/util/observer.pattern",function(){return{publisher:{subscribers:{any:[]},subscribe:function(a,b){b=b||"any",void 0===this.subscribers[b]&&(this.subscribers[b]=[]),this.subscribers[b].push(a)},unsubscribe:function(a,b){this.visitSubscribers("unsubscribe",a,b)},publish:function(a,b){this.visitSubscribers("publish",a,b)},visitSubscribers:function(a,b,c){var d,e,f,g=c||"any",h=this.subscribers[g];for(f=void 0!==h?h.length:0,e=0;e<f;e++)"publish"===a?(d=h[e],d.master[d.behavior](b,d.args)):h[e]===b&&h.splice(e,1)}},buildPublisher:function(a){for(var b in this.publisher)this.publisher.hasOwnProperty(b)&&"function"==typeof this.publisher[b]&&(a[b]=this.publisher[b]);a.subscribers={any:[]}}}}),b("lib/handlebars",function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){function d(){var a=r();return a.compile=function(b,c){return k.compile(b,c,a)},a.precompile=function(b,c){return k.precompile(b,c,a)},a.AST=i.default,a.Compiler=k.Compiler,a.JavaScriptCompiler=m.default,a.Parser=j.parser,a.parse=j.parse,a}var e=c(1).default;b.__esModule=!0;var f=c(2),g=e(f),h=c(21),i=e(h),j=c(22),k=c(27),l=c(28),m=e(l),n=c(25),o=e(n),p=c(20),q=e(p),r=g.default.create,s=d();s.create=d,q.default(s),s.Visitor=o.default,s.default=s,b.default=s,a.exports=b.default},function(a,b){b.default=function(a){return a&&a.__esModule?a:{default:a}},b.__esModule=!0},function(a,b,c){function d(){var a=new h.HandlebarsEnvironment;return n.extend(a,h),a.SafeString=j.default,a.Exception=l.default,a.Utils=n,a.escapeExpression=n.escapeExpression,a.VM=p,a.template=function(b){return p.template(b,a)},a}var e=c(3).default,f=c(1).default;b.__esModule=!0;var g=c(4),h=e(g),i=c(18),j=f(i),k=c(6),l=f(k),m=c(5),n=e(m),o=c(19),p=e(o),q=c(20),r=f(q),s=d();s.create=d,r.default(s),s.default=s,b.default=s,a.exports=b.default},function(a,b){b.default=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b},b.__esModule=!0},function(a,b,c){function d(a,b,c){this.helpers=a||{},this.partials=b||{},this.decorators=c||{},i.registerDefaultHelpers(this),j.registerDefaultDecorators(this)}var e=c(1).default;b.__esModule=!0,b.HandlebarsEnvironment=d;var f=c(5),g=c(6),h=e(g),i=c(7),j=c(15),k=c(17),l=e(k);b.VERSION="4.0.5";b.COMPILER_REVISION=7;var m={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};b.REVISION_CHANGES=m;d.prototype={constructor:d,logger:l.default,log:l.default.log,registerHelper:function(a,b){if("[object Object]"===f.toString.call(a)){if(b)throw new h.default("Arg not supported with multiple helpers");f.extend(this.helpers,a)}else this.helpers[a]=b},unregisterHelper:function(a){
delete this.helpers[a]},registerPartial:function(a,b){if("[object Object]"===f.toString.call(a))f.extend(this.partials,a);else{if(void 0===b)throw new h.default('Attempting to register a partial called "'+a+'" as undefined');this.partials[a]=b}},unregisterPartial:function(a){delete this.partials[a]},registerDecorator:function(a,b){if("[object Object]"===f.toString.call(a)){if(b)throw new h.default("Arg not supported with multiple decorators");f.extend(this.decorators,a)}else this.decorators[a]=b},unregisterDecorator:function(a){delete this.decorators[a]}};var n=l.default.log;b.log=n,b.createFrame=f.createFrame,b.logger=l.default},function(a,b){function c(a){return k[a]}function d(a){for(var b=1;b<arguments.length;b++)for(var c in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function e(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}function f(a){if("string"!=typeof a){if(a&&a.toHTML)return a.toHTML();if(null==a)return"";if(!a)return a+"";a=""+a}return m.test(a)?a.replace(l,c):a}function g(a){return!a&&0!==a||!(!p(a)||0!==a.length)}function h(a){var b=d({},a);return b._parent=a,b}function i(a,b){return a.path=b,a}function j(a,b){return(a?a+".":"")+b}b.__esModule=!0,b.extend=d,b.indexOf=e,b.escapeExpression=f,b.isEmpty=g,b.createFrame=h,b.blockParams=i,b.appendContextPath=j;var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},l=/[&<>"'`=]/g,m=/[&<>"'`=]/,n=Object.prototype.toString;b.toString=n;var o=function(a){return"function"==typeof a};o(/x/)&&(b.isFunction=o=function(a){return"function"==typeof a&&"[object Function]"===n.call(a)}),b.isFunction=o;var p=Array.isArray||function(a){return!(!a||"object"!=typeof a)&&"[object Array]"===n.call(a)};b.isArray=p},function(a,b){function c(a,b){var e=b&&b.loc,f=void 0,g=void 0;e&&(f=e.start.line,g=e.start.column,a+=" - "+f+":"+g);for(var h=Error.prototype.constructor.call(this,a),i=0;i<d.length;i++)this[d[i]]=h[d[i]];Error.captureStackTrace&&Error.captureStackTrace(this,c),e&&(this.lineNumber=f,this.column=g)}b.__esModule=!0;var d=["description","fileName","lineNumber","message","name","number","stack"];c.prototype=new Error,b.default=c,a.exports=b.default},function(a,b,c){function d(a){g.default(a),i.default(a),k.default(a),m.default(a),o.default(a),q.default(a),s.default(a)}var e=c(1).default;b.__esModule=!0,b.registerDefaultHelpers=d;var f=c(8),g=e(f),h=c(9),i=e(h),j=c(10),k=e(j),l=c(11),m=e(l),n=c(12),o=e(n),p=c(13),q=e(p),r=c(14),s=e(r)},function(a,b,c){b.__esModule=!0;var d=c(5);b.default=function(a){a.registerHelper("blockHelperMissing",function(b,c){var e=c.inverse,f=c.fn;if(!0===b)return f(this);if(!1===b||null==b)return e(this);if(d.isArray(b))return b.length>0?(c.ids&&(c.ids=[c.name]),a.helpers.each(b,c)):e(this);if(c.data&&c.ids){var g=d.createFrame(c.data);g.contextPath=d.appendContextPath(c.data.contextPath,c.name),c={data:g}}return f(b,c)})},a.exports=b.default},function(a,b,c){var d=c(1).default;b.__esModule=!0;var e=c(5),f=c(6),g=d(f);b.default=function(a){a.registerHelper("each",function(a,b){function c(b,c,f){j&&(j.key=b,j.index=c,j.first=0===c,j.last=!!f,k&&(j.contextPath=k+b)),i+=d(a[b],{data:j,blockParams:e.blockParams([a[b],b],[k+b,null])})}if(!b)throw new g.default("Must pass iterator to #each");var d=b.fn,f=b.inverse,h=0,i="",j=void 0,k=void 0;if(b.data&&b.ids&&(k=e.appendContextPath(b.data.contextPath,b.ids[0])+"."),e.isFunction(a)&&(a=a.call(this)),b.data&&(j=e.createFrame(b.data)),a&&"object"==typeof a)if(e.isArray(a))for(var l=a.length;h<l;h++)h in a&&c(h,h,h===a.length-1);else{var m=void 0;for(var n in a)a.hasOwnProperty(n)&&(void 0!==m&&c(m,h-1),m=n,h++);void 0!==m&&c(m,h-1,!0)}return 0===h&&(i=f(this)),i})},a.exports=b.default},function(a,b,c){var d=c(1).default;b.__esModule=!0;var e=c(6),f=d(e);b.default=function(a){a.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new f.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},a.exports=b.default},function(a,b,c){b.__esModule=!0;var d=c(5);b.default=function(a){a.registerHelper("if",function(a,b){return d.isFunction(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||d.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){return a.helpers.if.call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})})},a.exports=b.default},function(a,b){b.__esModule=!0,b.default=function(a){a.registerHelper("log",function(){for(var b=[void 0],c=arguments[arguments.length-1],d=0;d<arguments.length-1;d++)b.push(arguments[d]);var e=1;null!=c.hash.level?e=c.hash.level:c.data&&null!=c.data.level&&(e=c.data.level),b[0]=e,a.log.apply(a,b)})},a.exports=b.default},function(a,b){b.__esModule=!0,b.default=function(a){a.registerHelper("lookup",function(a,b){return a&&a[b]})},a.exports=b.default},function(a,b,c){b.__esModule=!0;var d=c(5);b.default=function(a){a.registerHelper("with",function(a,b){d.isFunction(a)&&(a=a.call(this));var c=b.fn;if(d.isEmpty(a))return b.inverse(this);var e=b.data;return b.data&&b.ids&&(e=d.createFrame(b.data),e.contextPath=d.appendContextPath(b.data.contextPath,b.ids[0])),c(a,{data:e,blockParams:d.blockParams([a],[e&&e.contextPath])})})},a.exports=b.default},function(a,b,c){function d(a){g.default(a)}var e=c(1).default;b.__esModule=!0,b.registerDefaultDecorators=d;var f=c(16),g=e(f)},function(a,b,c){b.__esModule=!0;var d=c(5);b.default=function(a){a.registerDecorator("inline",function(a,b,c,e){var f=a;return b.partials||(b.partials={},f=function(e,f){var g=c.partials;c.partials=d.extend({},g,b.partials);var h=a(e,f);return c.partials=g,h}),b.partials[e.args[0]]=e.fn,f})},a.exports=b.default},function(a,b,c){b.__esModule=!0;var d=c(5),e={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(a){if("string"==typeof a){var b=d.indexOf(e.methodMap,a.toLowerCase());a=b>=0?b:parseInt(a,10)}return a},log:function(a){if(a=e.lookupLevel(a),"undefined"!=typeof console&&e.lookupLevel(e.level)<=a){var b=e.methodMap[a];console[b]||(b="log");for(var c=arguments.length,d=Array(c>1?c-1:0),f=1;f<c;f++)d[f-1]=arguments[f];console[b].apply(console,d)}}};b.default=e,a.exports=b.default},function(a,b){function c(a){this.string=a}b.__esModule=!0,c.prototype.toString=c.prototype.toHTML=function(){return""+this.string},b.default=c,a.exports=b.default},function(a,b,c){function d(a){var b=a&&a[0]||1,c=r.COMPILER_REVISION;if(b!==c){if(b<c){var d=r.REVISION_CHANGES[c],e=r.REVISION_CHANGES[b];throw new q.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new q.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function e(a,b){function c(c,d,e){e.hash&&(d=o.extend({},d,e.hash),e.ids&&(e.ids[0]=!0)),c=b.VM.resolvePartial.call(this,c,d,e);var f=b.VM.invokePartial.call(this,c,d,e);if(null==f&&b.compile&&(e.partials[e.name]=b.compile(c,a.compilerOptions,b),f=e.partials[e.name](d,e)),null!=f){if(e.indent){for(var g=f.split("\n"),h=0,i=g.length;h<i&&(g[h]||h+1!==i);h++)g[h]=e.indent+g[h];f=g.join("\n")}return f}throw new q.default("The partial "+e.name+" could not be compiled when running in runtime-only mode")}function d(b){function c(b){return""+a.main(e,b,e.helpers,e.partials,g,i,h)}var f=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],g=f.data;d._setup(f),!f.partial&&a.useData&&(g=j(b,g));var h=void 0,i=a.useBlockParams?[]:void 0;return a.useDepths&&(h=f.depths?b!==f.depths[0]?[b].concat(f.depths):f.depths:[b]),(c=k(a.main,c,e,f.depths||[],g,i))(b,f)}if(!b)throw new q.default("No environment passed to template");if(!a||!a.main)throw new q.default("Unknown template object: "+typeof a);a.main.decorator=a.main_d,b.VM.checkRevision(a.compiler);var e={strict:function(a,b){if(!(b in a))throw new q.default('"'+b+'" not defined in '+a);return a[b]},lookup:function(a,b){for(var c=a.length,d=0;d<c;d++)if(a[d]&&null!=a[d][b])return a[d][b]},lambda:function(a,b){return"function"==typeof a?a.call(b):a},escapeExpression:o.escapeExpression,invokePartial:c,fn:function(b){var c=a[b];return c.decorator=a[b+"_d"],c},programs:[],program:function(a,b,c,d,e){var g=this.programs[a],h=this.fn(a);return b||e||d||c?g=f(this,a,h,b,c,d,e):g||(g=this.programs[a]=f(this,a,h)),g},data:function(a,b){for(;a&&b--;)a=a._parent;return a},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c=o.extend({},b,a)),c},noop:b.VM.noop,compilerInfo:a.compiler};return d.isTop=!0,d._setup=function(c){c.partial?(e.helpers=c.helpers,e.partials=c.partials,e.decorators=c.decorators):(e.helpers=e.merge(c.helpers,b.helpers),a.usePartial&&(e.partials=e.merge(c.partials,b.partials)),(a.usePartial||a.useDecorators)&&(e.decorators=e.merge(c.decorators,b.decorators)))},d._child=function(b,c,d,g){if(a.useBlockParams&&!d)throw new q.default("must pass block params");if(a.useDepths&&!g)throw new q.default("must pass parent depths");return f(e,b,a[b],c,0,d,g)},d}function f(a,b,c,d,e,f,g){function h(b){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],h=g;return g&&b!==g[0]&&(h=[b].concat(g)),c(a,b,a.helpers,a.partials,e.data||d,f&&[e.blockParams].concat(f),h)}return h=k(c,h,a,g,d,f),h.program=b,h.depth=g?g.length:0,h.blockParams=e||0,h}function g(a,b,c){return a?a.call||c.name||(c.name=a,a=c.partials[a]):a="@partial-block"===c.name?c.data["partial-block"]:c.partials[c.name],a}function h(a,b,c){c.partial=!0,c.ids&&(c.data.contextPath=c.ids[0]||c.data.contextPath);var d=void 0;if(c.fn&&c.fn!==i&&(c.data=r.createFrame(c.data),d=c.data["partial-block"]=c.fn,d.partials&&(c.partials=o.extend({},c.partials,d.partials))),void 0===a&&d&&(a=d),void 0===a)throw new q.default("The partial "+c.name+" could not be found");if(a instanceof Function)return a(b,c)}function i(){return""}function j(a,b){return b&&"root"in b||(b=b?r.createFrame(b):{},b.root=a),b}function k(a,b,c,d,e,f){if(a.decorator){var g={};b=a.decorator(b,g,c,d&&d[0],e,f,d),o.extend(b,g)}return b}var l=c(3).default,m=c(1).default;b.__esModule=!0,b.checkRevision=d,b.template=e,b.wrapProgram=f,b.resolvePartial=g,b.invokePartial=h,b.noop=i;var n=c(5),o=l(n),p=c(6),q=m(p),r=c(4)},function(b,c){(function(d){c.__esModule=!0,c.default=function(b){var c=void 0!==d?d:a,e=c.Handlebars;b.noConflict=function(){return c.Handlebars===b&&(c.Handlebars=e),b}},b.exports=c.default}).call(c,function(){return this}())},function(a,b){b.__esModule=!0;var c={helpers:{helperExpression:function(a){return"SubExpression"===a.type||("MustacheStatement"===a.type||"BlockStatement"===a.type)&&!!(a.params&&a.params.length||a.hash)},scopedId:function(a){return/^\.|this\b/.test(a.original)},simpleId:function(a){return 1===a.parts.length&&!c.helpers.scopedId(a)&&!a.depth}}};b.default=c,a.exports=b.default},function(a,b,c){function d(a,b){return"Program"===a.type?a:(h.default.yy=n,n.locInfo=function(a){return new n.SourceLocation(b&&b.srcName,a)},new j.default(b).accept(h.default.parse(a)))}var e=c(1).default,f=c(3).default;b.__esModule=!0,b.parse=d;var g=c(23),h=e(g),i=c(24),j=e(i),k=c(26),l=f(k),m=c(5);b.parser=h.default;var n={};m.extend(n,l)},function(a,b){var c=function(){function a(){this.yy={}}var b={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition_plus0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,1],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(a,b,c,d,e,f,g){var h=f.length-1;switch(e){case 1:return f[h-1];case 2:this.$=d.prepareProgram(f[h]);break;case 3:case 4:case 5:case 6:case 7:case 8:this.$=f[h];break;case 9:this.$={type:"CommentStatement",value:d.stripComment(f[h]),strip:d.stripFlags(f[h],f[h]),loc:d.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:f[h],value:f[h],loc:d.locInfo(this._$)};break;case 11:this.$=d.prepareRawBlock(f[h-2],f[h-1],f[h],this._$);break;case 12:this.$={path:f[h-3],params:f[h-2],hash:f[h-1]};break;case 13:this.$=d.prepareBlock(f[h-3],f[h-2],f[h-1],f[h],!1,this._$);break;case 14:this.$=d.prepareBlock(f[h-3],f[h-2],f[h-1],f[h],!0,this._$);break;case 15:this.$={open:f[h-5],path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 16:case 17:this.$={path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 18:this.$={strip:d.stripFlags(f[h-1],f[h-1]),program:f[h]};break;case 19:var i=d.prepareBlock(f[h-2],f[h-1],f[h],f[h],!1,this._$),j=d.prepareProgram([i],f[h-1].loc);j.chained=!0,this.$={strip:f[h-2].strip,program:j,chain:!0};break;case 20:this.$=f[h];break;case 21:this.$={path:f[h-1],strip:d.stripFlags(f[h-2],f[h])};break;case 22:case 23:this.$=d.prepareMustache(f[h-3],f[h-2],f[h-1],f[h-4],d.stripFlags(f[h-4],f[h]),this._$);break;case 24:this.$={type:"PartialStatement",name:f[h-3],params:f[h-2],hash:f[h-1],indent:"",strip:d.stripFlags(f[h-4],f[h]),loc:d.locInfo(this._$)};break;case 25:this.$=d.preparePartialBlock(f[h-2],f[h-1],f[h],this._$);break;case 26:this.$={path:f[h-3],params:f[h-2],hash:f[h-1],strip:d.stripFlags(f[h-4],f[h])};break;case 27:case 28:this.$=f[h];break;case 29:this.$={type:"SubExpression",path:f[h-3],params:f[h-2],hash:f[h-1],loc:d.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:f[h],loc:d.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:d.id(f[h-2]),value:f[h],loc:d.locInfo(this._$)};break;case 32:this.$=d.id(f[h-1]);break;case 33:case 34:this.$=f[h];break;case 35:this.$={type:"StringLiteral",value:f[h],original:f[h],loc:d.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(f[h]),original:Number(f[h]),loc:d.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===f[h],original:"true"===f[h],loc:d.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:d.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:d.locInfo(this._$)};break;case 40:case 41:this.$=f[h];break;case 42:this.$=d.preparePath(!0,f[h],this._$);break;case 43:this.$=d.preparePath(!1,f[h],this._$);break;case 44:f[h-2].push({part:d.id(f[h]),original:f[h],separator:f[h-1]}),this.$=f[h-2];break;case 45:this.$=[{part:d.id(f[h]),original:f[h]}];break;case 46:this.$=[];break;case 47:f[h-1].push(f[h]);break;case 48:this.$=[f[h]];break;case 49:f[h-1].push(f[h]);break;case 50:this.$=[];break;case 51:f[h-1].push(f[h]);break;case 58:this.$=[];break;case 59:f[h-1].push(f[h]);break;case 64:this.$=[];break;case 65:f[h-1].push(f[h]);break;case 70:this.$=[];break;case 71:f[h-1].push(f[h]);break;case 78:this.$=[];break;case 79:f[h-1].push(f[h]);break;case 82:this.$=[];break;case 83:f[h-1].push(f[h]);break;case 86:this.$=[];break;case 87:f[h-1].push(f[h]);break;case 90:this.$=[];break;case 91:f[h-1].push(f[h]);break;case 94:this.$=[];break;case 95:f[h-1].push(f[h]);break;case 98:this.$=[f[h]];break;case 99:f[h-1].push(f[h]);break;case 100:this.$=[f[h]];break;case 101:f[h-1].push(f[h])}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{13:40,15:[1,20],17:39},{20:42,56:41,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:45,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:48,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:42,56:49,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:50,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,51]},{72:[1,35],86:52},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:53,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:54,38:56,39:[1,58],43:57,44:[1,59],45:55,47:[2,54]},{28:60,43:61,44:[1,59],47:[2,56]},{13:63,15:[1,20],18:[1,62]},{15:[2,48],18:[2,48]},{33:[2,86],57:64,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:65,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:66,47:[1,67]},{30:68,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:69,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:70,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:71,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:75,33:[2,80],50:72,63:73,64:76,65:[1,44],69:74,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,80]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,51]},{20:75,53:81,54:[2,84],63:82,64:76,65:[1,44],69:83,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:84,47:[1,67]},{47:[2,55]},{4:85,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:86,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:87,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:88,47:[1,67]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:75,33:[2,88],58:89,63:90,64:76,65:[1,44],69:91,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:92,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:93,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,31:94,33:[2,60],63:95,64:76,65:[1,44],69:96,70:77,71:78,72:[1,79],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,66],36:97,63:98,64:76,65:[1,44],69:99,70:77,71:78,72:[1,79],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,22:100,23:[2,52],63:101,64:76,65:[1,44],69:102,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,92],62:103,63:104,64:76,65:[1,44],69:105,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,106]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:107,72:[1,108],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,109],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,110]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:56,39:[1,58],43:57,44:[1,59],45:112,46:111,47:[2,76]},{33:[2,70],40:113,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,114]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:75,63:116,64:76,65:[1,44],67:115,68:[2,96],69:117,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,118]},{32:119,33:[2,62],74:120,75:[1,121]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:122,74:123,75:[1,121]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,124]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,125]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,109]},{20:75,63:126,64:76,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:75,33:[2,72],41:127,63:128,64:76,65:[1,44],69:129,70:77,71:78,72:[1,79],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,130]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,131]},{33:[2,63]},{72:[1,133],76:132},{33:[1,134]},{33:[2,69]},{15:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:135,74:136,75:[1,121]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,138],77:[1,137]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,139]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],55:[2,55],57:[2,20],61:[2,57],74:[2,81],83:[2,85],87:[2,18],91:[2,89],102:[2,53],105:[2,93],111:[2,19],112:[2,77],117:[2,97],120:[2,63],123:[2,69],124:[2,12],136:[2,75],137:[2,32]},parseError:function(a,b){throw new Error(a)},parse:function(a){var b=this,c=[0],d=[null],e=[],f=this.table,g="",h=0,i=0,j=0;this.lexer.setInput(a),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var k=this.lexer.yylloc;e.push(k);var l=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var m,n,o,p,q,r,s,t,u,v={};;){if(o=c[c.length-1],this.defaultActions[o]?p=this.defaultActions[o]:(null!==m&&void 0!==m||(m=function(){var a;return a=b.lexer.lex()||1,"number"!=typeof a&&(a=b.symbols_[a]||a),a}()),p=f[o]&&f[o][m]),void 0===p||!p.length||!p[0]){var w="";if(!j){u=[];for(r in f[o])this.terminals_[r]&&r>2&&u.push("'"+this.terminals_[r]+"'");w=this.lexer.showPosition?"Parse error on line "+(h+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+u.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(h+1)+": Unexpected "+(1==m?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(w,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:k,expected:u})}}if(p[0]instanceof Array&&p.length>1)throw new Error("Parse Error: multiple actions possible at state: "+o+", token: "+m);switch(p[0]){case 1:c.push(m),d.push(this.lexer.yytext),e.push(this.lexer.yylloc),c.push(p[1]),m=null,n?(m=n,n=null):(i=this.lexer.yyleng,g=this.lexer.yytext,h=this.lexer.yylineno,k=this.lexer.yylloc,j>0&&j--);break;case 2:if(s=this.productions_[p[1]][1],v.$=d[d.length-s],v._$={first_line:e[e.length-(s||1)].first_line,last_line:e[e.length-1].last_line,first_column:e[e.length-(s||1)].first_column,last_column:e[e.length-1].last_column},l&&(v._$.range=[e[e.length-(s||1)].range[0],e[e.length-1].range[1]]),void 0!==(q=this.performAction.call(v,g,i,h,this.yy,p[1],d,e)))return q;s&&(c=c.slice(0,-1*s*2),d=d.slice(0,-1*s),e=e.slice(0,-1*s)),c.push(this.productions_[p[1]][0]),d.push(v.$),e.push(v._$),t=f[c[c.length-2]][c[c.length-1]],c.push(t);break;case 3:return!0}}return!0}},c=function(){var a={EOF:1,parseError:function(a,b){if(!this.yy.parser)throw new Error(a);this.yy.parser.parseError(a,b)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var a=this._input[0];return this.yytext+=a,this.yyleng++,this.offset++,this.match+=a,this.matched+=a,a.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input,
this.yytext=this.yytext.substr(0,this.yytext.length-b-1),this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var e=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b},this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-b]),this},more:function(){return this._more=!0,this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=new Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d,e;this._more||(this.yytext="",this.match="");for(var f=this._currentRules(),g=0;g<f.length&&(!(c=this._input.match(this.rules[f[g]]))||b&&!(c[0].length>b[0].length)||(b=c,d=g,this.options.flex));g++);return b?(e=b[0].match(/(?:\r\n?|\n).*/g),e&&(this.yylineno+=e.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:e?e[e.length-1].length-e[e.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,f[d],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),a||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return void 0!==a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)}};return a.options={},a.performAction=function(a,b,c,d){function e(a,c){return b.yytext=b.yytext.substr(a,b.yyleng-c)}switch(c){case 0:if("\\\\"===b.yytext.slice(-2)?(e(0,1),this.begin("mu")):"\\"===b.yytext.slice(-1)?(e(0,1),this.begin("emu")):this.begin("mu"),b.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(b.yytext=b.yytext.substr(5,b.yyleng-9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(b.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return b.yytext=e(1,2).replace(/\\"/g,'"'),80;case 32:return b.yytext=e(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return b.yytext=b.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},a.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^\/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],a.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},a}();return b.lexer=c,a.prototype=b,b.Parser=a,new a}();b.__esModule=!0,b.default=c},function(a,b,c){function d(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=a}function e(a,b,c){void 0===b&&(b=a.length);var d=a[b-1],e=a[b-2];return d?"ContentStatement"===d.type?(e||!c?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(d.original):void 0:c}function f(a,b,c){void 0===b&&(b=-1);var d=a[b+1],e=a[b+2];return d?"ContentStatement"===d.type?(e||!c?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(d.original):void 0:c}function g(a,b,c){var d=a[null==b?0:b+1];if(d&&"ContentStatement"===d.type&&(c||!d.rightStripped)){var e=d.value;d.value=d.value.replace(c?/^\s+/:/^[ \t]*\r?\n?/,""),d.rightStripped=d.value!==e}}function h(a,b,c){var d=a[null==b?a.length-1:b-1];if(d&&"ContentStatement"===d.type&&(c||!d.leftStripped)){var e=d.value;return d.value=d.value.replace(c?/\s+$/:/[ \t]+$/,""),d.leftStripped=d.value!==e,d.leftStripped}}var i=c(1).default;b.__esModule=!0;var j=c(25),k=i(j);d.prototype=new k.default,d.prototype.Program=function(a){var b=!this.options.ignoreStandalone,c=!this.isRootSeen;this.isRootSeen=!0;for(var d=a.body,i=0,j=d.length;i<j;i++){var k=d[i],l=this.accept(k);if(l){var m=e(d,i,c),n=f(d,i,c),o=l.openStandalone&&m,p=l.closeStandalone&&n,q=l.inlineStandalone&&m&&n;l.close&&g(d,i,!0),l.open&&h(d,i,!0),b&&q&&(g(d,i),h(d,i)&&"PartialStatement"===k.type&&(k.indent=/([ \t]+$)/.exec(d[i-1].original)[1])),b&&o&&(g((k.program||k.inverse).body),h(d,i)),b&&p&&(g(d,i),h((k.inverse||k.program).body))}}return a},d.prototype.BlockStatement=d.prototype.DecoratorBlock=d.prototype.PartialBlockStatement=function(a){this.accept(a.program),this.accept(a.inverse);var b=a.program||a.inverse,c=a.program&&a.inverse,d=c,i=c;if(c&&c.chained)for(d=c.body[0].program;i.chained;)i=i.body[i.body.length-1].program;var j={open:a.openStrip.open,close:a.closeStrip.close,openStandalone:f(b.body),closeStandalone:e((d||b).body)};if(a.openStrip.close&&g(b.body,null,!0),c){var k=a.inverseStrip;k.open&&h(b.body,null,!0),k.close&&g(d.body,null,!0),a.closeStrip.open&&h(i.body,null,!0),!this.options.ignoreStandalone&&e(b.body)&&f(d.body)&&(h(b.body),g(d.body))}else a.closeStrip.open&&h(b.body,null,!0);return j},d.prototype.Decorator=d.prototype.MustacheStatement=function(a){return a.strip},d.prototype.PartialStatement=d.prototype.CommentStatement=function(a){var b=a.strip||{};return{inlineStandalone:!0,open:b.open,close:b.close}},b.default=d,a.exports=b.default},function(a,b,c){function d(){this.parents=[]}function e(a){this.acceptRequired(a,"path"),this.acceptArray(a.params),this.acceptKey(a,"hash")}function f(a){e.call(this,a),this.acceptKey(a,"program"),this.acceptKey(a,"inverse")}function g(a){this.acceptRequired(a,"name"),this.acceptArray(a.params),this.acceptKey(a,"hash")}var h=c(1).default;b.__esModule=!0;var i=c(6),j=h(i);d.prototype={constructor:d,mutating:!1,acceptKey:function(a,b){var c=this.accept(a[b]);if(this.mutating){if(c&&!d.prototype[c.type])throw new j.default('Unexpected node type "'+c.type+'" found when accepting '+b+" on "+a.type);a[b]=c}},acceptRequired:function(a,b){if(this.acceptKey(a,b),!a[b])throw new j.default(a.type+" requires "+b)},acceptArray:function(a){for(var b=0,c=a.length;b<c;b++)this.acceptKey(a,b),a[b]||(a.splice(b,1),b--,c--)},accept:function(a){if(a){if(!this[a.type])throw new j.default("Unknown type: "+a.type,a);this.current&&this.parents.unshift(this.current),this.current=a;var b=this[a.type](a);return this.current=this.parents.shift(),!this.mutating||b?b:!1!==b?a:void 0}},Program:function(a){this.acceptArray(a.body)},MustacheStatement:e,Decorator:e,BlockStatement:f,DecoratorBlock:f,PartialStatement:g,PartialBlockStatement:function(a){g.call(this,a),this.acceptKey(a,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:e,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(a){this.acceptArray(a.pairs)},HashPair:function(a){this.acceptRequired(a,"value")}},b.default=d,a.exports=b.default},function(a,b,c){function d(a,b){if(b=b.path?b.path.original:b,a.path.original!==b){var c={loc:a.path.loc};throw new q.default(a.path.original+" doesn't match "+b,c)}}function e(a,b){this.source=a,this.start={line:b.first_line,column:b.first_column},this.end={line:b.last_line,column:b.last_column}}function f(a){return/^\[.*\]$/.test(a)?a.substr(1,a.length-2):a}function g(a,b){return{open:"~"===a.charAt(2),close:"~"===b.charAt(b.length-3)}}function h(a){return a.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function i(a,b,c){c=this.locInfo(c);for(var d=a?"@":"",e=[],f=0,g="",h=0,i=b.length;h<i;h++){var j=b[h].part,k=b[h].original!==j;if(d+=(b[h].separator||"")+j,k||".."!==j&&"."!==j&&"this"!==j)e.push(j);else{if(e.length>0)throw new q.default("Invalid path: "+d,{loc:c});".."===j&&(f++,g+="../")}}return{type:"PathExpression",data:a,depth:f,parts:e,original:d,loc:c}}function j(a,b,c,d,e,f){var g=d.charAt(3)||d.charAt(2),h="{"!==g&&"&"!==g;return{type:/\*/.test(d)?"Decorator":"MustacheStatement",path:a,params:b,hash:c,escaped:h,strip:e,loc:this.locInfo(f)}}function k(a,b,c,e){d(a,c),e=this.locInfo(e);var f={type:"Program",body:b,strip:{},loc:e};return{type:"BlockStatement",path:a.path,params:a.params,hash:a.hash,program:f,openStrip:{},inverseStrip:{},closeStrip:{},loc:e}}function l(a,b,c,e,f,g){e&&e.path&&d(a,e);var h=/\*/.test(a.open);b.blockParams=a.blockParams;var i=void 0,j=void 0;if(c){if(h)throw new q.default("Unexpected inverse block on decorator",c);c.chain&&(c.program.body[0].closeStrip=e.strip),j=c.strip,i=c.program}return f&&(f=i,i=b,b=f),{type:h?"DecoratorBlock":"BlockStatement",path:a.path,params:a.params,hash:a.hash,program:b,inverse:i,openStrip:a.strip,inverseStrip:j,closeStrip:e&&e.strip,loc:this.locInfo(g)}}function m(a,b){if(!b&&a.length){var c=a[0].loc,d=a[a.length-1].loc;c&&d&&(b={source:c.source,start:{line:c.start.line,column:c.start.column},end:{line:d.end.line,column:d.end.column}})}return{type:"Program",body:a,strip:{},loc:b}}function n(a,b,c,e){return d(a,c),{type:"PartialBlockStatement",name:a.path,params:a.params,hash:a.hash,program:b,openStrip:a.strip,closeStrip:c&&c.strip,loc:this.locInfo(e)}}var o=c(1).default;b.__esModule=!0,b.SourceLocation=e,b.id=f,b.stripFlags=g,b.stripComment=h,b.preparePath=i,b.prepareMustache=j,b.prepareRawBlock=k,b.prepareBlock=l,b.prepareProgram=m,b.preparePartialBlock=n;var p=c(6),q=o(p)},function(a,b,c){function d(){}function e(a,b,c){if(null==a||"string"!=typeof a&&"Program"!==a.type)throw new k.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+a);b=b||{},"data"in b||(b.data=!0),b.compat&&(b.useDepths=!0);var d=c.parse(a,b),e=(new c.Compiler).compile(d,b);return(new c.JavaScriptCompiler).compile(e,b)}function f(a,b,c){function d(){var d=c.parse(a,b),e=(new c.Compiler).compile(d,b),f=(new c.JavaScriptCompiler).compile(e,b,void 0,!0);return c.template(f)}function e(a,b){return f||(f=d()),f.call(this,a,b)}if(void 0===b&&(b={}),null==a||"string"!=typeof a&&"Program"!==a.type)throw new k.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+a);"data"in b||(b.data=!0),b.compat&&(b.useDepths=!0);var f=void 0;return e._setup=function(a){return f||(f=d()),f._setup(a)},e._child=function(a,b,c,e){return f||(f=d()),f._child(a,b,c,e)},e}function g(a,b){if(a===b)return!0;if(l.isArray(a)&&l.isArray(b)&&a.length===b.length){for(var c=0;c<a.length;c++)if(!g(a[c],b[c]))return!1;return!0}}function h(a){if(!a.path.parts){var b=a.path;a.path={type:"PathExpression",data:!1,depth:0,parts:[b.original+""],original:b.original+"",loc:b.loc}}}var i=c(1).default;b.__esModule=!0,b.Compiler=d,b.precompile=e,b.compile=f;var j=c(6),k=i(j),l=c(5),m=c(21),n=i(m),o=[].slice;d.prototype={compiler:d,equals:function(a){var b=this.opcodes.length;if(a.opcodes.length!==b)return!1;for(var c=0;c<b;c++){var d=this.opcodes[c],e=a.opcodes[c];if(d.opcode!==e.opcode||!g(d.args,e.args))return!1}b=this.children.length;for(var c=0;c<b;c++)if(!this.children[c].equals(a.children[c]))return!1;return!0},guid:0,compile:function(a,b){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=b,this.stringParams=b.stringParams,this.trackIds=b.trackIds,b.blockParams=b.blockParams||[];var c=b.knownHelpers;if(b.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},c)for(var d in c)d in c&&(b.knownHelpers[d]=c[d]);return this.accept(a)},compileProgram:function(a){var b=new this.compiler,c=b.compile(a,this.options),d=this.guid++;return this.usePartial=this.usePartial||c.usePartial,this.children[d]=c,this.useDepths=this.useDepths||c.useDepths,d},accept:function(a){if(!this[a.type])throw new k.default("Unknown type: "+a.type,a);this.sourceNode.unshift(a);var b=this[a.type](a);return this.sourceNode.shift(),b},Program:function(a){this.options.blockParams.unshift(a.blockParams);for(var b=a.body,c=b.length,d=0;d<c;d++)this.accept(b[d]);return this.options.blockParams.shift(),this.isSimple=1===c,this.blockParams=a.blockParams?a.blockParams.length:0,this},BlockStatement:function(a){h(a);var b=a.program,c=a.inverse;b=b&&this.compileProgram(b),c=c&&this.compileProgram(c);var d=this.classifySexpr(a);"helper"===d?this.helperSexpr(a,b,c):"simple"===d?(this.simpleSexpr(a),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("emptyHash"),this.opcode("blockValue",a.path.original)):(this.ambiguousSexpr(a,b,c),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(a){var b=a.program&&this.compileProgram(a.program),c=this.setupFullMustacheParams(a,b,void 0),d=a.path;this.useDecorators=!0,this.opcode("registerDecorator",c.length,d.original)},PartialStatement:function(a){this.usePartial=!0;var b=a.program;b&&(b=this.compileProgram(a.program));var c=a.params;if(c.length>1)throw new k.default("Unsupported number of partial arguments: "+c.length,a);c.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):c.push({type:"PathExpression",parts:[],depth:0}));var d=a.name.original,e="SubExpression"===a.name.type;e&&this.accept(a.name),this.setupFullMustacheParams(a,b,void 0,!0);var f=a.indent||"";this.options.preventIndent&&f&&(this.opcode("appendContent",f),f=""),this.opcode("invokePartial",e,d,f),this.opcode("append")},PartialBlockStatement:function(a){this.PartialStatement(a)},MustacheStatement:function(a){this.SubExpression(a),a.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(a){this.DecoratorBlock(a)},ContentStatement:function(a){a.value&&this.opcode("appendContent",a.value)},CommentStatement:function(){},SubExpression:function(a){h(a);var b=this.classifySexpr(a);"simple"===b?this.simpleSexpr(a):"helper"===b?this.helperSexpr(a):this.ambiguousSexpr(a)},ambiguousSexpr:function(a,b,c){var d=a.path,e=d.parts[0],f=null!=b||null!=c;this.opcode("getContext",d.depth),this.opcode("pushProgram",b),this.opcode("pushProgram",c),d.strict=!0,this.accept(d),this.opcode("invokeAmbiguous",e,f)},simpleSexpr:function(a){var b=a.path;b.strict=!0,this.accept(b),this.opcode("resolvePossibleLambda")},helperSexpr:function(a,b,c){var d=this.setupFullMustacheParams(a,b,c),e=a.path,f=e.parts[0];if(this.options.knownHelpers[f])this.opcode("invokeKnownHelper",d.length,f);else{if(this.options.knownHelpersOnly)throw new k.default("You specified knownHelpersOnly, but used the unknown helper "+f,a);e.strict=!0,e.falsy=!0,this.accept(e),this.opcode("invokeHelper",d.length,e.original,n.default.helpers.simpleId(e))}},PathExpression:function(a){this.addDepth(a.depth),this.opcode("getContext",a.depth);var b=a.parts[0],c=n.default.helpers.scopedId(a),d=!a.depth&&!c&&this.blockParamIndex(b);d?this.opcode("lookupBlockParam",d,a.parts):b?a.data?(this.options.data=!0,this.opcode("lookupData",a.depth,a.parts,a.strict)):this.opcode("lookupOnContext",a.parts,a.falsy,a.strict,c):this.opcode("pushContext")},StringLiteral:function(a){this.opcode("pushString",a.value)},NumberLiteral:function(a){this.opcode("pushLiteral",a.value)},BooleanLiteral:function(a){this.opcode("pushLiteral",a.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(a){var b=a.pairs,c=0,d=b.length;for(this.opcode("pushHash");c<d;c++)this.pushParam(b[c].value);for(;c--;)this.opcode("assignToHash",b[c].key);this.opcode("popHash")},opcode:function(a){this.opcodes.push({opcode:a,args:o.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(a){a&&(this.useDepths=!0)},classifySexpr:function(a){var b=n.default.helpers.simpleId(a.path),c=b&&!!this.blockParamIndex(a.path.parts[0]),d=!c&&n.default.helpers.helperExpression(a),e=!c&&(d||b);if(e&&!d){var f=a.path.parts[0],g=this.options;g.knownHelpers[f]?d=!0:g.knownHelpersOnly&&(e=!1)}return d?"helper":e?"ambiguous":"simple"},pushParams:function(a){for(var b=0,c=a.length;b<c;b++)this.pushParam(a[b])},pushParam:function(a){var b=null!=a.value?a.value:a.original||"";if(this.stringParams)b.replace&&(b=b.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),a.depth&&this.addDepth(a.depth),this.opcode("getContext",a.depth||0),this.opcode("pushStringParam",b,a.type),"SubExpression"===a.type&&this.accept(a);else{if(this.trackIds){var c=void 0;if(!a.parts||n.default.helpers.scopedId(a)||a.depth||(c=this.blockParamIndex(a.parts[0])),c){var d=a.parts.slice(1).join(".");this.opcode("pushId","BlockParam",c,d)}else b=a.original||b,b.replace&&(b=b.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",a.type,b)}this.accept(a)}},setupFullMustacheParams:function(a,b,c,d){var e=a.params;return this.pushParams(e),this.opcode("pushProgram",b),this.opcode("pushProgram",c),a.hash?this.accept(a.hash):this.opcode("emptyHash",d),e},blockParamIndex:function(a){for(var b=0,c=this.options.blockParams.length;b<c;b++){var d=this.options.blockParams[b],e=d&&l.indexOf(d,a);if(d&&e>=0)return[b,e]}}}},function(a,b,c){function d(a){this.value=a}function e(){}function f(a,b,c,d){var e=b.popStack(),f=0,g=c.length;for(a&&g--;f<g;f++)e=b.nameLookup(e,c[f],d);return a?[b.aliasable("container.strict"),"(",e,", ",b.quotedString(c[f]),")"]:e}var g=c(1).default;b.__esModule=!0;var h=c(4),i=c(6),j=g(i),k=c(5),l=c(29),m=g(l);e.prototype={nameLookup:function(a,b){return e.isValidJavaScriptVariableName(b)?[a,".",b]:[a,"[",JSON.stringify(b),"]"]},depthedLookup:function(a){return[this.aliasable("container.lookup"),'(depths, "',a,'")']},compilerInfo:function(){var a=h.COMPILER_REVISION;return[a,h.REVISION_CHANGES[a]]},appendToBuffer:function(a,b,c){return k.isArray(a)||(a=[a]),a=this.source.wrap(a,b),this.environment.isSimple?["return ",a,";"]:c?["buffer += ",a,";"]:(a.appendToBuffer=!0,a)},initializeBuffer:function(){return this.quotedString("")},compile:function(a,b,c,d){this.environment=a,this.options=b,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!d,this.name=this.environment.name,this.isChild=!!c,this.context=c||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(a,b),this.useDepths=this.useDepths||a.useDepths||a.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||a.useBlockParams;var e=a.opcodes,f=void 0,g=void 0,h=void 0,i=void 0;for(h=0,i=e.length;h<i;h++)f=e[h],this.source.currentLocation=f.loc,g=g||f.loc,this[f.opcode].apply(this,f.args);if(this.source.currentLocation=g,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new j.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend("var decorators = container.decorators;\n"),this.decorators.push("return fn;"),d?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators=this.decorators.merge()));var k=this.createFunctionContext(d);if(this.isChild)return k;var l={compiler:this.compilerInfo(),main:k};this.decorators&&(l.main_d=this.decorators,l.useDecorators=!0);var m=this.context,n=m.programs,o=m.decorators;for(h=0,i=n.length;h<i;h++)n[h]&&(l[h]=n[h],o[h]&&(l[h+"_d"]=o[h],l.useDecorators=!0));return this.environment.usePartial&&(l.usePartial=!0),this.options.data&&(l.useData=!0),this.useDepths&&(l.useDepths=!0),this.useBlockParams&&(l.useBlockParams=!0),this.options.compat&&(l.compat=!0),d?l.compilerOptions=this.options:(l.compiler=JSON.stringify(l.compiler),this.source.currentLocation={start:{line:1,column:0}},l=this.objectLiteral(l),b.srcName?(l=l.toStringWithSourceMap({file:b.destName}),l.map=l.map&&l.map.toString()):l=l.toString()),l},preamble:function(){this.lastContext=0,this.source=new m.default(this.options.srcName),this.decorators=new m.default(this.options.srcName)},createFunctionContext:function(a){var b="",c=this.stackVars.concat(this.registers.list);c.length>0&&(b+=", "+c.join(", "));var d=0;for(var e in this.aliases){var f=this.aliases[e];this.aliases.hasOwnProperty(e)&&f.children&&f.referenceCount>1&&(b+=", alias"+ ++d+"="+e,f.children[0]="alias"+d)}var g=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&g.push("blockParams"),this.useDepths&&g.push("depths");var h=this.mergeSource(b);return a?(g.push(h),Function.apply(this,g)):this.source.wrap(["function(",g.join(","),") {\n  ",h,"}"])},mergeSource:function(a){var b=this.environment.isSimple,c=!this.forceBuffer,d=void 0,e=void 0,f=void 0,g=void 0;return this.source.each(function(a){a.appendToBuffer?(f?a.prepend("  + "):f=a,g=a):(f&&(e?f.prepend("buffer += "):d=!0,g.add(";"),f=g=void 0),e=!0,b||(c=!1))}),c?f?(f.prepend("return "),g.add(";")):e||this.source.push('return "";'):(a+=", buffer = "+(d?"":this.initializeBuffer()),f?(f.prepend("return buffer + "),g.add(";")):this.source.push("return buffer;")),a&&this.source.prepend("var "+a.substring(2)+(d?"":";\n")),this.source.merge()},blockValue:function(a){var b=this.aliasable("helpers.blockHelperMissing"),c=[this.contextName(0)];this.setupHelperArgs(a,0,c);var d=this.popStack();c.splice(1,0,d),this.push(this.source.functionCall(b,"call",c))},ambiguousBlockValue:function(){var a=this.aliasable("helpers.blockHelperMissing"),b=[this.contextName(0)];this.setupHelperArgs("",0,b,!0),this.flushInline();var c=this.topStack();b.splice(1,0,c),this.pushSource(["if (!",this.lastHelper,") { ",c," = ",this.source.functionCall(a,"call",b),"}"])},appendContent:function(a){this.pendingContent?a=this.pendingContent+a:this.pendingLocation=this.source.currentLocation,this.pendingContent=a},append:function(){if(this.isInline())this.replaceStack(function(a){return[" != null ? ",a,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var a=this.popStack();this.pushSource(["if (",a," != null) { ",this.appendToBuffer(a,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(a){this.lastContext=a},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(a,b,c,d){var e=0;d||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(a[e++])),this.resolvePath("context",a,e,b,c)},lookupBlockParam:function(a,b){this.useBlockParams=!0,this.push(["blockParams[",a[0],"][",a[1],"]"]),this.resolvePath("context",b,1)},lookupData:function(a,b,c){a?this.pushStackLiteral("container.data(data, "+a+")"):this.pushStackLiteral("data"),this.resolvePath("data",b,0,!0,c)},resolvePath:function(a,b,c,d,e){var g=this;if(this.options.strict||this.options.assumeObjects)return void this.push(f(this.options.strict&&e,this,b,a));for(var h=b.length;c<h;c++)this.replaceStack(function(e){var f=g.nameLookup(e,b[c],a);return d?[" && ",f]:[" != null ? ",f," : ",e]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(a,b){this.pushContext(),this.pushString(b),"SubExpression"!==b&&("string"==typeof a?this.pushString(a):this.pushStackLiteral(a))},emptyHash:function(a){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(a?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var a=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(a.ids)),this.stringParams&&(this.push(this.objectLiteral(a.contexts)),this.push(this.objectLiteral(a.types))),this.push(this.objectLiteral(a.values))},pushString:function(a){this.pushStackLiteral(this.quotedString(a))},pushLiteral:function(a){this.pushStackLiteral(a)},pushProgram:function(a){null!=a?this.pushStackLiteral(this.programExpression(a)):this.pushStackLiteral(null)},registerDecorator:function(a,b){var c=this.nameLookup("decorators",b,"decorator"),d=this.setupHelperArgs(b,a);this.decorators.push(["fn = ",this.decorators.functionCall(c,"",["fn","props","container",d])," || fn;"])},invokeHelper:function(a,b,c){var d=this.popStack(),e=this.setupHelper(a,b),f=c?[e.name," || "]:"",g=["("].concat(f,d);this.options.strict||g.push(" || ",this.aliasable("helpers.helperMissing")),g.push(")"),this.push(this.source.functionCall(g,"call",e.callParams))},invokeKnownHelper:function(a,b){var c=this.setupHelper(a,b);this.push(this.source.functionCall(c.name,"call",c.callParams))},invokeAmbiguous:function(a,b){this.useRegister("helper");var c=this.popStack();this.emptyHash();var d=this.setupHelper(0,a,b),e=this.lastHelper=this.nameLookup("helpers",a,"helper"),f=["(","(helper = ",e," || ",c,")"];this.options.strict||(f[0]="(helper = ",f.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",f,d.paramsInit?["),(",d.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",d.callParams)," : helper))"])},invokePartial:function(a,b,c){var d=[],e=this.setupParams(b,1,d);a&&(b=this.popStack(),delete e.name),c&&(e.indent=JSON.stringify(c)),e.helpers="helpers",e.partials="partials",e.decorators="container.decorators",a?d.unshift(b):d.unshift(this.nameLookup("partials",b,"partial")),this.options.compat&&(e.depths="depths"),e=this.objectLiteral(e),d.push(e),this.push(this.source.functionCall("container.invokePartial","",d))},assignToHash:function(a){var b=this.popStack(),c=void 0,d=void 0,e=void 0;this.trackIds&&(e=this.popStack()),this.stringParams&&(d=this.popStack(),c=this.popStack());var f=this.hash;c&&(f.contexts[a]=c),d&&(f.types[a]=d),e&&(f.ids[a]=e),f.values[a]=b},pushId:function(a,b,c){"BlockParam"===a?this.pushStackLiteral("blockParams["+b[0]+"].path["+b[1]+"]"+(c?" + "+JSON.stringify("."+c):"")):"PathExpression"===a?this.pushString(b):"SubExpression"===a?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:e,compileChildren:function(a,b){for(var c=a.children,d=void 0,e=void 0,f=0,g=c.length;f<g;f++){d=c[f],e=new this.compiler;var h=this.matchExistingProgram(d);null==h?(this.context.programs.push(""),h=this.context.programs.length,d.index=h,d.name="program"+h,this.context.programs[h]=e.compile(d,b,this.context,!this.precompile),this.context.decorators[h]=e.decorators,this.context.environments[h]=d,this.useDepths=this.useDepths||e.useDepths,this.useBlockParams=this.useBlockParams||e.useBlockParams):(d.index=h,d.name="program"+h,this.useDepths=this.useDepths||d.useDepths,this.useBlockParams=this.useBlockParams||d.useBlockParams)}},matchExistingProgram:function(a){for(var b=0,c=this.context.environments.length;b<c;b++){var d=this.context.environments[b];if(d&&d.equals(a))return b}},programExpression:function(a){var b=this.environment.children[a],c=[b.index,"data",b.blockParams];return(this.useBlockParams||this.useDepths)&&c.push("blockParams"),this.useDepths&&c.push("depths"),"container.program("+c.join(", ")+")"},useRegister:function(a){this.registers[a]||(this.registers[a]=!0,this.registers.list.push(a))},push:function(a){return a instanceof d||(a=this.source.wrap(a)),this.inlineStack.push(a),a},pushStackLiteral:function(a){this.push(new d(a))},pushSource:function(a){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),a&&this.source.push(a)},replaceStack:function(a){var b=["("],c=void 0,e=void 0,f=void 0;if(!this.isInline())throw new j.default("replaceStack on non-inline");var g=this.popStack(!0);if(g instanceof d)c=[g.value],b=["(",c],f=!0;else{e=!0;var h=this.incrStack();b=["((",this.push(h)," = ",g,")"],c=this.topStack()}var i=a.call(this,c);f||this.popStack(),e&&this.stackSlot--,this.push(b.concat(i,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var a=this.inlineStack;this.inlineStack=[];for(var b=0,c=a.length;b<c;b++){var e=a[b];if(e instanceof d)this.compileStack.push(e);else{var f=this.incrStack();this.pushSource([f," = ",e,";"]),this.compileStack.push(f)}}},isInline:function(){return this.inlineStack.length},popStack:function(a){var b=this.isInline(),c=(b?this.inlineStack:this.compileStack).pop();if(!a&&c instanceof d)return c.value;if(!b){if(!this.stackSlot)throw new j.default("Invalid stack pop");this.stackSlot--}return c},topStack:function(){var a=this.isInline()?this.inlineStack:this.compileStack,b=a[a.length-1];return b instanceof d?b.value:b},contextName:function(a){return this.useDepths&&a?"depths["+a+"]":"depth"+a},quotedString:function(a){return this.source.quotedString(a)},objectLiteral:function(a){return this.source.objectLiteral(a)},aliasable:function(a){var b=this.aliases[a]
;return b?(b.referenceCount++,b):(b=this.aliases[a]=this.source.wrap(a),b.aliasable=!0,b.referenceCount=1,b)},setupHelper:function(a,b,c){var d=[];return{params:d,paramsInit:this.setupHelperArgs(b,a,d,c),name:this.nameLookup("helpers",b,"helper"),callParams:[this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : {}")].concat(d)}},setupParams:function(a,b,c){var d={},e=[],f=[],g=[],h=!c,i=void 0;h&&(c=[]),d.name=this.quotedString(a),d.hash=this.popStack(),this.trackIds&&(d.hashIds=this.popStack()),this.stringParams&&(d.hashTypes=this.popStack(),d.hashContexts=this.popStack());var j=this.popStack(),k=this.popStack();(k||j)&&(d.fn=k||"container.noop",d.inverse=j||"container.noop");for(var l=b;l--;)i=this.popStack(),c[l]=i,this.trackIds&&(g[l]=this.popStack()),this.stringParams&&(f[l]=this.popStack(),e[l]=this.popStack());return h&&(d.args=this.source.generateArray(c)),this.trackIds&&(d.ids=this.source.generateArray(g)),this.stringParams&&(d.types=this.source.generateArray(f),d.contexts=this.source.generateArray(e)),this.options.data&&(d.data="data"),this.useBlockParams&&(d.blockParams="blockParams"),d},setupHelperArgs:function(a,b,c,d){var e=this.setupParams(a,b,c);return e=this.objectLiteral(e),d?(this.useRegister("options"),c.push("options"),["options=",e]):c?(c.push(e),""):e}},function(){for(var a="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),b=e.RESERVED_WORDS={},c=0,d=a.length;c<d;c++)b[a[c]]=!0}(),e.isValidJavaScriptVariableName=function(a){return!e.RESERVED_WORDS[a]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(a)},b.default=e,a.exports=b.default},function(a,b,c){function d(a,b,c){if(f.isArray(a)){for(var d=[],e=0,g=a.length;e<g;e++)d.push(b.wrap(a[e],c));return d}return"boolean"==typeof a||"number"==typeof a?a+"":a}function e(a){this.srcFile=a,this.source=[]}b.__esModule=!0;var f=c(5),g=void 0;g||(g=function(a,b,c,d){this.src="",d&&this.add(d)},g.prototype={add:function(a){f.isArray(a)&&(a=a.join("")),this.src+=a},prepend:function(a){f.isArray(a)&&(a=a.join("")),this.src=a+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),e.prototype={isEmpty:function(){return!this.source.length},prepend:function(a,b){this.source.unshift(this.wrap(a,b))},push:function(a,b){this.source.push(this.wrap(a,b))},merge:function(){var a=this.empty();return this.each(function(b){a.add(["  ",b,"\n"])}),a},each:function(a){for(var b=0,c=this.source.length;b<c;b++)a(this.source[b])},empty:function(){var a=this.currentLocation||{start:{}};return new g(a.start.line,a.start.column,this.srcFile)},wrap:function(a){var b=arguments.length<=1||void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return a instanceof g?a:(a=d(a,this,b),new g(b.start.line,b.start.column,this.srcFile,a))},functionCall:function(a,b,c){return c=this.generateList(c),this.wrap([a,b?"."+b+"(":"(",c,")"])},quotedString:function(a){return'"'+(a+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(a){var b=[];for(var c in a)if(a.hasOwnProperty(c)){var e=d(a[c],this);"undefined"!==e&&b.push([this.quotedString(c),":",e])}var f=this.generateList(b);return f.prepend("{"),f.add("}"),f},generateList:function(a){for(var b=this.empty(),c=0,e=a.length;c<e;c++)c&&b.add(","),b.add(d(a[c],this));return b},generateArray:function(a){var b=this.generateList(a);return b.prepend("["),b.add("]"),b}},b.default=e,a.exports=b.default}])}),b("views/sheetContainer",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("lib/handlebars");return b.View.extend({tagName:"li",initialize:function(b){var c=this.model.toJSON();this.listenTo(this.model,"destroy",this.destroy),this.template=d.compile(a("#tempSheetContainer").html()),this.$el.html(this.template(c)),!0===b.active&&this.$el.addClass("active")},render:function(){return this},destroy:function(){this.remove()}})}),b("views/sheetsContainer",function(){var a=c("lib/backbone"),b=c("collections/sheets"),d=c("views/sheetContainer");return a.View.extend({tagName:"ul",className:"sheet-list",initialize:function(a){b.length<1&&b.add({name:"Sheet1",sort:0})},render:function(){var a,c,e;for(a=0;a<b.length;a++)e=0===a,c=new d({model:b.models[a],active:e}),this.$el.append(c.render().el);return this},destroy:function(){this.remove()}})}),b("basic/util/clone",function(){var a={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1};return{clone:function(b){if("object"==typeof b&&null!==b){var c=b;if(b instanceof Array){c=[];for(var d=0,e=b.length;d<e;d++)c[d]=this.clone(b[d])}else if(!a[Object.prototype.toString.call(b)]){c={};for(var f in b)b.hasOwnProperty(f)&&(c[f]=this.clone(b[f]))}return c}return b}}}),b("views/gridLineRowContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=c("collections/headItemRow"),d=c("basic/tools/cache"),e=c("basic/util/clone");c("spreadsheet/config");return a.View.extend({className:"row",initialize:function(a){this.offsetTop=d.TempProp.isFrozen?a.frozenTop||0:0,this.endIndex=a.endIndex,this.listenTo(this.model,"change:top",this.changeTop),this.listenTo(this.model,"change:height",this.changeHeight),this.listenTo(this.model,"destroy",this.remove),this.currentRule=e.clone(d.CurrentRule),!0===d.TempProp.isFrozen&&void 0!==this.endIndex||this.listenTo(this.model,"change:isView",this.destroy)},render:function(){return this.changeTop(),this.changeHeight(),this},changeTop:function(){var a,c=0;d.TempProp.isFrozen&&(a=b.getModelByAlias(d.UserView.rowAlias),c=a.toJSON().top),this.$el.css({top:this.model.toJSON().top-this.offsetTop-c})},changeHeight:function(){this.$el.css({height:this.model.toJSON().height})},destroy:function(){this.remove()}})}),b("basic/tools/gettextbox",function(){var a=c("lib/jquery");return{getTextHeight:function(b,c,d){var e,f,g,h,i="",j=0;for(g=b.split("\n"),h=g.length;j<h;j++)i+=g[j]+"<br>";return i=i.replace(/\u0020/g,"&nbsp;"),e=a("<div/>").html(i),e.css({display:"none","font-size":c+"pt",wordBreak:"break-word"}),void 0!==d&&e.css({width:d}),a("body").append(e),f=parseInt(e.height()),e.remove(),f},getInputHeight:function(b,c,d){var e,f;return e=a("<textarea>"),e.css({visibility:"hidden","font-size":c+"pt",height:0,width:d+"px",overflow:"scroll"}),a("body").append(e),e.val(b),f=parseInt(e[0].scrollHeight),e.remove(),f},getInputWidth:function(b,c){var d,e;return d=a("<textarea>"),d.css({position:"absolute",visibility:"hidden","font-size":c+"pt",height:0,width:0,overflow:"scroll"}),d.attr("wrap","off"),a("body").append(d),d.val(b),e=parseInt(d[0].scrollWidth),d.remove(),e}}}),b("views/cellContainer",function(){var a=c("lib/jquery"),b=c("lib/handlebars"),d=c("basic/util/binary"),e=c("lib/backbone"),f=c("collections/headItemRow"),g=c("collections/headItemCol"),h=(c("collections/selectRegion"),c("basic/tools/cache")),i=c("spreadsheet/config"),j=c("basic/tools/gettextbox"),k=c("entrance/cell/setcellheight"),l=c("entrance/tool/settexttype");return e.View.extend({className:"item",events:{mouseenter:"overHandle",mouseleave:"outHandle"},initialize:function(a){var b=f,c=g;e.on("event:destroyCellView",this.clear,this),this.listenTo(this.model,"change:physicsBox",this.render),this.listenTo(this.model,"change:content",this.render),this.listenTo(this.model,"change:border",this.render),this.listenTo(this.model,"change:format",this.render),this.listenTo(this.model,"change:customProp",this.render),this.listenTo(this.model,"change:highlight",this.render),this.listenTo(this.model,"change:wordWrap",this.adaptCellHight),this.listenTo(this.model,"change:content",this.adaptCellHight),this.listenTo(this.model,"change:isDestroy",this.destroy),this.listenTo(this.model,"change:commentShowState",this.commentViewHandler),this.listenTo(this.model,"change:hidden",this.destroy),this.listenTo(this.model,"destroy",this.clear),this.currentRule=a.currentRule,!0===h.TempProp.isFrozen&&void 0!==this.currentRule.displayPosition.endRowIndex||this.listenTo(this.model,"change:showState",this.changeShowState),this.currentRule=a.currentRule,this.offsetLeft=h.TempProp.isFrozen?this.currentRule.displayPosition.offsetLeft||0:0,this.offsetTop=h.TempProp.isFrozen?this.currentRule.displayPosition.offsetTop||0:0,this.userViewLeft=h.TempProp.isFrozen?c.getModelByAlias(h.UserView.colAlias).get("left"):0,this.userViewTop=h.TempProp.isFrozen?b.getModelByAlias(h.UserView.rowAlias).get("top"):0,_.bindAll(this,"overHandle","outHandle"),this.mouseOverEventId=null},overHandle:function(){var b=this,c=this.model;h.commentEditState||0===a(".comment").length&&"string"==typeof c.get("customProp").comment&&(this.mouseOverEventId=setTimeout(function(){b.model.set("commentShowState",!0)},1e3))},outHandle:function(){clearTimeout(this.mouseOverEventId),this.model.set("commentShowState",!1)},commentViewHandler:function(){!0===this.model.get("commentShowState")?this.showComment():this.hideComment()},showComment:function(){var a,b,c,d,h,i=this.model.get("occupy"),j=this.model.get("customProp").comment;a=i.y[0],b=i.x[i.x.length-1],c=f.getIndexByAlias(a),d=g.getIndexByAlias(b),h={colIndex:d,rowIndex:c,comment:j,state:"show"},e.trigger("event:commentContainer:show",h)},hideComment:function(){e.trigger("event:commentContainer:remove")},render:function(){var c=this.model.toJSON();return this.template=b.compile(a("#tempItemCell").html()),this.$el.css({width:c.physicsBox.width,height:c.physicsBox.height,left:c.physicsBox.left-this.offsetLeft-this.userViewLeft-1,top:c.physicsBox.top-this.offsetTop-this.userViewTop-1}).html(this.template(c)),this.$contentBody=a(".bg",this.$el),this.$contentBody.css({color:c.content.color,"font-family":c.content.family,"font-size":c.content.size+"pt"}).html(this.getDisplayText(c)),this.changeTopBorder(c),this.changeLeftBorder(c),this.changeBottomBorder(c),this.changeRightBorder(c),this.changeBackground(c),this.setTransverseAlign(c),this.setVerticalAlign(c),this.setBold(c),this.setItalic(c),this.wordWrap(c),this.showCommentSign(c),this},changeShowState:function(){!1===this.model.get("showState")&&this.remove()},showCommentSign:function(a){null!==a.customProp.comment&&void 0!==a.customProp.comment&&this.$el.prepend('<div class="comment-ico"><div class="triangle"></div></div>')},getDisplayText:function(a){var b,c,d=0;if(c=a.content.displayTexts,c=c||"",c,b=c.split("\n"),c="",!1===this.model.get("wordWrap"))for(d=0;d<b.length;d++)c+=b[d];else for(d=0;d<b.length;d++)c+=b[d]+"<br>";return c=c.replace(/\u0020/g,"&nbsp;")},adaptCellHight:function(){var a,b,c,d,l,m,n,o;if(l=i.User.cellHeight,c=this.model.get("occupy").y,d=this.model.get("occupy").x,o=this.model.get("content").size,!0===this.model.get("wordWrap")&&1===d.length&&1===c.length)return m=f.getModelByAlias(c[0]),n=g.getModelByAlias(d[0]),a=this.model.get("content").displayTexts,void((b=j.getTextHeight(a,o,n.get("width")))>l&&m.get("height")<b&&(k("sheetId",m.get("displayName"),b),h.TempProp.isFrozen&&e.trigger("event:bodyContainer:executiveFrozen")));o>11&&(m=f.getModelByAlias(c[0]),(b=j.getTextHeight("",o,200))>l&&m.get("height")<b&&(k("sheetId",m.get("displayName"),b),h.TempProp.isFrozen&&e.trigger("event:bodyContainer:executiveFrozen")))},setItalic:function(a){a.content.italic?this.$contentBody.css({"font-style":"italic"}):this.$contentBody.css({"font-style":"normal"})},setBold:function(a){a.content.bd?this.$contentBody.css({"font-weight":"bold"}):this.$contentBody.css({"font-weight":"normal"})},setTransverseAlign:function(a){var b=a.format,c=b.type,d=a.content.texts,e=b.isValid,f=a.content.alignRow;return"center"===f||"right"===f||"left"===f?void this.$contentBody.css({"text-align":f}):"text"!==c&&"normal"!==c&&!0===e?void this.$contentBody.css({"text-align":"right"}):"normal"===c&&l.isNum(d)?void this.$contentBody.css({"text-align":"right"}):void this.$contentBody.css({"text-align":"left"})},setVerticalAlign:function(a){"middle"===a.content.alignCol?this.$contentBody.css({"vertical-align":"middle"}):"bottom"===a.content.alignCol?this.$contentBody.css({"vertical-align":"bottom"}):this.$contentBody.css({"vertical-align":"top"})},changeTopBorder:function(a){a.border.top?this.$el.css({borderTopColor:"#000"}):this.$el.css({borderTopColor:"transparent"})},changeLeftBorder:function(a){var b,c=a.physicsBox.left,e=g.models;b=d.indexModelBinary(c+1,e,"left","width"),e[b].get("isLeftAjacentHide")||!a.border.left?this.$el.css({borderLeftColor:"transparent"}):this.$el.css({borderLeftColor:"#000"})},changeBottomBorder:function(a){a.border.bottom?this.$el.css({borderBottomColor:"#000"}):this.$el.css({borderBottomColor:"transparent"})},changeRightBorder:function(a){var b,c=a.physicsBox.left+a.physicsBox.width,e=g.models;b=d.indexModelBinary(c,e,"left","width"),e[b].get("isRightAjacentHide")||!a.border.right?this.$el.css({borderRightColor:"transparent"}):this.$el.css({borderRightColor:"#000"})},changeBackground:function(a){""!==a.customProp.background?this.$contentBody.css({backgroundColor:a.customProp.background}):this.$contentBody.css({backgroundColor:"#fff"})},wordWrap:function(a){!0===a.wordWrap?this.$contentBody.css({wordBreak:"break-word",whiteSpace:"normal"}):this.$contentBody.css({whiteSpace:"nowrap"})},destroy:function(){e.off("event:destroyCellView",this.destroy,this),(this.model.get("isDestroy")||this.model.get("hidden"))&&this.remove()},clear:function(){e.off("event:destroyCellView",this.destroy,this),this.remove()}})}),b("views/rowsGridContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=c("spreadsheet/config"),d=c("basic/tools/cache"),e=c("collections/headItemRow"),f=(c("collections/cells"),c("views/gridLineRowContainer"));return a.View.extend({className:"row-container",initialize:function(b){this.rowNumber=0,this.currentRule=d.CurrentRule,!0===d.TempProp.isFrozen&&void 0!==this.currentRule.displayPosition.endRowIndex||this.listenTo(e,"add",this.addGridLineRow),a.on("call:rowsGridContainer",this.rowsGridContainer,this)},rowsGridContainer:function(a){a(this)},render:function(){var a,b,c,f=0;for(a=b=e.models,d.TempProp.isFrozen&&(b=void 0!==this.currentRule.displayPosition.endRowIndex?a.slice(this.currentRule.displayPosition.startRowIndex,this.currentRule.displayPosition.endRowIndex):a.slice(this.currentRule.displayPosition.startRowIndex)),c=b.length;f<c;f++)this.addGridLineRow(b[f]),this.rowNumber++;return this},addGridLineRow:function(a){var b=new f({model:a,frozenTop:this.currentRule.displayPosition.offsetTop,endIndex:this.currentRule.displayPosition.endRowIndex});this.$el.append(b.render().el)},newAttrRow:function(){return{alias:(this.rowNumber+1).toString(),top:this.rowNumber*b.User.cellHeight,height:b.User.cellHeight-1,displayName:app.basic.buildRowAlias(this.rowNumber)}},destroy:function(){this.remove()}})}),b("views/gridLineColContainer",function(){var a=c("lib/backbone"),b=c("collections/headItemCol"),d=c("basic/tools/cache");c("spreadsheet/config"),c("basic/util/clone");return a.View.extend({className:"col",initialize:function(){var a,c;this.offsetLeft=0,this.listenTo(this.model,"change:isView",this.destroy),this.listenTo(this.model,"change:hidden",this.destroy),this.listenTo(this.model,"change:left",this.changeLeft),this.listenTo(this.model,"change:width",this.changeWidth),this.listenTo(this.model,"destroy",this.remove),a=b,c=a.getModelByAlias(d.TempProp.colAlias),this.userViewLeft=d.TempProp.isFrozen?a.getModelByAlias(d.UserView.colAlias).get("left"):0,this.offsetLeft=d.TempProp.isFrozen&&d.CurrentRule.autoColAlign?c.get("left")-this.userViewLeft||0:0},render:function(){return this.changeLeft(),this.changeWidth(),this},changeLeft:function(){this.$el.css({left:this.model.toJSON().left-this.offsetLeft-this.userViewLeft})},changeWidth:function(){this.$el.css({width:this.model.toJSON().width})},destroy:function(){this.model.get("isView")&&!this.model.get("hidden")||this.remove()}})}),b("views/colsGridContainer",function(){var a=c("lib/backbone"),b=c("spreadsheet/config"),d=(c("basic/util/binary"),c("basic/tools/cache")),e=c("collections/headItemCol"),f=c("basic/tools/buildalias"),g=c("views/gridLineColContainer");return a.View.extend({className:"col-container",initialize:function(b){this.colNumber=0,this.listenTo(e,"add",this.addGridLineCol),a.on("event:restoreHideCols",this.restoreHideCols,this)},render:function(){var a,b,c=0;for(a=e.models,d.TempProp.isFrozen&&(this.currentRule=d.CurrentRule,a=void 0!==this.currentRule.displayPosition.endColIndex?e.models.slice(this.currentRule.displayPosition.startColIndex,this.currentRule.displayPosition.endColIndex):e.models.slice(this.currentRule.displayPosition.startColIndex)),b=a.length;c<b;c++)a[c].get("hidden")||this.addGridLineCol(a[c]),this.colNumber++;return this},restoreHideCols:function(){for(var a=e.models,b=a.length,c=0;c<b;c++)a[c].get("hidden")&&this.addGridLineCol(a[c])},addGridLineCol:function(a){var b=new g({model:a,frozenLeft:0});this.$el.append(b.render().el)},createGridLineCol:function(){e.add(this.newAttrCol())},newAttrCol:function(){return{alias:(this.colNumber+1).toString(),left:this.colNumber*b.User.cellWidth,width:b.User.cellWidth-1,displayName:f.buildColAlias(this.colNumber)}},destroy:function(){a.off("event:restoreHideCols"),this.remove()}})}),b("views/gridLineContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=c("views/rowsGridContainer"),d=c("views/colsGridContainer");return a.View.extend({className:"line-container",initialize:function(){},render:function(){return this.rowsGridContainer=new b,this.$el.append(this.rowsGridContainer.render().el),this.colsGridContainer=new d,this.$el.append(this.colsGridContainer.render().el),this},destroy:function(){this.rowsGridContainer.destroy(),this.colsGridContainer.destroy(),this.remove()}})}),b("views/contentCellsContainer",function(){var b=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),d=c("basic/tools/cache"),e=(c("spreadsheet/config"),c("basic/util/clone")),f=c("basic/tools/send"),g=c("basic/tools/loadrecorder"),h=c("basic/tools/original"),i=c("collections/headItemCol"),j=c("collections/headItemRow"),k=c("collections/cells"),l=c("views/cellContainer");return b.View.extend({className:"content-list",initialize:function(){this.currentRule=e.clone(d.CurrentRule),b.on("event:contentCellsContainer:reloadCells",this.reloadCells,this),this.listenTo(k,"add",this.addCell)},render:function(){return this.fillCells(),this},fillCells:function(){var a,b,c=k.models;for(a=c.length,b=0;b<a;b++)c[b].get("isDestroy")||this.addCell(c[b])},reloadCells:function(){for(var a,b,c=0,e=k.length;c<e;c++)k.models[0].destroy();d.CellsPosition.strandX={},d.CellsPosition.strandY={},d.cellRegionPosi.vertical=[],a=d.viewRegion.top,b=d.viewRegion.bottom,this.getCells(a,b),g.insertPosi(a,b,d.cellRegionPosi.vertical)},restoreHideCellView:function(){var a,b,c,e,f,g,h,l,m,n=i.models,o=j.models,p=n.length,q=0;for(b=j.getIndexByAlias(d.UserView.rowAlias),c=j.getIndexByAlias(d.UserView.rowEndAlias),g=d.CellsPosition.strandX,l=c>b?c+1:j.length;q<p;q++)if(a=n[q],!0===a.get("hidden"))for(e=a.get("alias"),m=b;m<l;m++)f=o[m].get("alias"),void 0!==g[e]&&void 0!==g[e][f]&&(h=k.models[g[e][f]],!0===h.get("hidden")&&this.addCell(h))},getCells:function(b,c){f.PackAjax({url:"excel.htm?m=openexcel",isPublic:!1,async:!1,data:JSON.stringify({excelId:a.SPREADSHEET_AUTHENTIC_KEY,sheetId:"1",rowBegin:b,rowEnd:c}),success:function(a){if(""!==a){a=a.returndata;var b=a.spreadSheet[0].sheet.cells;h.analysisCellData(b)}}})},addCell:function(a){if(d.TempProp.isFrozen){var b,c,e,f,g=this.currentRule.displayPosition,h=g.startRowIndex,k=g.startColIndex,m=g.endRowIndex,n=g.endColIndex,o=i.models,p=j.models,q=a.get("physicsBox");if(b=q.top,e=b+q.height,c=q.left,f=c+q.width,e<p[h].get("top")||"number"==typeof m&&b>p[m].get("top")||f<o[k].get("left")||"number"==typeof n&&c>o[n].get("left"))return}this.cellView=new l({model:a,currentRule:this.currentRule}),this.$el.append(this.cellView.render().el)},destroy:function(){b.off("event:contentCellsContainer:reloadCells"),b.off("event:restoreHideCellView"),b.trigger("event:destroyCellView"),this.remove()}})}),b("views/selectRegion",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("lib/handlebars"),e=c("basic/util/clone"),f=c("basic/util/binary"),g=c("basic/tools/cache"),h=(c("basic/tools/send"),c("models/cell"),c("collections/headItemRow")),i=c("collections/headItemCol"),j=c("collections/cells");return b.View.extend({className:"selected-container",events:{dblclick:"editState",mousemove:"moveHandle",mouseout:"outHandle"},initialize:function(a){this.viewCellsContainer=a.parentView,"operation"===this.model.get("selectType")&&b.on("event:selectRegion:patchOprCell",this.patchOprCell,this),this.listenTo(this.model,"change",this.changePosition),this.listenTo(this.model,"destroy",this.destroy),void 0!==a.currentRule?this.currentRule=a.currentRule:this.currentRule=e.clone(g.CurrentRule),this.userViewTop=g.TempProp.isFrozen?h.getModelByAlias(g.UserView.rowAlias).get("top"):0,this.userViewLeft=g.TempProp.isFrozen?i.getModelByAlias(g.UserView.colAlias).get("left"):0,this.offsetLeft=g.TempProp.isFrozen?this.currentRule.displayPosition.offsetLeft||0:0,this.offsetTop=g.TempProp.isFrozen?this.currentRule.displayPosition.offsetTop||0:0,this.mouseOverModel=null,this.mouseOverEventId=null,_.bindAll(this,"moveHandle","outHandle")},render:function(){return this.changePosition(),this.template=d.compile(a("#tempSelectContainer").html()),this.$el.html(this.template()),this},moveHandle:function(a){var b,c,d,e,k,l=this.model.toJSON(),m=h.models,n=i.models,o=a.offsetY,p=a.offsetX;g.commentEidtState||o<0||p<0||o>l.physicsBox.height||p>l.physicsBox.width||(e=o+l.physicsPosi.top,k=p+l.physicsPosi.left,c=f.modelBinary(e,m,"top","height"),b=f.modelBinary(k,n,"left","width"),d=j.getCellByVertical(b,c)[0],this.mouseOverModel!==d&&(clearTimeout(this.mouseOverEventId),void 0!==d&&"string"==typeof d.get("customProp").comment&&(this.mouseOverEventId=setTimeout(function(){d.set("commentShowState",!0)},1e3)),null!==this.mouseOverModel&&this.mouseOverModel.set("commentShowState",!1),this.mouseOverModel=d||null))},outHandle:function(){clearTimeout(this.mouseOverEventId),null!==this.mouseOverModel&&this.mouseOverModel.set("commentShowState",!1),this.mouseOverModel=null},changePosition:function(){var a=this.model.toJSON(),b=a.physicsBox.height,c=a.physicsBox.width,d=a.physicsPosi.left,e=a.physicsPosi.top;0===d?(d-=1,c-=1):c-=2,0===e?(e-=1,b-=1):b-=2,this.$el.css({width:c,height:b,left:d-this.offsetLeft-this.userViewLeft,top:e-this.offsetTop-this.userViewTop})},callView:function(a){var b=this;return function(c){b[a]=c}},patchOprCell:function(a,b){function c(){return e=void 0===b.cellModel?j.getCellsByWholeSelectRegion():b.cellModel}var d,e,f,h,i,k,l=0;b=void 0===b||null===b?{cellModel:void 0,headModel:void 0}:b,c(),a=void 0===a||null===a?function(){}:a,f=void 0===b.headModel?j.getHeadModelByWholeSelectRegion():b.headModel,h=e.length;for(new Date;l<h;l++)d=c()[l],i=f[l],null===d&&(j.add({occupy:{x:[i.occupy.x],y:[i.occupy.y]},physicsBox:{top:i.physicsBox.top,left:i.physicsBox.left,width:i.physicsBox.width,height:i.physicsBox.height}}),g.cachePosition(i.occupy.y,i.occupy.x,j.length-1),k=j.models,d=k[k.length-1]),a(d)},editState:function(){b.trigger("event:InputContainer:show")},destroy:function(){"operation"===this.model.get("selectType")&&b.off("event:selectRegion:patchOprCell"),this.remove()}})}),b("views/cellsContainer",function(){var a=c("lib/jquery"),b=c("lib/underscore"),d=c("lib/backbone"),e=c("basic/util/binary"),f=c("basic/tools/cache"),g=c("spreadsheet/config"),h=c("basic/util/clone"),i=c("basic/util/listener"),j=c("models/selectRegion"),k=c("collections/headItemCol"),l=c("collections/headItemRow"),m=c("collections/selectRegion"),n=c("collections/siderLineRow"),o=c("collections/siderLineCol"),p=c("collections/cells"),q=c("views/gridLineContainer"),r=c("views/contentCellsContainer"),s=c("views/selectRegion");return d.View.extend({className:"cells-container",events:{mousedown:"located"},initialize:function(a){d.on("call:cellsContainer",this.callCellsContainer,this),d.on("event:cellsContainer:adjustSelectRegion",this.adjustSelectRegion,this),d.on("event:cellsContainer:adaptSelectRegion",this.adaptSelectRegion,this),d.on("event:cellsContainer:adaptWidth",this.adaptWidth,this),d.on("event:cellsContainer:destroy",this.destroy,this),d.on("event:cellsContainer:unBindDrag",this.unBindDrag,this),d.on("event:cellsContainer:bindDrag",this.bindDrag,this),d.on("event:cellsContainer:getCoordinate",this.getCoordinate,this),d.on("event:cellsContainer:startHighlight",this.startHighlight,this),d.on("event:cellsContainer:stopHighlight",this.stopHighlight,this),this.listenTo(m,"add",this.addSelectRegionView),b.bindAll(this,"callView","drag","highlightRegionMove"),this.currentRule=h.clone(f.CurrentRule),this.boxAttributes=a.boxAttributes,this.parentView=a.parentView,(!f.TempProp.isFrozen||this.currentRule.displayPosition.endRowIndex&&this.currentRule.displayPosition.endColIndex)&&d.on("event:cellsContainer:selectRegionChange",this.selectRegionChange,this)},render:function(){var a,b,c=m.models;for(this.attributesRender(this.boxAttributes),this.gridLineContainer=new q,this.$el.append(this.gridLineContainer.render().el),this.contentCellsContainer=new r,this.$el.append(this.contentCellsContainer.render().el),a=c.length,b=0;b<a;b++)this.addSelectRegionView(c[b]);return this.triggerCallback(),this},adaptWidth:function(){var a,b,c,d=k.models,e=d.length;for(c=e-1;c>-1;c--)if(!d[c].get("hidden")){a=d[c].get("left"),b=d[c].get("width");break}this.$el.css("width",a+b)},onDragOver:function(a){a.preventDefault();var b;b=this.getCoordinateByMouseEvent(a),this.adjustDragRegion(b)},onDrop:function(a){var b,c,d,e,f,g,h=l.models,j=k.models,n={};for(b=m.getModelByType("drag"),g=0;g<b.length;g++)b[g].destroy();if(c=this.getCoordinateByMouseEvent(a),d={Col:[j[c.startColIndex].get("displayName")],Row:[h[c.startRowIndex].get("displayName")]},n.point=d,!1===a.isDefaultPrevented()){if(e=a.originalEvent.dataTransfer.getData("text"),n.text=e,a.originalEvent.dataTransfer.clearData(),""===e)return;void 0===f&&(f=p.createCellModel(c.startColIndex,c.startRowIndex,c.endColIndex,c.endRowIndex)),f.set("content.texts",e)}i.excute("dataDrag",n)},getCoordinate:function(b,c,d){var h,i,j,m,n,o,p,q,r=l.getModelByAlias(f.TempProp.rowAlias),s=k.getModelByAlias(f.TempProp.colAlias),t=l.models,u=k.models,v=f.containerId,w={};this.userViewTop=f.TempProp.isFrozen?l.getModelByAlias(f.UserView.rowAlias).get("top"):0,this.userViewLeft=f.TempProp.isFrozen?k.getModelByAlias(f.UserView.colAlias).get("left"):0,h=0===this.currentRule.displayPosition.offsetLeft?this.userViewLeft:s.get("left"),i=0===this.currentRule.displayPosition.offsetTop?this.userViewTop:r.get("top"),j=c-g.System.outerLeft-a("#"+v).offset().left,m=d-g.System.outerTop-a("#"+v).offset().top,j<0||m<0||(n=j+this.parentView.el.scrollLeft-this.currentRule.displayPosition.offsetLeft+h,o=m+this.parentView.el.scrollTop-this.currentRule.displayPosition.offsetTop+i,n<0||o<0||(p=e.modelBinary(n,u,"left","width",0,u.length-1),q=e.modelBinary(o,t,"top","height",0,t.length-1),w.col=u[p].get("displayName"),w.row=t[q].get("displayName"),b(w)))},startHighlight:function(){this.undelegateEvents(),this.$el.off("mousemove",this.drag),this.$el.on("mousemove",this.highlightRegionMove)},highlightRegionMove:function(a){var b,c,d,e,g,h,i,k,l,m,n=this;if(c=this.getCoordinateByMouseEvent(a),void 0===(b=c.model)||!0!==b.get("highlight"))return f.highlightDirection="null",void(null!==this.hightlightView&&void 0!==this.hightlightView&&(this.hightlightModel.destroy(),this.hightlightView=null));g=b.get("physicsBox").left,h=b.get("physicsBox").top,l=b.get("physicsBox").height,i=b.get("physicsBox").width,k=g+i,m=h+l,d=function(){var b=n.getMouseColRelativePosi(a),c=n.getMouseRowRelativePosi(a),d=k-b,e=b-g,f=c-h,i=m-c,j=d,l="right";return j>e&&(j=e,l="left"),j>f&&(j=f,l="top"),j>i&&(j=i,l="bottom"),l}(),null!==this.hightlightView&&void 0!==this.hightlightView||(e=new j,this.hightlightModel=e,e.set("selectType","extend"),this.hightlightView=new s({model:e,className:"highlight-container",parentView:this}),this.$el.append(this.hightlightView.render().el)),this.hightlightModel.set("physicsPosi",{left:g,top:h,bottom:m,right:k}),this.hightlightModel.set("physicsBox",{height:l,width:i}),function(){n.hightlightView.$el.removeClass("highlight-right"),n.hightlightView.$el.removeClass("highlight-left"),n.hightlightView.$el.removeClass("highlight-top"),n.hightlightView.$el.removeClass("highlight-bottom")}(),this.hightlightView.$el.addClass("highlight-"+d),f.highlightDirection=d},stopHighlight:function(){this.$el.off("mousemove",this.highlightRegionMove),this.delegateEvents(),null!==this.hightlightView&&void 0!==this.hightlightView&&(this.hightlightModel.destroy(),this.hightlightView=null)},getMouseColRelativePosi:function(b){var c,d=k.getModelByAlias(f.TempProp.colAlias),e=(k.models,f.containerId);return this.userViewLeft=f.TempProp.isFrozen?k.getModelByAlias(f.UserView.colAlias).get("left"):0,c=0===this.currentRule.displayPosition.offsetLeft?this.userViewLeft:d.get("left"),void 0===b.clientX&&(b.clientX=b.originalEvent.clientX),b.clientX-g.System.outerLeft-a("#"+e).offset().left+this.parentView.el.scrollLeft-this.currentRule.displayPosition.offsetLeft+c},getMouseRowRelativePosi:function(b){var c,d=l.getModelByAlias(f.TempProp.rowAlias),e=(l.models,f.containerId);return this.userViewTop=f.TempProp.isFrozen?l.getModelByAlias(f.UserView.rowAlias).get("top"):0,c=0===this.currentRule.displayPosition.offsetTop?this.userViewTop:d.get("top"),void 0===b.clientY&&(b.clientY=b.originalEvent.clientY),b.clientY-g.System.outerTop-a("#"+e).offset().top+this.parentView.el.scrollTop-this.currentRule.displayPosition.offsetTop+c},getCoordinateByMouseEvent:function(a){var b,c,d,g,h,i,j,m,n,o,q,r,s,t,u,v,w=l.models,x=k.models;return b=this.getMouseColRelativePosi(a),c=this.getMouseRowRelativePosi(a),d=e.modelBinary(b,x,"left","width",0,x.length-1),g=e.modelBinary(c,w,"top","height",0,w.length-1),i=x[d].get("alias"),h=w[g].get("alias"),j=f.CellsPosition.strandX,void 0!==j[i]&&void 0!==j[i][h]&&(m=p.models[j[i][h]]),m?(s=m.get("occupy").x,t=m.get("occupy").y,u=s.indexOf(i),v=t.indexOf(h),n=d-u,o=g-v,q=d+s.length-u-1,r=g+t.length-v-1):(n=q=d,o=r=g),{startColIndex:n,startRowIndex:o,endColIndex:q,endRowIndex:r,model:m}},selectRegionChange:function(a){switch(a){case"LEFT":case"RIGHT":case"UP":break;case"DOWN":this.downSelectRegion()}},downSelectRegion:function(){var a,b,c,d,g,h,i,j,n,o,q,r,s,t,u;this.userViewTop=f.TempProp.isFrozen?l.getModelByAlias(f.UserView.rowAlias).get("top"):0,this.userViewLeft=f.TempProp.isFrozen?k.getModelByAlias(f.UserView.colAlias).get("left"):0,a=l.getIndexByAlias(m.models[0].get("wholePosi").endY),b=k.getIndexByAlias(m.models[0].get("wholePosi").startX),n=l.models[a+1].get("alias"),o=m.models[0].get("wholePosi").startX,j=f.CellsPosition.strandX,void 0!==j[o]&&void 0!==j[o][n]&&(c=p.models[j[o][n]]),c?(r=c.get("physicsBox").left,s=c.get("physicsBox").top,u=c.get("physicsBox").width,t=c.get("physicsBox").height,d=e.modelBinary(r,k.models,"left","width",0,k.models.length-1),g=e.modelBinary(s,l.models,"top","height",0,l.models.length-1),h=e.modelBinary(r+u,k.models,"left","width",0,k.models.length-1),i=e.modelBinary(s+t,l.models,"top","height",0,l.models.length-1)):(d=h=b,g=i=a+1),q={initColIndex:d,initRowIndex:g,mouseColIndex:h,mouseRowIndex:i},this.adjustOperationRegion(q)},destoryDelegate:function(){this.$el.off("mousemove",self.drag)},
triggerCallback:function(){d.trigger("call:mainContainer",this.callView("viewMainContainer"))},callCellsContainer:function(a){a(this)},attributesRender:function(a){this.$el.css({width:a.width,height:a.height})},addSelectRegionView:function(a){var b;b="operation"===a.get("selectType")?"selected-container":"datasource-container",this.selectRegion=new s({model:a,className:b,currentRule:this.currentRule,parentView:this}),this.$el.append(this.selectRegion.render().el)},newSelectRegion:function(){var a,b,c,d,e,g;return a=k.models,b=l.models,c=a[0].get("alias"),d=b[0].get("alias"),e=f.CellsPosition.strandX,void 0!==e[d]&&void 0!==e[d][c]&&(g=p.models[e[d][c]]),void 0===g?{physicsPosi:{top:0,left:0},physicsBox:{width:a[0].get("width"),height:b[0].get("height")}}:(this.changeSelectHeadLine(g),{physicsPosi:{top:0,left:0},physicsBox:{width:g.get("physicsBox").width,height:g.get("physicsBox").height}})},changeSelectHeadLine:function(a){var b,c,d,f,g,h;b=l.models,c=k.models,d=0,f=0,g=e.modelBinary(a.get("physicsBox").left+a.get("physicsBox").width,c,"left","width",0,c.length-1),h=e.modelBinary(a.get("physicsBox").top+a.get("physicsBox").height,b,"top","height",0,b.length-1),n.models[0].set({top:a.get("physicsBox").top,height:a.get("physicsBox").height}),o.models[0].set({left:a.get("physicsBox").left,width:a.get("physicsBox").width});var i,j=b.length;for(i=0;i<j;i++)b[i].set({activeState:!1});for(j=c.length,i=0;i<j;i++)c[i].set({activeState:!1});for(i=0;i<g-d+1;i++)c[d+i].set({activeState:!0});for(i=0;i<h-f+1;i++)b[f+i].set({activeState:!0})},callView:function(a){var b=this;return function(c){b[a]=c}},located:function(b){f.commentEditState||"edit-frame"!==a(b.target).attr("class")&&(this.changePosi(b),d.trigger("event:cellsContainer:bindDrag"))},changePosi:function(a){var b,c,d,e,f,g,h,j,m=k.models,n=l.models,o=[],p=[],q="";b=this.getCoordinateByMouseEvent(a),c=b.model,d=b.startColIndex,e=b.startRowIndex,f=b.endColIndex,g=b.endRowIndex,void 0!==c&&(c.get("physicsBox").left,c.get("physicsBox").top,c.get("physicsBox").width,c.get("physicsBox").height,q=c.get("content").texts),h={initColIndex:d,initRowIndex:e,mouseColIndex:d,mouseRowIndex:e},this.adjustOperationRegion(h);var r={};for(j=d;j<f+1;j++)o.push(m[j].get("displayName"));for(j=e;j<g+1;j++)p.push(n[j].get("displayName"));r.point={col:o,row:p},r.text=q,r.property={size:c?c.get("content").size:"11pt",family:c?c.get("content").family:"SimSun",bd:!!c&&c.get("content").bd,italic:!!c&&c.get("content").italic,color:c?c.get("content").color:"#000",alignRow:c?c.get("content").alignRow:"left",alignCol:c?c.get("content").alignCol:"middle",background:c?c.get("customProp").background:"#fff",format:c?c.get("customProp").format:"text",wordWrap:!!c&&c.get("wordWrap")},r.border={top:!!c&&c.get("border").top,right:!!c&&c.get("border").right,bottom:!!c&&c.get("border").bottom,left:!!c&&c.get("border").left},i.excute("mousedown",r)},bindDrag:function(){this.$el.on("mousemove",this.drag)},unBindDrag:function(){this.$el.off("mousemove",this.drag)},drag:function(a){var b,c,d,h,i,j,n,o,p,q,r=l.models,s=k.models;b=this.getMouseColRelativePosi(a),c=this.getMouseRowRelativePosi(a),d=e.modelBinary(b,s,"left","width",0,s.length-1),h=e.modelBinary(c,r,"top","height",0,r.length-1),p=f.mouseOperateState===g.mouseOperateState.dataSource?m.getModelByType("dataSource")[0]:m.getModelByType("operation")[0],i=p.get("initPosi").startX,j=p.get("initPosi").startY,n=p.get("mousePosi").mouseX,o=p.get("mousePosi").mouseY,n===d&&o===h||(q={initColIndex:i,initRowIndex:j,mouseColIndex:d,mouseRowIndex:h},this.adjustOperationRegion(q))},adaptSelectRegion:function(){var a,b,c,d,e,f,g,h,i,j,n;l.models,k.models;a=m.getModelByType("operation")[0],b=a.get("wholePosi").startY,c=a.get("wholePosi").startX,d=a.get("wholePosi").endY,e=a.get("wholePosi").endX,f=k.getIndexByAlias(c),g=l.getIndexByAlias(b),h=k.getIndexByAlias(e),i=l.getIndexByAlias(d),j={startColIndex:f,startRowIndex:g,endColIndex:h,endRowIndex:i},n={initColIndex:j.startColIndex,initRowIndex:j.startRowIndex,mouseColIndex:j.endColIndex,mouseRowIndex:j.endRowIndex},this.adjustOperationRegion(n)},adjustOperationRegion:function(a){f.mouseOperateState===g.mouseOperateState.dataSource?this.adjustDataSourceRegion(a):this.adjustSelectRegion(a)},adjustDragRegion:function(a){var b,c,d=a.startColIndex,e=a.startRowIndex,f=a.endColIndex,g=a.endRowIndex,h=k.models,i=l.models,j=0,n=0;b=m.getModelByType("drag"),0===b.length&&(this.createDragRegion(a),b=m.getModelByType("drag")),c=b[0],void 0!==this.dragView&&null!==this.dragView||(this.dragView=new s({model:c,className:"datasource-container",currentRule:this.currentRule,parentView:this}),this.$el.append(this.dragView.render().el)),h[d].get("left"),i[e].get("top"),j=h[f].get("width")+h[f].get("left")-h[d].get("left"),n=i[g].get("height")+i[g].get("top")-i[e].get("top"),c.set({physicsPosi:{top:i[e].get("top"),left:h[d].get("left")},physicsBox:{width:j-1,height:n-1}})},adjustSelectRegion:function(a){var b,c,d,e,f,g,h,j=k.models,q=l.models,r=[],s=[],t=0,u=0;b=p.getFullOperationRegion({startColIndex:a.initColIndex,startRowIndex:a.initRowIndex,endColIndex:a.mouseColIndex,endRowIndex:a.mouseRowIndex}),c=b.startColIndex,d=b.startRowIndex,e=b.endColIndex,f=b.endRowIndex;var v={};for(h=c;h<e+1;h++)r.push(j[h].get("displayName"));for(h=d;h<f+1;h++)s.push(q[h].get("displayName"));for(v.point={col:r,row:s},i.excute("regionChange",v),i.excute("selectRegionChange",v),t=j[e].get("width")+j[e].get("left")-j[c].get("left"),u=q[f].get("height")+q[f].get("top")-q[d].get("top"),m.models[0].set({initPosi:{startX:a.initColIndex,startY:a.initRowIndex},mousePosi:{mouseX:a.mouseColIndex,mouseY:a.mouseRowIndex},physicsPosi:{top:q[d].get("top"),left:j[c].get("left")},physicsBox:{width:t,height:u},wholePosi:{startX:j[c].get("alias"),startY:q[d].get("alias"),endX:j[e].get("alias"),endY:q[f].get("alias")}}),n.models[0].set({top:q[d].get("top"),height:u-1}),o.models[0].set({left:j[c].get("left"),width:t-1}),g=q.length,h=0;h<g;h++)q[h].set({activeState:!1});for(g=j.length,h=0;h<g;h++)j[h].set({activeState:!1});for(h=0;h<e-c+1;h++)t+=j[c+h].set({activeState:!0});for(h=0;h<f-d+1;h++)u+=q[d+h].set({activeState:!0})},adjustDataSourceRegion:function(a){var b,c,d,e,f,g,h,n,o,q=k.models,r=l.models,s=[],t=[];b=p.getFullOperationRegion({startColIndex:a.initColIndex,startRowIndex:a.initRowIndex,endColIndex:a.mouseColIndex,endRowIndex:a.mouseRowIndex}),c=b.startColIndex,d=b.startRowIndex,e=b.endColIndex,f=b.endRowIndex;var u={};for(o=c;o<e+1;o++)t.push(q[o].get("displayName"));for(o=d;o<f+1;o++)s.push(r[o].get("displayName"));u.point={col:t,row:s},i.excute("regionChange",u),i.excute("dataSourceRegionChange",u),g=m.getModelByType("dataSource")[0],void 0===g&&(g=new j,g.set("selectType","dataSource"),m.add(g)),h=q[e].get("width")+q[e].get("left")-q[c].get("left"),n=r[f].get("height")+r[f].get("top")-r[d].get("top"),g.set({initPosi:{startX:a.initColIndex,startY:a.initRowIndex},mousePosi:{mouseX:a.mouseColIndex,mouseY:a.mouseRowIndex},physicsPosi:{top:r[d].get("top"),left:q[c].get("left")},physicsBox:{width:h,height:n},wholePosi:{startX:q[c].get("alias"),startY:r[d].get("alias"),endX:q[e].get("alias"),endY:r[f].get("alias")}})},createDragRegion:function(a){var b,c,d=a.startColIndex||0,e=a.startRowIndex||0,f=a.endColIndex||0,g=a.endRowIndex||0,h=k.models,i=l.models;b=h[f].get("width")+h[f].get("left")-h[d].get("left"),c=i[g].get("height")+i[g].get("top")-i[e].get("top"),m.add({physicsPosi:{top:i[e].get("top"),left:h[d].get("left")},physicsBox:{width:b-1,height:c-1},selectType:"drag"})},addSelectRegion:function(){},destroy:function(){var a,b,c=0;for(d.off("call:cellsContainer"),d.off("event:cellsContainer:destroy"),d.off("event:cellsContainer:selectRegionChange"),d.off("event:cellsContainer:adjustSelectRegion"),d.off("event:cellsContainer:adaptSelectRegion"),d.off("event:cellsContainer:destroy"),d.off("event:cellsContainer:unBindDrag"),d.off("event:cellsContainer:bindDrag"),d.off("event:cellsContainer:getCoordinate"),d.off("event:cellsContainer:startHighlight"),d.off("event:cellsContainer:stopHighlight"),d.off("event:cellsContainer:adaptWidth"),this.contentCellsContainer.destroy(),this.selectRegion.destroy(),b=m.models,a=b.length;c<a;c++)"operation"!==b[c].get("selectType")&&b[c].destroy();this.remove()}})}),b("views/mainContainer",function(){var b=c("lib/jquery"),d=c("lib/underscore"),e=c("lib/backbone"),f=c("basic/util/binary"),g=c("basic/tools/cache"),h=c("spreadsheet/config"),i=c("basic/tools/original"),j=c("basic/util/clone"),k=c("basic/tools/send"),l=c("basic/tools/buildalias"),m=c("basic/tools/loadrecorder"),n=c("collections/headItemCol"),o=c("collections/headItemRow"),p=c("collections/siderLineRow"),q=c("collections/cells"),r=c("collections/selectRegion"),s=c("views/gridLineRowContainer"),t=c("views/cellContainer"),u=c("views/cellsContainer");return e.View.extend({initialize:function(){var a,b,c,d,f,h,i;e.on("event:mainContainer:destroy",this.destroy,this),e.on("event:mainContainer:attributesRender",this.attributesRender,this),e.on("event:mainContainer:appointPosition",this.appointPosition,this),this.currentRule=j.clone(g.CurrentRule),this.currentRule.eventScroll&&(this.delegateEvents({scroll:"syncScroll"}),e.on("call:mainContainer",this.callMainContainer,this),e.on("event:mainContainer:nextCellPosition",this.nextCellPosition,this),e.on("event:mainContainer:adaptRowHeightChange",this.adaptRowHeightChange,this)),!0===g.TempProp.isFrozen?(this.offsetTop=this.currentRule.displayPosition.offsetTop,this.userViewTop=o.getModelByAlias(g.UserView.rowAlias).get("top")):(this.offsetTop=0,this.userViewTop=0),!0===g.TempProp.isFrozen?(this.offsetTop=this.currentRule.displayPosition.offsetTop,this.userViewTop=o.getModelByAlias(g.UserView.rowAlias).get("top")):(this.offsetTop=0,this.userViewTop=0),this.boxModel={},this.boxAttributes=this.currentRule.boxAttributes,this.isPreventScroll=!0,c=a=o.models,d=b=n.models,g.TempProp.isFrozen&&(c=this.currentRule.displayPosition.endRowIndex?a.slice(this.currentRule.displayPosition.startRowIndex,this.currentRule.displayPosition.endRowIndex):a.slice(this.currentRule.displayPosition.startRowIndex),d=this.currentRule.displayPosition.endColIndex?b.slice(this.currentRule.displayPosition.startColIndex,this.currentRule.displayPosition.endColIndex):b.slice(this.currentRule.displayPosition.startColIndex)),i=c.length,f=c[i-1],i=d.length,h=d[i-1],this.boxModel.height=f.get("top")+f.get("height")-c[0].get("top"),this.boxModel.width=h.get("left")+h.get("width")-d[0].get("left"),g.viewRegion.top=0,g.viewRegion.bottom=this.boxModel.height},addBackGround:function(){void 0!==this.currentRule.displayPosition.endColAlias&&void 0!==this.currentRule.displayPosition.endRowAlias?(this.$el.append('<div style="position:absolute;width:inherit;height:inherit;background-color:white;top:0;left:0;z-index:13"></div>'),this.cellsContainer.$el.css({"z-index":"14"})):void 0===this.currentRule.displayPosition.endColAlias&&void 0===this.currentRule.displayPosition.endRowAlias||(this.$el.append('<div style="position:absolute;width:inherit;height:inherit;background-color:white;top:0;left:0;z-index:10"></div>'),this.cellsContainer.$el.css({"z-index":"11"}))},addCellViewPublish:function(a){this.publish(a,"addCellViewPublish")},addRowHeadItemViewPublish:function(a){this.publish(a,"addRowHeadItemViewPublish")},addHeadItemView:function(a){var b,c=this.currentRule.displayPosition.startRowIndex,d=this.currentRule.displayPosition.endRowIndex,e=o.models;a.get("top")<e[c].get("top")||"number"==typeof d&&a.get("top")>e[d].get("top")||(b=new s({model:a,frozenTop:this.currentRule.displayPosition.offsetTop}),this.cellsContainer.gridLineContainer.rowsGridContainer.$el.append(b.render().el))},addCellView:function(a){var b,c,d,e,f,g=this.currentRule.displayPosition.startRowIndex,h=this.currentRule.displayPosition.endRowIndex,i=this.currentRule.displayPosition.startColIndex,j=this.currentRule.displayPosition.endColIndex,k=o.models,l=n.models;f=a.get("physicsBox").top,e=a.get("physicsBox").top+a.get("physicsBox").height,c=a.get("physicsBox").left,d=a.get("physicsBox").left+a.get("physicsBox").width,e<k[g].get("top")||"number"==typeof h&&f>k[h].get("top")||d<l[i].get("left")||"number"==typeof j&&c>l[j].get("left")||(b=new t({model:a,currentRule:this.currentRule}),this.cellsContainer.contentCellsContainer.$el.prepend(b.render().el))},render:function(){return this.attributesRender(this.boxAttributes),this.cellsContainer=new u({boxAttributes:{height:this.boxModel.height,width:this.boxModel.width},parentView:this}),this.$el.append(this.cellsContainer.render().el),this.addBackGround(),this.triggerCallback(),this},subscribeScroll:function(a,b){this.appointPosition(a,b.direction)},appointPosition:function(a,b){this.isPreventScroll=!1,"TRANSVERSE"===b&&this.$el.scrollLeft(a),"VERTICAL"===b&&this.$el.scrollTop(a)},triggerCallback:function(){d.bindAll(this,"callView"),e.trigger("call:bodyContainer",this.callView("viewBodyContainer")),e.trigger("call:colsAllHeadContainer",this.callView("viewColsAllHeadContainer"))},callView:function(a){var b=this;return function(c){b[a]=c}},callMainContainer:function(a){a(this)},attributesRender:function(a){this.$el.css({width:a.width,height:a.height}),a.style&&this.$el.addClass(a.style)},nextCellPosition:function(a){switch(a){case"LEFT":case"RIGHT":case"UP":break;case"DOWN":this.downCellPosition()}},downCellPosition:function(){var a,b,c,d,e,f,i,j,k=[],l=[];if(!g.TempProp.isFrozen||!this.currentRule.displayPosition.endRowIndex&&!this.currentRule.displayPosition.endColIndex){for(d=q.getCellsByWholeSelectRegion()[0],null===d?k.push(r.models[0].get("wholePosi").startY):k=d.get("occupy").y,j=k.length,i=0;i<j;i++)if(-1===o.getIndexByAlias(k[i])){l=k[i];break}void 0!==l&&k[j-1],e=o.getModelByAlias(k[j-1]),!0===g.TempProp.isFrozen?(a=this.currentRule.displayPosition.offsetTop,b=o.getModelByAlias(g.UserView.rowAlias).get("top")):(a=0,b=0),f=e.get("top")+e.get("height")+h.User.cellHeight+10-a-b,f<this.el.scrollTop+this.el.offsetHeight||(c=this.el.scrollTop,this.el.scrollTop=f-this.el.offsetHeight,this.deleteTop(c),this.addBottom(this.recordBottomPosi))}},syncScroll:function(a,b){var c,d,e,f,h,i=g.viewRegion.top;this.preventAutoScroll(),c=i-this.el.scrollTop-this.offsetTop-this.userViewTop,g.TempProp.isFrozen||(d=o.getModelByPosition(this.recordScrollTop),f=o.getModelByPosition(this.recordScrollTop+this.el.offsetHeight),g.UserView.rowAlias=d.get("alias"),g.UserView.rowEndAlias=f.get("alias"),e=n.getModelByPosition(this.recordScrollLeft),h=n.getModelByPosition(this.recordScrollLeft+this.el.offsetWidth),g.UserView.colAlias=e.get("alias"),g.UserView.colEndAlias=h.get("alias")),(c>0||"up"===b)&&(this.addTop(i),this.deleteBottom(g.viewRegion.bottom)),(c<0||"down"===b)&&(this.addBottom(g.viewRegion.bottom),this.deleteTop(i))},deleteTop:function(a){var b,c,d,e,a,i,j,k,l,m,n,p=o.models;if(k=this.offsetTop,l=this.userViewTop,c=this.el.scrollTop-h.System.prestrainHeight+k+l,a<0&&(a=0),c<0&&(c=0),b=f.indexModelBinary(c,p,"top","height"),!((e=f.indexModelBinary(a,p,"top","height"))>=b)){for(m=e;m<b;m++)p[m].destroyView();for(i=q.getCellByRow(e,b-1),d=p[m].get("alias"),m=0,n=i.length;m<n;m++)j=i[m].get("occupy").y,-1===j.indexOf(d)&&i[m].hide();g.viewRegion.top=p[b].get("top")}},addTop:function(a){var a,b,c,d,e,i,j,k,l,m,n,p=o.models;for(k=this.offsetTop,l=this.userViewTop,c=this.el.scrollTop-h.System.prestrainHeight+k+l,c=c<0?0:c,e=this.el.scrollTop+this.el.offsetHeight+h.System.prestrainHeight+k+l,a=a<e?a:e,this.loadRegion(c,a),d=f.indexModelBinary(c,p,"top","height"),b=f.indexModelBinary(a,p,"top","height"),m=b-1;m>=d;m--)i=p[m],!1===i.get("isView")&&(i.set("isView",!0),this.addHeadItemView(i),this.addRowHeadItemViewPublish(i));if(d<b)for(j=q.getCellByRow(d,b),m=0,n=j.length;m<n;m++)!1===j[m].get("showState")&&(j[m].set("showState",!0),this.addCellView(j[m]),this.addCellViewPublish(j[m]));this.adjustColPropCell(d,b),g.viewRegion.top=p[d].get("top")},deleteBottom:function(a){var b,c,d,e,i,j,k,l,m=o.models;for(i=this.offsetTop,j=this.userViewTop,b=f.indexModelBinary(a,m,"top","height"),c=this.el.scrollTop+this.el.offsetHeight+h.System.prestrainHeight+i+j,d=f.indexModelBinary(c,m,"top","height"),k=d+1;k<=b;k++)m[k].destroyView();for(e=q.getCellByRow(d+1,void 0),k=0,l=e.length;k<l;k++)cellRowAliasArray=e[k].get("occupy").y,-1===cellRowAliasArray.indexOf(void 0)&&e[k].hide();g.viewRegion.bottom=m[d].get("top")+m[d].get("height")},addBottom:function(a){var b,c,d,e,i,j,k,l,m,n,p,r,s=o.models;if(l=this.offsetTop,m=this.userViewTop,b=this.el.scrollTop-h.System.prestrainHeight+l+m,c=this.el.scrollTop+this.el.offsetHeight+h.System.prestrainHeight+l+m,!(a>c)){for(a=a>b?a:b,j=this.loadRegion(a,c),k=this.addRows(c),this.adaptSelectRegion(),e=f.indexModelBinary(a,s,"top","height"),d=f.indexModelBinary(c,s,"top","height"),p=e+1;p<=d;p++)i=s[p],!1===i.get("isView")&&(i.set("isView",!0),this.addHeadItemView(i),this.addRowHeadItemViewPublish(i));n=q.getCellByRow(e,d);for(var p=0,r=n.length;p<r;p++)!1===n[p].get("showState")&&(n[p].set("showState",!0),this.addCellView(n[p]),this.addCellViewPublish(n[p]));j=j||c,c=c>j?c:j,c=c>k?c:k,d=f.indexModelBinary(c,s,"top","height"),this.adjustColPropCell(e,d),g.viewRegion.bottom=s[d].get("top")+s[d].get("height")}},loadRegion:function(a,b){var c,d,e,h,i,j,k=o.models;return a>g.localRowPosi||0===g.localRowPosi?b:(b=b<g.localRowPosi?b:g.localRowPosi,c=m.isUnloadPosi(a,b,g.rowRegionPosi),d=m.isUnloadPosi(a,b,g.cellRegionPosi.vertical),(c||d)&&(b+=g.scrollBufferHeight),b=b<g.localRowPosi?b:g.localRowPosi,c&&(this.requestRows(a,b),j=o.getMaxDistanceHeight(),this.adjustContainerHeight(j),this.publish(j,"adjustHeadItemContainerPublish"),this.publish(j,"adjustContainerHeightPublish"),e=f.indexModelBinary(a,k,"top","height"),h=f.indexModelBinary(b,k,"top","height"),m.insertPosi(k[e].get("top"),k[h].get("top")+k[h].get("height"),g.rowRegionPosi),i=b),d&&(this.requestCells(a,b),e=f.indexModelBinary(a,k,"top","height"),h=f.indexModelBinary(b,k,"top","height"),m.insertPosi(k[e].get("top"),k[h].get("top")+k[h].get("height"),g.cellRegionPosi.vertical)),i)},requestRows:function(b,c){k.PackAjax({url:"excel.htm?m=openexcel",async:!1,isPublic:!1,data:JSON.stringify({excelId:a.SPREADSHEET_AUTHENTIC_KEY,sheetId:"1",rowBegin:b,rowEnd:c}),success:function(a){if(""!==a){var b;b=a.dataRowStartIndex,g.localRowPosi=a.maxRowPixel;var c=a.returndata.spreadSheet[0].sheet.glY;i.analysisRowData(c,b)}}})},requestCells:function(b,c){k.PackAjax({url:"excel.htm?m=openexcel",async:!1,isPublic:!1,data:JSON.stringify({excelId:a.SPREADSHEET_AUTHENTIC_KEY,sheetId:"1",rowBegin:b,rowEnd:c}),success:function(a){if(""!==a){var b=a.returndata.spreadSheet[0].sheet.cells;i.analysisCellData(b)}}})},adaptSelectRegion:function(){var a,b,c,d,e,g=r.getModelByType("operation")[0],h=o.models,i=g.get("wholePosi").endX,j=g.get("wholePosi").endY;if("MAX"===i||"MAX"===j)for("MAX"===j&&(b=g.get("physicsBox").height,a=f.modelBinary(b-1,h,"top","height",0,h.length-1),c=o.length,e=o.models[c-1],b=e.get("top")+e.get("height")-1,g.set("physicsBox.height",b),p.models[0].set({height:b})),d=a+1;d<c;d++)h[d].set("activeState",!0)},preventAutoScroll:function(){var a,b,c,d;this.isPreventScroll&&(a=this.viewBodyContainer.mousePageX-(this.viewBodyContainer.el.offsetWidth-this.el.offsetWidth),c=this.viewBodyContainer.mousePageY-(this.viewBodyContainer.el.offsetHeight-this.el.offsetHeight-h.System.outerBottom),d=c-this.el.clientHeight,b=a-this.el.clientWidth,b>=0||a<=0?this.el.scrollLeft=this.recordScrollLeft:(this.recordScrollLeft=this.el.scrollLeft,this.publish(this.recordScrollLeft,"transversePublish")),d>=0||c<=0?this.el.scrollTop=this.recordScrollTop:(this.recordScrollTop=this.el.scrollTop,this.publish(this.recordScrollTop,"verticalPublish"))),!this.isPreventScroll&&this.currentRule.eventScroll&&(this.recordScrollLeft!==this.el.scrollLeft&&(this.recordScrollLeft=this.el.scrollLeft,this.publish(this.recordScrollLeft,"transversePublish")),this.recordScrollTop!==this.el.scrollTop&&(this.recordScrollTop=this.el.scrollTop,this.publish(this.recordScrollTop,"verticalPublish"))),this.isPreventScroll=!0},adaptRowHeightChange:function(a,b){var c,d;g.viewRegion.top>a&&(g.viewRegion.top+=b,c=o.getModelByPosition(this.recordScrollTop),g.UserView.rowAlias=c.get("alias"),b>0?this.addTop(g.viewRegion.top):this.deleteTop(g.viewRegion.top)),g.viewRegion.bottom>a&&(g.viewRegion.bottom+=b,d=o.getModelByPosition(this.recordScrollTop+this.el.offsetHeight),g.UserView.rowEndAlias=d.get("alias"),b>0?this.deleteBottom(g.viewRegion.bottom):this.addBottom(g.viewRegion.bottom)),m.adaptPosi(a,b,g.rowRegionPosi),m.adaptPosi(a,b,g.cellRegionPosi.vertical),0!==g.localRowPosi&&(g.localRowPosi+=b)},addCol:function(){var a,b,c=0;for(a=h.User.addCol,b=n.length;c<a;)n.add({alias:(b+1).toString(),left:b*h.User.cellWidth,width:h.User.cellWidth-1,displayName:l.buildColAlias(b)}),b++,c++;this.cellsContainer.attributesRender({width:n.getMaxDistanceWidth(),height:o.getMaxDistanceHeight()}),this.viewColsAllHeadContainer.$el.css({width:n.getMaxDistanceWidth()})},addRows:function(a){var b,c=o.getMaxDistanceHeight(),d=g.localRowPosi,e=o.length;return a<=c||a<=d?a:(c=c>d?c:d,b=Math.ceil((a+g.scrollBufferHeight-c)/h.User.cellHeight),o.generate(b),k.PackAjax({url:"sheet.htm?m=addrowline",data:JSON.stringify({rowNum:b})}),this.adjustColPropCell(e,e+b-1),a=o.getMaxDistanceHeight(),this.adjustContainerHeight(a),this.publish(a,"adjustHeadItemContainerPublish"),this.publish(a,"adjustContainerHeightPublish"),a)},adjustColPropCell:function(a,c){var d,e,f,h,i,j,k,l,m,p=0;for(d=n.models,e=o.models,l=d.length,j=g.CellsPosition.strandX;p<l;p++)if(f=d[p],k=f.get("operProp"),!b.isEmptyObject(k))for(m=a;m<c+1;m++)h=d[p].get("alias"),i=e[m].get("alias"),void 0!==j[h]&&void 0!==j[h][i]||q.createCellModel(p,m,k)},adjustContainerHeight:function(a){this.cellsContainer.attributesRender({height:a})},destroy:function(){e.off("call:mainContainer"),e.off("event:mainContainer:destroy"),e.off("event:mainContainer:attributesRender"),this.cellsContainer.destroy(),this.remove()}})}),b("views/headItemColContainer",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("lib/handlebars"),e=c("collections/headItemCol"),f=c("basic/tools/cache"),g=c("basic/util/clone");return b.View.extend({className:"col-head-item",initialize:function(){this.listenTo(this.model,"change:activeState",this.toggleActive),this.listenTo(this.model,"change:isView",this.destroy),this.listenTo(this.model,"change:hidden",this.destroy),this.listenTo(this.model,"change:left",this.changeLeft),this.listenTo(this.model,"change:width",this.changeWidth),this.listenTo(this.model,"change:displayName",this.changeDisplayName),this.listenTo(this.model,"change:isLeftAjacentHide",this.changeLeftAjacentHide),this.listenTo(this.model,"change:isRightAjacentHide",this.changeRightAjacentHide),this.listenTo(this.model,"destroy",this.remove),this.currentRule=g.clone(f.CurrentRule),this.offsetLeft=f.TempProp.isFrozen?this.currentRule.displayPosition.offsetLeft||0:0},render:function(){return this.template=d.compile(a("#tempColHeadItem").html()),this.changeLeft(),this.changeRightAjacentHide(),this.$el.html(this.template(this.model.toJSON())).data("alias",this.model.get("alias")),this.toggleActive(),this},toggleActive:function(){this.$el.toggleClass("active",this.model.toJSON().activeState)},changeLeft:function(){var a,b=this.model.toJSON(),c=b.left,d=0;this.currentRule.reduceUserView&&(a=e.getModelByAlias(f.UserView.colAlias),d=a.toJSON().left),b.isLeftAjacentHide&&c++,this.$el.css({left:c-this.offsetLeft-d})},changeWidth:function(){var a=this.model.toJSON(),b=a.width;a.isLeftAjacentHide&&b--,a.isRightAjacentHide&&b--,this.$el.css({width:b})},changeRightAjacentHide:function(){this.model.toJSON().isRightAjacentHide?(this.changeWidth(),this.$el.css({"border-right":"3px double #d4d4d4"})):(this.changeWidth(),this.$el.removeAttr("border-right"))},changeLeftAjacentHide:function(){this.changeWidth(),this.changeLeft()},changeDisplayName:function(){this.$el.children(".item").html(this.model.get("displayName"))},changeView:function(){!1===this.model.toJSON().isView&&this.destroy()},destroy:function(){this.model.get("isView")&&!this.model.get("hidden")||this.remove()}})}),b("views/colsSpaceLineContainer",function(){var a=c("lib/backbone");return a.View.extend({className:"col-space-container",initialize:function(b){a.on("call:colsSpaceLineContainer",this.callColsSpaceLineContainer,this),a.on("event:colsSpaceLineContainer:destroy",this.destroy,this),this.boxAttributes=b.boxAttributes},render:function(){return this.attributesRender(this.boxAttributes),this},callColsSpaceLineContainer:function(a){a(this)},attributesRender:function(a){this.$el.css({left:a.left})},destroy:function(){this.remove()}})}),b("views/colsHeadContainer",function(){var a=c("lib/jquery"),b=c("lib/underscore"),d=c("lib/backbone"),e=c("spreadsheet/config"),f=c("basic/util/binary"),g=c("basic/tools/cache"),h=c("basic/tools/send"),i=c("basic/tools/buildalias"),j=c("collections/headItemRow"),k=c("collections/headItemCol"),l=c("collections/cells"),m=c("collections/selectRegion"),n=(c("collections/siderLineRow"),c("collections/siderLineCol")),o=c("views/headItemColContainer"),p=c("views/colsSpaceLineContainer"),q=c("entrance/cell/selectcellrows");return d.View.extend({className:"col-head-panel",initialize:function(){g.TempProp.isFrozen||this.delegateEvents({"mousedown .col-head-item":"transAction","mousemove .col-head-item":"overEffect"}),d.on("call:colsHeadContainer",this.callColsHeadContainer,this),d.on("event:colsHeadContainer:relaseSpaceEffect",this.relaseSpaceEffect,this),d.on("event:colWidthAdjust",this.colWidthAdjust,this),d.on("event:restoreHideCols",this.restoreHideCols,this),this.colNumber=0,this.listenTo(k,"add",this.addColsHeadContainer)},render:function(){var a,b,c,d,e=0,f=k;for(a=b=f.models,g.TempProp.isFrozen&&(this.currentRule=g.CurrentRule,b=void 0!==this.currentRule.displayPosition.endIndex?a.slice(this.currentRule.displayPosition.startIndex,this.currentRule.displayPosition.endColIndex):a.slice(this.currentRule.displayPosition.startIndex)),c=b.length;e<c;e++)b[e].get("hidden")||this.addColsHeadContainer(b[e]),this.colNumber++;return d=f.where({activeState:!0}),0===d.length&&a[0].set("activeState",!0),this.triggerCallback(),this},triggerCallback:function(){b.bindAll(this,"callView"),d.trigger("call:screenContainer",this.callView("viewScreenContainer")),d.trigger("call:mainContainer",this.callView("viewMainContainer")),d.trigger("call:cellsContainer",this.callView("viewCellsContainer")),d.trigger("call:colsAllHeadContainer",this.callView("viewColsAllHeadContainer"))},callColsHeadContainer:function(a){a(this)},overEffect:function(a){a.currentTarget.style.cursor=!0===this.isAdjustable(a)?"col-resize":""},isAdjustable:function(b){var c=this.itemEl||b.currentTarget;return b.pageX-a(c).offset().left>c.clientWidth-e.System.effectDistanceCol},transAction:function(a){if(!this.isAdjustable(a))return void this.colLocate(a);this.spaceEffect(a)},spaceEffect:function(b){this.itemEl=b.currentTarget,this.$itemEl=a(this.itemEl),this.cacheItemElOffsetWidth=this.itemEl.offsetWidth,this.$lockData=a(".col-head-item:gt("+this.$itemEl.index()+")",this.el),this.$tempSpaceContainer=a("<div/>").addClass("temp-space-container").html(this.$lockData),this.$el.append(this.$tempSpaceContainer),this.viewScreenContainer.mouseMoveHeadContainer(b,{spaceMouse:this.itemEl.clientWidth-b.offsetX,offsetleftByRight:this.itemEl.clientWidth+this.$itemEl.offset().left,self:this},this.moveEvent),this.colsSpaceLineContainer=new p({boxAttributes:{left:this.itemEl.offsetLeft+this.itemEl.clientWidth}}),a(".line-container").append(this.colsSpaceLineContainer.render().el)},relaseSpaceEffect:function(a){var b,c,d;this.$lockData&&(b=k.getIndexByAlias(this.$itemEl.data("alias")),d=this.itemEl.offsetWidth-this.cacheItemElOffsetWidth,c=d+k.models[b].get("width"),this.colWidthAdjust(b,c),this.$el.append(this.$lockData),this.$tempSpaceContainer.remove(),this.itemEl=this.$itemEl=this.$lockData=null)},colWidthAdjust:function(a,b){var c=b-k.models[a].get("width");this.adjustHeadLine(a,c),this.adjustCells(a,c),this.adjustSelectRegion(a,c),this.requstAdjust(a,c),this.triggerCallback(),this.viewCellsContainer.attributesRender({width:k.getMaxDistanceWidth(),height:j.getMaxDistanceHeight()}),this.viewColsAllHeadContainer.$el.css({width:k.getMaxDistanceWidth()})},restoreHideCols:function(){for(var a=k.models,b=a.length,c=0;c<b;c++)a[c].get("hidden")&&this.addColsHeadContainer(a[c])},requstAdjust:function(a,b){var c=k.models[a].get("sort");h.PackAjax({url:"cells.htm?m=cols_width",data:JSON.stringify({colSort:c,offset:b})})},moveEvent:function(a){var b=a.data,c=a.pageX+b.spaceMouse,d=parseInt(c-b.self.$itemEl.offset().left,0);d<e.System.effectDistanceCol||(b.self.$itemEl.css("width",d),b.self.$tempSpaceContainer.css("left",parseInt(c-b.offsetleftByRight,0)),b.self.colsSpaceLineContainer.attributesRender({left:parseInt(c-b.self.$el.offset().left,0)}))},addColsHeadContainer:function(a){this.headItemColContainer=new o({model:a}),this.$el.append(this.headItemColContainer.render().el)},createHeadItemCol:function(){k.add(this.newAttrCol())},newAttrCol:function(){return{alias:(this.colNumber+1).toString(),left:this.colNumber*e.User.cellWidth,width:e.User.cellWidth-1,displayName:i.buildColAlias(this.colNumber)}},callView:function(a){var b=this;return function(c){b[a]=c}},colLocate:function(b){var c,d,h,i=g.containerId;this.viewMainContainer||this.triggerCallback(),c=b.clientX-a("#"+i).offset().left-e.System.outerLeft+this.viewMainContainer.el.scrollLeft,j.models,h=k.models,d=f.modelBinary(c,h,"left","width",0,h.length-1),h[d],q("1",null,d,b)},adjustHeadLine:function(a,b){var c,d,e,f,g;for(e=k.models,f=e[a].get("width"),e[a].set("width",f+b),d=e.length,c=a+1;c<d;c++)g=e[c].get("left"),e[c].set("left",g+b)},adjustCells:function(a,b){var c,d,e,f,g,h;for(c=l.getCellsByColIndex(a,a),h=c.length,e=0;e<h;e++)c[e].set("physicsBox.width",c[e].get("physicsBox").width+b);for(g=k.length,d=l.getCellsInStartColRegion(a+1,g-1),h=d.length,f=0;f<h;f++)d[f].set("physicsBox.left",d[f].get("physicsBox").left+b)},adjustSelectRegion:function(a,b){var c,d,e,f,g,h,i,j;g=m.models[0],c=g.get("wholePosi").startX,d=g.get("wholePosi").endX,e=k.getIndexByAlias(c),(f=k.getIndexByAlias(d))<a||(h=n.models[0],e<=a?(i=g.get("physicsBox").width,g.set("physicsBox.width",i+b),h.set("width",i+b)):(j=g.get("physicsPosi").left,g.set("physicsPosi.left",j+b),h.set("left",j+b)))},destroy:function(){d.off("call:colsHeadContainer"),d.off("event:colsHeadContainer:relaseSpaceEffect"),d.off("event:colWidthAdjust"),d.off("event:restoreHideCols"),this.undelegateEvents(),this.headItemColContainer.destroy(),this.remove()}})}),b("views/siderLineColContainer",function(){var a=c("lib/backbone"),b=c("basic/tools/cache"),d=c("basic/util/clone"),e=c("collections/headItemCol");return a.View.extend({className:"col-head-line",initialize:function(){var a;this.listenTo(this.model,"change",this.render),this.currentRule=d.clone(b.CurrentRule),a=e,this.userViewLeft=b.TempProp.isFrozen?a.getModelByAlias(b.UserView.colAlias).get("left"):0,this.offsetLeft=b.TempProp.isFrozen?this.currentRule.displayPosition.offsetLeft||0:0},render:function(){var a=this.model.toJSON();return this.$el.css({left:a.left-this.offsetLeft-this.userViewLeft,width:a.width-2}),this},destroy:function(){this.remove()}})}),b("views/colsAllHeadContainer",function(){var a=c("lib/backbone"),b=c("collections/siderLineCol"),d=c("collections/headItemCol"),e=c("spreadsheet/config"),f=c("views/colsHeadContainer"),g=c("views/siderLineColContainer");return a.View.extend({className:"col-head-bg col-head-height",initialize:function(c){a.on("call:colsAllHeadContainer",this.callColsAllHeadContainer,this),a.on("event:colsAllHeadContainer:adaptWidth",this.adaptWidth,this),this.listenTo(b,"add",this.addSiderLineCol),this.boxAttributes=c.boxAttributes},render:function(){
var a,c=b.models,d=c.length;if(this.colsHeadContainer=new f,this.attributesRender(this.boxAttributes),this.$el.append(this.colsHeadContainer.render().el),0===d)this.createSiderLineCol();else for(a=d-1;a>=0;a--)this.addSiderLineCol(c[a]);return this},callColsAllHeadContainer:function(a){a(this)},attributesRender:function(a){-1!==a.width&&this.$el.css({width:a.width})},adaptWidth:function(){var a=d.length,b=d.models[a-1].get("width"),c=d.models[a-1].get("left");this.$el.css({width:c+b})},addSiderLineCol:function(a){this.siderLineColContainer=new g({model:a}),this.$el.append(this.siderLineColContainer.render().el)},createSiderLineCol:function(){b.add({left:0,width:e.User.cellWidth-1})},destroy:function(){a.off("call:colsAllHeadContainer"),a.off("event:colsAllHeadContainer:adaptWidth"),this.colsHeadContainer.destroy(),this.remove()}})}),b("views/colsPanelContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=c("basic/tools/cache"),d=c("spreadsheet/config"),e=(c("basic/util/clone"),c("collections/headItemCol")),f=c("views/colsAllHeadContainer");return a.View.extend({className:"col-head-container",initialize:function(c){var f,g,h,i;if(a.on("call:colsPanelContainer",this.colsPanelContainer,this),a.on("event:colsPanelContainer:destroy",this.destroy,this),a.trigger("event:colsPanelContainer:adjustWidth",this.adjustWidth,this),this.boxModel={},this.cacheDiffDistance=0,this.currentRule=b.CurrentRule,this.boxAttributes=this.currentRule.boxAttributes,g=f=e.models,b.TempProp.isFrozen&&(g=this.currentRule.displayPosition.endIndex?f.slice(this.currentRule.displayPosition.startIndex,this.currentRule.displayPosition.endIndex):f.slice(this.currentRule.displayPosition.startIndex)),0===(i=g.length))return void(this.boxModel.width=d.User.initColNum*d.User.cellWidth-1);h=g[i-1],this.boxModel.width=this.currentRule.autoScroll?h.get("left")+h.get("width")-g[0].get("left"):-1},render:function(){return this.colsAllHeadContainer=new f({boxAttributes:{width:this.boxModel.width}}),this.attributesRender(this.boxAttributes),this.$el.html(this.colsAllHeadContainer.render().el),this},colsPanelContainer:function(a){a(this)},attributesRender:function(a){-1!==a.width&&this.$el.css({width:a.width}),a.style&&this.$el.addClass(a.style)},scrollToPosition:function(a){this.$el.scrollLeft(a)},destroy:function(){a.off("call:colsPanelContainer"),a.off("event:colsPanelContainer:destroy"),this.colsAllHeadContainer.destroy(),this.remove()}})}),b("views/rowsSpaceLineContainer",function(){var a=c("lib/backbone");return a.View.extend({className:"row-space-container",initialize:function(b){a.on("call:rowsSpaceLineContainer",this.callRowsSpaceLineContainer,this),a.on("event:rowsSpaceLineContainer:destroy",this.destroy,this),this.boxAttributes=b.boxAttributes},render:function(){return this.attributesRender(this.boxAttributes),this},callRowsSpaceLineContainer:function(a){a(this)},attributesRender:function(a){this.$el.css({top:a.top})},destroy:function(){this.remove()}})}),b("views/headItemRowContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=c("lib/handlebars"),e=c("collections/headItemRow"),f=c("basic/tools/cache");c("basic/util/clone"),c("spreadsheet/config");return b.View.extend({className:"row-head-item",initialize:function(a){this.listenTo(this.model,"change:activeState",this.toggleActive),this.listenTo(this.model,"change:top",this.changeTop),this.listenTo(this.model,"change:height",this.changeHeight),this.listenTo(this.model,"change:displayName",this.changeDisplayName),this.listenTo(this.model,"destroy",this.remove),this.offsetTop=f.TempProp.isFrozen?a.frozenTop||0:0,this.reduceUserView=a.reduceUserView,this.endIndex=a.endIndex,!0===f.TempProp.isFrozen&&void 0!==this.endIndex||this.listenTo(this.model,"change:isView",this.destroy)},render:function(){return this.template=d.compile(a("#tempRowHeadItem").html()),this.changeTop(),this.changeHeight(),this.$el.html(this.template(this.model.toJSON())).data("alias",this.model.get("alias")),this.toggleActive(),this},toggleActive:function(){this.$el.toggleClass("active",this.model.toJSON().activeState)},changeTop:function(){var a,b=0;f.TempProp.isFrozen&&(a=e.getModelByAlias(f.UserView.rowAlias),b=a.toJSON().top),this.$el.css({top:this.model.toJSON().top-this.offsetTop-b})},changeHeight:function(){this.$el.css({height:this.model.toJSON().height})},changeDisplayName:function(){this.$el.children(".item").html(this.model.get("displayName"))},destroy:function(){this.remove()}})}),b("views/rowsHeadContainer",function(){var a=c("lib/jquery"),b=c("lib/underscore"),d=c("lib/backbone"),e=c("spreadsheet/config"),f=c("basic/tools/cache"),g=c("basic/util/binary"),h=c("basic/tools/send"),i=c("collections/headItemRow"),j=c("collections/headItemCol"),k=c("collections/cells"),l=c("collections/selectRegion"),m=c("collections/siderLineRow"),n=(c("collections/siderLineCol"),c("views/rowsSpaceLineContainer")),o=c("views/headItemRowContainer"),p=(c("basic/tools/loadrecorder"),c("entrance/cell/selectcellcols"));return d.View.extend({className:"row-head-panel",initialize:function(a){f.TempProp.isFrozen||this.delegateEvents({"mousedown .row-head-item":"transAction","mousemove .row-head-item":"overEffect"}),d.on("call:rowsHeadContainer",this.callRowsHeadContainer,this),d.on("event:rowsHeadContainer:relaseSpaceEffect",this.relaseSpaceEffect,this),d.on("event:rowHeightAdjust",this.rowHeightAdjust,this),this.rowNumber=0,this.currentRule=f.CurrentRule,!0===f.TempProp.isFrozen&&void 0!==this.currentRule.displayPosition.endIndex||this.listenTo(i,"add",this.addRowsHeadContainer)},render:function(){var a,b,c,d,e=0,g=i;for(a=b=g.models,f.TempProp.isFrozen&&(b=void 0!==this.currentRule.displayPosition.endIndex?a.slice(this.currentRule.displayPosition.startIndex,this.currentRule.displayPosition.endIndex):a.slice(this.currentRule.displayPosition.startIndex)),c=b.length;e<c;e++)this.addRowsHeadContainer(b[e],!0),this.rowNumber++;return d=g.where({activeState:!0}),0===d.length&&a[0].set("activeState",!0),this.triggerCallback(),this},triggerCallback:function(){b.bindAll(this,"callView"),d.trigger("call:screenContainer",this.callView("viewScreenContainer")),d.trigger("call:mainContainer",this.callView("viewMainContainer")),d.trigger("call:cellsContainer",this.callView("viewCellsContainer")),d.trigger("call:rowsAllHeadContainer",this.callView("viewRowsAllHeadContainer"))},callRowsHeadContainer:function(a){a(this)},overEffect:function(a){a.currentTarget.style.cursor=!0===this.isAdjustable(a)?"row-resize":""},isAdjustable:function(b){var c=this.itemEl||b.currentTarget;return b.pageY-a(c).offset().top>c.clientHeight-e.System.effectDistanceRow},transAction:function(a){if(!this.isAdjustable(a))return void this.rowLocate(a);this.spaceEffect(a)},callView:function(a){var b=this;return function(c){b[a]=c}},spaceEffect:function(b){this.itemEl=b.currentTarget,this.cacheItemElOffsetHeight=this.itemEl.offsetHeight,this.$itemEl=a(this.itemEl),this.$lockData=a(".row-head-item:gt("+this.$itemEl.index()+")",this.el),this.$tempSpaceContainer=a("<div/>").addClass("temp-space-container").html(this.$lockData),this.$el.append(this.$tempSpaceContainer),this.viewScreenContainer.mouseMoveHeadContainer(b,{spaceMouse:this.itemEl.clientHeight-b.offsetY,offsetTopByBottom:this.itemEl.clientHeight+this.$itemEl.offset().top,self:this},this.moveEvent),this.rowsSpaceLineContainer=new n({boxAttributes:{top:this.itemEl.offsetTop+this.itemEl.clientHeight}}),a(".line-container").append(this.rowsSpaceLineContainer.render().el)},moveEvent:function(a){var b=a.data,c=a.pageY+b.spaceMouse,d=parseInt(c-b.self.$itemEl.offset().top,0);d<e.System.effectDistanceRow||(b.self.$itemEl.css("height",d),b.self.$tempSpaceContainer.css("top",parseInt(c-b.offsetTopByBottom,0)),b.self.rowsSpaceLineContainer.attributesRender({top:parseInt(c-b.self.$el.offset().top,0)}))},relaseSpaceEffect:function(a){var b,c,d,e;this.$lockData&&(c=i.models,c.length,d=i.getIndexByAlias(this.$itemEl.data("alias")),e=this.itemEl.offsetHeight-this.cacheItemElOffsetHeight,b=e+i.models[d].get("height"),this.rowHeightAdjust(d,b),this.$el.append(this.$lockData),this.$tempSpaceContainer.remove(),this.itemEl=this.$itemEl=this.$lockData=null)},rowHeightAdjust:function(a,b){var c=b-i.models[a].get("height");this.adjustHeadLine(a,c),this.adjustCells(a,c),this.adjustSelectRegion(a,c),this.requstAdjust(a,c),void 0!==this.viewCellsContainer&&void 0!==this.viewRowsAllHeadContainer||this.triggerCallback(),this.viewCellsContainer.attributesRender({width:j.getMaxDistanceWidth(),height:i.getMaxDistanceHeight()}),this.viewRowsAllHeadContainer.$el.css({height:i.getMaxDistanceHeight()}),d.trigger("event:mainContainer:adaptRowHeightChange",i.models[a].get("top"),c)},requstAdjust:function(a,b){var c=i.models[a].get("sort");h.PackAjax({url:"cells.htm?m=rows_height",data:JSON.stringify({rowSort:c,offset:b})})},rowLocate:function(b){var c,d,h,j=f.containerId;this.viewMainContainer||this.triggerCallback(),c=b.clientY-e.System.outerTop-a("#"+j).offset().top+this.viewMainContainer.el.scrollTop,h=i.models,d=g.modelBinary(c,h,"top","height",0,h.length-1),p("1",null,d,b)},addRowsHeadContainer:function(a,b){this.headItemRowContainer=new o({model:a,frozenTop:this.currentRule.displayPosition.offsetTop,reduceUserView:this.currentRule.reduceUserView,endIndex:this.currentRule.displayPosition.endIndex}),!0===b||a.get("top")?this.$el.append(this.headItemRowContainer.render().el):this.$el.prepend(this.headItemRowContainer.render().el)},createHeadItemRow:function(){i.add(this.newAttrRow())},newAttrRow:function(){return{alias:(this.rowNumber+1).toString(),top:20*this.rowNumber,height:19,displayName:buildAlias.buildRowAlias(this.rowNumber)}},adjustHeadLine:function(a,b){var c,d,e,f,g;for(e=i.models,f=e[a].get("height"),e[a].set("height",f+b),d=e.length,c=a+1;c<d;c++)g=e[c].get("top"),e[c].set("top",g+b)},adjustCells:function(a,b){var c,d,e,f,g,h,j=k;for(c=j.getCellByRow(a,a),h=c.length,e=0;e<h;e++)c[e].set("physicsBox.height",c[e].get("physicsBox").height+b);for(g=i.length,d=j.getCellsInStartRowRegion(a+1,g-1),h=d.length,f=0;f<h;f++)d[f].set("physicsBox.top",d[f].get("physicsBox").top+b)},adjustSelectRegion:function(a,b){var c,d,e,f,g,h,j,k;g=l.models[0],e=g.get("wholePosi").startY,f=g.get("wholePosi").endY,c=i.getIndexByAlias(e),(d=i.getIndexByAlias(f))<a||(h=m.models[0],c<=a?(j=g.get("physicsBox").height,g.set("physicsBox.height",j+b),h.set("height",j+b)):(k=g.get("physicsPosi").top,g.set("physicsPosi.top",k+b),h.set("top",k+b)))},destroy:function(){d.off("call:rowsHeadContainer"),d.off("event:rowsHeadContainer:relaseSpaceEffect"),d.off("event:rowHeightAdjust"),this.undelegateEvents(),this.remove()}})}),b("views/siderLineRowContainer",function(){var a=c("lib/backbone"),b=c("basic/tools/cache"),d=c("basic/util/clone"),e=c("collections/headItemRow");return a.View.extend({className:"row-head-line",initialize:function(){var a;this.listenTo(this.model,"change",this.render),this.currentRule=d.clone(b.CurrentRule),a=e,this.userViewTop=b.TempProp.isFrozen?a.getModelByAlias(b.UserView.rowAlias).get("top"):0,this.offsetTop=b.TempProp.isFrozen?this.currentRule.displayPosition.offsetTop||0:0},render:function(){var a=this.model.toJSON();return this.$el.css({top:a.top-this.offsetTop-this.userViewTop,height:a.height-2}),this},destroy:function(){this.remove()}})}),b("views/rowsAllHeadContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=c("collections/siderLineRow"),d=c("views/rowsHeadContainer"),e=c("views/siderLineRowContainer");return a.View.extend({className:"row-head-bg row-head-width",initialize:function(c){a.on("call:rowsAllHeadContainer",this.callRowsAllHeadContainer,this),this.listenTo(b,"add",this.addSiderLineRow),this.boxAttributes=c.boxAttributes},render:function(){var a,c=b.models,e=c.length;if(this.rowsHeadContainer=new d,this.attributesRender(this.boxAttributes),this.$el.append(this.rowsHeadContainer.render().el),0===e)this.createSiderLineRow();else for(a=e-1;a>=0;a--)this.addSiderLineRow(c[a]);return this},callRowsAllHeadContainer:function(a){a(this)},attributesRender:function(a){-1!==a.height&&this.$el.css({height:a.height})},addSiderLineRow:function(a){this.siderLineRowContainer=new e({model:a}),this.$el.append(this.siderLineRowContainer.render().el)},createSiderLineRow:function(){b.add({top:0,height:config.User.cellHeight-1})},destroy:function(){a.off("call:rowsAllHeadContainer"),this.siderLineRowContainer.destroy(),this.rowsHeadContainer.destroy(),this.remove()}})}),b("views/rowsPanelContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=c("basic/tools/cache"),d=c("spreadsheet/config"),e=c("basic/util/clone"),f=c("collections/headItemRow"),g=c("views/rowsAllHeadContainer");return a.View.extend({className:"row-head-container",initialize:function(c){var g,h,i,j;if(a.on("call:rowsPanelContainer",this.rowsPanelContainer,this),a.on("event:rowsPanelContainer:destroy",this.destroy,this),this.boxModel={},this.currentRule=e.clone(b.CurrentRule),this.boxAttributes=this.currentRule.boxAttributes,h=g=f.models,b.TempProp.isFrozen&&(h=this.currentRule.displayPosition.endIndex?g.slice(this.currentRule.displayPosition.startIndex,this.currentRule.displayPosition.endIndex):g.slice(this.currentRule.displayPosition.startIndex)),0===(j=h.length))return void(this.boxModel.height=d.User.initRowNum*d.User.cellHeight-1);i=g[j-1],this.boxModel.height=this.currentRule.autoScroll?i.get("top")+i.get("height")-g[0].get("top"):-1},render:function(){return this.rowsAllHeadContainer=new g({boxAttributes:{height:this.boxModel.height},startY:this.startY,endY:this.endY}),this.attributesRender(this.boxAttributes),this.$el.html(this.rowsAllHeadContainer.render().el),this},rowsPanelContainer:function(a){a(this)},attributesRender:function(a){-1!==a.height&&this.$el.css({height:a.height}),a.style&&this.$el.addClass(a.style)},scrollToPosition:function(a){this.$el.scrollTop(a)},destroy:function(){a.off("call:rowsPanelContainer"),a.off("event:rowsPanelContainer:destroy"),this.rowsAllHeadContainer.destroy(),this.remove()},adjustHeadItemContainer:function(a){this.rowsAllHeadContainer.$el.css({height:a})},addHeadItemView:function(a){this.rowsAllHeadContainer.rowsHeadContainer.addRowsHeadContainer(a)}})}),b("views/inputContainer",function(){var b=c("lib/backbone"),d=c("basic/tools/cache"),e=c("basic/tools/gettextbox"),f=c("spreadsheet/config"),g=c("basic/tools/send"),h=c("models/cell"),i=c("collections/headItemRow"),j=c("collections/headItemCol"),k=c("collections/selectRegion"),l=c("collections/cells"),m=c("entrance/tool/settexttype"),n=c("entrance/tool/clipselectoperate"),o=c("entrance/tool/clippasteoperate");return b.View.extend({tagName:"textarea",className:"edit-frame",events:{input:"adapt",propertychange:"adapt",keydown:"keypressHandle",blur:"hide",copy:"copyData",paste:"pasteData",cut:"cutData"},initialize:function(){b.on("event:InputContainer:show",this.show,this),b.on("event:InputContainer:hide",this.hide,this)},show:function(a){var c,e,f,g,h,m,n,o,p,q,r;o=k.getModelByType("clip")[0],void 0!==o&&(d.clipState="null",o.destroy()),n=k.getModelByType("operation")[0],g=n.get("wholePosi").startX,h=j.getIndexByAlias(g),f=n.get("wholePosi").startY,m=i.getIndexByAlias(f),b.trigger("call:mainContainer",function(a){c=a}),this.rowIndex=m,this.colIndex=h,this.mainContainer=c,r=l.getRegionCells(h,m)[0],null===r&&(r=this.createCell(m,h)),this.model=r,this.showState=!0,p=this.getAbsoluteLeft(),q=this.getAbsoluteTop(),this.adjustZIndex(),!1===a&&this.model.set("content.texts",""),e=this.model.toJSON(),!0===e.content.bd?this.$el.css({"font-weight":"bold"}):this.$el.css({"font-weight":"normal"}),!0===e.content.italic?this.$el.css({"font-style":"italic"}):this.$el.css({"font-style":"normal"}),this.$el.css({color:e.content.color,"font-size":e.content.size+"pt","font-family":e.content.family,left:p,top:q}),!1!==a&&this.$el.val(e.content.texts),this.adjustWidth(!0),this.adjustHeight()},pasteData:function(b){if(!1===this.showState){b.preventDefault();var c;c=a.clipboardData&&a.clipboardData.getData?a.clipboardData.getData("Text"):b.originalEvent.clipboardData.getData("Text"),o(c)}},copyData:function(a){!1===this.showState&&n("copy",a)},cutData:function(a){!1===this.showState&&n("cut",a)},createCell:function(a,b){var c,e,f,g,k;g=j.models,k=i.models,e=g[b].get("alias"),f=k[a].get("alias");var m,n,o,p;return m=k[a].get("top"),n=g[b].get("left"),o=g[b].get("width"),p=k[a].get("height"),c=new h,c.set("occupy",{x:[e],y:[f]}),c.set("physicsBox",{top:m,left:n,width:o,height:p}),d.cachePosition(f,e,l.length),l.add(c),c},hide:function(a){!0===this.showState&&(this.$el.css({left:-1e3,top:-1e3,width:0,height:0,"z-index":-100}),this.model.set("content.texts",this.$el.val()),m.typeRecognize(this.model),m.generateDisplayText(this.model),this.sendData()),this.$el.val(""),void 0===a&&this.$el.focus(),this.showState=!1},transverseScroll:function(){var a;!0===this.showState&&(a=this.getAbsoluteLeft(),this.$el.css({left:a}))},verticalScroll:function(){var a;!0===this.showState&&(a=this.getAbsoluteTop(),this.$el.css({top:a}))},autoScrollLeft:function(){var a,b,c,d,e;a=this.mainContainer.$el[0].offsetWidth-this.mainContainer.$el[0].clientWidth,b=this.$el.position().left+this.$el.width(),c=this.$el.parent()[0].clientWidth-a,(e=c-b)<0&&(d=this.mainContainer.$el.scrollLeft(),this.mainContainer.$el.scrollLeft(d-e))},autoScrollTop:function(){var a,b,c,d,e;a=this.mainContainer.$el[0].offsetHeight-this.mainContainer.$el[0].clientHeight,b=this.$el.position().top+this.$el.height(),c=this.$el.parent()[0].clientHeight-a,(e=c-b)<0&&(d=this.mainContainer.$el.scrollTop()-e,this.mainContainer.$el.scrollTop(d))},getAbsoluteLeft:function(){var a,b,c,e,g,h,i,k;return k=this.colIndex,i=this.mainContainer,a=f.System.outerLeft,b=i.$el.scrollLeft(),h=j.models[k].get("left"),d.TempProp.colFrozen?(g=j.getIndexByAlias(d.TempProp.colAlias),g>k&&(b=0),e=j.getIndexByAlias(d.UserView.colAlias),c=j.models[e].get("left"),h-c+a-b+1):h+a-b+1},getAbsoluteTop:function(){var a,b,c,e,g,h,j,k;return j=this.rowIndex,h=this.mainContainer,a=f.System.outerTop,b=h.$el.scrollTop(),k=i.models[j].get("top"),d.TempProp.colFrozen?(g=i.getIndexByAlias(d.TempProp.rowAlias),g>j&&(b=0),e=i.getIndexByAlias(d.UserView.rowAlias),c=i.models[e].get("top"),k-c+a-b+1):k+a-b+1},adjustZIndex:function(){var a,b,c,e;a=this.colIndex,b=this.rowIndex,d.TempProp.colFrozen&&d.TempProp.rowFrozen?(c=j.getIndexByAlias(d.TempProp.colAlias),e=i.getIndexByAlias(d.TempProp.rowAlias),c>a&&e>b?this.$el.css({"z-index":"15"}):c>a||e>b?this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"9"})):d.TempProp.colFrozen?(c=j.getIndexByAlias(d.TempProp.colAlias),c>a?this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"9"})):d.TempProp.rowFrozen?(e=i.getIndexByAlias(d.TempProp.rowAlias),e>b?this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"9"})):this.$el.css({"z-index":"9"})},render:function(){return this.hide(),this},adapt:function(a){if(!0===this.showState)this.adjustWidth(a),this.adjustHeight(a);else{if(!1===this.keyHandle())return;this.showState,this.show(!1)}},adjustHeight:function(a){var b,c,d,f,g,h,i;return c=this.mainContainer.$el[0].offsetHeight-this.mainContainer.$el[0].clientHeight,d=this.$el.parent().height()-this.$el.position().top-c,f=this.model.get("physicsBox").height,i=this.$el.val(),g=this.model.get("content").size,h=this.$el.width(),b=e.getInputHeight(i,g,h),b=b>f?b:f,b<d?(this.$el.height(b),b):(this.$el.height(d),b)},adjustWidth:function(a){var b,c,d,f,g,h,i;return d=this.mainContainer.$el[0].offsetWidth-this.mainContainer.$el[0].clientWidth,h=this.$el.parent().width()-this.$el.position().left-d,i=this.model.get("physicsBox").width-1,!0===this.model.get("wordWrap")?void this.$el.width(i):(c=this.$el.val(),g=this.model.get("content").size,f=this.$el.width(),b=e.getInputWidth(c,g)+20,b=b>i?b:i,!0!==a&&(b=b>f?b:f),b<h?(this.$el.width(b),b):(this.$el.width(h),h))},sendData:function(){var b,c,d,e,f;b=this.$el.val(),c=this.model.get("occupy").x[0],d=this.model.get("occupy").y[0],f=i.getModelByAlias(d).get("sort"),e=j.getModelByAlias(c).get("sort"),g.PackAjax({url:"text.htm?m=data",data:JSON.stringify({excelId:a.SPREADSHEET_AUTHENTIC_KEY,sheetId:"1",coordinate:{startSortY:f,startSortX:e},content:encodeURIComponent(b)})}),b.indexOf("\n")>0&&!1===this.model.get("wordWrap")&&(this.model.set({wordWrap:!0}),g.PackAjax({url:"text.htm?m=wordwrap",data:JSON.stringify({excelId:a.SPREADSHEET_AUTHENTIC_KEY,sheetId:"1",coordinate:{startX:c,startY:d},wordWrap:!0})}))},isShortKey:function(a){var b,c=f.keyboard;for(b in c)if(c[b]===a)return!0;return!1},keypressHandle:function(a){var c,d,e=this;if(d=f.keyboard,(c=this.isShortKey(a.keyCode))&&f.shortcuts.enter&&!1===a.altKey&&a.keyCode===d.enter)return b.trigger("event:mainContainer:nextCellPosition","DOWN"),b.trigger("event:cellsContainer:selectRegionChange","DOWN"),!0===this.showState&&this.hide(),void a.preventDefault();if(!0===this.showState){if(c&&f.shortcuts.altEnter&&a.altKey)return function(a){var b=e.$el[0];if(document.selection)e.$el.focus(),e=document.selection.createRange(),e.text=a,e.$el.focus();else if(b.selectionStart||"0"===b.selectionStart){var c=b.selectionStart,d=b.selectionEnd,f=b.scrollTop;b.value=b.value.substring(0,c)+a+b.value.substring(d,b.value.length),e.$el.focus(),b.selectionStart=c+a.length,b.selectionEnd=c+a.length,b.scrollTop=f}else e.value+=a,e.$el.focus()}("\n"),void this.adjustHeight();this.autoScrollLeft(),this.autoScrollTop()}},keyHandle:function(){var a,b;return b=/[a-zA-Z0-9]/,a=this.$el.val(),!!b.test(a)||(this.$el.val(""),!1)},destroy:function(){b.off("event:InputContainer:show"),b.off("event:InputContainer:hide"),this.remove()}})}),b("views/commentcontainer",function(){var a=c("lib/backbone"),b=c("collections/headItemCol"),d=c("collections/headItemRow"),e=c("collections/selectRegion"),f=c("basic/tools/getoperregion"),g=c("spreadsheet/config"),h=c("collections/cells"),i=c("basic/tools/send"),j=c("basic/tools/cache"),k=c("entrance/row/rowoperation"),l=c("entrance/col/coloperation");return a.View.extend({tagName:"textarea",className:"comment",state:"show",events:{blur:"close"},initialize:function(c){var f,g,i,k,l;void 0!==c.colIndex?(this.colIndex=c.colIndex,this.rowIndex=c.rowIndex,this.comment=c.comment):(k=e.getModelByType("operation")[0],g=k.get("wholePosi").endX,i=k.get("wholePosi").startY,this.colIndex=b.getIndexByAlias(g),this.rowIndex=d.getIndexByAlias(i),"edit"===c.state&&k.get("wholePosi").endX===k.get("wholePosi").startX&&k.get("wholePosi").endY===k.get("wholePosi").startY?(l=h.getCellByVertical(this.colIndex,this.rowIndex),l.length>0&&(this.comment=l[0].get("customProp").comment||"")):this.comment=""),this.parentNode=c.parentNode,this.state=c.state,"show"!==this.state&&(j.commentEditState=!0),a.trigger("call:mainContainer",function(a){f=a}),this.mainContainer=f},render:function(){var a,b;return a=this.getAbsoluteLeft(),b=this.getAbsoluteTop(),this.adjustZIndex(),this.$el.css({left:a,top:b,width:g.User.commentWidth+"px",height:g.User.commentHeight+"px"}),this.$el.val(this.comment),"show"===this.state&&this.$el.attr("disabled",!0),this},transverseScroll:function(){var a;a=this.getAbsoluteLeft(),this.$el.css({left:a})},verticalScroll:function(){var a;a=this.getAbsoluteTop(),this.$el.css({top:a})},getAbsoluteLeft:function(){var a,c,d,e,f,h,i,k,l,m,n;return n=this.colIndex,i=this.mainContainer,a=g.System.outerLeft,c=i.$el.scrollLeft(),h="MAX"===n?0:b.models[n].get("left")+b.models[n].get("width"),j.TempProp.colFrozen?(f=b.getIndexByAlias(j.TempProp.colAlias),f>n&&(c=0),e=b.getIndexByAlias(j.UserView.colAlias),d=b.models[e].get("left"),h=h-d+a-c+1):h=h+a-c+1,l=h+g.User.commentWidth+1,k=this.parentNode.$el.width(),l>k&&(m=h-g.User.commentWidth-b.models[n].get("width")-10)>0&&(h=m),h},getAbsoluteTop:function(){var a,b,c,e,f,h,i,k;return i=this.rowIndex,h=this.mainContainer,a=g.System.outerTop,b=h.$el.scrollTop(),k=d.models[i].get("top"),j.TempProp.rowFrozen?(f=d.getIndexByAlias(j.TempProp.rowAlias),f>i&&(b=0),e=d.getIndexByAlias(j.UserView.rowAlias),c=d.models[e].get("top"),k-c+a-b+1):k+a-b+1},adjustZIndex:function(){var a,c,e,f;a=this.colIndex,c=this.rowIndex,j.TempProp.colFrozen&&j.TempProp.rowFrozen?(e=b.getIndexByAlias(j.TempProp.colAlias),f=d.getIndexByAlias(j.TempProp.rowAlias),e>a&&f>c?this.$el.css({"z-index":"15"}):e>a||f>c?this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"9"})):j.TempProp.colFrozen?(e=b.getIndexByAlias(j.TempProp.colAlias),e>a?this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"9"})):j.TempProp.rowFrozen?(f=d.getIndexByAlias(j.TempProp.rowAlias),f>c?this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"9"})):this.$el.css({"z-index":"9"})},close:function(){var a,c,f,g,i,m,n,o;if("show"!==this.state){if(a=this.$el.val(),a=a||"",c=e.getModelByType("operation")[0],g=b.getIndexByAlias(c.get("wholePosi").startX),i=d.getIndexByAlias(c.get("wholePosi").startY),"MAX"===c.get("wholePosi").endX)m="MAX",n=d.getIndexByAlias(c.get("wholePosi").endY),k.rowPropOper(i,"customProp.comment",a);else if("MAX"===c.get("wholePosi").endY)n="MAX",m=b.getIndexByAlias(c.get("wholePosi").endX),l.colPropOper(g,"customProp.comment",a);else{m=b.getIndexByAlias(c.get("wholePosi").endX),n=d.getIndexByAlias(c.get("wholePosi").endY),f=h.getFillCellsByRegion(i,g,n,m);for(o in f)f[o].set("customProp.comment",a)}this.sendData(a)}j.commentEditState=!1,this.remove()},sendData:function(a){var b;b=f().sendRegion,i.PackAjax({url:"text.htm?m=comment_set",data:JSON.stringify({coordinate:b,comment:a})})}})}),b("views/bodyContainer",function(){var b=c("lib/jquery"),d=c("lib/backbone"),e=(c("basic/tools/send"),c("spreadsheet/config")),f=c("basic/tools/cache"),g=c("basic/util/observer.pattern"),h=c("collections/headItemRow"),i=c("collections/headItemCol"),j=c("views/sheetsContainer"),k=c("views/mainContainer"),l=c("views/colsPanelContainer"),m=c("views/rowsPanelContainer"),n=c("views/inputContainer"),o=c("views/commentcontainer");return d.View.extend({events:{mousemove:"mouseInfo",mouseup:"getFocus"},initialize:function(){d.on("call:bodyContainer",this.callBodyContainer,this),d.on("event:bodyContainer:executiveFrozen",this.executiveFrozen,this),d.on("event:commentContainer:show",this.showCommentContainer,this),d.on("event:commentContainer:remove",this.removeCommentContainer,this),_.bindAll(this,"executiveFrozen","showCommentContainer","removeCommentContainer"),this.commentContainer=null},render:function(){this.inputContainer=new n,this.$el.find(".main-layout").append(this.inputContainer.render().el),this.calculation(),this.adaptScreen(),this.generateSheet(),this.$el.css({overflow:"hidden",position:"relative"}),this.inputContainer.$el.focus()},showCommentContainer:function(a){f.commentEditState||(a.parentNode=this,this.commentContainer=new o(a),this.publisherList.mainContainer.subscribe({master:this.commentContainer,behavior:"transverseScroll"},"transversePublish"),this.publisherList.mainContainer.subscribe({master:this.commentContainer,behavior:"verticalScroll"},"verticalPublish"),this.$el.find(".main-layout").append(this.commentContainer.render().el),"show"!==a.state&&this.commentContainer.$el.focus())},removeCommentContainer:function(a){null!==this.commentContainer&&"show"===this.commentContainer.state&&(this.publisherList.mainContainer.unsubscribe({master:this.commentContainer,behavior:"transverseScroll"},"transversePublish"),this.publisherList.mainContainer.unsubscribe({master:this.commentContainer,behavior:"verticalScroll"},"verticalPublish"),this.commentContainer.close(),this.commentContainer=null)},generateSheet:function(){var a=new j;this.sheetsView=a,this.$el.find(".sheet-cf-list").append(a.render().el)},getFocus:function(a){var c=b(":focus")[0];void 0!==c&&"textarea"===c.type||d.trigger("event:InputContainer:hide")},callView:function(a){var b=this;return function(c){b[a]=c}},saveUserView:function(){a.SPREADSHEET_AUTHENTIC_KEY,b("#sheetId").val(),f.UserView.rowAlias,f.UserView.colAlias},adaptScreen:function(){this.executiveFrozen()},clearFrozenRule:function(){f.FrozenRules={main:[],row:[],col:[]}},executiveFrozen:function(){function a(a){var b,c,d=f.CurrentRule;if(d.isPublisher&&(g.buildPublisher(a),j.publisherList[d.publisherName]=a),b=d.isSubscribe||!1)for(e=b.length,c=0;c<e;c++)j.publisherList[b[c].publisherName].subscribe({master:a,behavior:b[c].behavior,args:b[c].args},b[c].action)}var c,e,h,i="#"+this.el.id,j=this;if(this.clearFrozenRule(),this.ruleRow(),this.ruleCol(),this.ruleMain(),this.publisherList={},d.trigger("event:colsPanelContainer:destroy"),d.trigger("event:rowsPanelContainer:destroy"),d.trigger("event:mainContainer:destroy"),f.TempProp.colFrozen&&!f.TempProp.rowFrozen)for(e=f.FrozenRules.main.length,c=e-1;c>=0;c--)f.CurrentRule=f.FrozenRules.main[c],h=new k,b("tr:eq(1) td:eq("+(c+1)+")",i).prepend(h.render().el),a(h);else if(!f.TempProp.colFrozen&&f.TempProp.rowFrozen)for(e=f.FrozenRules.main.length,c=e-1;c>=0;c--)f.CurrentRule=f.FrozenRules.main[c],h=new k,b("tr:eq(1) td:eq(2)",i).prepend(h.render().el),a(h);else if(f.TempProp.colFrozen&&f.TempProp.rowFrozen){var n;for(c=4;c>0;c--)n=c%2?1:2,f.CurrentRule=f.FrozenRules.main[c-1],h=new k,b("tr:eq(1) td:eq("+n+")",i).prepend(h.render().el),a(h)}else f.TempProp.colFrozen||f.TempProp.rowFrozen||(f.CurrentRule=f.FrozenRules.main[0],h=new k,b("tr:eq(1) td:eq(2)",i).append(h.render().el),a(h));for(e=f.FrozenRules.col.length,c=0;c<e;c++){f.CurrentRule=f.FrozenRules.col[c];var o=new l;b("tr:eq(0) td:eq("+(3-e+c)+")",i).append(o.render().el),a(o)}for(e=f.FrozenRules.row.length,c=e-1;c>=0;c--){f.CurrentRule=f.FrozenRules.row[c];var p=new m;b("tr:eq(1) td:eq(0)",i).prepend(p.render().el),a(p)}this.publisherList.mainContainer.subscribe({master:this.inputContainer,behavior:"transverseScroll"},"transversePublish"),this.publisherList.mainContainer.subscribe({master:this.inputContainer,behavior:"verticalScroll"},"verticalPublish"),this.initMainView()},ruleCol:function(){var a,b,c,d,e,g,h;d=i,a=d.getIndexByAlias(f.TempProp.colAlias),-1===a&&(a=0),b=d.models[a],c=b.toJSON().left,g=d.getModelByAlias(f.UserView.colAlias),h=d.getIndexByAlias(f.UserView.colAlias),f.TempProp.isFrozen&&f.TempProp.colFrozen?(e={displayPosition:{offsetLeft:0,startIndex:h,startAlias:f.UserView.colAlias,endAlias:f.TempProp.colAlias,endIndex:a},boxAttributes:{width:c-g.toJSON().left-1,style:"frozen-right-border"},autoScroll:!1,reduceUserView:!0},f.FrozenRules.col.push(e)):c=0,e={displayPosition:{offsetLeft:c,startAlias:f.TempProp.colAlias,startIndex:a},boxAttributes:{width:this.scrollWidth-this.scrollbarWidth-c},autoScroll:!0,isSubscribe:[{publisherName:"mainContainer",behavior:"scrollToPosition",action:"transversePublish"}]},f.TempProp.isFrozen&&f.TempProp.colFrozen&&(e.displayPosition.offsetLeft-=g.get("left"),e.boxAttributes.width+=g.toJSON().left,e.reduceUserView=!0),f.FrozenRules.col.push(e)},ruleRow:function(){var a,b,c,d,e,g,i;a=h,b=a.getIndexByAlias(f.TempProp.rowAlias),-1===b?e=0:(c=a.models[b],e=c.toJSON().top),g=a.getModelByAlias(f.UserView.rowAlias),i=a.getIndexByAlias(f.UserView.rowAlias),f.TempProp.isFrozen&&f.TempProp.rowFrozen?(d={displayPosition:{offsetTop:0,startAlias:f.UserView.rowAlias,endAlias:f.TempProp.rowAlias,startIndex:i,endIndex:b},boxAttributes:{height:e-g.toJSON().top-1,style:"frozen-bottom-border"},autoScroll:!1,reduceUserView:!0},f.FrozenRules.row.push(d)):e=0,d={displayPosition:{offsetTop:e,startIndex:b,startAlias:f.TempProp.rowAlias},boxAttributes:{height:this.scrollHeight-this.scrollbarWidth-e},autoScroll:!0,isSubscribe:[{publisherName:"mainContainer",behavior:"scrollToPosition",action:"verticalPublish"},{publisherName:"mainContainer",behavior:"addHeadItemView",action:"addRowHeadItemViewPublish"},{publisherName:"mainContainer",behavior:"adjustHeadItemContainer",action:"adjustHeadItemContainerPublish"}]},f.TempProp.isFrozen&&f.TempProp.rowFrozen&&(d.displayPosition.offsetTop-=g.get("top"),d.boxAttributes.height+=g.toJSON().top,
d.reduceUserView=!0),f.FrozenRules.row.push(d)},ruleMain:function(){var a,b,c,d,e,g,j,k,l,m,n,o=h,p=i;d=o.getIndexByAlias(f.TempProp.rowAlias),e=p.getIndexByAlias(f.TempProp.colAlias),-1===d?g=0:(b=o.models[d],g=b.get("top")),-1===e?j=0:(c=p.models[e],j=c.get("left")),k=o.getModelByAlias(f.UserView.rowAlias),m=o.getIndexByAlias(f.UserView.rowAlias),l=p.getModelByAlias(f.UserView.colAlias),n=p.getIndexByAlias(f.UserView.colAlias),f.TempProp.isFrozen?(f.TempProp.rowFrozen&&f.TempProp.colFrozen&&(a={boxAttributes:{height:g-k.toJSON().top-1,width:j-l.toJSON().left-1,style:"container frozen-right-border frozen-bottom-border"},displayPosition:{startColIndex:n,endColIndex:e,startRowIndex:m,endRowIndex:d,startColAlias:f.UserView.colAlias,startRowAlias:f.UserView.rowAlias,endColAlias:f.TempProp.colAlias,endRowAlias:f.TempProp.rowAlias,offsetTop:0,offsetLeft:0}},f.FrozenRules.main.push(a)),f.TempProp.rowFrozen&&(a={boxAttributes:{height:g-k.toJSON().top-1,width:this.scrollWidth-this.scrollbarWidth-j,style:"container frozen-bottom-border"},displayPosition:{startRowIndex:m,endRowIndex:d,startColIndex:e,startColAlias:f.TempProp.colAlias,startRowAlias:f.UserView.rowAlias,endRowAlias:f.TempProp.rowAlias,offsetLeft:j,offsetTop:0},autoScroll:!0,autoColAlign:!0,isSubscribe:[{publisherName:"mainContainer",behavior:"subscribeScroll",action:"transversePublish",args:{direction:"TRANSVERSE"}}]},f.TempProp.colFrozen&&(a.boxAttributes.width+=l.toJSON().left,a.displayPosition.offsetLeft-=l.get("left")),f.FrozenRules.main.push(a)),f.TempProp.colFrozen&&(a={boxAttributes:{height:this.scrollHeight-this.scrollbarWidth-g,width:j-l.toJSON().left-1,style:"container frozen-right-border"},displayPosition:{startColIndex:n,endColIndex:e,startRowIndex:d,startColAlias:f.UserView.colAlias,startRowAlias:f.TempProp.rowAlias,endColAlias:f.TempProp.colAlias,offsetLeft:0,offsetTop:g},autoScroll:!0,autoRowAlign:!0,isSubscribe:[{publisherName:"mainContainer",behavior:"subscribeScroll",action:"verticalPublish",args:{direction:"VERTICAL"}},{publisherName:"mainContainer",behavior:"addHeadItemView",action:"addRowHeadItemViewPublish",args:{}},{publisherName:"mainContainer",behavior:"addCellView",action:"addCellViewPublish",args:{}},{publisherName:"mainContainer",behavior:"adjustContainerHeight",action:"adjustContainerHeightPublish",args:{}}]},f.TempProp.rowFrozen&&(a.boxAttributes.height+=k.toJSON().top,a.displayPosition.offsetTop-=k.get("top")),f.FrozenRules.main.push(a))):(g=0,j=0),a={boxAttributes:{height:this.scrollHeight-g,width:this.scrollWidth-j,style:"scroll-container"},displayPosition:{startColIndex:e,startRowIndex:d,startColAlias:f.TempProp.colAlias,startRowAlias:f.TempProp.rowAlias,offsetLeft:j,offsetTop:g},autoRowAlign:!0,autoColAlign:!0,autoScroll:!0,eventScroll:!0,isPublisher:!0,publisherName:"mainContainer"},f.TempProp.rowFrozen&&(a.boxAttributes.height+=k.toJSON().top,a.displayPosition.offsetTop-=k.get("top")),f.TempProp.colFrozen&&(a.boxAttributes.width+=l.toJSON().left,a.displayPosition.offsetLeft-=l.get("left")),f.FrozenRules.main.push(a)},initMainView:function(){var a,b;!0!==f.TempProp.isFrozen&&(a=h.getModelByAlias(f.UserView.rowAlias),b=i.getModelByAlias(f.UserView.colAlias),d.trigger("event:mainContainer:appointPosition",a.get("top"),"VERTICAL"),d.trigger("event:mainContainer:appointPosition",b.get("left"),"TRANSVERSE"))},calculation:function(){this.scrollWidth=this.el.offsetWidth-e.System.outerLeft,this.scrollHeight=this.el.offsetHeight-e.System.outerTop-e.System.outerBottom,this.scrollbarWidth=this.getScrollbarWidth()},callBodyContainer:function(a){a(this)},addressing:function(a,b){return!(!a.length||a!==b)||!(!a.parents(b).length||a.parents(b)!==b)},mouseInfo:function(a){this.mousePageX=a.pageX-this.$el.left,this.mousePageY=a.pageY-this.$el.top},getScrollbarWidth:function(){function a(){return parseInt(b("div",c).innerWidth(),0)}var c,d,e;return c=b("<div/>").css({width:50,height:50,overflow:"hidden",position:"absolute",top:-200,left:-200}).html('<div style="height:1000px;">'),this.$el.append(c),d=a(),c.css("overflow-y","auto"),e=a(),b(c).remove(),d-e},destroy:function(){d.off("call:bodyContainer"),d.off("event:bodyContainer:executiveFrozen"),d.off("event:commentContainer:show"),d.off("event:commentContainer:remove"),d.trigger("event:colsPanelContainer:destroy"),d.trigger("event:rowsPanelContainer:destroy"),d.trigger("event:mainContainer:destroy"),this.sheetsView.destroy(),this.remove()}})}),b("views/screen",function(){var b=c("lib/jquery"),d=c("lib/underscore"),e=c("lib/backbone"),f=c("views/bodyContainer");c("basic/tools/send"),c("basic/tools/cache"),c("spreadsheet/config"),c("basic/util/listener"),c("entrance/tool/clipselectoperate"),c("entrance/tool/clippasteoperate");return e.View.extend({el:a,events:{resize:"attributesRender",mouseup:"realseDrag",beforeunload:"closeWindow",mousedown:"transAction"},initialize:function(a){e.on("call:screenContainer",this.screenContainer,this),e.on("event:screenContainer:destroy",this.destroy,this),e.on("call:screenContainer:adaptScreen",this.attributesRender,this),d.bindAll(this,"callView"),this.render(a)},render:function(a){this.bodyContainer=new f({el:"#"+a}),this.bodyContainer.render(),this.triggerCallback()},transAction:function(a){this.toolbar(a)},toolbar:function(a){var c,d,e,f,g,h=0;if(b(a.target).length&&(f=b(a.target)),b(a.target).parents("[data-toolbar]").length&&(f=b(a.target).parents("[data-toolbar]")),g=f.length,d=b(".widget-list > div"),d.removeClass("active"),b("#toolBar .fui-section,#toolBar .section,#toolBar .ico-section ").removeClass("active"),0!==g&&(e=d.length,void 0!==(c=f.data("toolbar")))){for(;h<e;h++){var i=d.eq(h);if(c===i.data("widget")){var j=0;j=f[0].offsetHeight>f[0].clientHeight?parseInt((f[0].offsetHeight-f[0].clientHeight)/2,0)+f[0].clientHeight:f.outerHeight(),i.css({left:f.offset().left,top:f.offset().top+j}).addClass("active")}}f.addClass("active")}},triggerCallback:function(){e.trigger("call:rowsPanelContainer",this.callView("viewRowsPanelContainer")),e.trigger("call:colsPanelContainer",this.callView("viewColsPanelContainer")),e.trigger("call:mainContainer",this.callView("viewMainContainer")),e.trigger("call:cellsContainer",this.callView("viewCellsContainer")),e.trigger("call:colsHeadContainer",this.callView("viewColsHeadContainer")),e.trigger("call:rowsHeadContainer",this.callView("viewRowsHeadContainer"))},closeWindow:function(){},screenContainer:function(a){a(this)},attributesRender:function(){this.bodyContainer.calculation(),e.trigger("event:bodyContainer:executiveFrozen")},callView:function(a){var b=this;return function(c){b[a]=c}},realseDrag:function(a){this.triggerCallback(),e.trigger("event:cellsContainer:unBindDrag"),e.trigger("event:colsHeadContainer:relaseSpaceEffect"),e.trigger("event:rowsHeadContainer:relaseSpaceEffect"),this.$el.off("mousemove",this.viewColsHeadContainer.moveEvent),e.trigger("event:colsSpaceLineContainer:destroy"),this.$el.off("mousemove",this.viewRowsHeadContainer.moveEvent),e.trigger("event:rowsSpaceLineContainer:destroy")},mouseMoveHeadContainer:function(a,b,c){this.$el.on("mousemove",b,c)},destroy:function(){e.off("call:screenContainer"),e.off("call:screenContainer:adaptScreen"),this.bodyContainer.destroy(),this.remove()}})}),b("widgets/clipboard/shearPlateContainer",function(){var a=c("lib/jquery"),b=c("lib/underscore"),d=c("basic/tools/cache"),e=c("lib/backbone"),f=c("entrance/tool/clipselectoperate"),g=c("entrance/tool/clippasteoperate");return e.View.extend({el:"#shearPlateContainer",initialize:function(){b.bindAll(this,"pasteData"),e.on("event:pasteData",this.pasteData)},events:{"mousedown div":"pasteAction"},pasteAction:function(b){switch(a(b.currentTarget).data("toolbar")){case"paste":this.pasteData();break;case"copy":this.copyData();break;case"cut":this.cutData()}},copyData:function(){f("copy")},cutData:function(){f("cut")},pasteData:function(a){"null"!==d.clipState&&g(a)}})}),b("widgets/font/fontFamilyContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=(c("basic/tools/send"),c("collections/cells"),c("collections/selectRegion"),c("entrance/tool/setfontfamily"));return b.View.extend({el:"#font",events:{"mousedown li":"setFontFamily"},setFontFamily:function(b){var c,e,f;this.$el.removeClass("active"),f=a(b.currentTarget),e=f.data("family"),c=f.text(),a("#fontShow").text(c),d("1",e)}})}),b("widgets/font/fontSizeContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=(c("basic/tools/send"),c("collections/selectRegion"),c("entrance/tool/setfontfamilysize"));c("entrance/cell/setcellheight");return b.View.extend({el:"#fontSize",events:{"mousedown li":"setFontSize"},setFontSize:function(b){var c,e,f;f=a(b.currentTarget),this.$el.removeClass("active"),c=f.data("size"),e=f.text(),a("#fontSizeShow").text(e),d("1",c)}})}),b("widgets/celloperation/borderContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=(c("basic/tools/send"),c("collections/cells"),c("collections/selectRegion"),c("entrance/tool/setcellborder"));return b.View.extend({el:"#funcBorder",events:{"mousedown li":"transAction"},initialize:function(){},render:function(){},transAction:function(b){var c=a(b.currentTarget).data("border");d("1",c)}})}),b("widgets/celloperation/fillColorContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=c("entrance/tool/setfillcolor");return b.View.extend({el:"#fillColor",events:{"mousedown .color-body":"setFillColor"},setFillColor:function(b){this.$el.removeClass("active");var c=a(b.currentTarget).css("background-color");d("1",c)}})}),b("widgets/font/fontColorContainer",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=(c("basic/tools/send"),c("collections/selectRegion"),c("entrance/tool/setfontcolor"));return b.View.extend({el:"#fontColor",events:{"mousedown .color-body":"setFontColor"},setFontColor:function(b){this.$el.removeClass("active");var c=a(b.currentTarget).css("background-color");d("1",c)}})}),b("widgets/align/contentAlignContainer",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("entrance/tool/setalign");return b.View.extend({el:"#contentAlignContainer",events:{"click span[data-align]":"setAlignAction"},setAlignAction:function(b){var c;c=a(b.currentTarget).data("align"),d("1",c)}})}),b("widgets/cellformat/textFormatContainer",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("spreadsheet/config"),e=c("entrance/tool/settexttype");return b.View.extend({el:"#contentFormat",events:{"mousedown li":"setContentFormat"},setContentFormat:function(b){switch(this.$el.removeClass("active"),a(b.currentTarget).data("format")){case"normal":e.setNormal("1");break;case"text":e.setText("1");break;case"number-0":e.setNum("1",!1,0);break;case"number-1":e.setNum("1",!1,1);break;case"number-2":e.setNum("1",!1,2);break;case"number-3":e.setNum("1",!1,3);break;case"number-4":e.setNum("1",!1,4);break;case"date-1":e.setDate("1",d.dateFormatType.frist);break;case"date-2":e.setDate("1",d.dateFormatType.fourth);break;case"date-3":e.setDate("1",d.dateFormatType.fifth);break;case"percent":e.setPercent("1",2);break;case"coin-1":e.setCurrency("1",2,"$");break;case"coin-2":e.setCurrency("1",2,"¥");break;default:e.setText("1")}}})}),b("widgets/celloperation/mergeCellContainer",function(){var a=c("lib/jquery"),b=c("lib/underscore"),d=c("lib/backbone"),e=(c("basic/tools/send"),c("basic/tools/cache")),f=(c("basic/util/binary"),c("collections/selectRegion"),c("collections/headItemCol"),c("collections/headItemRow"),c("collections/cells"),c("entrance/tool/mergecell")),g=c("entrance/tool/splitcell");return d.View.extend({el:"#mergeCellContainer",events:{"click div[data-toolbar]":"transAction"},initialize:function(){b.bindAll(this,"splitCell")},transAction:function(b){switch(a(b.currentTarget).data("toolbar")){case"merge":this.mergeCell(b);break;case"split":this.splitCell(b)}},mergeCell:function(){f("1")},splitCell:function(){g("1")},splitCreateCell:function(a){},deletePosi:function(a,b){var c=e.CellsPosition,d=c.strandX,f=c.strandY;void 0!==d[a]&&void 0!==d[a][b]&&(delete d[a][b],Object.getOwnPropertyNames(d[a]).length||delete d[a]),void 0!==f[b]&&void 0!==f[b][a]&&(delete f[b][a],Object.getOwnPropertyNames(f[b]).length||delete f[b])},setPosi:function(a,b,c){var d={};void 0===e.CellsPosition.strandX[a]?(d={},d[b]=c,e.CellsPosition.strandX[a]=d):e.CellsPosition.strandX[a][b]=c,void 0===e.CellsPosition.strandY[b]?(d={},d[a]=c,e.CellsPosition.strandY[b]=d):e.CellsPosition.strandY[b][a]=c}})}),b("widgets/font/contentFontContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=(c("basic/tools/send"),c("collections/cells"),c("collections/selectRegion"),c("entrance/tool/setfontweight")),e=c("entrance/tool/setfontstyle");return b.View.extend({el:"#contentFontContainer",events:{"click span":"setFontAction"},setFontAction:function(b){switch(a(b.currentTarget).data("toolbar")){case"bold":this.setCellModelBold();break;case"italic":this.setCellModelItalic();break;default:return}},setCellModelBold:function(){d("1")},setCellModelItalic:function(){e("1")}})}),b("widgets/frozen/frozenContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=(c("basic/tools/send"),c("basic/tools/cache")),e=(c("collections/selectRegion"),c("collections/headItemRow"),c("collections/headItemCol"),c("entrance/sheet/setfrozen"));return b.View.extend({el:"#frozen",events:{"mousedown li":"transAction"},initialize:function(){b.on("event:frozenContainer:changeState",this.changeState,this),this.unfrozenBtn=a('li[data-frozen="unfrozen"]',this.$el),this.customBtn=a('li[data-frozen="custom"]',this.$el),this.changeState()},render:function(){},changeState:function(){d.TempProp.isFrozen?(this.unfrozenBtn.show(),this.customBtn.hide()):(this.unfrozenBtn.hide(),this.customBtn.show())},transAction:function(b){var c=a(b.currentTarget).data("frozen");e("1",c),this.changeState()}})}),b("widgets/insert/insertoperation",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("entrance/tool/addrow"),e=c("entrance/tool/addcol");return b.View.extend({el:"#insert",events:{"mousedown li":"action"},action:function(b){"column"===a(b.currentTarget).data("type")?this.insertColumn():this.insertRow()},insertRow:function(){d.addRow()},insertColumn:function(){e.addCol()}})}),b("widgets/delete/deleteoperation",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("entrance/tool/deleterow"),e=c("entrance/tool/deletecol");return b.View.extend({el:"#delete",events:{"mousedown li":"action"},action:function(b){"column"===a(b.currentTarget).data("type")?this.deleteColumn():this.deleteRow()},deleteRow:function(){d.deleteRow()},deleteColumn:function(){e.deleteCol()}})}),b("widgets/celloperation/commentcontainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=c("entrance/tool/comment");return b.View.extend({el:"#reviewContainer",events:{"click .fui-section":"commentAction"},commentAction:function(b){switch(a(b.currentTarget).data("toolbar")){case"addComment":d.createAddCommentView();break;case"editComment":d.createEditComment();break;case"deleteComment":d.deleteComment()}}})}),b("widgets/celloperation/wordwrapcontainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=(c("basic/tools/send"),c("collections/selectRegion"),c("entrance/tool/setwordwrap"));return a.View.extend({el:"#wordWrapContainer",events:{click:"wordWrap"},wordWrap:function(a){b("1")}})}),b("widgets/hidecol/colhidecontainer",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("entrance/col/colhide");return b.View.extend({el:"#hideContainer",events:{"click .fui-section":"action"},action:function(b){"hide"===a(b.currentTarget).data("toolbar")?d.hide():d.cancelHide()}})}),b("widgets/celldel/regiondel",function(){var a=(c("lib/jquery"),c("lib/backbone")),b=c("entrance/tool/regiondel");return a.View.extend({el:"#regionDelContainer",events:{click:"action"},action:function(a){b()}})}),b("spreadsheet/excelbuild",function(){var a=c("basic/tools/original"),b=c("basic/tools/template"),d=c("basic/util/listener"),e=c("basic/tools/cache"),f=c("entrance/tool/setfontcolor"),g=c("entrance/tool/setfillcolor"),h=c("entrance/tool/setfontfamily"),i=c("entrance/cell/setcellheight"),j=c("entrance/cell/setcellwidth"),k=c("entrance/cell/selectcell"),l=c("entrance/tool/mergecell"),m=c("entrance/tool/splitcell"),n=c("entrance/tool/setcellcontent"),o=c("entrance/cell/selectcellcols"),p=c("entrance/cell/selectcellrows"),q=c("entrance/tool/setcellborder"),r=c("entrance/tool/setfontfamilysize"),s=c("entrance/tool/setfontweight"),t=c("entrance/tool/setfontstyle"),u=c("entrance/sheet/setfrozen"),v=c("entrance/tool/setalign"),w=c("entrance/selectregion/datasourceregionoperation"),x=c("entrance/sheet/getpointbyposi"),y=c("entrance/tool/setwordwrap"),z=c("entrance/cell/gettextbycoordinate"),A=c("entrance/sheet/adaptscreen"),B=c("entrance/sheet/getfrozenstate"),C=c("entrance/sheet/getselectregion"),D=c("entrance/extention/highlight"),E=c("entrance/cell/reloadcells"),F=c("entrance/tool/settexttype"),G=c("entrance/tool/addrow"),H=c("entrance/tool/addcol"),I=c("entrance/tool/deleterow"),J=c("entrance/tool/deletecol"),K=c("entrance/tool/regiondel"),L=c("entrance/col/colhide"),M=c("entrance/tool/clipselectoperate"),N=c("entrance/tool/clippasteoperate"),O=c("entrance/tool/comment");return{buildDom:function(a){b(a)},buildExcelOriginalData:function(b){a.restoreExcel(b)},buildExcelView:function(a){new(c("views/screen"))(a)},buildExcelToolbar:function(){var a=c("widgets/clipboard/shearPlateContainer"),b=c("widgets/font/fontFamilyContainer"),d=c("widgets/font/fontSizeContainer"),e=c("widgets/celloperation/borderContainer"),f=c("widgets/celloperation/fillColorContainer"),g=c("widgets/font/fontColorContainer"),h=c("widgets/align/contentAlignContainer"),i=c("widgets/cellformat/textFormatContainer"),j=c("widgets/celloperation/mergeCellContainer"),k=c("widgets/font/contentFontContainer"),l=c("widgets/frozen/frozenContainer"),m=c("widgets/insert/insertoperation"),n=c("widgets/delete/deleteoperation"),o=c("widgets/celloperation/commentcontainer"),p=c("widgets/celloperation/wordwrapcontainer"),q=c("widgets/hidecol/colhidecontainer"),r=c("widgets/celldel/regiondel");new a,new b,new d,new e,new f,new g,new h,new i,new j,new k,new l,new o,new m,new n,new p,new r,new q},buildExcelPublicAPI:function(a){a.prototype.setFontColor=f,a.prototype.setFillColor=g,a.prototype.setFontFamily=h,a.prototype.setCellHeight=i,a.prototype.selectCell=k,a.prototype.mergeCell=l,a.prototype.splitCell=m,a.prototype.setCellBorder=q,a.prototype.setCellContent=n,a.prototype.setAlign=v,a.prototype.selectCellCols=o,a.prototype.selectCellRows=p,a.prototype.setCellWidth=j,a.prototype.setFontSize=r,a.prototype.setFontStyle=t,a.prototype.setFontWeight=s,a.prototype.setFrozen=u,a.prototype.setNormalType=F.setNormal.bind(F),a.prototype.setTextType=F.setText.bind(F),a.prototype.setNumType=F.setNum.bind(F),a.prototype.setDateType=F.setDate.bind(F),a.prototype.setPercentType=F.setPercent.bind(F),a.prototype.setCoinType=F.setCurrency.bind(F),a.prototype.modifyComment=O.modifyComment.bind(O),a.prototype.createAddCommentView=O.createAddCommentView.bind(O),a.prototype.createEditCommentView=O.createEditComment.bind(O),a.prototype.deleteComment=O.deleteComment.bind(O),a.prototype.getPointByPosi=x,a.prototype.adaptScreen=A,a.prototype.getTextByCoordinate=z,a.prototype.getFrozenState=B,a.prototype.setWordWrap=y,a.prototype.getSelectRegion=C,a.prototype.reloadCells=E,a.prototype.clipSelectOperate=function(a){M(a)},a.prototype.clipPasteOperate=function(){"null"!==e.clipState&&N()},a.prototype.addRow=G,a.prototype.addCol=H,a.prototype.deleteRow=I,a.prototype.deleteCol=J,a.prototype.regionDel=K,a.prototype.clearQueue=function(){e.sendQueueStep=0},a.prototype.getLastStep=function(){return e.sendQueueStep},a.prototype.colHide=L.hide.bind(L),a.prototype.colCancelHide=L.cancelHide.bind(L)},buildDataSourceOperation:function(a){a.prototype.setDataSourceRegion=w.setDataSourceRegion,a.prototype.setSelectRegion=w.setSelectRegion,a.prototype.destroyDataSoureRegion=w.destroyDataSoureRegion},buildExcelEventListener:function(a){a.prototype.addEventListener=d.addEventListener,a.prototype.removeEventListener=d.removeEventListener},buildExcelExtend:function(a){a.prototype.startHighlight=D.startHighlight,a.prototype.stopHighlight=D.stopHighlight,a.prototype.getHighlightDirection=D.getHighlightDirection}}}),b("spreadsheet/spreadsheet",function(){function b(c,f){if(!document.getElementById(c))throw new Error("未找到id为"+c+"容器");void 0!==f&&"true"===a.SPREADSHEET_BUILD_STATE&&(d.User.initRowNum=f.initRowNum||d.User.initRowNum,d.User.initColNum=f.initColNum||d.User.initColNum,d.User.cellWidth=f.cellWidth||d.User.cellWidth,d.User.cellHeight=f.cellHeight||d.User.cellHeight,d.User.maxColNum=f.maxColNum||d.User.maxColNum,d.User.maxRowNum=f.maxRowNum||d.User.maxRowNum),e.containerId=c,g.buildDom(c),g.buildExcelOriginalData(c),g.buildExcelView(c),g.buildExcelToolbar(),g.buildExcelPublicAPI(b),g.buildDataSourceOperation(b),g.buildExcelEventListener(b),g.buildExcelExtend(b)}var d=(c("lib/jquery"),c("spreadsheet/config")),e=c("basic/tools/cache"),f=c("basic/tools/point"),g=c("spreadsheet/excelbuild");return b.Point=f,b}),c("spreadsheet/spreadsheet")});