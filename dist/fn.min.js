!function(a,b){var c,d={},e=function(a,b){var c,d,e;if("string"==typeof a)return h(a);for(c=[],d=a.length,e=0;e<d;e++)c.push(h(a[e]));return b.apply(null,c)},f=function(a,b,c){2===arguments.length&&(c=b,b=null),e(b||[],function(){g(a,c,arguments)})},g=function(a,b,c){var f,g={exports:b};"function"==typeof b&&(c.length||(c=[e,g.exports,g]),void 0!==(f=b.apply(null,c))&&(g.exports=f)),d[a]=g.exports},h=function(b){var c=d[b]||a[b];if(!c)throw new Error("`"+b+"` is undefined");return c},i=function(a){var b,c,e,f,g,h;h=function(a){return a&&a.charAt(0).toUpperCase()+a.substr(1)};for(b in d)if(c=a,d.hasOwnProperty(b)){for(e=b.split("/"),g=h(e.pop());f=h(e.shift());)c[f]=c[f]||{},c=c[f];c[g]=d[b]}return a},j=function(c){return a.__dollar=c,i(b(a,f,e))};"object"==typeof module&&"object"==typeof module.exports?module.exports=j():"function"==typeof define&&define.amd?define(["jquery"],j):(c=a.SpreadSheet,a.SpreadSheet=j(),a.SpreadSheet.noConflict=function(){a.SpreadSheet=c})}(window,function(a,b,c){return b("lib/jquery",function(){return function(a,c){function d(a){var b=a.length,c=aa.type(a);return"function"!==c&&!aa.isWindow(a)&&(!(1!==a.nodeType||!b)||("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a))}function e(a,b,c){if(aa.isFunction(b))return aa.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return aa.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(ia.test(b))return aa.filter(b,a,c);b=aa.filter(b,a)}return aa.grep(a,function(a){return W.call(b,a)>=0!==c})}function g(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function h(a){var b=oa[a]={};return aa.each(a.match(na)||[],function(a,c){b[c]=!0}),b}function i(){_.removeEventListener("DOMContentLoaded",i,!1),a.removeEventListener("load",i,!1),aa.ready()}function j(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=aa.expando+j.uid++}function k(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(ua,"-$1").toLowerCase(),"string"==typeof(c=a.getAttribute(d))){try{c="true"===c||"false"!==c&&("null"===c?null:+c+""===c?+c:ta.test(c)?aa.parseJSON(c):c)}catch(a){}sa.set(a,b,c)}else c=void 0;return c}function l(){return!0}function m(){return!1}function n(){try{return _.activeElement}catch(a){}}function o(a,b){return aa.nodeName(a,"table")&&aa.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function p(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function q(a){var b=Ja.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function r(a,b){for(var c=0,d=a.length;c<d;c++)ra.set(a[c],"globalEval",!b||ra.get(b[c],"globalEval"))}function s(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(ra.hasData(a)&&(f=ra.access(a),g=ra.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;c<d;c++)aa.event.add(b,e,j[e][c])}sa.hasData(a)&&(h=sa.access(a),i=aa.extend({},h),sa.set(b,i))}}function t(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&aa.nodeName(a,b)?aa.merge([a],c):c}function u(a,b){var c=b.nodeName.toLowerCase();"input"===c&&ya.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function v(b,c){var d,e=aa(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:aa.css(e[0],"display");return e.detach(),f}function w(a){var b=_,c=Na[a];return c||(c=v(a,b),"none"!==c&&c||(Ma=(Ma||aa("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Ma[0].contentDocument,b.write(),b.close(),c=v(a,b),Ma.detach()),Na[a]=c),c}function x(a,b,c){var d,e,f,g,h=a.style;return c=c||Qa(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||aa.contains(a.ownerDocument,a)||(g=aa.style(a,b)),Pa.test(g)&&Oa.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function y(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function z(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=Wa.length;e--;)if((b=Wa[e]+c)in a)return b;return d}function A(a,b,c){var d=Sa.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function B(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;f<4;f+=2)"margin"===c&&(g+=aa.css(a,c+wa[f],!0,e)),d?("content"===c&&(g-=aa.css(a,"padding"+wa[f],!0,e)),"margin"!==c&&(g-=aa.css(a,"border"+wa[f]+"Width",!0,e))):(g+=aa.css(a,"padding"+wa[f],!0,e),"padding"!==c&&(g+=aa.css(a,"border"+wa[f]+"Width",!0,e)));return g}function C(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Qa(a),g="border-box"===aa.css(a,"boxSizing",!1,f);if(e<=0||null==e){if(e=x(a,b,f),(e<0||null==e)&&(e=a.style[b]),Pa.test(e))return e;d=g&&($.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+B(a,b,c||(g?"border":"content"),d,f)+"px"}function D(a,b){for(var c,d,e,f=[],g=0,h=a.length;g<h;g++)d=a[g],d.style&&(f[g]=ra.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&xa(d)&&(f[g]=ra.access(d,"olddisplay",w(d.nodeName)))):(e=xa(d),"none"===c&&e||ra.set(d,"olddisplay",e?c:aa.css(d,"display"))));for(g=0;g<h;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function E(a,b,c,d,e){return new E.prototype.init(a,b,c,d,e)}function F(){return setTimeout(function(){Xa=void 0}),Xa=aa.now()}function G(a,b){var c,d=0,e={height:a};for(b=b?1:0;d<4;d+=2-b)c=wa[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function H(a,b,c){for(var d,e=(bb[b]||[]).concat(bb["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function I(a,b,c){var d,e,f,g,h,i,j,k=this,l={},m=a.style,n=a.nodeType&&xa(a),o=ra.get(a,"fxshow");c.queue||(h=aa._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,k.always(function(){k.always(function(){h.unqueued--,aa.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[m.overflow,m.overflowX,m.overflowY],j=aa.css(a,"display"),"inline"===("none"===j?ra.get(a,"olddisplay")||w(a.nodeName):j)&&"none"===aa.css(a,"float")&&(m.display="inline-block")),c.overflow&&(m.overflow="hidden",k.always(function(){m.overflow=c.overflow[0],m.overflowX=c.overflow[1],m.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Za.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(n?"hide":"show")){if("show"!==e||!o||void 0===o[d])continue;n=!0}l[d]=o&&o[d]||aa.style(a,d)}else j=void 0;if(aa.isEmptyObject(l))"inline"===("none"===j?w(a.nodeName):j)&&(m.display=j);else{o?"hidden"in o&&(n=o.hidden):o=ra.access(a,"fxshow",{}),f&&(o.hidden=!n),n?aa(a).show():k.done(function(){aa(a).hide()}),k.done(function(){var b;ra.remove(a,"fxshow");for(b in l)aa.style(a,b,l[b])});for(d in l)g=H(n?o[d]:0,d,k),d in o||(o[d]=g.start,n&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function J(a,b){var c,d,e,f,g;for(c in a)if(d=aa.camelCase(c),e=b[d],f=a[c],aa.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=aa.cssHooks[d])&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function K(a,b,c){var d,e,f=0,g=ab.length,h=aa.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Xa||F(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:aa.extend({},b),opts:aa.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Xa||F(),duration:c.duration,tweens:[],createTween:function(b,c){var d=aa.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(J(k,j.opts.specialEasing);f<g;f++)if(d=ab[f].call(j,a,k,j.opts))return d;return aa.map(k,H,j),aa.isFunction(j.opts.start)&&j.opts.start.call(a,j),aa.fx.timer(aa.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function L(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(na)||[];if(aa.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function M(a,b,c,d){function e(h){var i;return f[h]=!0,aa.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===rb;return e(b.dataTypes[0])||!f["*"]&&e("*")}function N(a,b){var c,d,e=aa.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&aa.extend(!0,a,d),a}function O(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}if(f)return f!==i[0]&&i.unshift(f),c[f]}function P(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(!(g=j[i+" "+f]||j["* "+f]))for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){!0===g?g=j[e]:!0!==j[e]&&(f=h[0],k.unshift(h[1]));break}if(!0!==g)if(g&&a.throws)b=g(b);else try{b=g(b)}catch(a){return{state:"parsererror",error:g?a:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function Q(a,b,c,d){var e;if(aa.isArray(b))aa.each(b,function(b,e){c||wb.test(a)?d(a,e):Q(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==aa.type(b))d(a,b);else for(e in b)Q(a+"["+e+"]",b[e],c,d)}function R(a){return aa.isWindow(a)?a:9===a.nodeType&&a.defaultView}var S=[],T=S.slice,U=S.concat,V=S.push,W=S.indexOf,X={},Y=X.toString,Z=X.hasOwnProperty,$={},_=a.document,aa=function(a,b){return new aa.fn.init(a,b)},ba=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ca=/^-ms-/,da=/-([\da-z])/gi,ea=function(a,b){return b.toUpperCase()};aa.fn=aa.prototype={jquery:"2.1.3",constructor:aa,selector:"",length:0,toArray:function(){return T.call(this)},get:function(a){return null!=a?a<0?this[a+this.length]:this[a]:T.call(this)},pushStack:function(a){var b=aa.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return aa.each(this,a,b)},map:function(a){return this.pushStack(aa.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(T.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:V,sort:S.sort,splice:S.splice},aa.extend=aa.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||aa.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(aa.isPlainObject(d)||(e=aa.isArray(d)))?(e?(e=!1,f=c&&aa.isArray(c)?c:[]):f=c&&aa.isPlainObject(c)?c:{},g[b]=aa.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},aa.extend({expando:"jQuery"+("2.1.3"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===aa.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!aa.isArray(a)&&a-parseFloat(a)+1>=0},isPlainObject:function(a){return"object"===aa.type(a)&&!a.nodeType&&!aa.isWindow(a)&&!(a.constructor&&!Z.call(a.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?X[Y.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;(a=aa.trim(a))&&(1===a.indexOf("use strict")?(b=_.createElement("script"),b.text=a,_.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(ca,"ms-").replace(da,ea)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var e=0,f=a.length,g=d(a);if(c){if(g)for(;e<f&&!1!==b.apply(a[e],c);e++);else for(e in a)if(!1===b.apply(a[e],c))break}else if(g)for(;e<f&&!1!==b.call(a[e],e,a[e]);e++);else for(e in a)if(!1===b.call(a[e],e,a[e]))break;return a},trim:function(a){return null==a?"":(a+"").replace(ba,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(d(Object(a))?aa.merge(c,"string"==typeof a?[a]:a):V.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:W.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d=[],e=0,f=a.length,g=!c;e<f;e++)!b(a[e],e)!==g&&d.push(a[e]);return d},map:function(a,b,c){var e,f=0,g=a.length,h=d(a),i=[];if(h)for(;f<g;f++)null!=(e=b(a[f],f,c))&&i.push(e);else for(f in a)null!=(e=b(a[f],f,c))&&i.push(e);return U.apply([],i)},guid:1,proxy:function(a,b){var c,d,e;if("string"==typeof b&&(c=a[b],b=a,a=c),aa.isFunction(a))return d=T.call(arguments,2),e=function(){return a.apply(b||this,d.concat(T.call(arguments)))},e.guid=a.guid=a.guid||aa.guid++,e},now:Date.now,support:$}),aa.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){X["[object "+b+"]"]=b.toLowerCase()});var fa=function(a){function b(a,b,c,d){var e,f,g,h,j,l,m,n,o,p;if((b?b.ownerDocument||b:M)!==E&&D(b),b=b||E,c=c||[],h=b.nodeType,"string"!=typeof a||!a||1!==h&&9!==h&&11!==h)return c;if(!d&&G){if(11!==h&&(e=qa.exec(a)))if(g=e[1]){if(9===h){if(!(f=b.getElementById(g))||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&K(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return Y.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&t.getElementsByClassName)return Y.apply(c,b.getElementsByClassName(g)),c}if(t.qsa&&(!H||!H.test(a))){if(n=m=L,o=b,p=1!==h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(l=x(a),(m=b.getAttribute("id"))?n=m.replace(sa,"\\$&"):b.setAttribute("id",n),n="[id='"+n+"'] ",j=l.length;j--;)l[j]=n+k(l[j]);o=ra.test(a)&&i(b.parentNode)||b,p=l.join(",")}if(p)try{return Y.apply(c,o.querySelectorAll(p)),c}catch(a){}finally{m||b.removeAttribute("id")}}}return z(a.replace(ga,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>u.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[L]=!0,a}function e(a){var b=E.createElement("div");try{return!!a(b)}catch(a){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)u.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||T)-(~a.sourceIndex||T);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function i(a){return a&&void 0!==a.getElementsByTagName&&a}function j(){}function k(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function l(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=O++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[N,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[L]||(b[L]={}),(h=i[d])&&h[0]===N&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function m(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function n(a,c,d){for(var e=0,f=c.length;e<f;e++)b(a,c[e],d);return d}function o(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function p(a,b,c,e,f,g){return e&&!e[L]&&(e=p(e)),f&&!f[L]&&(f=p(f,g)),d(function(d,g,h,i){var j,k,l,m=[],p=[],q=g.length,r=d||n(b||"*",h.nodeType?[h]:h,[]),s=!a||!d&&b?r:o(r,m,a,h,i),t=c?f||(d?a:q||e)?[]:g:s;if(c&&c(s,t,h,i),e)for(j=o(t,p),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(t[p[k]]=!(s[p[k]]=l));if(d){if(f||a){if(f){for(j=[],k=t.length;k--;)(l=t[k])&&j.push(s[k]=l);f(null,t=[],j,i)}for(k=t.length;k--;)(l=t[k])&&(j=f?$(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else t=o(t===g?t.splice(q,t.length):t),f?f(null,g,t,i):Y.apply(g,t)})}function q(a){for(var b,c,d,e=a.length,f=u.relative[a[0].type],g=f||u.relative[" "],h=f?1:0,i=l(function(a){return a===b},g,!0),j=l(function(a){return $(b,a)>-1},g,!0),n=[function(a,c,d){var e=!f&&(d||c!==A)||((b=c).nodeType?i(a,c,d):j(a,c,d));return b=null,e}];h<e;h++)if(c=u.relative[a[h].type])n=[l(m(n),c)];else{if(c=u.filter[a[h].type].apply(null,a[h].matches),c[L]){for(d=++h;d<e&&!u.relative[a[d].type];d++);return p(h>1&&m(n),h>1&&k(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ga,"$1"),c,h<d&&q(a.slice(h,d)),d<e&&q(a=a.slice(d)),d<e&&k(a))}n.push(c)}return m(n)}function r(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,p="0",q=d&&[],r=[],s=A,t=d||f&&u.find.TAG("*",j),v=N+=null==s?1:Math.random()||.1,w=t.length;for(j&&(A=g!==E&&g);p!==w&&null!=(k=t[p]);p++){if(f&&k){for(l=0;m=a[l++];)if(m(k,g,h)){i.push(k);break}j&&(N=v)}e&&((k=!m&&k)&&n--,d&&q.push(k))}if(n+=p,e&&p!==n){for(l=0;m=c[l++];)m(q,r,g,h);if(d){if(n>0)for(;p--;)q[p]||r[p]||(r[p]=W.call(i));r=o(r)}Y.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(N=v,A=s),q};return e?d(g):g}var s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L="sizzle"+1*new Date,M=a.document,N=0,O=0,P=c(),Q=c(),R=c(),S=function(a,b){return a===b&&(C=!0),0},T=1<<31,U={}.hasOwnProperty,V=[],W=V.pop,X=V.push,Y=V.push,Z=V.slice,$=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},_="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",aa="[\\x20\\t\\r\\n\\f]",ba="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ca=ba.replace("w","w#"),da="\\["+aa+"*("+ba+")(?:"+aa+"*([*^$|!~]?=)"+aa+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ca+"))|)"+aa+"*\\]",ea=":("+ba+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+da+")*)|.*)\\)|)",fa=new RegExp(aa+"+","g"),ga=new RegExp("^"+aa+"+|((?:^|[^\\\\])(?:\\\\.)*)"+aa+"+$","g"),ha=new RegExp("^"+aa+"*,"+aa+"*"),ia=new RegExp("^"+aa+"*([>+~]|"+aa+")"+aa+"*"),ja=new RegExp("="+aa+"*([^\\]'\"]*?)"+aa+"*\\]","g"),ka=new RegExp(ea),la=new RegExp("^"+ca+"$"),ma={ID:new RegExp("^#("+ba+")"),CLASS:new RegExp("^\\.("+ba+")"),TAG:new RegExp("^("+ba.replace("w","w*")+")"),ATTR:new RegExp("^"+da),PSEUDO:new RegExp("^"+ea),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+aa+"*(even|odd|(([+-]|)(\\d*)n|)"+aa+"*(?:([+-]|)"+aa+"*(\\d+)|))"+aa+"*\\)|)","i"),bool:new RegExp("^(?:"+_+")$","i"),needsContext:new RegExp("^"+aa+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+aa+"*((?:-\\d)?\\d*)"+aa+"*\\)|)(?=[^-]|$)","i")},na=/^(?:input|select|textarea|button)$/i,oa=/^h\d$/i,pa=/^[^{]+\{\s*\[native \w/,qa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ra=/[+~]/,sa=/'|\\/g,ta=new RegExp("\\\\([\\da-f]{1,6}"+aa+"?|("+aa+")|.)","ig"),ua=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},va=function(){D()};try{Y.apply(V=Z.call(M.childNodes),M.childNodes),V[M.childNodes.length].nodeType}catch(a){Y={apply:V.length?function(a,b){X.apply(a,Z.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}t=b.support={},w=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},D=b.setDocument=function(a){var b,c,d=a?a.ownerDocument||a:M;return d!==E&&9===d.nodeType&&d.documentElement?(E=d,F=d.documentElement,c=d.defaultView,c&&c!==c.top&&(c.addEventListener?c.addEventListener("unload",va,!1):c.attachEvent&&c.attachEvent("onunload",va)),G=!w(d),t.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),t.getElementsByTagName=e(function(a){return a.appendChild(d.createComment("")),!a.getElementsByTagName("*").length}),t.getElementsByClassName=pa.test(d.getElementsByClassName),t.getById=e(function(a){return F.appendChild(a).id=L,!d.getElementsByName||!d.getElementsByName(L).length}),t.getById?(u.find.ID=function(a,b){if(void 0!==b.getElementById&&G){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},u.filter.ID=function(a){var b=a.replace(ta,ua);return function(a){return a.getAttribute("id")===b}}):(delete u.find.ID,u.filter.ID=function(a){var b=a.replace(ta,ua);return function(a){var c=void 0!==a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),u.find.TAG=t.getElementsByTagName?function(a,b){return void 0!==b.getElementsByTagName?b.getElementsByTagName(a):t.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},u.find.CLASS=t.getElementsByClassName&&function(a,b){if(G)return b.getElementsByClassName(a)},I=[],H=[],(t.qsa=pa.test(d.querySelectorAll))&&(e(function(a){F.appendChild(a).innerHTML="<a id='"+L+"'></a><select id='"+L+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&H.push("[*^$]="+aa+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||H.push("\\["+aa+"*(?:value|"+_+")"),a.querySelectorAll("[id~="+L+"-]").length||H.push("~="),a.querySelectorAll(":checked").length||H.push(":checked"),a.querySelectorAll("a#"+L+"+*").length||H.push(".#.+[+~]")}),e(function(a){var b=d.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&H.push("name"+aa+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||H.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),H.push(",.*:")})),(t.matchesSelector=pa.test(J=F.matches||F.webkitMatchesSelector||F.mozMatchesSelector||F.oMatchesSelector||F.msMatchesSelector))&&e(function(a){t.disconnectedMatch=J.call(a,"div"),J.call(a,"[s!='']:x"),I.push("!=",ea)}),H=H.length&&new RegExp(H.join("|")),I=I.length&&new RegExp(I.join("|")),b=pa.test(F.compareDocumentPosition),K=b||pa.test(F.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},S=b?function(a,b){if(a===b)return C=!0,0;var c=!a.compareDocumentPosition-!b.compareDocumentPosition;return c||(c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&c||!t.sortDetached&&b.compareDocumentPosition(a)===c?a===d||a.ownerDocument===M&&K(M,a)?-1:b===d||b.ownerDocument===M&&K(M,b)?1:B?$(B,a)-$(B,b):0:4&c?-1:1)}:function(a,b){if(a===b)return C=!0,0;var c,e=0,f=a.parentNode,h=b.parentNode,i=[a],j=[b];if(!f||!h)return a===d?-1:b===d?1:f?-1:h?1:B?$(B,a)-$(B,b):0;if(f===h)return g(a,b);for(c=a;c=c.parentNode;)i.unshift(c);for(c=b;c=c.parentNode;)j.unshift(c);for(;i[e]===j[e];)e++;return e?g(i[e],j[e]):i[e]===M?-1:j[e]===M?1:0},d):E},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==E&&D(a),c=c.replace(ja,"='$1']"),t.matchesSelector&&G&&(!I||!I.test(c))&&(!H||!H.test(c)))try{var d=J.call(a,c);if(d||t.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(a){}return b(c,E,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==E&&D(a),K(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==E&&D(a);var c=u.attrHandle[b.toLowerCase()],d=c&&U.call(u.attrHandle,b.toLowerCase())?c(a,b,!G):void 0;return void 0!==d?d:t.attributes||!G?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(C=!t.detectDuplicates,B=!t.sortStable&&a.slice(0),a.sort(S),C){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return B=null,a},v=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=v(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=v(b);return c},u=b.selectors={cacheLength:50,createPseudo:d,match:ma,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ta,ua),a[3]=(a[3]||a[4]||a[5]||"").replace(ta,ua),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return ma.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&ka.test(c)&&(b=x(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ta,ua).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=P[a+" "];return b||(b=new RegExp("(^|"+aa+")"+a+"("+aa+"|$)"))&&P(a,function(a){return b.test("string"==typeof a.className&&a.className||void 0!==a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:!c||(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f.replace(fa," ")+" ").indexOf(d)>-1:"|="===c&&(f===d||f.slice(0,d.length+1)===d+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[L]||(q[L]={}),j=k[a]||[],n=j[0]===N&&j[1],m=j[0]===N&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[N,n,m];break}}else if(s&&(j=(b[L]||(b[L]={}))[a])&&j[0]===N)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[L]||(l[L]={}))[a]=[N,m]),l!==b)););return(m-=e)===d||m%d==0&&m/d>=0}}},PSEUDO:function(a,c){var e,f=u.pseudos[a]||u.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[L]?f(c):f.length>1?(e=[a,a,"",c],u.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=$(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=y(a.replace(ga,"$1"));return e[L]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),b[0]=null,!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return a=a.replace(ta,ua),function(b){return(b.textContent||b.innerText||v(b)).indexOf(a)>-1}}),lang:d(function(a){return la.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(ta,ua).toLowerCase(),function(b){var c;do{if(c=G?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return(c=c.toLowerCase())===a||0===c.indexOf(a+"-")}while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===F},focus:function(a){return a===E.activeElement&&(!E.hasFocus||E.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!u.pseudos.empty(a)},header:function(a){return oa.test(a.nodeName)},input:function(a){return na.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:h(function(){return[0]}),last:h(function(a,b){return[b-1]}),eq:h(function(a,b,c){return[c<0?c+b:c]}),even:h(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:h(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:h(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:h(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},u.pseudos.nth=u.pseudos.eq;for(s in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})u.pseudos[s]=function(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}(s);for(s in{submit:!0,reset:!0})u.pseudos[s]=function(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}(s);return j.prototype=u.filters=u.pseudos,u.setFilters=new j,x=b.tokenize=function(a,c){var d,e,f,g,h,i,j,k=Q[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=u.preFilter;h;){d&&!(e=ha.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=ia.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ga," ")}),h=h.slice(d.length));for(g in u.filter)!(e=ma[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):Q(a,i).slice(0)},y=b.compile=function(a,b){var c,d=[],e=[],f=R[a+" "];if(!f){for(b||(b=x(a)),c=b.length;c--;)f=q(b[c]),f[L]?d.push(f):e.push(f);f=R(a,r(e,d)),f.selector=a}return f},z=b.select=function(a,b,c,d){var e,f,g,h,j,l="function"==typeof a&&a,m=!d&&x(a=l.selector||a);if(c=c||[],1===m.length){if(f=m[0]=m[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&t.getById&&9===b.nodeType&&G&&u.relative[f[1].type]){if(!(b=(u.find.ID(g.matches[0].replace(ta,ua),b)||[])[0]))return c;l&&(b=b.parentNode),a=a.slice(f.shift().value.length)}for(e=ma.needsContext.test(a)?0:f.length;e--&&(g=f[e],!u.relative[h=g.type]);)if((j=u.find[h])&&(d=j(g.matches[0].replace(ta,ua),ra.test(f[0].type)&&i(b.parentNode)||b))){if(f.splice(e,1),!(a=d.length&&k(f)))return Y.apply(c,d),c;break}}return(l||y(a,m))(d,b,!G,c,ra.test(a)&&i(b.parentNode)||b),c},t.sortStable=L.split("").sort(S).join("")===L,t.detectDuplicates=!!C,D(),t.sortDetached=e(function(a){return 1&a.compareDocumentPosition(E.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),t.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){
if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(_,function(a,b,c){var d;if(!c)return!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(a);aa.find=fa,aa.expr=fa.selectors,aa.expr[":"]=aa.expr.pseudos,aa.unique=fa.uniqueSort,aa.text=fa.getText,aa.isXMLDoc=fa.isXML,aa.contains=fa.contains;var ga=aa.expr.match.needsContext,ha=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ia=/^.[^:#\[\.,]*$/;aa.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?aa.find.matchesSelector(d,a)?[d]:[]:aa.find.matches(a,aa.grep(b,function(a){return 1===a.nodeType}))},aa.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(aa(a).filter(function(){for(b=0;b<c;b++)if(aa.contains(e[b],this))return!0}));for(b=0;b<c;b++)aa.find(a,e[b],d);return d=this.pushStack(c>1?aa.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(e(this,a||[],!1))},not:function(a){return this.pushStack(e(this,a||[],!0))},is:function(a){return!!e(this,"string"==typeof a&&ga.test(a)?aa(a):a||[],!1).length}});var ja,ka=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(aa.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(!(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:ka.exec(a))||!c[1]&&b)return!b||b.jquery?(b||ja).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof aa?b[0]:b,aa.merge(this,aa.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:_,!0)),ha.test(c[1])&&aa.isPlainObject(b))for(c in b)aa.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=_.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=_,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):aa.isFunction(a)?void 0!==ja.ready?ja.ready(a):a(aa):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),aa.makeArray(a,this))}).prototype=aa.fn,ja=aa(_);var la=/^(?:parents|prev(?:Until|All))/,ma={children:!0,contents:!0,next:!0,prev:!0};aa.extend({dir:function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&aa(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),aa.fn.extend({has:function(a){var b=aa(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(aa.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=ga.test(a)||"string"!=typeof a?aa(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&aa.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?aa.unique(f):f)},index:function(a){return a?"string"==typeof a?W.call(aa(a),this[0]):W.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(aa.unique(aa.merge(this.get(),aa(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),aa.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return aa.dir(a,"parentNode")},parentsUntil:function(a,b,c){return aa.dir(a,"parentNode",c)},next:function(a){return g(a,"nextSibling")},prev:function(a){return g(a,"previousSibling")},nextAll:function(a){return aa.dir(a,"nextSibling")},prevAll:function(a){return aa.dir(a,"previousSibling")},nextUntil:function(a,b,c){return aa.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return aa.dir(a,"previousSibling",c)},siblings:function(a){return aa.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return aa.sibling(a.firstChild)},contents:function(a){return a.contentDocument||aa.merge([],a.childNodes)}},function(a,b){aa.fn[a]=function(c,d){var e=aa.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=aa.filter(d,e)),this.length>1&&(ma[a]||aa.unique(e),la.test(a)&&e.reverse()),this.pushStack(e)}});var na=/\S+/g,oa={};aa.Callbacks=function(a){a="string"==typeof a?oa[a]||h(a):aa.extend({},a);var b,c,d,e,f,g,i=[],j=!a.once&&[],k=function(h){for(b=a.memory&&h,c=!0,g=e||0,e=0,f=i.length,d=!0;i&&g<f;g++)if(!1===i[g].apply(h[0],h[1])&&a.stopOnFalse){b=!1;break}d=!1,i&&(j?j.length&&k(j.shift()):b?i=[]:l.disable())},l={add:function(){if(i){var c=i.length;!function b(c){aa.each(c,function(c,d){var e=aa.type(d);"function"===e?a.unique&&l.has(d)||i.push(d):d&&d.length&&"string"!==e&&b(d)})}(arguments),d?f=i.length:b&&(e=c,k(b))}return this},remove:function(){return i&&aa.each(arguments,function(a,b){for(var c;(c=aa.inArray(b,i,c))>-1;)i.splice(c,1),d&&(c<=f&&f--,c<=g&&g--)}),this},has:function(a){return a?aa.inArray(a,i)>-1:!(!i||!i.length)},empty:function(){return i=[],f=0,this},disable:function(){return i=j=b=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,b||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||c&&!j||(b=b||[],b=[a,b.slice?b.slice():b],d?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!c}};return l},aa.extend({Deferred:function(a){var b=[["resolve","done",aa.Callbacks("once memory"),"resolved"],["reject","fail",aa.Callbacks("once memory"),"rejected"],["notify","progress",aa.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return aa.Deferred(function(c){aa.each(b,function(b,f){var g=aa.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&aa.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?aa.extend(a,d):d}},e={};return d.pipe=d.then,aa.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=T.call(arguments),g=f.length,h=1!==g||a&&aa.isFunction(a.promise)?g:0,i=1===h?a:aa.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?T.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);e<g;e++)f[e]&&aa.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var pa;aa.fn.ready=function(a){return aa.ready.promise().done(a),this},aa.extend({isReady:!1,readyWait:1,holdReady:function(a){a?aa.readyWait++:aa.ready(!0)},ready:function(a){(!0===a?--aa.readyWait:aa.isReady)||(aa.isReady=!0,!0!==a&&--aa.readyWait>0||(pa.resolveWith(_,[aa]),aa.fn.triggerHandler&&(aa(_).triggerHandler("ready"),aa(_).off("ready"))))}}),aa.ready.promise=function(b){return pa||(pa=aa.Deferred(),"complete"===_.readyState?setTimeout(aa.ready):(_.addEventListener("DOMContentLoaded",i,!1),a.addEventListener("load",i,!1))),pa.promise(b)},aa.ready.promise();var qa=aa.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===aa.type(c)){e=!0;for(h in c)aa.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,aa.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(aa(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};aa.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType},j.uid=1,j.accepts=aa.acceptData,j.prototype={key:function(a){if(!j.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=j.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,aa.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),g=this.cache[e];if("string"==typeof b)g[b]=c;else if(aa.isEmptyObject(g))f(this.cache[e],b);else for(d in b)g[d]=b[d];return g},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,aa.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{aa.isArray(b)?d=b.concat(b.map(aa.camelCase)):(e=aa.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(na)||[])),c=d.length;for(;c--;)delete g[d[c]]}},hasData:function(a){return!aa.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var ra=new j,sa=new j,ta=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ua=/([A-Z])/g;aa.extend({hasData:function(a){return sa.hasData(a)||ra.hasData(a)},data:function(a,b,c){return sa.access(a,b,c)},removeData:function(a,b){sa.remove(a,b)},_data:function(a,b,c){return ra.access(a,b,c)},_removeData:function(a,b){ra.remove(a,b)}}),aa.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=sa.get(f),1===f.nodeType&&!ra.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=aa.camelCase(d.slice(5)),k(f,d,e[d])));ra.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){sa.set(this,a)}):qa(this,function(b){var c,d=aa.camelCase(a);if(f&&void 0===b){if(void 0!==(c=sa.get(f,a)))return c;if(void 0!==(c=sa.get(f,d)))return c;if(void 0!==(c=k(f,d,void 0)))return c}else this.each(function(){var c=sa.get(this,d);sa.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&sa.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){sa.remove(this,a)})}}),aa.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=ra.get(a,b),c&&(!d||aa.isArray(c)?d=ra.access(a,b,aa.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=aa.queue(a,b),d=c.length,e=c.shift(),f=aa._queueHooks(a,b),g=function(){aa.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return ra.get(a,c)||ra.access(a,c,{empty:aa.Callbacks("once memory").add(function(){ra.remove(a,[b+"queue",c])})})}}),aa.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?aa.queue(this[0],a):void 0===b?this:this.each(function(){var c=aa.queue(this,a,b);aa._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&aa.dequeue(this,a)})},dequeue:function(a){return this.each(function(){aa.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=aa.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)(c=ra.get(f[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var va=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,wa=["Top","Right","Bottom","Left"],xa=function(a,b){return a=b||a,"none"===aa.css(a,"display")||!aa.contains(a.ownerDocument,a)},ya=/^(?:checkbox|radio)$/i;!function(){var a=_.createDocumentFragment(),b=a.appendChild(_.createElement("div")),c=_.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),$.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",$.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();$.focusinBubbles="onfocusin"in a;var za=/^key/,Aa=/^(?:mouse|pointer|contextmenu)|click/,Ba=/^(?:focusinfocus|focusoutblur)$/,Ca=/^([^.]*)(?:\.(.+)|)$/;aa.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=ra.get(a);if(q)for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=aa.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return void 0!==aa&&aa.event.triggered!==b.type?aa.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(na)||[""],j=b.length;j--;)h=Ca.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=aa.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=aa.event.special[n]||{},k=aa.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&aa.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&!1!==l.setup.call(a,d,o,g)||a.addEventListener&&a.addEventListener(n,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),aa.event.global[n]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=ra.hasData(a)&&ra.get(a);if(q&&(i=q.events)){for(b=(b||"").match(na)||[""],j=b.length;j--;)if(h=Ca.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=aa.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&!1!==l.teardown.call(a,o,q.handle)||aa.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)aa.event.remove(a,n+b[j],c,d,!0);aa.isEmptyObject(i)&&(delete q.handle,ra.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,j,k,l,m=[d||_],n=Z.call(b,"type")?b.type:b,o=Z.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||_,3!==d.nodeType&&8!==d.nodeType&&!Ba.test(n+aa.event.triggered)&&(n.indexOf(".")>=0&&(o=n.split("."),n=o.shift(),o.sort()),j=n.indexOf(":")<0&&"on"+n,b=b[aa.expando]?b:new aa.Event(n,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=o.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:aa.makeArray(c,[b]),l=aa.event.special[n]||{},e||!l.trigger||!1!==l.trigger.apply(d,c))){if(!e&&!l.noBubble&&!aa.isWindow(d)){for(i=l.delegateType||n,Ba.test(i+n)||(g=g.parentNode);g;g=g.parentNode)m.push(g),h=g;h===(d.ownerDocument||_)&&m.push(h.defaultView||h.parentWindow||a)}for(f=0;(g=m[f++])&&!b.isPropagationStopped();)b.type=f>1?i:l.bindType||n,k=(ra.get(g,"events")||{})[b.type]&&ra.get(g,"handle"),k&&k.apply(g,c),(k=j&&g[j])&&k.apply&&aa.acceptData(g)&&(b.result=k.apply(g,c),!1===b.result&&b.preventDefault());return b.type=n,e||b.isDefaultPrevented()||l._default&&!1!==l._default.apply(m.pop(),c)||!aa.acceptData(d)||j&&aa.isFunction(d[n])&&!aa.isWindow(d)&&(h=d[j],h&&(d[j]=null),aa.event.triggered=n,d[n](),aa.event.triggered=void 0,h&&(d[j]=h)),b.result}},dispatch:function(a){a=aa.event.fix(a);var b,c,d,e,f,g=[],h=T.call(arguments),i=(ra.get(this,"events")||{})[a.type]||[],j=aa.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||!1!==j.preDispatch.call(this,a)){for(g=aa.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(f=e.handlers[c++])&&!a.isImmediatePropagationStopped();)a.namespace_re&&!a.namespace_re.test(f.namespace)||(a.handleObj=f,a.data=f.data,void 0!==(d=((aa.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,h))&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(!0!==i.disabled||"click"!==a.type){for(d=[],c=0;c<h;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?aa(e,this).index(i)>=0:aa.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||_,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[aa.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Aa.test(e)?this.mouseHooks:za.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new aa.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=_),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==n()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===n()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&aa.nodeName(this,"input"))return this.click(),!1},_default:function(a){return aa.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=aa.extend(new aa.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?aa.event.trigger(e,null,b):aa.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},aa.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},aa.Event=function(a,b){if(!(this instanceof aa.Event))return new aa.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?l:m):this.type=a,b&&aa.extend(this,b),this.timeStamp=a&&a.timeStamp||aa.now(),this[aa.expando]=!0},aa.Event.prototype={isDefaultPrevented:m,isPropagationStopped:m,isImmediatePropagationStopped:m,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=l,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=l,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=l,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},aa.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){aa.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||aa.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),$.focusinBubbles||aa.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){aa.event.simulate(b,a.target,aa.event.fix(a),!0)};aa.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=ra.access(d,b);e||d.addEventListener(a,c,!0),ra.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=ra.access(d,b)-1;e?ra.access(d,b,e):(d.removeEventListener(a,c,!0),ra.remove(d,b))}}}),aa.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),!1===d)d=m;else if(!d)return this;return 1===e&&(f=d,d=function(a){return aa().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=aa.guid++)),this.each(function(){aa.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,aa(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return!1!==b&&"function"!=typeof b||(c=b,b=void 0),!1===c&&(c=m),this.each(function(){aa.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){aa.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return aa.event.trigger(a,b,c,!0)}});var Da=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ea=/<([\w:]+)/,Fa=/<|&#?\w+;/,Ga=/<(?:script|style|link)/i,Ha=/checked\s*(?:[^=]|=\s*.checked.)/i,Ia=/^$|\/(?:java|ecma)script/i,Ja=/^true\/(.*)/,Ka=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,La={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};La.optgroup=La.option,La.tbody=La.tfoot=La.colgroup=La.caption=La.thead,La.th=La.td,aa.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=aa.contains(a.ownerDocument,a);if(!($.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||aa.isXMLDoc(a)))for(g=t(h),f=t(a),d=0,e=f.length;d<e;d++)u(f[d],g[d]);if(b)if(c)for(f=f||t(a),g=g||t(h),d=0,e=f.length;d<e;d++)s(f[d],g[d]);else s(a,h);return g=t(h,"script"),g.length>0&&r(g,!i&&t(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,n=a.length;m<n;m++)if((e=a[m])||0===e)if("object"===aa.type(e))aa.merge(l,e.nodeType?[e]:e);else if(Fa.test(e)){for(f=f||k.appendChild(b.createElement("div")),g=(Ea.exec(e)||["",""])[1].toLowerCase(),h=La[g]||La._default,f.innerHTML=h[1]+e.replace(Da,"<$1></$2>")+h[2],j=h[0];j--;)f=f.lastChild;aa.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));for(k.textContent="",m=0;e=l[m++];)if((!d||-1===aa.inArray(e,d))&&(i=aa.contains(e.ownerDocument,e),f=t(k.appendChild(e),"script"),i&&r(f),c))for(j=0;e=f[j++];)Ia.test(e.type||"")&&c.push(e);return k},cleanData:function(a){for(var b,c,d,e,f=aa.event.special,g=0;void 0!==(c=a[g]);g++){if(aa.acceptData(c)&&(e=c[ra.expando])&&(b=ra.cache[e])){if(b.events)for(d in b.events)f[d]?aa.event.remove(c,d):aa.removeEvent(c,d,b.handle);ra.cache[e]&&delete ra.cache[e]}delete sa.cache[c[sa.expando]]}}}),aa.fn.extend({text:function(a){return qa(this,function(a){return void 0===a?aa.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){o(this,a).appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=o(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?aa.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||aa.cleanData(t(c)),c.parentNode&&(b&&aa.contains(c.ownerDocument,c)&&r(t(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(aa.cleanData(t(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return aa.clone(this,a,b)})},html:function(a){return qa(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Ga.test(a)&&!La[(Ea.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Da,"<$1></$2>");try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(aa.cleanData(t(b,!1)),b.innerHTML=a);b=0}catch(a){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,aa.cleanData(t(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=U.apply([],a);var c,d,e,f,g,h,i=0,j=this.length,k=this,l=j-1,m=a[0],n=aa.isFunction(m);if(n||j>1&&"string"==typeof m&&!$.checkClone&&Ha.test(m))return this.each(function(c){var d=k.eq(c);n&&(a[0]=m.call(this,c,d.html())),d.domManip(a,b)});if(j&&(c=aa.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(e=aa.map(t(c,"script"),p),f=e.length;i<j;i++)g=c,i!==l&&(g=aa.clone(g,!0,!0),f&&aa.merge(e,t(g,"script"))),b.call(this[i],g,i);if(f)for(h=e[e.length-1].ownerDocument,aa.map(e,q),i=0;i<f;i++)g=e[i],Ia.test(g.type||"")&&!ra.access(g,"globalEval")&&aa.contains(h,g)&&(g.src?aa._evalUrl&&aa._evalUrl(g.src):aa.globalEval(g.textContent.replace(Ka,"")))}return this}}),aa.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){aa.fn[a]=function(a){for(var c,d=[],e=aa(a),f=e.length-1,g=0;g<=f;g++)c=g===f?this:this.clone(!0),aa(e[g])[b](c),V.apply(d,c.get());return this.pushStack(d)}});var Ma,Na={},Oa=/^margin/,Pa=new RegExp("^("+va+")(?!px)[a-z%]+$","i"),Qa=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)};!function(){function b(){g.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",g.innerHTML="",e.appendChild(f);var b=a.getComputedStyle(g,null);c="1%"!==b.top,d="4px"===b.width,e.removeChild(f)}var c,d,e=_.documentElement,f=_.createElement("div"),g=_.createElement("div");g.style&&(g.style.backgroundClip="content-box",g.cloneNode(!0).style.backgroundClip="",$.clearCloneStyle="content-box"===g.style.backgroundClip,f.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",f.appendChild(g),a.getComputedStyle&&aa.extend($,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return null==d&&b(),d},reliableMarginRight:function(){var b,c=g.appendChild(_.createElement("div"));return c.style.cssText=g.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",g.style.width="1px",e.appendChild(f),b=!parseFloat(a.getComputedStyle(c,null).marginRight),e.removeChild(f),g.removeChild(c),b}}))}(),aa.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Ra=/^(none|table(?!-c[ea]).+)/,Sa=new RegExp("^("+va+")(.*)$","i"),Ta=new RegExp("^([+-])=("+va+")","i"),Ua={position:"absolute",visibility:"hidden",display:"block"},Va={letterSpacing:"0",fontWeight:"400"},Wa=["Webkit","O","Moz","ms"];aa.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=x(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=aa.camelCase(b),i=a.style;if(b=aa.cssProps[h]||(aa.cssProps[h]=z(i,h)),g=aa.cssHooks[b]||aa.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];f=typeof c,"string"===f&&(e=Ta.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(aa.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||aa.cssNumber[h]||(c+="px"),$.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c))}},css:function(a,b,c,d){var e,f,g,h=aa.camelCase(b);return b=aa.cssProps[h]||(aa.cssProps[h]=z(a.style,h)),g=aa.cssHooks[b]||aa.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=x(a,b,d)),"normal"===e&&b in Va&&(e=Va[b]),""===c||c?(f=parseFloat(e),!0===c||aa.isNumeric(f)?f||0:e):e}}),aa.each(["height","width"],function(a,b){aa.cssHooks[b]={get:function(a,c,d){if(c)return Ra.test(aa.css(a,"display"))&&0===a.offsetWidth?aa.swap(a,Ua,function(){return C(a,b,d)}):C(a,b,d)},set:function(a,c,d){var e=d&&Qa(a);return A(a,c,d?B(a,b,d,"border-box"===aa.css(a,"boxSizing",!1,e),e):0)}}}),aa.cssHooks.marginRight=y($.reliableMarginRight,function(a,b){if(b)return aa.swap(a,{display:"inline-block"},x,[a,"marginRight"])}),aa.each({margin:"",padding:"",border:"Width"},function(a,b){aa.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+wa[d]+b]=f[d]||f[d-2]||f[0];return e}},Oa.test(a)||(aa.cssHooks[a+b].set=A)}),aa.fn.extend({css:function(a,b){return qa(this,function(a,b,c){var d,e,f={},g=0;if(aa.isArray(b)){for(d=Qa(a),e=b.length;g<e;g++)f[b[g]]=aa.css(a,b[g],!1,d);return f}return void 0!==c?aa.style(a,b,c):aa.css(a,b)},a,b,arguments.length>1)},show:function(){return D(this,!0)},hide:function(){return D(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){xa(this)?aa(this).show():aa(this).hide()})}}),aa.Tween=E,E.prototype={constructor:E,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(aa.cssNumber[c]?"":"px")},cur:function(){var a=E.propHooks[this.prop];return a&&a.get?a.get(this):E.propHooks._default.get(this)},run:function(a){var b,c=E.propHooks[this.prop];return this.options.duration?this.pos=b=aa.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):E.propHooks._default.set(this),this}},E.prototype.init.prototype=E.prototype,E.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=aa.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){aa.fx.step[a.prop]?aa.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[aa.cssProps[a.prop]]||aa.cssHooks[a.prop])?aa.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},E.propHooks.scrollTop=E.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},aa.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},aa.fx=E.prototype.init,aa.fx.step={};var Xa,Ya,Za=/^(?:toggle|show|hide)$/,$a=new RegExp("^(?:([+-])=|)("+va+")([a-z%]*)$","i"),_a=/queueHooks$/,ab=[I],bb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=$a.exec(b),f=e&&e[3]||(aa.cssNumber[a]?"":"px"),g=(aa.cssNumber[a]||"px"!==f&&+d)&&$a.exec(aa.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do{h=h||".5",g/=h,aa.style(c.elem,a,g+f)}while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};aa.Animation=aa.extend(K,{tweener:function(a,b){aa.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],bb[c]=bb[c]||[],bb[c].unshift(b)},prefilter:function(a,b){b?ab.unshift(a):ab.push(a)}}),aa.speed=function(a,b,c){var d=a&&"object"==typeof a?aa.extend({},a):{complete:c||!c&&b||aa.isFunction(a)&&a,duration:a,easing:c&&b||b&&!aa.isFunction(b)&&b};return d.duration=aa.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in aa.fx.speeds?aa.fx.speeds[d.duration]:aa.fx.speeds._default,null!=d.queue&&!0!==d.queue||(d.queue="fx"),d.old=d.complete,d.complete=function(){aa.isFunction(d.old)&&d.old.call(this),d.queue&&aa.dequeue(this,d.queue)},d},aa.fn.extend({fadeTo:function(a,b,c,d){
return this.filter(xa).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=aa.isEmptyObject(a),f=aa.speed(b,c,d),g=function(){var b=K(this,aa.extend({},a),f);(e||ra.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||!1===f.queue?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=aa.timers,g=ra.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&_a.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||aa.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,c=ra.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=aa.timers,g=d?d.length:0;for(c.finish=!0,aa.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),aa.each(["toggle","show","hide"],function(a,b){var c=aa.fn[b];aa.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(G(b,!0),a,d,e)}}),aa.each({slideDown:G("show"),slideUp:G("hide"),slideToggle:G("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){aa.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),aa.timers=[],aa.fx.tick=function(){var a,b=0,c=aa.timers;for(Xa=aa.now();b<c.length;b++)(a=c[b])()||c[b]!==a||c.splice(b--,1);c.length||aa.fx.stop(),Xa=void 0},aa.fx.timer=function(a){aa.timers.push(a),a()?aa.fx.start():aa.timers.pop()},aa.fx.interval=13,aa.fx.start=function(){Ya||(Ya=setInterval(aa.fx.tick,aa.fx.interval))},aa.fx.stop=function(){clearInterval(Ya),Ya=null},aa.fx.speeds={slow:600,fast:200,_default:400},aa.fn.delay=function(a,b){return a=aa.fx?aa.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=_.createElement("input"),b=_.createElement("select"),c=b.appendChild(_.createElement("option"));a.type="checkbox",$.checkOn=""!==a.value,$.optSelected=c.selected,b.disabled=!0,$.optDisabled=!c.disabled,a=_.createElement("input"),a.value="t",a.type="radio",$.radioValue="t"===a.value}();var cb,db=aa.expr.attrHandle;aa.fn.extend({attr:function(a,b){return qa(this,aa.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){aa.removeAttr(this,a)})}}),aa.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return void 0===a.getAttribute?aa.prop(a,b,c):(1===f&&aa.isXMLDoc(a)||(b=b.toLowerCase(),d=aa.attrHooks[b]||(aa.expr.match.bool.test(b)?cb:void 0)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=aa.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void aa.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(na);if(f&&1===a.nodeType)for(;c=f[e++];)d=aa.propFix[c]||c,aa.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!$.radioValue&&"radio"===b&&aa.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),cb={set:function(a,b,c){return!1===b?aa.removeAttr(a,c):a.setAttribute(c,c),c}},aa.each(aa.expr.match.bool.source.match(/\w+/g),function(a,b){var c=db[b]||aa.find.attr;db[b]=function(a,b,d){var e,f;return d||(f=db[b],db[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,db[b]=f),e}});var eb=/^(?:input|select|textarea|button)$/i;aa.fn.extend({prop:function(a,b){return qa(this,aa.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[aa.propFix[a]||a]})}}),aa.extend({propFix:{for:"htmlFor",class:"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!aa.isXMLDoc(a),f&&(b=aa.propFix[b]||b,e=aa.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||eb.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),$.optSelected||(aa.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),aa.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){aa.propFix[this.toLowerCase()]=this});var fb=/[\t\r\n\f]/g;aa.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(aa.isFunction(a))return this.each(function(b){aa(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(na)||[];i<j;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(fb," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=aa.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(aa.isFunction(a))return this.each(function(b){aa(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(na)||[];i<j;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(fb," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");g=a?aa.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):aa.isFunction(a)?this.each(function(c){aa(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=aa(this),f=a.match(na)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else"undefined"!==c&&"boolean"!==c||(this.className&&ra.set(this,"__className__",this.className),this.className=this.className||!1===a?"":ra.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;c<d;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(fb," ").indexOf(b)>=0)return!0;return!1}});var gb=/\r/g;aa.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=aa.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,aa(this).val()):a,null==e?e="":"number"==typeof e?e+="":aa.isArray(e)&&(e=aa.map(e,function(a){return null==a?"":a+""})),(b=aa.valHooks[this.type]||aa.valHooks[this.nodeName.toLowerCase()])&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return(b=aa.valHooks[e.type]||aa.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(gb,""):null==c?"":c)}}}),aa.extend({valHooks:{option:{get:function(a){var b=aa.find.attr(a,"value");return null!=b?b:aa.trim(aa.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?null:[],h=f?e+1:d.length,i=e<0?h:f?e:0;i<h;i++)if(c=d[i],(c.selected||i===e)&&($.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!aa.nodeName(c.parentNode,"optgroup"))){if(b=aa(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=aa.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=aa.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),aa.each(["radio","checkbox"],function(){aa.valHooks[this]={set:function(a,b){if(aa.isArray(b))return a.checked=aa.inArray(aa(a).val(),b)>=0}},$.checkOn||(aa.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),aa.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){aa.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),aa.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var hb=aa.now(),ib=/\?/;aa.parseJSON=function(a){return JSON.parse(a+"")},aa.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(a){b=void 0}return b&&!b.getElementsByTagName("parsererror").length||aa.error("Invalid XML: "+a),b};var jb=/#.*$/,kb=/([?&])_=[^&]*/,lb=/^(.*?):[ \t]*([^\r\n]*)$/gm,mb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,nb=/^(?:GET|HEAD)$/,ob=/^\/\//,pb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,qb={},rb={},sb="*/".concat("*"),tb=a.location.href,ub=pb.exec(tb.toLowerCase())||[];aa.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:tb,type:"GET",isLocal:mb.test(ub[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":aa.parseJSON,"text xml":aa.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?N(N(a,aa.ajaxSettings),b):N(aa.ajaxSettings,a)},ajaxPrefilter:L(qb),ajaxTransport:L(rb),ajax:function(a,b){function c(a,b,c,g){var i,k,r,s,u,w=b;2!==t&&(t=2,h&&clearTimeout(h),d=void 0,f=g||"",v.readyState=a>0?4:0,i=a>=200&&a<300||304===a,c&&(s=O(l,v,c)),s=P(l,s,v,i),i?(l.ifModified&&(u=v.getResponseHeader("Last-Modified"),u&&(aa.lastModified[e]=u),(u=v.getResponseHeader("etag"))&&(aa.etag[e]=u)),204===a||"HEAD"===l.type?w="nocontent":304===a?w="notmodified":(w=s.state,k=s.data,r=s.error,i=!r)):(r=w,!a&&w||(w="error",a<0&&(a=0))),v.status=a,v.statusText=(b||w)+"",i?o.resolveWith(m,[k,w,v]):o.rejectWith(m,[v,w,r]),v.statusCode(q),q=void 0,j&&n.trigger(i?"ajaxSuccess":"ajaxError",[v,l,i?k:r]),p.fireWith(m,[v,w]),j&&(n.trigger("ajaxComplete",[v,l]),--aa.active||aa.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,f,g,h,i,j,k,l=aa.ajaxSetup({},b),m=l.context||l,n=l.context&&(m.nodeType||m.jquery)?aa(m):aa.event,o=aa.Deferred(),p=aa.Callbacks("once memory"),q=l.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!g)for(g={};b=lb.exec(f);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(l.mimeType=a),this},statusCode:function(a){var b;if(a)if(t<2)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return d&&d.abort(b),c(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,l.url=((a||l.url||tb)+"").replace(jb,"").replace(ob,ub[1]+"//"),l.type=b.method||b.type||l.method||l.type,l.dataTypes=aa.trim(l.dataType||"*").toLowerCase().match(na)||[""],null==l.crossDomain&&(i=pb.exec(l.url.toLowerCase()),l.crossDomain=!(!i||i[1]===ub[1]&&i[2]===ub[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(ub[3]||("http:"===ub[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=aa.param(l.data,l.traditional)),M(qb,l,b,v),2===t)return v;j=aa.event&&l.global,j&&0==aa.active++&&aa.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!nb.test(l.type),e=l.url,l.hasContent||(l.data&&(e=l.url+=(ib.test(e)?"&":"?")+l.data,delete l.data),!1===l.cache&&(l.url=kb.test(e)?e.replace(kb,"$1_="+hb++):e+(ib.test(e)?"&":"?")+"_="+hb++)),l.ifModified&&(aa.lastModified[e]&&v.setRequestHeader("If-Modified-Since",aa.lastModified[e]),aa.etag[e]&&v.setRequestHeader("If-None-Match",aa.etag[e])),(l.data&&l.hasContent&&!1!==l.contentType||b.contentType)&&v.setRequestHeader("Content-Type",l.contentType),v.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+sb+"; q=0.01":""):l.accepts["*"]);for(k in l.headers)v.setRequestHeader(k,l.headers[k]);if(l.beforeSend&&(!1===l.beforeSend.call(m,v,l)||2===t))return v.abort();u="abort";for(k in{success:1,error:1,complete:1})v[k](l[k]);if(d=M(rb,l,b,v)){v.readyState=1,j&&n.trigger("ajaxSend",[v,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){v.abort("timeout")},l.timeout));try{t=1,d.send(r,c)}catch(a){if(!(t<2))throw a;c(-1,a)}}else c(-1,"No Transport");return v},getJSON:function(a,b,c){return aa.get(a,b,c,"json")},getScript:function(a,b){return aa.get(a,void 0,b,"script")}}),aa.each(["get","post"],function(a,b){aa[b]=function(a,c,d,e){return aa.isFunction(c)&&(e=e||d,d=c,c=void 0),aa.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),aa._evalUrl=function(a){return aa.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},aa.fn.extend({wrapAll:function(a){var b;return aa.isFunction(a)?this.each(function(b){aa(this).wrapAll(a.call(this,b))}):(this[0]&&(b=aa(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return aa.isFunction(a)?this.each(function(b){aa(this).wrapInner(a.call(this,b))}):this.each(function(){var b=aa(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=aa.isFunction(a);return this.each(function(c){aa(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){aa.nodeName(this,"body")||aa(this).replaceWith(this.childNodes)}).end()}}),aa.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},aa.expr.filters.visible=function(a){return!aa.expr.filters.hidden(a)};var vb=/%20/g,wb=/\[\]$/,xb=/\r?\n/g,yb=/^(?:submit|button|image|reset|file)$/i,zb=/^(?:input|select|textarea|keygen)/i;aa.param=function(a,b){var c,d=[],e=function(a,b){b=aa.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=aa.ajaxSettings&&aa.ajaxSettings.traditional),aa.isArray(a)||a.jquery&&!aa.isPlainObject(a))aa.each(a,function(){e(this.name,this.value)});else for(c in a)Q(c,a[c],b,e);return d.join("&").replace(vb,"+")},aa.fn.extend({serialize:function(){return aa.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=aa.prop(this,"elements");return a?aa.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!aa(this).is(":disabled")&&zb.test(this.nodeName)&&!yb.test(a)&&(this.checked||!ya.test(a))}).map(function(a,b){var c=aa(this).val();return null==c?null:aa.isArray(c)?aa.map(c,function(a){return{name:b.name,value:a.replace(xb,"\r\n")}}):{name:b.name,value:c.replace(xb,"\r\n")}}).get()}}),aa.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Ab=0,Bb={},Cb={0:200,1223:204},Db=aa.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Bb)Bb[a]()}),$.cors=!!Db&&"withCredentials"in Db,$.ajax=Db=!!Db,aa.ajaxTransport(function(a){var b;if($.cors||Db&&!a.crossDomain)return{send:function(c,d){var e,f=a.xhr(),g=++Ab;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Bb[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Cb[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Bb[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(a){if(b)throw a}},abort:function(){b&&b()}}}),aa.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return aa.globalEval(a),a}}}),aa.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),aa.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=aa("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),_.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Eb=[],Fb=/(=)\?(?=&|$)|\?\?/;aa.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Eb.pop()||aa.expando+"_"+hb++;return this[a]=!0,a}}),aa.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=!1!==b.jsonp&&(Fb.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Fb.test(b.data)&&"data");if(h||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=aa.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Fb,"$1"+e):!1!==b.jsonp&&(b.url+=(ib.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||aa.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Eb.push(e)),g&&aa.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),aa.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||_;var d=ha.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=aa.buildFragment([a],b,e),e&&e.length&&aa(e).remove(),aa.merge([],d.childNodes))};var Gb=aa.fn.load;aa.fn.load=function(a,b,c){if("string"!=typeof a&&Gb)return Gb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=aa.trim(a.slice(h)),a=a.slice(0,h)),aa.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&aa.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?aa("<div>").append(aa.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},aa.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){aa.fn[b]=function(a){return this.on(b,a)}}),aa.expr.filters.animated=function(a){return aa.grep(aa.timers,function(b){return a===b.elem}).length};var Hb=a.document.documentElement;aa.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=aa.css(a,"position"),l=aa(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=aa.css(a,"top"),i=aa.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),aa.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},aa.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){aa.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,aa.contains(b,d)?(void 0!==d.getBoundingClientRect&&(e=d.getBoundingClientRect()),c=R(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===aa.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),aa.nodeName(a[0],"html")||(d=a.offset()),d.top+=aa.css(a[0],"borderTopWidth",!0),d.left+=aa.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-aa.css(c,"marginTop",!0),left:b.left-d.left-aa.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||Hb;a&&!aa.nodeName(a,"html")&&"static"===aa.css(a,"position");)a=a.offsetParent;return a||Hb})}}),aa.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;aa.fn[b]=function(e){return qa(this,function(b,e,f){var g=R(b);if(void 0===f)return g?g[c]:b[e];g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f},b,e,arguments.length,null)}}),aa.each(["top","left"],function(a,b){aa.cssHooks[b]=y($.pixelPosition,function(a,c){if(c)return c=x(a,b),Pa.test(c)?aa(a).position()[b]+"px":c})}),aa.each({Height:"height",Width:"width"},function(a,b){aa.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){aa.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(!0===d||!0===e?"margin":"border");return qa(this,function(b,c,d){var e;return aa.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?aa.css(b,c,g):aa.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),aa.fn.size=function(){return this.length},aa.fn.andSelf=aa.fn.addBack,"function"==typeof b&&b.amd&&b("jquery",[],function(){return aa});var Ib=a.jQuery,Jb=a.$;return aa.noConflict=function(b){return a.$===aa&&(a.$=Jb),b&&a.jQuery===aa&&(a.jQuery=Ib),aa},aa}(a)}),b("spreadsheet/config",function(){return{User:{initRowNum:100,initColNum:26,cellWidth:72,cellHeight:20,maxColNum:100,maxRowNum:9999,commentWidth:150,commentHeight:150},System:{outerLeft:37,outerTop:20,outerBottom:30,effectDistanceCol:10,effectDistanceRow:5,prestrainHeight:200,prestrainWidth:100,maxRowNum:9999,comment:{height:150,width:150}},validationType:{defaultType:0,intType:1,decimalType:2,sequenceType:3,textType:6},sidebarWidth:280,mouseOperateState:{select:"selected",dataSource:"datasource",drag:"drag",highlight:"highlight",ruleSource:"rule"},dateFormatType:{frist:"yyyy/MM/dd",second:"yyyy/MM",third:"yyyy",fourth:"yyyy年MM月dd日",fifth:"yyyy年MM月",sixth:"yyyy年"},defaultNumberFormat:{decimal:6},shortcuts:{clip:!0,alt_enter:!0,enter:!0,delete:!0,redo:!0,undo:!0,arrow:!0},url:{row:{plus:"row/plus",reduce:"row/reduce",hide:"row/hide",show:"row/show",adjust:"row/adjust",plusBatch:"row/plus-batch"},col:{plus:"col/plus",reduce:"col/reduce",hide:"col/hide",show:"col/show",adjust:"col/adjust",plus_batch:"col/plus-batch"},cell:{merge:"cell/merge",split:"cell/split",border:"cell/border",bg:"cell/bg",wordwrap:"cell/wordwrap",alignTransverse:"cell/align-landscape",alignVertical:"cell/align-portrait",format:"cell/format",content:"cell/content",commentPlus:"cell/comment-plus",commentDel:"cell/comment-reduce",fontSize:"cell/font-size",fontFamily:"cell/font-family",fontWeight:"cell/font-weight",fontItalic:"cell/font-italic",fontColor:"cell/font-color",bgBatch:"cell/bg-batch",underline:"cell/font-underline",clear:"cell/clean-data",lock:"cell/lock"},table:{reload:"reload"},sheet:{cut:"sheet/cut",copy:"sheet/copy",paste:"sheet/paste",undo:"sheet/undo",redo:"sheet/redo",frozen:"sheet/frozen",unfrozen:"sheet/unfrozen",load:"sheet/area",protect:"sheet/protect",validate:"sheet/validate-set",validateFull:"sheet/validate-full"}},version:"0.12.0",rootPath:"http://excel-inc.acmr.com.cn/"}}),b("basic/tools/cache",function(){return{sendQueueStep:0,containerId:"",CurrentRule:{},FrozenRules:{main:[],row:[],col:[]},scrollBarWidth:null,scrollBufferHeight:600,CellsPosition:{strandX:{},strandY:{}},clipState:"null",validate:[],validateCounter:0,UserView:{colAlias:"1",rowAlias:"1",colEndAlias:"1",rowEndAlias:"1"},highlightDirection:"null",mouseOperateState:c("spreadsheet/config").mouseOperateState.select,listenerList:{},localRowPosi:0,localColPosi:0,aliasRowCounter:"100",aliasColCounter:"26",loadCol:{startSort:0,endSort:0},TempProp:{isFrozen:!1,colAlias:"1",rowAlias:"1",rowFrozen:!1,colFrozen:!1},rowRegionPosi:[],colRegionPosi:[],cellRegionPosi:{transverse:[],vertical:[]},viewRegion:{top:0,bottom:0,left:0,right:0,scrollLeft:0,scrollTop:0},commentEidtState:!1,clipboardData:null,shortcut:{select:{colAlias:"1",rowAlias:"1"}},sidebarState:!1,protectState:!1,redoUndoLock:!1,cachePosition:function(a,b,c){var d,e;d=this.CellsPosition.strandX,d[b]||(d[b]={}),d[b][a]||(d[b][a]={}),e=this.CellsPosition.strandY,e[a]||(e[a]={}),e[a][b]||(e[a][b]={}),d[b][a]=c,e[a][b]=c},deletePosi:function(a,b){var c=this.CellsPosition,d=c.strandX,e=c.strandY;void 0!==d[b]&&void 0!==d[b][a]&&(delete d[b][a],Object.getOwnPropertyNames(d[b]).length||delete d[b]),void 0!==e[a]&&void 0!==e[a][b]&&(delete e[a][b],Object.getOwnPropertyNames(e[a]).length||delete e[a])},aliasGenerator:function(a){var b,c;return b="col"===a?this.aliasColCounter:this.aliasRowCounter,c=parseInt(b),b=(c+1).toString(),"col"===a?this.aliasColCounter=b:this.aliasRowCounter=b,b}}}),b("basic/tools/point",function(){return function(a){var b=/^[A-Z]+$/,c=/^[1-9]+[0-9]*$/;if("object"!=typeof a)throw new Error("Parameter format error");if(this.startCol=a.startCol,this.startRow=a.startRow,this.endCol=a.endCol||a.startCol,this.endRow=a.endRow||a.startRow,this.success=a.success,this.error=a.error,void 0===this.startRow&&void 0===this.startCol)throw new Error("Parameter format error");if(void 0!==this.startCol&&!b.test(this.startCol))throw new Error("Parameter format error");if(void 0!==this.startRow&&!c.test(this.startRow))throw new Error("Parameter format error");if(void 0!==this.endCol&&!b.test(this.endCol))throw new Error("Parameter format error");if(void 0!==this.endRow&&!c.test(this.endRow))throw new Error("Parameter format error");if(!this.success&&"function"==typeof this.success)throw new Error("Parameter format error");if(!this.error&&"function"==typeof this.error)throw new Error("Parameter format error")}}),b("basic/util/binary",function(){return{modelBinary:function(a,b,c,d,e,f){var g,h,i,j,k,l=e||0,m=Math.floor(a);if(h=void 0===f?b.length-1:f,l<=h){if(b[l].get(c)===m)return l;if(b[h].get(c)===m)return h;if(g=h+l>>>1,k=b[g],i=k.get(c),j=k.get(d),i<=m&&i+j>=m)return g;if(i>m)return this.modelBinary(m,b,c,d,l,g-1);if(i+j<m)return this.modelBinary(m,b,c,d,g+1,h)}return-1},newModelBinary:function(a,b,c,d,e,f){for(var g,h,i,j,k=e||0,l=f||b.length,m=Math.floor(a);k<l;)g=l+k>>>1,j=b[g],h=j.get(c),i=j.get(d),h+i<m?k=g+1:l=g;return k},indexModelBinary:function(a,b,c,d,e,f){if(0===b.length)return 0;var g,h,i,j,k=e||0,l=f||b.length-1,m=Math.floor(a);if(1===b.length)return b[0].get(c)+b[0].get(d)>=m?0:1;for(;k<l;){if(b[k].get(c)+b[k].get(d)>=m)return k;if(b[l].get(c)+b[l].get(d)===m)return l;if(b[l].get(c)+b[l].get(d)<m)return l+1;g=l+k>>>1,j=b[g],h=j.get(c),i=j.get(d),h+i<m?k=g+1:l=g}return k},existArrayBinary:function(a,b,c,d,e,f){var g,h=e||0,i=f||b.length-1,j=Math.floor(a);if(0===b.length)return!1;if(1===b.length)return b[0][d]>=j&&b[0][c]<=j;for(;h<i;){if(b[h][c]<=j&&b[h][d]>=j)return!0;if(b[i][c]<=j&&b[i][d]>=j)return!0;if(g=i+h>>>1,b[i][c]<=j&&b[i][d]>=j)return!0;b[g][d]<j?h=g+1:i=g}return!1},indexArrayBinary:function(a,b,c,d,e,f){var g,h=e||0,i=f||b.length-1,j=Math.floor(a);if(0===b.length)return 0;if(1===b.length)return b[h][d]<j?1:0;for(;h<i;){if(b[h][c]>=j)return h;if(b[i][d]<j)return i+1;if(g=i+h>>>1,b[g][c]<=j&&b[g][d]>=j)return g;b[g][d]<j?h=g+1:i=g}return h},indexAttrBinary:function(a,b,c,d,e){var f;if(d=d||0,e=e||b.length-1,b[d].attributes[c]>a)return-1;if(b[e].attributes[c]<a)return-1;for(;d<e;){if(b[d].attributes[c]===a)return d;if(b[e].attributes[c]===a)return e;if(f=e+d>>>1,b[f].attributes[c]===a)return f;b[f].attributes[c]<a?d=f+1:e=f}return-1}}}),b("basic/tools/send",function(){var b=c("lib/jquery"),d=c("basic/tools/cache"),e=c("spreadsheet/config");return{PackAjax:function(c){var f={},g=function(){};c.url&&(f={url:"string"==typeof c.url?e.rootPath+c.url:void 0,type:c.type||"post",contentType:c.contentType||"application/json; charset=UTF-8",dataType:c.dataType||"json",data:c.data||"",async:void 0!==c.async&&c.async,timeout:c.timeout||5e3,success:c.success||g,error:c.error||g,complete:c.complete||g,isPublic:void 0===c.isPublic||c.isPublic},function(c){b.ajax({url:c.url,beforeSend:function(b){c.isPublic&&d.sendQueueStep++,b.setRequestHeader("step",d.sendQueueStep),b.setRequestHeader("excelId",a.SPREADSHEET_AUTHENTIC_KEY),b.setRequestHeader("sheetId","1")},type:c.type,contentType:c.contentType,dataType:c.dataType,async:c.async,data:c.data,timeout:c.timeout,error:c.error,complete:c.complete,success:function(a){!1===a.isLegal&&d.sendQueueStep--,c.success.apply(this,arguments)}})}(f))}}}),b("basic/tools/text2sort",function(){function a(a){function b(a){if("MAX"===a)return a;for(var b,c=0,d=0,e=a.length,f=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];c<e;c++)b=f.indexOf(a[c])+1,d+=b*Math.pow(26,e-c-1);return d-1}function c(a){return"MAX"===a?a:parseInt(a)-1}var d,e,f,g,h,i,j,k,l=/^\$([A-Z]+)\$([0-9]+)$/,m=/^\$([0-9]+)$/,n=/^\$([A-Z]+)$/;if(0===a.indexOf("=")&&(a=a.substring(1)),a=a.split(":"),j=a[0],void 0===(k=a[1])){if(!(h=l.exec(j)))return;d=h[1],e=h[2],f=h[1],g=h[2]}else(h=l.exec(j))&&(i=l.exec(k))?(d=h[1],e=h[2],f=i[1],g=i[2]):(h=m.exec(j))&&(i=m.exec(k))?(d="A",e=h[1],f="MAX",g=i[1]):(h=n.exec(j))&&(i=n.exec(k))&&(d=h[1],e="1",f=i[1],g="MAX");return d?{startColSort:b(d),endColSort:b(f),startRowSort:c(e),endRowSort:c(g)}:void 0}return a}),b("basic/tools/loadrecorder",function(){var a=c("basic/util/binary");return{insertPosi:function(b,c,d){var e,f,g,h,i,j,k,l,m,n;if(b>c&&(e=b,b=c,c=e),f=a.indexArrayBinary(b,d,"start","end"),g=a.indexArrayBinary(c,d,"start","end"),h=a.existArrayBinary(b,d,"start","end"),i=a.existArrayBinary(c,d,"start","end"),l=!1===h?b:d[f].start,m=!1===i?c:d[g].end,j=a.existArrayBinary(l-1,d,"start","end"),k=a.existArrayBinary(m+1,d,"start","end"),!0===j&&(f=a.indexArrayBinary(l-1,d,"start","end"),l=d[f].start,h=!0),!0===k&&(g=a.indexArrayBinary(m+1,d,"start","end"),m=d[g].end,i=!0),f===g){if(!0===h&&!0===i)return;n=!0===h||!0===i?1:0}else n=g-f,!0===i&&n++;d.splice(f,n,{start:l,end:m})},adaptPosi:function(b,c,d){var e,f;if(e=a.indexArrayBinary(b,d,"start","end"),!0===a.existArrayBinary(b,d,"start","end"))for(d[e].end=d[e].end+c,d[e].end<d[e].start?(f=e,d.splice(e,1)):f=e+1,f=e+1;f<d.length;f++)d[f].start+=c,d[f].end+=c;else for(f=e;f<d.length;f++)d[f].start+=c,d[f].end+=c},isUnloadPosi:function(b,c,d){var e,f,g,h;return e=a.indexArrayBinary(b,d,"start","end"),f=a.existArrayBinary(b,d,"start","end"),g=a.indexArrayBinary(c,d,"start","end"),h=a.existArrayBinary(c,d,"start","end"),!1===f||!1===h||e!==g}}}),b("basic/tools/getdisplayname",function(){return{getColDisplayName:function(a){var b,c,d=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],e="";if("MAX"===a)return"MAX";for(b=a%d.length,c=Math.floor(a/d.length),e=d[b]+e;c>0;)a=c-1,b=a%d.length,c=Math.floor(a/d.length),e=d[b]+e;return e},getRowDisplayName:function(a){return"MAX"===a?"MAX":(a+1).toString()}}}),b("lib/underscore",function(){var a="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this,b=a._,c=Array.prototype,d=Object.prototype,e="undefined"!=typeof Symbol?Symbol.prototype:null,f=c.push,g=c.slice,h=d.toString,i=d.hasOwnProperty,j=Array.isArray,k=Object.keys,l=Object.create,m=function(){},n=function(a){return a instanceof n?a:this instanceof n?void(this._wrapped=a):new n(a)};"undefined"==typeof exports||exports.nodeType?a._=n:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=n),exports._=n),n.VERSION="1.8.3";var o,p=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},q=function(a,b,c){return n.iteratee!==o?n.iteratee(a,b):null==a?n.identity:n.isFunction(a)?p(a,b,c):n.isObject(a)?n.matcher(a):n.property(a)};n.iteratee=o=function(a,b){return q(a,b,1/0)};var r=function(a,b){
return b=null==b?a.length-1:+b,function(){for(var c=Math.max(arguments.length-b,0),d=Array(c),e=0;e<c;e++)d[e]=arguments[e+b];switch(b){case 0:return a.call(this,d);case 1:return a.call(this,arguments[0],d);case 2:return a.call(this,arguments[0],arguments[1],d)}var f=Array(b+1);for(e=0;e<b;e++)f[e]=arguments[e];return f[b]=d,a.apply(this,f)}},s=function(a){if(!n.isObject(a))return{};if(l)return l(a);m.prototype=a;var b=new m;return m.prototype=null,b},t=function(a){return function(b){return null==b?void 0:b[a]}},u=Math.pow(2,53)-1,v=t("length"),w=function(a){var b=v(a);return"number"==typeof b&&b>=0&&b<=u};n.each=n.forEach=function(a,b,c){b=p(b,c);var d,e;if(w(a))for(d=0,e=a.length;d<e;d++)b(a[d],d,a);else{var f=n.keys(a);for(d=0,e=f.length;d<e;d++)b(a[f[d]],f[d],a)}return a},n.map=n.collect=function(a,b,c){b=q(b,c);for(var d=!w(a)&&n.keys(a),e=(d||a).length,f=Array(e),g=0;g<e;g++){var h=d?d[g]:g;f[g]=b(a[h],h,a)}return f};var x=function(a){var b=function(b,c,d,e){var f=!w(b)&&n.keys(b),g=(f||b).length,h=a>0?0:g-1;for(e||(d=b[f?f[h]:h],h+=a);h>=0&&h<g;h+=a){var i=f?f[h]:h;d=c(d,b[i],i,b)}return d};return function(a,c,d,e){var f=arguments.length>=3;return b(a,p(c,e,4),d,f)}};n.reduce=n.foldl=n.inject=x(1),n.reduceRight=n.foldr=x(-1),n.find=n.detect=function(a,b,c){var d=w(a)?n.findIndex:n.findKey,e=d(a,b,c);if(void 0!==e&&-1!==e)return a[e]},n.filter=n.select=function(a,b,c){var d=[];return b=q(b,c),n.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d},n.reject=function(a,b,c){return n.filter(a,n.negate(q(b)),c)},n.every=n.all=function(a,b,c){b=q(b,c);for(var d=!w(a)&&n.keys(a),e=(d||a).length,f=0;f<e;f++){var g=d?d[f]:f;if(!b(a[g],g,a))return!1}return!0},n.some=n.any=function(a,b,c){b=q(b,c);for(var d=!w(a)&&n.keys(a),e=(d||a).length,f=0;f<e;f++){var g=d?d[f]:f;if(b(a[g],g,a))return!0}return!1},n.contains=n.includes=n.include=function(a,b,c,d){return w(a)||(a=n.values(a)),("number"!=typeof c||d)&&(c=0),n.indexOf(a,b,c)>=0},n.invoke=r(function(a,b,c){var d=n.isFunction(b);return n.map(a,function(a){var e=d?b:a[b];return null==e?e:e.apply(a,c)})}),n.pluck=function(a,b){return n.map(a,n.property(b))},n.where=function(a,b){return n.filter(a,n.matcher(b))},n.findWhere=function(a,b){return n.find(a,n.matcher(b))},n.max=function(a,b,c){var d,e,f=-1/0,g=-1/0;if(null==b||"number"==typeof b&&"object"!=typeof a[0]&&null!=a){a=w(a)?a:n.values(a);for(var h=0,i=a.length;h<i;h++)null!=(d=a[h])&&d>f&&(f=d)}else b=q(b,c),n.each(a,function(a,c,d){((e=b(a,c,d))>g||e===-1/0&&f===-1/0)&&(f=a,g=e)});return f},n.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b||"number"==typeof b&&"object"!=typeof a[0]&&null!=a){a=w(a)?a:n.values(a);for(var h=0,i=a.length;h<i;h++)null!=(d=a[h])&&d<f&&(f=d)}else b=q(b,c),n.each(a,function(a,c,d){((e=b(a,c,d))<g||e===1/0&&f===1/0)&&(f=a,g=e)});return f},n.shuffle=function(a){return n.sample(a,1/0)},n.sample=function(a,b,c){if(null==b||c)return w(a)||(a=n.values(a)),a[n.random(a.length-1)];var d=w(a)?n.clone(a):n.values(a),e=v(d);b=Math.max(Math.min(b,e),0);for(var f=e-1,g=0;g<b;g++){var h=n.random(g,f),i=d[g];d[g]=d[h],d[h]=i}return d.slice(0,b)},n.sortBy=function(a,b,c){var d=0;return b=q(b,c),n.pluck(n.map(a,function(a,c,e){return{value:a,index:d++,criteria:b(a,c,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index-b.index}),"value")};var y=function(a,b){return function(c,d,e){var f=b?[[],[]]:{};return d=q(d,e),n.each(c,function(b,e){var g=d(b,e,c);a(f,b,g)}),f}};n.groupBy=y(function(a,b,c){n.has(a,c)?a[c].push(b):a[c]=[b]}),n.indexBy=y(function(a,b,c){a[c]=b}),n.countBy=y(function(a,b,c){n.has(a,c)?a[c]++:a[c]=1});var z=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;n.toArray=function(a){return a?n.isArray(a)?g.call(a):n.isString(a)?a.match(z):w(a)?n.map(a,n.identity):n.values(a):[]},n.size=function(a){return null==a?0:w(a)?a.length:n.keys(a).length},n.partition=y(function(a,b,c){a[c?0:1].push(b)},!0),n.first=n.head=n.take=function(a,b,c){if(!(null==a||a.length<1))return null==b||c?a[0]:n.initial(a,a.length-b)},n.initial=function(a,b,c){return g.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},n.last=function(a,b,c){if(!(null==a||a.length<1))return null==b||c?a[a.length-1]:n.rest(a,Math.max(0,a.length-b))},n.rest=n.tail=n.drop=function(a,b,c){return g.call(a,null==b||c?1:b)},n.compact=function(a){return n.filter(a,Boolean)};var A=function(a,b,c,d){d=d||[];for(var e=d.length,f=0,g=v(a);f<g;f++){var h=a[f];if(w(h)&&(n.isArray(h)||n.isArguments(h)))if(b)for(var i=0,j=h.length;i<j;)d[e++]=h[i++];else A(h,b,c,d),e=d.length;else c||(d[e++]=h)}return d};n.flatten=function(a,b){return A(a,b,!1)},n.without=r(function(a,b){return n.difference(a,b)}),n.uniq=n.unique=function(a,b,c,d){n.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=q(c,d));for(var e=[],f=[],g=0,h=v(a);g<h;g++){var i=a[g],j=c?c(i,g,a):i;b?(g&&f===j||e.push(i),f=j):c?n.contains(f,j)||(f.push(j),e.push(i)):n.contains(e,i)||e.push(i)}return e},n.union=r(function(a){return n.uniq(A(a,!0,!0))}),n.intersection=function(a){for(var b=[],c=arguments.length,d=0,e=v(a);d<e;d++){var f=a[d];if(!n.contains(b,f)){var g;for(g=1;g<c&&n.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},n.difference=r(function(a,b){return b=A(b,!0,!0),n.filter(a,function(a){return!n.contains(b,a)})}),n.unzip=function(a){for(var b=a&&n.max(a,v).length||0,c=Array(b),d=0;d<b;d++)c[d]=n.pluck(a,d);return c},n.zip=r(n.unzip),n.object=function(a,b){for(var c={},d=0,e=v(a);d<e;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c};var B=function(a){return function(b,c,d){c=q(c,d);for(var e=v(b),f=a>0?0:e-1;f>=0&&f<e;f+=a)if(c(b[f],f,b))return f;return-1}};n.findIndex=B(1),n.findLastIndex=B(-1),n.sortedIndex=function(a,b,c,d){c=q(c,d,1);for(var e=c(b),f=0,g=v(a);f<g;){var h=Math.floor((f+g)/2);c(a[h])<e?f=h+1:g=h}return f};var C=function(a,b,c){return function(d,e,f){var h=0,i=v(d);if("number"==typeof f)a>0?h=f>=0?f:Math.max(f+i,h):i=f>=0?Math.min(f+1,i):f+i+1;else if(c&&f&&i)return f=c(d,e),d[f]===e?f:-1;if(e!==e)return f=b(g.call(d,h,i),n.isNaN),f>=0?f+h:-1;for(f=a>0?h:i-1;f>=0&&f<i;f+=a)if(d[f]===e)return f;return-1}};n.indexOf=C(1,n.findIndex,n.sortedIndex),n.lastIndexOf=C(-1,n.findLastIndex),n.range=function(a,b,c){null==b&&(b=a||0,a=0),c||(c=b<a?-1:1);for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;f<d;f++,a+=c)e[f]=a;return e},n.chunk=function(a,b){if(null==b||b<1)return[];for(var c=[],d=0,e=a.length;d<e;)c.push(g.call(a,d,d+=b));return c};var D=function(a,b,c,d,e){if(!(d instanceof b))return a.apply(c,e);var f=s(a.prototype),g=a.apply(f,e);return n.isObject(g)?g:f};n.bind=r(function(a,b,c){if(!n.isFunction(a))throw new TypeError("Bind must be called on a function");var d=r(function(e){return D(a,d,b,this,c.concat(e))});return d}),n.partial=r(function(a,b){var c=n.partial.placeholder,d=function(){for(var e=0,f=b.length,g=Array(f),h=0;h<f;h++)g[h]=b[h]===c?arguments[e++]:b[h];for(;e<arguments.length;)g.push(arguments[e++]);return D(a,d,this,this,g)};return d}),n.partial.placeholder=n,n.bindAll=r(function(a,b){b=A(b,!1,!1);var c=b.length;if(c<1)throw new Error("bindAll must be passed function names");for(;c--;){var d=b[c];a[d]=n.bind(a[d],a)}}),n.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);return n.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},n.delay=r(function(a,b,c){return setTimeout(function(){return a.apply(null,c)},b)}),n.defer=n.partial(n.delay,n,1),n.throttle=function(a,b,c){var d,e,f,g,h=0;c||(c={});var i=function(){h=!1===c.leading?0:n.now(),d=null,g=a.apply(e,f),d||(e=f=null)},j=function(){var j=n.now();h||!1!==c.leading||(h=j);var k=b-(j-h);return e=this,f=arguments,k<=0||k>b?(d&&(clearTimeout(d),d=null),h=j,g=a.apply(e,f),d||(e=f=null)):d||!1===c.trailing||(d=setTimeout(i,k)),g};return j.cancel=function(){clearTimeout(d),h=0,d=e=f=null},j},n.debounce=function(a,b,c){var d,e,f=function(b,c){d=null,c&&(e=a.apply(b,c))},g=r(function(g){if(d&&clearTimeout(d),c){var h=!d;d=setTimeout(f,b),h&&(e=a.apply(this,g))}else d=n.delay(f,b,this,g);return e});return g.cancel=function(){clearTimeout(d),d=null},g},n.wrap=function(a,b){return n.partial(b,a)},n.negate=function(a){return function(){return!a.apply(this,arguments)}},n.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},n.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}},n.before=function(a,b){var c;return function(){return--a>0&&(c=b.apply(this,arguments)),a<=1&&(b=null),c}},n.once=n.partial(n.before,2),n.restArgs=r;var E=!{toString:null}.propertyIsEnumerable("toString"),F=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],G=function(a,b){var c=F.length,e=a.constructor,f=n.isFunction(e)&&e.prototype||d,g="constructor";for(n.has(a,g)&&!n.contains(b,g)&&b.push(g);c--;)(g=F[c])in a&&a[g]!==f[g]&&!n.contains(b,g)&&b.push(g)};n.keys=function(a){if(!n.isObject(a))return[];if(k)return k(a);var b=[];for(var c in a)n.has(a,c)&&b.push(c);return E&&G(a,b),b},n.allKeys=function(a){if(!n.isObject(a))return[];var b=[];for(var c in a)b.push(c);return E&&G(a,b),b},n.values=function(a){for(var b=n.keys(a),c=b.length,d=Array(c),e=0;e<c;e++)d[e]=a[b[e]];return d},n.mapObject=function(a,b,c){b=q(b,c);for(var d=n.keys(a),e=d.length,f={},g=0;g<e;g++){var h=d[g];f[h]=b(a[h],h,a)}return f},n.pairs=function(a){for(var b=n.keys(a),c=b.length,d=Array(c),e=0;e<c;e++)d[e]=[b[e],a[b[e]]];return d},n.invert=function(a){for(var b={},c=n.keys(a),d=0,e=c.length;d<e;d++)b[a[c[d]]]=c[d];return b},n.functions=n.methods=function(a){var b=[];for(var c in a)n.isFunction(a[c])&&b.push(c);return b.sort()};var H=function(a,b){return function(c){var d=arguments.length;if(b&&(c=Object(c)),d<2||null==c)return c;for(var e=1;e<d;e++)for(var f=arguments[e],g=a(f),h=g.length,i=0;i<h;i++){var j=g[i];b&&void 0!==c[j]||(c[j]=f[j])}return c}};n.extend=H(n.allKeys),n.extendOwn=n.assign=H(n.keys),n.findKey=function(a,b,c){b=q(b,c);for(var d,e=n.keys(a),f=0,g=e.length;f<g;f++)if(d=e[f],b(a[d],d,a))return d};var I=function(a,b,c){return b in c};n.pick=r(function(a,b){var c={},d=b[0];if(null==a)return c;n.isFunction(d)?(b.length>1&&(d=p(d,b[1])),b=n.allKeys(a)):(d=I,b=A(b,!1,!1),a=Object(a));for(var e=0,f=b.length;e<f;e++){var g=b[e],h=a[g];d(h,g,a)&&(c[g]=h)}return c}),n.omit=r(function(a,b){var c,d=b[0];return n.isFunction(d)?(d=n.negate(d),b.length>1&&(c=b[1])):(b=n.map(A(b,!1,!1),String),d=function(a,c){return!n.contains(b,c)}),n.pick(a,d,c)}),n.defaults=H(n.allKeys,!0),n.create=function(a,b){var c=s(a);return b&&n.extendOwn(c,b),c},n.clone=function(a){return n.isObject(a)?n.isArray(a)?a.slice():n.extend({},a):a},n.tap=function(a,b){return b(a),a},n.isMatch=function(a,b){var c=n.keys(b),d=c.length;if(null==a)return!d;for(var e=Object(a),f=0;f<d;f++){var g=c[f];if(b[g]!==e[g]||!(g in e))return!1}return!0};var J,K;J=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;if(a!==a)return b!==b;var e=typeof a;return("function"===e||"object"===e||"object"==typeof b)&&K(a,b,c,d)},K=function(a,b,c,d){a instanceof n&&(a=a._wrapped),b instanceof n&&(b=b._wrapped);var f=h.call(a);if(f!==h.call(b))return!1;switch(f){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!=+a?+b!=+b:0==+a?1/+a==1/b:+a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object Symbol]":return e.valueOf.call(a)===e.valueOf.call(b)}var g="[object Array]"===f;if(!g){if("object"!=typeof a||"object"!=typeof b)return!1;var i=a.constructor,j=b.constructor;if(i!==j&&!(n.isFunction(i)&&i instanceof i&&n.isFunction(j)&&j instanceof j)&&"constructor"in a&&"constructor"in b)return!1}c=c||[],d=d||[];for(var k=c.length;k--;)if(c[k]===a)return d[k]===b;if(c.push(a),d.push(b),g){if((k=a.length)!==b.length)return!1;for(;k--;)if(!J(a[k],b[k],c,d))return!1}else{var l,m=n.keys(a);if(k=m.length,n.keys(b).length!==k)return!1;for(;k--;)if(l=m[k],!n.has(b,l)||!J(a[l],b[l],c,d))return!1}return c.pop(),d.pop(),!0},n.isEqual=function(a,b){return J(a,b)},n.isEmpty=function(a){return null==a||(w(a)&&(n.isArray(a)||n.isString(a)||n.isArguments(a))?0===a.length:0===n.keys(a).length)},n.isElement=function(a){return!(!a||1!==a.nodeType)},n.isArray=j||function(a){return"[object Array]"===h.call(a)},n.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},n.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(a){n["is"+a]=function(b){return h.call(b)==="[object "+a+"]"}}),n.isArguments(arguments)||(n.isArguments=function(a){return n.has(a,"callee")});var L=a.document&&a.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof L&&(n.isFunction=function(a){return"function"==typeof a||!1}),n.isFinite=function(a){return!n.isSymbol(a)&&isFinite(a)&&!isNaN(parseFloat(a))},n.isNaN=function(a){return n.isNumber(a)&&isNaN(a)},n.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"===h.call(a)},n.isNull=function(a){return null===a},n.isUndefined=function(a){return void 0===a},n.has=function(a,b){return null!=a&&i.call(a,b)},n.noConflict=function(){return a._=b,this},n.identity=function(a){return a},n.constant=function(a){return function(){return a}},n.noop=function(){},n.property=t,n.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}},n.matcher=n.matches=function(a){return a=n.extendOwn({},a),function(b){return n.isMatch(b,a)}},n.times=function(a,b,c){var d=Array(Math.max(0,a));b=p(b,c,1);for(var e=0;e<a;e++)d[e]=b(e);return d},n.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},n.now=Date.now||function(){return(new Date).getTime()};var M={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},N=n.invert(M),O=function(a){var b=function(b){return a[b]},c="(?:"+n.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};n.escape=O(M),n.unescape=O(N),n.result=function(a,b,c){var d=null==a?void 0:a[b];return void 0===d&&(d=c),n.isFunction(d)?d.call(a):d};var P=0;n.uniqueId=function(a){var b=++P+"";return a?a+b:b},n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Q=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},S=/\\|'|\r|\n|\u2028|\u2029/g,T=function(a){return"\\"+R[a]};n.template=function(a,b,c){!b&&c&&(b=c),b=n.defaults({},b,n.templateSettings);var d=RegExp([(b.escape||Q).source,(b.interpolate||Q).source,(b.evaluate||Q).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(S,T),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";var g;try{g=new Function(b.variable||"obj","_",f)}catch(a){throw a.source=f,a}var h=function(a){return g.call(this,a,n)};return h.source="function("+(b.variable||"obj")+"){\n"+f+"}",h},n.chain=function(a){var b=n(a);return b._chain=!0,b};var U=function(a,b){return a._chain?n(b).chain():b};return n.mixin=function(a){return n.each(n.functions(a),function(b){var c=n[b]=a[b];n.prototype[b]=function(){var a=[this._wrapped];return f.apply(a,arguments),U(this,c.apply(n,a))}}),n},n.mixin(n),n.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=c[a];n.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],U(this,c)}}),n.each(["concat","join","slice"],function(a){var b=c[a];n.prototype[a]=function(){return U(this,b.apply(this._wrapped,arguments))}}),n.prototype.value=function(){return this._wrapped},n.prototype.valueOf=n.prototype.toJSON=n.prototype.value,n.prototype.toString=function(){return String(this._wrapped)},n}),b("lib/backbone",function(){var b=c("lib/underscore"),d=c("lib/jquery"),e=a,f={},g=e.Backbone,h=[],i=h.slice;f.VERSION="1.1.2",f.$=d,f.noConflict=function(){return e.Backbone=g,this},f.emulateHTTP=!1,f.emulateJSON=!1;var j=f.Events={on:function(a,b,c){return l(this,"on",a,[b,c])&&b?(this._events||(this._events={}),(this._events[a]||(this._events[a]=[])).push({callback:b,context:c,ctx:c||this}),this):this},once:function(a,c,d){if(!l(this,"once",a,[c,d])||!c)return this;var e=this,f=b.once(function(){e.off(a,f),c.apply(this,arguments)});return f._callback=c,this.on(a,f,d)},off:function(a,c,d){var e,f,g,h,i,j,k,m;if(!this._events||!l(this,"off",a,[c,d]))return this;if(!a&&!c&&!d)return this._events=void 0,this;for(h=a?[a]:b.keys(this._events),i=0,j=h.length;i<j;i++)if(a=h[i],g=this._events[a]){if(this._events[a]=e=[],c||d)for(k=0,m=g.length;k<m;k++)f=g[k],(c&&c!==f.callback&&c!==f.callback._callback||d&&d!==f.context)&&e.push(f);e.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=i.call(arguments,1);if(!l(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&m(c,b),d&&m(d,arguments),this},stopListening:function(a,c,d){var e=this._listeningTo;if(!e)return this;var f=!c&&!d;d||"object"!=typeof c||(d=this),a&&((e={})[a._listenId]=a);for(var g in e)a=e[g],a.off(c,d,this),(f||b.isEmpty(a._events))&&delete this._listeningTo[g];return this}},k=/\s+/,l=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(k.test(c)){for(var f=c.split(k),g=0,h=f.length;g<h;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},m=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b);return}},n={listenTo:"on",listenToOnce:"once"};b.each(n,function(a,c){j[c]=function(c,d,e){return(this._listeningTo||(this._listeningTo={}))[c._listenId||(c._listenId=b.uniqueId("l"))]=c,e||"object"!=typeof d||(e=this),c[a](d,e,this),this}}),j.bind=j.on,j.unbind=j.off,b.extend(f,j);var o=f.Model=function(a,c){var d=a||{};c||(c={}),this.cid=b.uniqueId("c"),this.attributes={},c.collection&&(this.collection=c.collection),c.parse&&(d=this.parse(d,c)||{}),d=b.defaults({},d,b.result(this,"defaults")),this.set(d,c),this.changed={},this.initialize.apply(this,arguments)};b.extend(o.prototype,j,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(a){return b.clone(this.attributes)},sync:function(){return f.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return b.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,c,d){var e,f,g,h,i,j,k,l;if(null==a)return this;if("object"==typeof a?(f=a,d=c):(f={})[a]=c,d||(d={}),!this._validate(f,d))return!1;g=d.unset,i=d.silent,h=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=b.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in f&&(this.id=f[this.idAttribute]);for(e in f)c=f[e],b.isEqual(l[e],c)||h.push(e),b.isEqual(k[e],c)?delete this.changed[e]:this.changed[e]=c,g?delete l[e]:l[e]=c;if(!i){h.length&&(this._pending=d);for(var m=0,n=h.length;m<n;m++)this.trigger("change:"+h[m],this,l[h[m]],d)}if(j)return this;if(!i)for(;this._pending;)d=this._pending,this._pending=!1,this.trigger("change",this,d);return this._pending=!1,this._changing=!1,this},unset:function(a,c){return this.set(a,void 0,b.extend({},c,{unset:!0}))},clear:function(a){var c={};for(var d in this.attributes)c[d]=void 0;return this.set(c,b.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!b.isEmpty(this.changed):b.has(this.changed,a)},changedAttributes:function(a){if(!a)return!!this.hasChanged()&&b.clone(this.changed);var c,d=!1,e=this._changing?this._previousAttributes:this.attributes;for(var f in a)b.isEqual(e[f],c=a[f])||((d||(d={}))[f]=c);return d},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return b.clone(this._previousAttributes)},fetch:function(a){a=a?b.clone(a):{},void 0===a.parse&&(a.parse=!0);var c=this,d=a.success;return a.success=function(b){if(!c.set(c.parse(b,a),a))return!1;d&&d(c,b,a),c.trigger("sync",c,b,a)},N(this,a),this.sync("read",this,a)},save:function(a,c,d){var e,f,g,h=this.attributes;if(null==a||"object"==typeof a?(e=a,d=c):(e={})[a]=c,d=b.extend({validate:!0},d),e&&!d.wait){if(!this.set(e,d))return!1}else if(!this._validate(e,d))return!1;e&&d.wait&&(this.attributes=b.extend({},h,e)),void 0===d.parse&&(d.parse=!0);var i=this,j=d.success;return d.success=function(a){i.attributes=h;var c=i.parse(a,d);if(d.wait&&(c=b.extend(e||{},c)),b.isObject(c)&&!i.set(c,d))return!1;j&&j(i,a,d),i.trigger("sync",i,a,d)},N(this,d),f=this.isNew()?"create":d.patch?"patch":"update","patch"===f&&(d.attrs=e),g=this.sync(f,this,d),e&&d.wait&&(this.attributes=h),g},destroy:function(a){a=a?b.clone(a):{};var c=this,d=a.success,e=function(){c.trigger("destroy",c,c.collection,a)};if(a.success=function(b){(a.wait||c.isNew())&&e(),d&&d(c,b,a),c.isNew()||c.trigger("sync",c,b,a)},this.isNew())return a.success(),!1;N(this,a);var f=this.sync("delete",this,a);return a.wait||e(),f},url:function(){var a=b.result(this,"urlRoot")||b.result(this.collection,"url")||M();return this.isNew()?a:a.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},b.extend(a||{},{validate:!0}))},_validate:function(a,c){if(!c.validate||!this.validate)return!0;a=b.extend({},this.attributes,a);var d=this.validationError=this.validate(a,c)||null;return!d||(this.trigger("invalid",this,d,b.extend(c,{validationError:d})),!1)}});var p=["keys","values","pairs","invert","pick","omit"];b.each(p,function(a){o.prototype[a]=function(){var c=i.call(arguments);return c.unshift(this.attributes),b[a].apply(b,c)}});var q=f.Collection=function(a,c){c||(c={}),c.model&&(this.model=c.model),void 0!==c.comparator&&(this.comparator=c.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,b.extend({silent:!0},c))},r={add:!0,remove:!0,merge:!0},s={add:!0,remove:!1};b.extend(q.prototype,j,{model:o,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return f.sync.apply(this,arguments)},add:function(a,c){return this.set(a,b.extend({merge:!1},c,s))},remove:function(a,c){var d=!b.isArray(a);a=d?[a]:b.clone(a),c||(c={});var e,f,g,h;for(e=0,f=a.length;e<f;e++)(h=a[e]=this.get(a[e]))&&(delete this._byId[h.id],delete this._byId[h.cid],g=this.indexOf(h),this.models.splice(g,1),this.length--,c.silent||(c.index=g,h.trigger("remove",h,this,c)),this._removeReference(h,c));return d?a[0]:a},set:function(a,c){c=b.defaults({},c,r),c.parse&&(a=this.parse(a,c));var d=!b.isArray(a);a=d?a?[a]:[]:b.clone(a);var e,f,g,h,i,j,k,l=c.at,m=this.model,n=this.comparator&&null==l&&!1!==c.sort,p=b.isString(this.comparator)?this.comparator:null,q=[],s=[],t={},u=c.add,v=c.merge,w=c.remove,x=!(n||!u||!w)&&[];for(e=0,f=a.length;e<f;e++){if(i=a[e]||{},g=i instanceof o?h=i:i[m.prototype.idAttribute||"id"],j=this.get(g))w&&(t[j.cid]=!0),v&&(i=i===h?h.attributes:i,c.parse&&(i=j.parse(i,c)),j.set(i,c),n&&!k&&j.hasChanged(p)&&(k=!0)),a[e]=j;else if(u){if(!(h=a[e]=this._prepareModel(i,c)))continue;q.push(h),this._addReference(h,c)}h=j||h,!x||!h.isNew()&&t[h.id]||x.push(h),t[h.id]=!0}if(w){for(e=0,f=this.length;e<f;++e)t[(h=this.models[e]).cid]||s.push(h);s.length&&this.remove(s,c)}if(q.length||x&&x.length)if(n&&(k=!0),this.length+=q.length,null!=l)for(e=0,f=q.length;e<f;e++)this.models.splice(l+e,0,q[e]);else{x&&(this.models.length=0);var y=x||q;for(e=0,f=y.length;e<f;e++)this.models.push(y[e])}if(k&&this.sort({silent:!0}),!c.silent){for(e=0,f=q.length;e<f;e++)(h=q[e]).trigger("add",h,this,c);(k||x&&x.length)&&this.trigger("sort",this,c)}return d?a[0]:a},reset:function(a,c){c||(c={});for(var d=0,e=this.models.length;d<e;d++)this._removeReference(this.models[d],c);return c.previousModels=this.models,this._reset(),a=this.add(a,b.extend({silent:!0},c)),c.silent||this.trigger("reset",this,c),a},push:function(a,c){return this.add(a,b.extend({at:this.length},c))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,c){return this.add(a,b.extend({at:0},c))},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(){return i.apply(this.models,arguments)},get:function(a){if(null!=a)return this._byId[a]||this._byId[a.id]||this._byId[a.cid]},at:function(a){return this.models[a]},where:function(a,c){return b.isEmpty(a)?c?void 0:[]:this[c?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),b.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(b.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return b.invoke(this.models,"get",a)},fetch:function(a){a=a?b.clone(a):{},void 0===a.parse&&(a.parse=!0);var c=a.success,d=this;return a.success=function(b){var e=a.reset?"reset":"set";d[e](b,a),c&&c(d,b,a),d.trigger("sync",d,b,a)},N(this,a),this.sync("read",this,a)},create:function(a,c){if(c=c?b.clone(c):{},!(a=this._prepareModel(a,c)))return!1;c.wait||this.add(a,c);var d=this,e=c.success;return c.success=function(a,b){c.wait&&d.add(a,c),e&&e(a,b,c)},a.save(null,c),a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,c){if(a instanceof o)return a;c=c?b.clone(c):{},c.collection=this;var d=new this.model(a,c);return d.validationError?(this.trigger("invalid",this,d.validationError,c),!1):d},_addReference:function(a,b){this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a),a.collection||(a.collection=this),a.on("all",this._onModelEvent,this)},_removeReference:function(a,b){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var t=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];b.each(t,function(a){q.prototype[a]=function(){var c=i.call(arguments);return c.unshift(this.models),b[a].apply(b,c)}});var u=["groupBy","countBy","sortBy","indexBy"];b.each(u,function(a){q.prototype[a]=function(c,d){var e=b.isFunction(c)?c:function(a){return a.get(c)};return b[a](this.models,e,d)}});var v=f.View=function(a){this.cid=b.uniqueId("view"),a||(a={}),b.extend(this,b.pick(a,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];b.extend(v.prototype,j,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,b){return this.$el&&this.undelegateEvents(),this.$el=a instanceof f.$?a:f.$(a),this.el=this.$el[0],!1!==b&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=b.result(this,"events")))return this;this.undelegateEvents();for(var c in a){var d=a[c];if(b.isFunction(d)||(d=this[a[c]]),d){var e=c.match(w),f=e[1],g=e[2];d=b.bind(d,this),f+=".delegateEvents"+this.cid,""===g?this.$el.on(f,d):this.$el.on(f,g,d)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(b.result(this,"el"),!1);else{var a=b.extend({},b.result(this,"attributes"));this.id&&(a.id=b.result(this,"id")),this.className&&(a.class=b.result(this,"className"));var c=f.$("<"+b.result(this,"tagName")+">").attr(a);this.setElement(c,!1)}}}),f.sync=function(a,c,d){var e=z[a];b.defaults(d||(d={}),{emulateHTTP:f.emulateHTTP,emulateJSON:f.emulateJSON});var g={type:e,dataType:"json"};if(d.url||(g.url=b.result(c,"url")||M()),null!=d.data||!c||"create"!==a&&"update"!==a&&"patch"!==a||(g.contentType="application/json",g.data=JSON.stringify(d.attrs||c.toJSON(d))),d.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),d.emulateHTTP&&("PUT"===e||"DELETE"===e||"PATCH"===e)){g.type="POST",d.emulateJSON&&(g.data._method=e);var h=d.beforeSend;d.beforeSend=function(a){if(a.setRequestHeader("X-HTTP-Method-Override",e),h)return h.apply(this,arguments)}}"GET"===g.type||d.emulateJSON||(g.processData=!1),"PATCH"===g.type&&y&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=d.xhr=f.ajax(b.extend(g,d));return c.trigger("request",c,i,d),i};var y=!(void 0===a||!a.ActiveXObject||a.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),z={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};f.ajax=function(){return f.$.ajax.apply(f.$,arguments)};var A=f.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},B=/\((.*?)\)/g,C=/(\(\?)?:\w+/g,D=/\*\w+/g,E=/[\-{}\[\]+?.,\\\^$|#\s]/g;b.extend(A.prototype,j,{initialize:function(){},route:function(a,c,d){b.isRegExp(a)||(a=this._routeToRegExp(a)),b.isFunction(c)&&(d=c,c=""),d||(d=this[c]);var e=this;return f.history.route(a,function(b){var g=e._extractParameters(a,b);e.execute(d,g),e.trigger.apply(e,["route:"+c].concat(g)),e.trigger("route",c,g),f.history.trigger("route",e,c,g)}),this},execute:function(a,b){a&&a.apply(this,b)},navigate:function(a,b){return f.history.navigate(a,b),this},_bindRoutes:function(){if(this.routes){this.routes=b.result(this,"routes");for(var a,c=b.keys(this.routes);null!=(a=c.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(E,"\\$&").replace(B,"(?:$1)?").replace(C,function(a,b){return b?a:"([^/?]+)"}).replace(D,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,c){var d=a.exec(c).slice(1);return b.map(d,function(a,b){return b===d.length-1?a||null:a?decodeURIComponent(a):null})}});var F=f.History=function(){this.handlers=[],b.bindAll(this,"checkUrl"),void 0!==a&&(this.location=a.location,this.history=a.history)},G=/^[#\/]|\s+$/g,H=/^\/+|\/+$/g,I=/msie [\w.]+/,J=/\/$/,K=/#.*$/;F.started=!1,b.extend(F.prototype,j,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=decodeURI(this.location.pathname+this.location.search);var c=this.root.replace(J,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(G,"")},start:function(c){if(F.started)throw new Error("Backbone.history has already been started")
;F.started=!0,this.options=b.extend({root:"/"},this.options,c),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var d=this.getFragment(),e=document.documentMode,g=I.exec(navigator.userAgent.toLowerCase())&&(!e||e<=7);if(this.root=("/"+this.root+"/").replace(H,"/"),g&&this._wantsHashChange){var h=f.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=h.hide().appendTo("body")[0].contentWindow,this.navigate(d)}this._hasPushState?f.$(a).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in a&&!g?f.$(a).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=d;var i=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&i.hash&&(this.fragment=this.getHash().replace(G,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){f.$(a).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),F.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();if(b===this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe))),b===this.fragment)return!1;this.iframe&&this.navigate(b),this.loadUrl()},loadUrl:function(a){return a=this.fragment=this.getFragment(a),b.any(this.handlers,function(b){if(b.route.test(a))return b.callback(a),!0})},navigate:function(a,b){if(!F.started)return!1;b&&!0!==b||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));if(a=a.replace(K,""),this.fragment!==a){if(this.fragment=a,""===a&&"/"!==c&&(c=c.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),f.history=new F;var L=function(a,c){var d,e=this;d=a&&b.has(a,"constructor")?a.constructor:function(){return e.apply(this,arguments)},b.extend(d,e,c);var f=function(){this.constructor=d};return f.prototype=e.prototype,d.prototype=new f,a&&b.extend(d.prototype,a),d.__super__=e.prototype,d};o.extend=q.extend=A.extend=v.extend=F.extend=L;var M=function(){throw new Error('A "url" property or function must be specified')},N=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}};return e.Backbone=f,f}),b("lib/backbone.nested",function(){var a,b=c("lib/underscore"),d=c("lib/jquery"),e=c("lib/backbone"),f=[];return e.NestedModel=e.Model.extend({get:function(a){return e.NestedModel.walkThenGet(this.attributes,a)},previous:function(a){return e.NestedModel.walkThenGet(this._previousAttributes,a)},has:function(a){var c=this.get(a);return!(null===c||b.isUndefined(c))},set:function(c,d,f){var g,h,i,j=e.NestedModel.deepClone(this.attributes);if(b.isString(c)?g=e.NestedModel.attrPath(c):b.isArray(c)&&(g=c),g)f=f||{},this._setAttr(j,g,d,f);else{f=d||{};var k=c;for(var l in k)k.hasOwnProperty(l)&&this._setAttr(j,e.NestedModel.attrPath(l),f.unset?void 0:k[l],f)}return a=e.NestedModel.__super__.changedAttributes.call(this),f.unset&&g&&1===g.length?(h={},h[c]=void 0,a=b.omit(a,b.keys(h)),i=e.NestedModel.__super__.set.call(this,h,f)):(h=j,f.unset&&g?(f=b.extend({},f),delete f.unset):f.unset&&b.isObject(c)&&(h=c),a=b.omit(a,b.keys(h)),i=e.NestedModel.__super__.set.call(this,h,f)),i?(this._runDelayedTriggers(),this):(this.changed={},a={},!1)},unset:function(a,c){return this.set(a,void 0,b.extend({},c,{unset:!0}))},clear:function(c){a={},c=c||{};var d=b.clone(this.attributes);if(!c.silent&&this.validate&&!this.validate(d,c))return!1;var e=this.changed={},f=this,g=function(a,c,d){b.each(a,function(h,i){var j=c;b.isArray(a)?j+="["+i+"]":c?j+="."+i:j=i,h=a[i],b.isObject(h)&&g(h,j,d),d.silent||f._delayedChange(j,null,d),e[j]=null})};return g(this.attributes,"",c),this.attributes={},c.silent||this._delayedTrigger("change"),this._runDelayedTriggers(),this},add:function(a,c,d){var e=this.get(a);if(!b.isArray(e))throw new Error("current value is not an array");return this.set(a+"["+e.length+"]",c,d)},remove:function(a,c){c=c||{};var d=e.NestedModel.attrPath(a),f=b.initial(d),g=this.get(f),h=b.last(d);if(!b.isArray(g))throw new Error("remove() must be called on a nested array");var i=!c.silent&&g.length>=h+1,j=g[h];if(g.splice(h,1),c.silent=!0,this.set(f,g,c),i){a=e.NestedModel.createAttrStr(f),this.trigger("remove:"+a,this,j);for(var k=f.length;k>=1;k--)a=e.NestedModel.createAttrStr(b.first(f,k)),this.trigger("change:"+a,this,j);this.trigger("change",this,j)}return this},changedAttributes:function(c){var d=e.NestedModel.__super__.changedAttributes.call(this,c);return!!b.isObject(d)&&b.extend({},a,d)},toJSON:function(){return e.NestedModel.deepClone(this.attributes)},_delayedTrigger:function(){f.push(arguments)},_delayedChange:function(a,b,c){this._delayedTrigger("change:"+a,this,b,c),this.changed||(this.changed={}),this.changed[a]=b},_runDelayedTriggers:function(){for(;f.length>0;)this.trigger.apply(this,f.shift())},_setAttr:function(a,c,d,f){f=f||{};var g=c.length,h=this;e.NestedModel.walkPath(a,c,function(a,i,j){var k=b.last(i),l=e.NestedModel.createAttrStr(i),m=!b.isEqual(a[k],d);if(i.length===g){if(f.unset){if(delete a[k],b.isArray(a)){var n=e.NestedModel.createAttrStr(b.initial(c));h._delayedTrigger("remove:"+n,h,a[k])}}else a[k]=d;if(!f.silent&&b.isObject(d)&&m){var o=[],p=function(a,c){if(!(b.indexOf(o,a)>-1)){o.push(a);var d,e;for(var g in a)a.hasOwnProperty(g)&&(d=c+"."+g,e=a[g],b.isEqual(h.get(d),e)||h._delayedChange(d,e,f),b.isObject(e)&&p(e,d))}};p(d,l)}}else a[k]||(b.isNumber(j)?a[k]=[]:a[k]={});f.silent||(i.length>1&&m&&h._delayedChange(l,a[k],f),b.isArray(a[k])&&h._delayedTrigger("add:"+l,h,a[k]))})}},{attrPath:function(a){var c;return b.isString(a)?(c=""===a?[""]:a.match(/[^\.\[\]]+/g),c=b.map(c,function(a){return a.match(/^\d+$/)?parseInt(a,10):a})):c=a,c},createAttrStr:function(a){var c=a[0];return b.each(b.rest(a),function(a){c+=b.isNumber(a)?"["+a+"]":"."+a}),c},deepClone:function(a){return d.extend(!0,{},a)},walkPath:function(a,b,c,d){for(var e,f=a,g=0;g<b.length&&(c.call(d||this,f,b.slice(0,g+1),b[g+1]),e=b[g],f=f[e]);g++);},walkThenGet:function(a,c){var d,f=e.NestedModel.attrPath(c);return e.NestedModel.walkPath(a,f,function(a,c){var e=b.last(c);c.length===f.length&&(d=a[e])}),d}}),e}),b("models/lineCol",function(){var a=c("lib/backbone.nested");return a.NestedModel.extend({defaults:{sort:0,alias:"",left:0,width:71,originalWidth:71,isRightAjacentHide:!1,isleftAjacentHide:!1,displayName:"",activeState:!1,hidden:!1,isView:!0,operProp:{}},destoryView:function(){this.set("isView",!1)}})}),b("models/selectRegion",function(){var a=c("lib/backbone.nested");return a.NestedModel.extend({defaults:{tempPosi:{initColIndex:0,initRowIndex:0,mouseColIndex:0,mouseRowIndex:0},physicsBox:{width:71,height:19,top:0,left:0},wholePosi:{startX:0,startY:0,endX:0,endY:0},selectType:"selected"}})}),b("collections/selectRegion",function(){var a=c("lib/backbone"),b=c("spreadsheet/config"),d=c("models/selectRegion");return new(a.Collection.extend({model:d,url:"select",getAdjacent:function(a){var c=this.models[0].get("initPosi"),d=this.models[0].get("physicsBox"),e=this.models[0].get("wholePosi"),f=c.startX,g=e.startX,h=e.endX,i={};switch(a){case"LEFT":i.initPosi={},i.wholePosi={},i.physicsBox={},i.physicsBox={},i.initPosi.startX=f-1,i.wholePosi.startX=g-1,i.wholePosi.endX=h-1,i.physicsBox.left=d.left-b.User.cellWidth,this.models[0].set(i);break;case"RIGHT":i.initPosi={},i.wholePosi={},i.physicsBox={},i.physicsBox={},i.initPosi.startX=f+1,i.wholePosi.startX=g+1,i.wholePosi.endX=h+1,i.physicsBox.left=d.left+b.User.cellWidth,this.models[0].set(i)}},getModelByType:function(a){return this.findWhere({selectType:a})}}))}),b("collections/headItemCol",function(){var a=c("lib/underscore"),b=c("lib/backbone"),d=c("basic/util/binary"),e=c("models/lineCol"),f=c("collections/selectRegion");return new(b.Collection.extend({model:e,url:"itemcol",getModelInitSelectRegion:function(){return this.models[f.models[0].toJSON().initPosi.startX]},getModelListByWholeSelectRegion:function(){var a,b,c,d,e=[],g=0;for(a=f.models[0],c=a.get("wholePosi").startX,d=a.get("wholePosi").endX,b=d-c+1;g<b;g++)e.push(this.models[c+g]);return e},getIndexBySort:function(a){return"MAX"===a?"MAX":d.indexAttrBinary(a,this.models,"sort")},getAliasBySort:function(a){var b;return"MAX"===a?"MAX":(b=d.indexAttrBinary(a,this.models,"sort"),-1===b?-1:this.models[b].get("alias"))},getIndexByDisplayname:function(b){var c=this.findWhere({displayName:b});return a.indexOf(this.models,c)},getModelListByIndex:function(a,b){var c,d=[];for(c=a;c<b+1;c++)d.push(this.models[c]);return d},getMaxDistanceWidth:function(){var a=this.models[this.models.length-1];return a.get("left")+a.get("width")},getIndexByAlias:function(a){var b,c,d=this.models;if("MAX"===a)return"MAX";for(b=0,c=this.length;b<c;b++)if(d[b].attributes.alias===a)return b;return-1},getModelByAlias:function(a){return this.findWhere({alias:a})},getModelByPosition:function(a){var b=d.newModelBinary(a,this.models,"left","width",0,this.models.length-1);return this.models[b]},getNeighborModelByAlias:function(a,b){var c,d=this.models,e=d.length;return"RIGHT"===b?(c=this.getIndexByAlias(a),c===e-1?null:d[c+1]):"LEFT"===b?(c=this.getIndexByAlias(a),0===c?null:d[c-1]):null}}))}),b("models/lineRow",function(){var a=c("lib/backbone.nested");return a.NestedModel.extend({defaults:{sort:0,alias:"",top:0,height:19,displayName:"",activeState:!1,isView:!0,operProp:{}},destroyView:function(){this.set("isView",!1)}})}),b("collections/headItemRow",function(){var a=c("lib/underscore"),b=c("lib/backbone"),d=c("basic/util/binary"),e=c("models/lineRow"),f=c("spreadsheet/config"),g=c("basic/tools/getdisplayname"),h=c("collections/selectRegion");return new(b.Collection.extend({model:e,url:"itemrow",getModelInitSelectRegion:function(){return this.models[h.models[0].toJSON().initPosi.startY]},getModelListByIndex:function(a,b){var c,d=[];for(c=a;c<b+1;c++)d.push(this.models[c]);return d},getModelListByWholeSelectRegion:function(){var a,b,c,d,e=[],f=0;for(a=h.models[0],c=a.get("wholePosi").startY,d=a.get("wholePosi").endY,b=d-c+1;f<b;f++)e.push(this.models[c+f]);return e},getIndexByDisplayname:function(b){return a.findIndex(this.toJSON(),{displayName:b})},getMaxDistanceHeight:function(){var a=this.models[this.models.length-1];return a.get("top")+a.get("height")},getModelByAlias:function(a){return this.findWhere({alias:a})},getModelByPosition:function(a){var b=d.newModelBinary(a,this.models,"top","height",0,this.models.length-1);return this.models[b]},getIndexByPosi:function(a){return d.newModelBinary(a,this.models,"top","height")},getIndexBySort:function(a){return"MAX"===a?"MAX":d.indexAttrBinary(a,this.models,"sort")},getAliasBySort:function(a){var b;return"MAX"===a?"MAX":(b=d.indexAttrBinary(a,this.models,"sort"),-1===b?-1:this.models[b].get("alias"))},getIndexByAlias:function(a){var b,c,d=this.models;if("MAX"===a)return"MAX";for(b=0,c=this.length;b<c;b++)if(d[b].attributes.alias===a)return b;return-1},getNextAliasByAlias:function(b){var c,d;return d=this.findWhere({alias:b}),c=a.indexOf(this.models,d),this.models[c+1].get("alias")},getNeighborModelByAlias:function(a,b){var c,d=this.models,e=d.length;return"RIGHT"===b?(c=this.getIndexByAlias(a),c===e-1?null:d[c+1]):"LEFT"===b?(c=this.getIndexByAlias(a),0===c?null:d[c-1]):null},generate:function(a){var b,c,d,e;for(void 0===a&&(a=1),b=this.models[this.length-1],d=b.get("sort")+1,c=b.get("height")+b.get("top")+1,e=0;e<a&&!(d+2>f.User.maxRowNum);e++)this.add({sort:d,alias:(d+1).toString(),top:c,height:f.User.cellHeight-1,displayName:g.getRowDisplayName(d)}),d++,c+=f.User.cellHeight}}))}),b("models/siderLineCol",function(){var a=c("lib/backbone.nested");return a.NestedModel.extend({defaults:{left:0,width:69}})}),b("collections/siderLineCol",function(){var a=c("lib/backbone"),b=c("models/siderLineCol");return new(a.Collection.extend({model:b,url:"sidercol"}))}),b("models/siderLineRow",function(){var a=c("lib/backbone.nested");return a.NestedModel.extend({defaults:{top:0,height:17}})}),b("collections/siderLineRow",function(){var a=c("lib/backbone"),b=c("models/siderLineRow");return new(a.Collection.extend({model:b,url:"siderrow"}))}),b("models/sheet",function(){var a=c("lib/backbone");return a.Model.extend({defaults:{name:"book",sort:0}})}),b("collections/sheets",function(){var a=c("lib/backbone"),b=c("models/sheet");return new(a.Collection.extend({model:b}))}),b("models/cell",function(){var a=c("lib/backbone.nested");return a.NestedModel.extend({defaults:{physicsBox:{top:0,left:0,width:71,height:19},occupy:{x:[],y:[]},content:{size:"11",family:"SimSun",bd:!1,underline:!1,italic:!1,color:"rgb(0, 0, 0)",alignRow:"",alignCol:"middle",texts:"",displayTexts:""},wordWrap:!1,border:{top:!1,right:!1,bottom:!1,left:!1},format:{type:"normal",isValid:!0,decimal:null,thousands:null,dateFormat:null,currencySign:null,currencyValid:!0},customProp:{background:"rgb(255, 255, 255)",comment:null},locked:!0,showState:!0,hidden:!1,isDestroy:!1,highlight:!1},hide:function(){this.set("showState",!1)}})}),b("collections/cells",function(){var a=c("lib/backbone"),b=c("basic/tools/cache"),d=c("basic/util/binary"),e=c("models/cell"),f=c("collections/headItemCol"),g=c("collections/headItemRow"),h=c("collections/selectRegion"),i=g.models,j=f.models;return new(a.Collection.extend({model:e,url:"/cell.htm",createCellModel:function(a,c,d,f,g){function h(a,b){var c,d;for(c in b)if("object"==typeof b[c])for(d in b[c])a.set(c+"."+d,b[c][d]);else a.set(c,b[c])}function k(a){var b;for(b in a)return!1;return!0}var l,m,n,o,p,q,r,s,t=[],u=[],v=0,w=0;for(void 0===d?(d=a,f=c):"object"==typeof d&&(g=d,d=a,f=c),r=j[a].get("left"),q=i[c].get("top"),l=f-c+1,m=d-a+1,p=new e,void 0!==g?h(p,g):k(s=j[a].get("operProp"))?k(s=i[c].get("operProp"))||h(p,s):h(p,s),n=0;n<m;n++)t.push(j[a+n].get("alias")),v+=j[a+n].get("width")+1;for(n=0;n<l;n++)u.push(i[c+n].get("alias")),w+=i[c+n].get("height")+1;for(n=0;n<l;n++)for(o=0;o<m;o++)b.cachePosition(i[c+n].get("alias"),j[a+o].get("alias"),this.length);return p.set("occupy",{x:t,y:u}),p.set("physicsBox",{top:q,left:r,width:v-1,height:w-1}),this.add(p),p},getCellByVertical:function(a,c,d,e){var h,i,j,k,l,m,n,o,p,q=[],r={};for("object"==typeof a&&(p=a,a=p.startColIndex,c=p.startRowIndex,d=p.endColIndex,e=p.endRowIndex),void 0===e&&(e=c),void 0===d&&(d=a),"MAX"===e&&(e=g.length-1),"MAX"===d&&(d=f.length-1),h=b.CellsPosition.strandX,j=a,l=d+1;j<l;j++)if(o=f.models[j].get("alias"),void 0!==h[o])for(k=c,m=e+1;k<m;k++)n=g.models[k].get("alias"),void 0!==h[o][n]&&(i=h[o][n],r[i]||(q.push(this.at(i)),r[i]=1));return q},getCellByTransverse:function(a,c,d,e){var h,i,j,k,l,m,n,o,p=[],q={};for(void 0===d&&(d=a),void 0===e&&(e=c),"MAX"===d&&(d=g.length-1),"MAX"===e&&(e=f.length-1),h=b.CellsPosition.strandY,j=a,l=d+1;j<l;j++)if(n=g.models[j].get("alias"),void 0!==h[n])for(k=c,m=e+1;k<m;k++)o=f.models[k].get("alias"),void 0!==h[n][o]&&(i=h[n][o],q[i]||(p.push(this.at(i)),q[i]=1));return p},getCellByRow:function(a,b){return this.getCellByTransverse(a,0,b,"MAX")},getRegionCells:function(a,c,d,e){void 0===d&&(d=a),void 0===e&&(e=c);for(var h,i,j=[],k=0,l=0,m=e-c+1,n=d-a+1,o=g.models,p=f.models,q=b.CellsPosition.strandX;k<m;k++)for(l=0;l<n;l++)i=o[c+k].get("alias"),h=p[a+l].get("alias"),void 0!==q[h]&&void 0!==q[h][i]?j.push(this.models[q[h][i]]):j.push(null);return j},getCellsByWholeSelectRegion:function(){var a,c,d,e,i,j,k,l,m,n,o=[],p=h.models[0].get("wholePosi"),q=g.models,r=f.models,s=b.CellsPosition.strandX;for(i=f.getIndexByAlias(p.startX),j=g.getIndexByAlias(p.startY),k=f.getIndexByAlias(p.endX),l=g.getIndexByAlias(p.endY),d=k-i+1,e=l-j+1,a=0;a<d;a++)for(c=0;c<e;c++)m=q[j+a].get("alias"),n=r[i+c].get("alias"),void 0!==s[n]&&void 0!==s[n][m]?o.push(this.models[s[n][m]]):o.push(null);return o},getCellsBySiderSelectRegion:function(){var a,b,c={};return a=this.getCellsByVerticalSiderSelectRegion(),b=this.getCellsByTransverSiderSelectRegion(),c.vertical=a,c.transver=b,c},getCellsByVerticalSiderSelectRegion:function(){var a,c,d,e,h,i,j,k,l,m={left:[],right:[]};for(l=b.CellsPosition.strandX,d=f.getModelListByWholeSelectRegion(),e=g.getModelListByWholeSelectRegion(),h=d.length,i=e.length,j=0;j<i;j++)for(k=0;k<h;k++)0===k&&(c=e[j].get("alias"),a=d[k].get("alias"),void 0!==l[a]&&void 0!==l[a][c]?m.left.push(this.models[l[a][c]]):m.left.push(null)),k===h-1&&(c=e[j].get("alias"),a=d[k].get("alias"),void 0!==l[a]&&void 0!==l[a][c]?m.right.push(this.models[l[a][c]]):m.right.push(null));return m},getCellsByTransverSiderSelectRegion:function(){var a,c,d,e,h,i,j,k,l,m={top:[],bottom:[]};for(l=b.CellsPosition.strandX,d=f.getModelListByWholeSelectRegion(),e=g.getModelListByWholeSelectRegion(),h=d.length,i=e.length,j=0;j<h;j++)for(k=0;k<i;k++)0===k&&(c=e[k].get("alias"),a=d[j].get("alias"),void 0!==l[a]&&void 0!==l[a][c]?m.top.push(this.models[l[a][c]]):m.top.push(null)),k===i-1&&(c=e[k].get("alias"),a=d[j].get("alias"),void 0!==l[a]&&void 0!==l[a][c]?m.bottom.push(this.models[l[a][c]]):m.bottom.push(null));return m},getHeadModelByWholeSelectRegion:function(){var a,b,c,d,e,i,j,k=[];for(b=f.getModelListByWholeSelectRegion(),c=g.getModelListByWholeSelectRegion(),d=b.length,e=c.length,i=0;i<e;i++)for(j=0;j<d;j++)a={wholePosi:{startX:h.models[0].get("wholePosi").startX+j,startY:h.models[0].get("wholePosi").startY+i},occupy:{x:b[j].get("alias"),y:c[i].get("alias")},physicsBox:{top:c[i].get("top"),left:b[j].get("left"),width:b[j].get("width"),height:c[i].get("height")}},k.push(a);return k},getHeadModelBySiderSelectRegion:function(){var a,b,c={};return a=this.getHeadModelByVerticalSiderSelectRegion(),b=this.getHeadModelByTransverSiderSelectRegion(),c.vertical=a,c.transverse=b,c},getHeadModelByVerticalSiderSelectRegion:function(){var a,b,c,d,e,i,j,k={left:[],right:[]};for(b=f.getModelListByWholeSelectRegion(),c=g.getModelListByWholeSelectRegion(),d=b.length,e=c.length,i=0;i<e;i++)for(j=0;j<d;j++)0===j&&(a={wholePosi:{startX:h.models[0].get("wholePosi").startX+j,startY:h.models[0].get("wholePosi").startY+i},occupy:{x:b[j].get("alias"),y:c[i].get("alias")},physicsBox:{top:c[i].get("top"),left:b[j].get("left"),width:b[j].get("width"),height:c[i].get("height")}},k.left.push(a)),j===d-1&&(a={wholePosi:{startX:h.models[0].get("wholePosi").startX+j,startY:h.models[0].get("wholePosi").startY+i},occupy:{x:b[j].get("alias"),y:c[i].get("alias")},physicsBox:{top:c[i].get("top"),left:b[j].get("left"),width:b[j].get("width"),height:c[i].get("height")}},k.right.push(a));return k},getHeadModelByTransverSiderSelectRegion:function(){var a,b,c,d,e,i,j,k={top:[],bottom:[]};for(b=f.getModelListByWholeSelectRegion(),c=g.getModelListByWholeSelectRegion(),d=b.length,e=c.length,i=0;i<d;i++)for(j=0;j<e;j++)0===j&&(a={wholePosi:{startX:h.models[0].get("wholePosi").startX+i,startY:h.models[0].get("wholePosi").startY+j},occupy:{x:b[i].get("alias"),y:c[j].get("alias")},physicsBox:{top:c[j].get("top"),left:b[i].get("left"),width:b[i].get("width"),height:c[j].get("height")}},k.top.push(a)),j===e-1&&(a={wholePosi:{startX:h.models[0].get("wholePosi").startX+i,startY:h.models[0].get("wholePosi").startY+j},occupy:{x:b[i].get("alias"),y:c[j].get("alias")},physicsBox:{top:c[j].get("top"),left:b[i].get("left"),width:b[i].get("width"),height:c[j].get("height")}},k.bottom.push(a));return k},operLeftHeadModel:function(a,c,d,e,h){var i,j,k,l,m,n=g.models,o=f.models,p={};for(void 0===d&&(d=a),void 0===e&&(e=c),k=o[a].get("alias"),i=b.CellsPosition.strandX[k],m=c;m<e+1;m++){if(l=n[m].get("alias"),void 0!==i&&void 0!==i[l]){if(p[i[l]]){p[i[k]]=1;continue}j=this.models[i[l]]}else j=this.createCellModel(a,m);h(j,o[a].get("sort"),n[m].get("sort"))}},operRightHeadModel:function(a,c,d,e,h){var i,j,k,l,m,n=g.models,o=f.models,p={};for(void 0===d&&(d=a),void 0===e&&(e=c),k=o[d].get("alias"),i=b.CellsPosition.strandX[k],m=c;m<e+1;m++){if(l=n[m].get("alias"),void 0!==i&&void 0!==i[l]){if(p[i[l]]){p[i[k]]=1;continue}j=this.models[i[l]]}else j=this.createCellModel(d,m);h(j,o[d].get("sort"),n[m].get("sort"))}},operTopHeadModel:function(a,c,d,e,h){var i,j,k,l,m,n=g.models,o=f.models,p={};for(void 0===d&&(d=a),void 0===e&&(e=c),l=n[c].get("alias"),i=b.CellsPosition.strandY[l],m=a;m<d+1;m++){if(k=o[m].get("alias"),void 0!==i&&void 0!==i[k]){if(p[i[k]]){p[i[k]]=1;continue}j=this.models[i[k]]}else j=this.createCellModel(m,c);h(j,o[m].get("sort"),n[c].get("sort"))}},operBottomHeadModel:function(a,c,d,e,h){var i,j,k,l,m,n=g.models,o=f.models,p={};for(void 0===d&&(d=a),void 0===e&&(e=c),l=n[e].get("alias"),i=b.CellsPosition.strandY[l],m=a;m<d+1;m++){if(k=o[m].get("alias"),void 0!==i&&void 0!==i[k]){if(p[i[k]]){p[i[k]]=1;continue}j=this.models[i[k]]}else j=this.createCellModel(m,e);h(j,o[m].get("sort"),n[e].get("sort"))}},operOuterHeadModel:function(a,b,c,d,e){this.operBottomHeadModel(a,b,c,d,e),this.operTopHeadModel(a,b,c,d,e),this.operLeftHeadModel(a,b,c,d,e),this.operRightHeadModel(a,b,c,d,e)},getAdjacent:function(a,b){var c,e,h,i,j,k=a.toJSON();switch(e=f.models,c=g.models,h=d.modelBinary(k.physicsBox.top,c,"top","height",0,c.length-1),i=d.modelBinary(k.physicsBox.left,e,"left","width",0,e.length-1),b){case"LEFT":j=this.getSelectRegionCells(i-1,h);break;case"RIGHT":j=this.getSelectRegionCells(i+1,h);break;case"UP":j=this.getSelectRegionCells(i,h-1);break;case"DOWN":j=this.getSelectRegionCells(i,h+1)}return j[0]},getFillCellsByRegion:function(a,c,d,e){void 0===e&&(e=c),void 0===d&&(d=a);for(var h,i,j=[],k=0,l=0,m=d-a+1,n=e-c+1,o=g.models,p=f.models,q=b.CellsPosition.strandX;k<m;k++)for(l=0;l<n;l++)i=o[a+k].get("alias"),h=p[c+l].get("alias"),void 0!==q[h]&&void 0!==q[h][i]?j.push(this.models[q[h][i]]):j.push(this.createCellModel(c+l,a+k));return j},getInitCellBySelectRegion:function(){var a,c,d,e,i,j,k,l;return d=h.models[0],e=d.toJSON(),a=f.models,c=g.models,i=c[e.initPosi.startY].get("alias"),j=a[e.initPosi.startX].get("alias"),l=b.CellsPosition.strandX,k=void 0===l[j]||void 0===l[j][i]?-1:l[j][i],-1!==k?this.models[k]:null},getCellsByColIndex:function(a,b){return this.getCellByVertical(a,0,b,"MAX")},getCellByAlias:function(a,c){var d;return void 0===b.CellsPosition.strandY[c]||void 0===b.CellsPosition.strandY[c][a]?null:(d=b.CellsPosition.strandY[c][a],this.models[d])},getCellsInStartRowRegion:function(a,c){var d,e,f,h,i,j,k,l=0;for(f=[],i=this.models,h=b.CellsPosition.strandY,l=a;l<c+1;l++)if(void 0!==g.models[l]&&(j=g.models[l].get("alias"),void 0!==h[j])){d=h[j];for(e in d)k=i[d[e]],g.getIndexByAlias(k.get("occupy").y[0])>=a&&-1===f.indexOf(k)&&f.push(k)}return f},getCellsInStartColRegion:function(a,c){var d,e,g,h,i,j,k,l=0;for(g=[],i=this.models,h=b.CellsPosition.strandX;l<c-a+1;l++)if(void 0!==f.models[a+l]&&(j=f.models[a+l].get("alias"),void 0!==h[j])){d=h[j];for(e in d)k=i[d[e]],f.getIndexByAlias(k.get("occupy").x[0])>=a&&-1===g.indexOf(k)&&g.push(k)}return g},oprCellsByRegion:function(a,c,d,e){var h,i,j,k,l,m,n=g.models,o=f.models,p=b.CellsPosition.strandX,q=a.startColIndex,r=a.startRowIndex,s=a.endColIndex,t=a.endRowIndex,u=0;for(void 0!==s&&null!==s||(s=q),void 0!==t&&null!==t||(t=r),j=s-q,i=t-r;u<i+1;u++)for(m=0;m<j+1;m++)k=n[r+u].get("alias"),l=o[q+m].get("alias"),h=void 0!==p[l]&&void 0!==p[l][k]?this.models[p[l][k]]:this.createCellModel(q+m,r+u),c(h,o[q+m].get("sort"),n[r+u].get("sort"),d,e)},getFullOperationRegion:function(a,b,c,e){var h,k,l,m,n,o,p,q,r=!0;if(c=void 0!==c?c:a,e=void 0!==e?e:b,"MAX"===a||"MAX"===c)return b>e&&(o=b,b=e,e=o),{startRowIndex:b,startColIndex:0,endRowIndex:e,endColIndex:f.length-1};if("MAX"===b||"MAX"===e)return a>c&&(o=a,a=c,c=o),{startRowIndex:0,startColIndex:a,endColIndex:c,endRowIndex:g.length-1};for(a>c&&(o=a,a=c,c=o),b>e&&(o=b,b=e,e=o);r;)for(r=!1,h=this.getCellByVertical(a,b,c,e),p=0,q=h.length;p<q;p++)o=h[p].get("physicsBox"),l=d.modelBinary(o.top,i,"top","height"),k=d.modelBinary(o.left,j,"left","width"),n=d.modelBinary(o.top+o.height,i,"top","height"),m=d.modelBinary(o.left+o.width,j,"left","width"),k<a&&(a=k,r=!0),l<b&&(b=l,r=!0),n>e&&(e=n,r=!0),m>c&&(c=m,r=!0);return{startRowIndex:b,startColIndex:a,endRowIndex:e,endColIndex:c}}}))}),b("basic/tools/strandmap",function(){var a={},b={},c="MAX";return{addPointRecord:function(c,d,e,f){this._addPointRecord(c,d,a,e,f),this._addPointRecord(d,c,b,e,f)},getPointRecord:function(b,c,d){var e;if(a[b]&&(e=a[b][c]))return void 0!==d&&void 0!==e[d]?e[d]:e},deletePointRecord:function(c,d,e){var f;e?a[c]&&(f=a[c][d])&&(delete f[e],f=b[d][c],delete f[e]):((f=a[c])&&delete f[d],(f=b[d])&&delete f[c])},calcPointRecord:function(d,e,f){var g;return a[d]&&(g=a[d][e])&&void 0!==g[f]?g[f]:a[d]&&(g=a[d][c])&&void 0!==g[f]?g[f]:b[e]&&(g=b[e][c])&&void 0!==g[f]?g[f]:void 0},getVerticalRecord:function(b,c){var d,e,f=[];if(e=a[b])for(d in e)void 0!==e[d]&&void 0!==e[d][c]&&f.push(e[d][c]);return f},getTransverseRecord:function(a,c){var d,e,f=[];if(e=b[a])for(d in e)void 0!==e[d]&&void 0!==e[d][c]&&f.push(e[d][c]);return f},addColRecord:function(c,d,e){this._addRecord(c,a,b,d,e)},addRowRecord:function(c,d,e){this._addRecord(c,b,a,d,e)},getColRecord:function(b,c){return this._getRecord(b,a,c)},getRowRecord:function(a,c){return this._getRecord(a,b,c)},insertRowUpdateRecord:function(a){this._insert(b,a)},insertColUpdateRecord:function(b){this._insert(a,b)},_addPointRecord:function(a,b,c,d,e){var f;void 0===e&&(e=d,d=null),c[a]||(c[a]={}),d?(f=c[a][b]?c[a][b]:c[a][b]={},f[d]=e):c[a][b]=e},_insert:function(a,b){var d,e;for(e in a)(d=a[e][c]&&d[b]>=b)&&d[b]++},_getRecord:function(a,b,d){var e;if(b[a]&&(e=b[a][c])&&void 0!==typeof(e=e[d]))return e},_getRecordList:function(a,b){var d,e,f={};for(e in a)(d=a[e][c])&&d[b]&&(f[e]=d[b]);return f},_addRecord:function(a,b,d,e,f){var g,h,i;b[a]||(b[a]={}),g=b[a][c]?b[a][c]:b[a][c]={},h=this._getRecordList(d,e);for(i in h)this._addPointRecord(a,i,b,e,f),this._addPointRecord(i,a,d,e,f);for(i in b[a])i!==c&&(this._addPointRecord(a,i,b,e,f),this._addPointRecord(i,a,d,e,f));g[e]=f}}}),b("basic/tools/original",function(){var b=c("lib/jquery"),d=c("spreadsheet/config"),e=c("basic/util/binary"),f=c("basic/tools/cache"),g=c("basic/tools/send"),h=c("basic/tools/text2sort"),i=c("basic/tools/loadrecorder"),j=c("basic/tools/getdisplayname"),k=c("collections/headItemCol"),l=c("collections/headItemRow"),m=c("collections/siderLineCol"),n=c("collections/siderLineRow"),o=c("collections/selectRegion"),p=c("collections/sheets"),q=c("collections/cells"),r=c("basic/tools/strandmap"),s=k.models,t=l.models;return{bulidNewExcel:function(){var a,b,c,e,f;for(c=d.User.initColNum,e=d.User.initRowNum,a=0;a<c;a++)f={sort:a,alias:(a+1).toString(),left:a*d.User.cellWidth,width:d.User.cellWidth-1,displayName:j.getColDisplayName(a)},k.add(f);for(b=0;b<e;b++)f={sort:b,alias:(b+1).toString(),top:b*d.User.cellHeight,height:d.User.cellHeight-1,displayName:j.getRowDisplayName(b)},l.add(f);this.restoreSelectRegion()},analysisRowData:function(a,b){var c,d,f;for(f=0;f<a.length;f++)d=e.indexModelBinary(a[f].top,l.models,"top","height"),-1===l.getIndexByAlias(a[f].aliasY)?(c={sort:b+f,top:a[f].top,height:a[f].height,alias:a[f].aliasY,operProp:a[f].operProp,displayName:j.getRowDisplayName(b+f)},l.push(c,{at:d})):d++},analysisColData:function(a,b){function c(a){var b;for(b in a)return!1;return!0}var e,f,g,h,i;for(f=0;f<a.length;f++)-1===k.getIndexByAlias(a[f].aliasY)&&(e={sort:b+f,left:a[f].left,width:a[f].width,alias:a[f].aliasX,hidden:a[f].hidden,originalWidth:a[f].originWidth,operProp:{}},c(a[f].operProp.content)||(e.operProp.content=a[f].operProp.content),c(a[f].operProp.customProp)||(e.operProp.customProp=a[f].operProp.customProp),c(a[f].operProp.border)||(e.operProp.border=a[f].operProp.border),e.displayName=j.getColDisplayName(b+f),a[f].hidden&&f>0&&k.models[f-1].set("isRightAjacentHide",!0),f>0&&a[f-1].hidden&&(e.isLeftAjacentHide=!0),k.add(e));if(k.length<d.User.initColNum)for(h=d.User.initColNum-k.length,i=k.length,g=0;g<h;g++)e={sort:i+g,left:k.models[i+g-1].get("left")+k.models[i+g-1].get("width")+1,width:d.User.cellWidth,alias:(k.length+1).toString(),displayName:j.getColDisplayName(i+g)},k.add(e)},analysisCellData:function(a){var b,c,d,g,h,i,j,k,m,n,o,p,r,u=null,v=l.length-1,w={},x=f.CellsPosition.strandX,y=0,z=0;for(p=0;p<a.length;p++)if(null!==(d=a[p])&&(g=d.occupy.x,h=d.occupy.y,n=d.occupy.col,o=d.occupy.row,delete d.occupy.col,delete d.occupy.row,i=e.indexAttrBinary(o,t,"sort"),k=i+h.length-1,k>v&&(k=v),-1!==i)){for(j=e.indexAttrBinary(n,s,"sort"),m=j+g.length-1,x[g[0]]&&void 0!==x[g[0]][h[0]]&&(u=q.models[x[g[0]][h[0]]]),b=j;b<m+1;b++)r=s[b],r.get("hidden")||(y+=r.get("width")+1);for(b=i;b<k+1;b++)r=t[b],z+=r.get("height")+1;if(w={top:t[i].get("top"),left:s[j].get("left"),width:y-1,height:z-1},null!==u)u.set("physicsBox",w);else for(d.physicsBox=w,q.add(d),b=0;b<g.length;b++)for(c=0;c<h.length;c++)f.cachePosition(h[c],g[b],q.length-1);u=null,y=0,z=0}},analysisSheetData:function(a){var b;for(b=0;b<a.length;b++)p.add({name:a[b],sort:b})},restoreSelectRegion:function(){var a,b,c,d,e,g,h,i,j,p,r,s,t,u,v,w;for(c=f.UserView.rowAlias,d=f.UserView.colAlias,a=l.getModelByAlias(c),e=k.getIndexByAlias(d),b=k.models[e],u=k.length,v=e;v<u&&b.get("hidden");v++)b=k.models[++e],d=b.get("alias");if(s=f.CellsPosition.strandX,void 0!==s[d]&&void 0!==s[d][c]&&(t=q.models[s[d][c]]),void 0!==t){for(g=t.get("occupy").y,g=g[g.length-1],h=t.get("occupy").x,h=h[h.length-1],i=k.getIndexByAlias(h),j=l.getIndexByAlias(g),p=k.getIndexByAlias(d),r=l.getIndexByAlias(c),w={physicsBox:{top:t.get("physicsBox").top,left:t.get("physicsBox").left,width:t.get("physicsBox").width,height:t.get("physicsBox").height},wholePosi:{startX:d,startY:c,endX:h,endY:g}},o.add(w),m.add({left:t.get("physicsBox").left,width:t.get("physicsBox").width}),n.add({top:t.get("physicsBox").top,height:t.get("physicsBox").height}),u=l.length,v=0;v<u;v++)l.models[v].set({activeState:!1});for(u=k.length,v=0;v<u;v++)k.models[v].set({activeState:!1});for(v=0;v<i-p+1;v++)k.models[p+v].set({activeState:!0});for(v=0;v<j-r+1;v++)l.models[r+v].set({activeState:!0})}else w={physicsBox:{width:b.get("width"),height:a.get("height"),top:a.get("top"),left:b.get("left")},wholePosi:{startX:d,startY:c,endX:d,endY:c}},o.add(w),m.add({left:b.get("left"),width:b.get("width")}),n.add({top:a.get("top"),height:a.get("height")})},analysisValidateRule:function(a){var b,c,e,g,h,i,j,k,l,m,n,o,p,q;for(a instanceof Array||(a=[a]),l=0,p=a.length;l<p;l++){for(b=a[l],e={},c=b.coordinate||[],e.validationType=b.rule.validationType,e.formula1=b.rule.formula1,e.formula2=b.rule.formula2,g=b.rule.index,m=0,q=c.length;m<q;m++)if(i=c[m].startCol,h=c[m].startRow,k=c[m].endCol,-1===(j=c[m].endRow))for(n=i;n<k+1;n++)r.addColRecord((n+1).toString(),"validate",g);else if(-1===k)for(n=h;n<j+1;n++)r.addRowRecord((n+1).toString(),"validate",g);else for(n=i;n<k+1;n++)for(o=h;o<j+1;o++)r.addPointRecord((n+1).toString(),(o+1).toString(),"validate",g);void 0===f.validate[g]&&(e.validationType===d.validationType.sequenceType?this.insertSequenceRule(e,g):f.validate[g]=e)}},insertSequenceRule:function(a,b){var c,d,e,g,i;if(0!==a.formula1.indexOf("="))return void(f.validate[b]=a);c=h(a.formula1),d=l.getAliasBySort(c.startRowSort),e=l.getAliasBySort(c.endRowSort),g=k.getAliasBySort(c.startColSort),i=k.getAliasBySort(c.endColSort),
-1!==d&&-1!==e&&-1!==g&&-1!==i&&"MAX"!==i&&"MAX"!==e&&(a.formula1={startRowAlias:d,endRowAlias:e,startColAlias:g,endColAlias:i},f.validate[b]=a)},restoreExcel:function(c){function e(a){var b,c,d,e;if(a&&a.returndata&&(f.UserView.rowAlias=a.displayRowStartAlias,f.UserView.colAlias=a.displayColStartAlias,f.protectState=a.protect,h=a.dataRowStartIndex,j=a.dataColStartIndex,f.localRowPosi=a.maxPixel,f.aliasRowCounter=a.aliasRowCounter,f.aliasColCounter=a.aliasColCounter,a=a.returndata,a.spreadSheet&&a.spreadSheet[0]&&(b=a.spreadSheet[0].sheet))){n.push(a.spreadSheet[0].name);var g=b.cells,m=b.glY,p=b.glX;o.analysisSheetData(n),o.analysisRowData(m,h),o.analysisColData(p,j),o.analysisCellData(g),o.restoreSelectRegion(),o.analysisValidateRule(a.spreadSheet[0].validate.rules),f.validateCounter=a.spreadSheet[0].validate.total,c=k.models,d=l.models,f.TempProp.colAlias=c[0].get("alias"),f.TempProp.rowAlias=d[0].get("alias"),k.length,e=l.length,i.insertPosi(d[0].get("top"),d[e-1].get("top")+d[e-1].get("height"),f.rowRegionPosi),i.insertPosi(d[0].get("top"),d[e-1].get("top")+d[e-1].get("height"),f.cellRegionPosi.vertical)}}var h,j,m=a.SPREADSHEET_BUILD_STATE,n=[],o=this;if("true"===m||void 0===m)return this.bulidNewExcel(),void(f.localRowPosi=0);g.PackAjax({url:d.url.table.reload,async:!1,isPublic:!1,data:JSON.stringify({top:0,bottom:b("#"+c).height()+d.System.prestrainHeight}),dataType:"json",success:function(){e.apply(this,arguments)}})}}}),b("basic/util/listener",function(){var a=c("basic/tools/cache"),b=a.listenerList;return{addEventListener:function(a,c){var d;0!==a.indexOf("on")&&(a="on"+a),b=b||{},b[a]=b[a]||{},void 0===c.listener&&(c.listener=[]),"function"==typeof c&&(d=Object.getOwnPropertyNames(b[a]).length,c.listener.push(d),b[a][d]=c)},removeEventListener:function(a,c){if(0!==a.indexOf("on")&&(a="on"+a),void 0===c)return void delete b[a];if(void 0!==c.listener&&void 0!==b[a])for(var d in c.listener)void 0!==b[a][d]&&delete b[a][d]},excute:function(a,c){if(0!==a.indexOf("on")&&(a="on"+a),void 0!==b[a])for(var d in b[a])b[a][d](c)}}}),b("basic/tools/parselabel",function(){return function(a){function b(a,b){var c="",d=0;return/[A-Z]/i.test(a)&&(d=a.match(/[A-Z]/gi).length),"col"===b?c=a.substring(0,d):"row"===b&&(c=a.substring(d)),c}function c(a){var b,c=0,d=0,e=a.length,f=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if("MAX"===a)return"MAX";for(;c<e;c++)b=f.indexOf(a[c])+1,d+=b*Math.pow(26,e-c-1);return d-1}function d(a){return"MAX"===a?"MAX":parseInt(a)-1}var e,f,g,h,i,j,k,l,m,n=/^[A-Z]+[1-9]+[0-9]*$/;if(a instanceof Array){if(2!==a.length)throw new Error("Parameter format error");if(!n.test(a[0])&&!n.test(a[1]))throw new Error("Parameter format error");j=b(a[0],"col"),k=b(a[0],"row"),l=b(a[1],"col"),m=b(a[1],"row"),f=c(j),g=c(l),h=d(k),i=d(m)}else if(/^[A-Z]+$/.test(a))h=0,i=-1,f=g=c(a);else if(/^[1-9]+[0-9]*$/.test(a))f=0,g=-1,h=i=d(a);else{if(!n.test(a))throw new Error("Parameter format error");k=b(a,"row"),j=b(a,"col"),f=g=c(j),h=i=d(k)}return h>i&&-1!==i&&(e=h,h=i,i=e),f>g&&-1!==g&&(e=f,f=i,i=e),{startRowSort:h,endRowSort:i,startColSort:f,endColSort:g}}}),b("basic/tools/getoperregion",function(){var a=c("basic/util/binary"),b=c("basic/tools/parselabel"),d=c("collections/headItemCol"),e=c("collections/headItemRow"),f=c("collections/selectRegion");return function(c){var g,h,i,j,k,l,m,n,o,p,q,r=d.models,s=e.models;return c?(h=b(c),o=h.startColSort,n=h.startRowSort,p=h.endRowSort,q=h.endColSort,k=a.indexAttrBinary(o,r,"sort"),j=a.indexAttrBinary(n,s,"sort"),m=-1!==q?a.indexAttrBinary(q,r,"sort"):"MAX",l=-1!==p?a.indexAttrBinary(p,s,"sort"):"MAX",-1===l&&(l=e.length-1),-1===m&&(m=d.length-1)):(g=f.getModelByType("selected"),i=g.get("wholePosi"),k=d.getIndexByAlias(i.startX),m=d.getIndexByAlias(i.endX),j=e.getIndexByAlias(i.startY),l=e.getIndexByAlias(i.endY),o=r[k].get("sort"),n=s[j].get("sort"),p="MAX"===l?-1:s[l].get("sort"),q="MAX"===m?-1:r[m].get("sort")),{sendRegion:{startCol:o,endCol:q,startRow:n,endRow:p},operRegion:{startColIndex:k,startRowIndex:j,endRowIndex:l,endColIndex:m}}}}),b("basic/tools/history",function(){var a=[],b=-1;return{next:function(){return b!==a.length-1&&a[++b]},previous:function(){return 0!==a.length&&a[b--]},addAction:function(c){a=a.slice(0,b+1),a.push(c),b=a.length-1},getCellPropUpdateAction:function(a,b,c,d){return{region:c,type:"updateCellProp",propName:a,propValue:b,originalData:d}},getCellCoverAction:function(a,b){return{type:"coverCellModel",currentModelIndexs:a,originalModelIndexs:b}},getValidateUpdateAction:function(a,b,c){return{type:"updateValidateRule",region:a,currentRuleIndex:b,originalData:c}},getValidateCoverAction:function(a,b){return{type:"coverValidateRule",currentData:a,originalData:b}},clear:function(){b=0,a=[]}}}),b("entrance/row/rowoperation",function(){var a=c("models/cell"),b=c("basic/tools/cache"),d=c("collections/headItemRow"),e=c("collections/headItemCol"),f=c("collections/cells");return{rowPropOper:function(c,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;for(w=h.split("."),w.length>1&&(l=w[1]),k=w[0],o=(new a).toJSON(),d.length,v=b.CellsPosition.strandX,y=c;y<g+1;y++){for(m=d.models[y],n=m.get("operProp"),void 0!==n[k]&&void 0!==n[k][l]?o[k][l]===i?(delete n[k][l],Object.getOwnPropertyNames(n[k]).length||delete n[k]):n[k][l]=i:o[k][l]!==i&&(n[k]||(n[k]={}),n[k][l]=i),m.set("operProp",n),t=f.getCellByTransverse(y,0,y,e.length-1),x=t.length,z=0;z<x;z++)1===t[z].get("occupy").y.length&&(t[z].set(h,i),"function"==typeof j&&j(t[z]));for(p=0,q=e.length-1,z=p;z<q+1;z++)r=d.models[y].get("alias"),s=e.models[z].get("alias"),v[s]&&void 0!==v[s][r]||(u=f.createCellModel(z,y),u.set(h,i))}}}}),b("entrance/col/coloperation",function(){var a=c("models/cell"),b=c("basic/tools/cache"),d=c("basic/util/binary"),e=c("collections/headItemRow"),f=c("collections/headItemCol"),g=c("collections/cells"),h=f.models,i=e.models;return{colPropOper:function(c,j,k,l,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;for(z=k.split("."),z.length>1&&(o=z[1]),n=z[0],t=(new a).toJSON(),D=e.length,B=c;B<j+1;B++){for(r=f.models[B],s=r.toJSON().operProp,void 0!==s[n]&&void 0!==s[n][o]?t[n][o]===l?(delete s[n][o],Object.getOwnPropertyNames(s[n]).length||delete s[n]):s[n][o]=l:t[n][o]!==l&&(s[n]||(s[n]={}),s[n][o]=l),r.set("operProp",s),p=h[B].get("alias"),u=d.indexModelBinary(b.viewRegion.top,i,"top","height"),v=d.indexModelBinary(b.viewRegion.bottom,i,"top","height"),y=b.CellsPosition.strandX,x=g.getCellByTransverse(0,B,D-1,B),A=x.length,C=0;C<A;C++)x[C].set(k,l),"function"==typeof m&&m(x[C]);for(C=u;C<v+1;C++)q=i[C].get("alias"),void 0!==y[p]&&void 0!==y[p][q]||(w=g.createCellModel(B,C),w.set(k,l))}}}}),b("entrance/tool/setfontcolor",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("basic/tools/cache"),e=c("spreadsheet/config"),f=c("collections/selectRegion"),g=c("collections/headItemCol"),h=c("collections/headItemRow"),i=c("basic/tools/getoperregion"),j=c("basic/tools/history"),k=c("collections/cells"),l=c("entrance/row/rowoperation"),m=c("entrance/col/coloperation");return function(c,n,o){function p(){b.PackAjax({url:e.url.cell.fontColor,data:JSON.stringify({sheetId:"1",coordinate:t,color:n})})}var q,r,s,t,u=h.models,v=g.models,w=[];return q=f.getModelByType("clip"),void 0!==q&&(d.clipState="null",q.destroy()),d.protectState?void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作"):(r=i(o),s=r.operRegion,t=r.sendRegion,-1===s.startColIndex||-1===s.startRowIndex?void p():("MAX"===s.endColIndex?l.rowPropOper(s.startRowIndex,s.endRowIndex,"content.color",n):"MAX"===s.endRowIndex?m.colPropOper(s.startColIndex,s.endColIndex,"content.color",n):(k.oprCellsByRegion(s,function(a,b,c){a.get("content").color!==n&&(w.push({colSort:b,rowSort:c,value:a.get("content").color}),a.set("content.color",n))}),j.addAction(j.getCellPropUpdateAction("content.color",n,{startColSort:v[s.startColIndex].get("sort"),startRowSort:u[s.startRowIndex].get("sort"),endColSort:v[s.endColIndex].get("sort"),endRowSort:u[s.endRowIndex].get("sort")},w))),void p()))}}),b("entrance/tool/setfillcolor",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("spreadsheet/config"),e=c("basic/tools/cache"),f=c("collections/cells"),g=c("basic/tools/history"),h=c("collections/headItemCol"),i=c("collections/headItemRow"),j=c("collections/selectRegion"),k=c("basic/tools/getoperregion"),l=c("entrance/row/rowoperation"),m=c("entrance/col/coloperation");return function(c,n,o){var p,q,r,s,t,u=i.models,v=h.models,w=[];if(p=j.getModelByType("clip"),void 0!==p&&(e.clipState="null",p.destroy()),e.protectState)return void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作");n||(n=c),q=k(o),r=q.operRegion,s=q.sendRegion,"MAX"===r.endColIndex?l.rowPropOper(r.startRowIndex,r.endRowIndex,"customProp.background",n):"MAX"===r.endRowIndex?m.colPropOper(r.startColIndex,r.endColIndex,"customProp.background",n):(f.oprCellsByRegion(r,function(a,b,c){a.get("customProp").background!==n&&(w.push({colSort:b,rowSort:c,value:a.get("customProp").background}),a.set("customProp.background",n))}),t=g.getCellPropUpdateAction("customProp.background",n,{startColSort:v[r.startColIndex].get("sort"),startRowSort:u[r.startRowIndex].get("sort"),endColSort:v[r.endColIndex].get("sort"),endRowSort:u[r.endRowIndex].get("sort")},w),g.addAction(t)),b.PackAjax({url:d.url.cell.bg,data:JSON.stringify({coordinate:s,color:n})})}}),b("entrance/tool/setfontfamily",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("collections/cells"),e=c("basic/tools/cache"),f=c("spreadsheet/config"),g=c("basic/tools/history"),h=c("collections/headItemCol"),i=c("collections/headItemRow"),j=c("collections/selectRegion"),k=c("basic/tools/getoperregion"),l=c("entrance/col/coloperation"),m=c("entrance/row/rowoperation");return function(c,n,o){function p(){b.PackAjax({url:f.url.cell.fontFamily,data:JSON.stringify({coordinate:t,family:n})})}var q,r,s,t,u=i.models,v=h.models,w=[];return q=j.getModelByType("clip"),void 0!==q&&(e.clipState="null",q.destroy()),e.protectState?void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作"):(r=k(o),s=r.operRegion,t=r.sendRegion,-1===s.startColIndex||-1===s.startRowIndex?void p():("MAX"===s.endColIndex?m.rowPropOper(s.startRowIndex,s.endRowIndex,"content.family",n):"MAX"===s.endRowIndex?l.colPropOper(s.startColIndex,s.endColIndex,"content.family",n):(d.oprCellsByRegion(s,function(a,b,c){a.get("content").family!==n&&(w.push({colSort:b,rowSort:c,value:a.get("content").family}),a.set("content.family",n))}),g.addAction(g.getCellPropUpdateAction("content.family",n,{startColSort:v[s.startColIndex].get("sort"),startRowSort:u[s.startRowIndex].get("sort"),endColSort:v[s.endColIndex].get("sort"),endRowSort:u[s.endRowIndex].get("sort")},w))),void p()))}}),b("entrance/cell/setcellheight",function(){var a=c("lib/backbone"),b=c("collections/headItemRow"),d=c("basic/tools/cache");return function(c,e,f){var g;!0!==d.TempProp.isFrozen&&(g=b.getIndexByDisplayname(e))>-1&&a.trigger("event:rowHeightAdjust",g,f)}}),b("entrance/cell/setcellwidth",function(){var a=c("lib/backbone"),b=c("collections/headItemCol"),d=c("basic/tools/cache");return function(c,e,f){var g;!0!==d.TempProp.isFrozen&&(g=b.getIndexByDisplayname(e))>-1&&a.trigger("event:colWidthAdjust",g,f)}}),b("entrance/tool/mergecell",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("basic/tools/cache"),e=c("basic/tools/strandmap"),f=c("spreadsheet/config"),g=c("collections/selectRegion"),h=c("basic/tools/history"),i=c("collections/cells"),j=c("models/cell"),k=c("collections/headItemCol"),l=c("collections/headItemRow"),m=c("basic/tools/getoperregion"),n=k.models,o=l.models,p=i.models;return function(c,k){var l,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=d.CellsPosition.strandX,J=[],K=[],L=[],M=[],N=0,O=0;if(w=g.getModelByType("clip"),void 0!==w&&(d.clipState="null",w.destroy()),t=m(k),u=t.operRegion,v=t.sendRegion,d.protectState)return void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作");if(-1===u.startColIndex||-1===u.startRowIndex)return void b.PackAjax({url:f.url.cell.merge,data:JSON.stringify({coordinate:v})});if("MAX"!==u.endColIndex&&"MAX"!==u.endRowIndex){for(l=u.startRowIndex,q=u.startColIndex,r=u.endRowIndex,s=u.endColIndex,C=n[q].get("alias"),D=o[l].get("alias"),x=i.getCellByTransverse(l,q)[0],x=x?x.clone():new j,y=e.getPointRecord(C,D,"validate"),G=l;G<r+1;G++)for(H=q;H<s+1;H++)C=n[H].get("alias"),D=o[G].get("alias"),z||(z=i.getCellByTransverse(G,H)[0],(z=z&&""!==z.get("content").texts?z.clone():null)&&(B=e.getPointRecord(C,D,"validate"))),I[C]&&void 0!==(A=I[C][D])&&(J.push(A),p[A].set("isDestroy",!0)),K.push({colSort:n[H].get("sort"),rowSort:o[G].get("sort"),originalIndex:e.getPointRecord(C,D,"validate")}),d.cachePosition(D,C,i.length);for(!z&&x?(z=x,B=y):z||(z=new j),G=0;G<s-q+1;G++)L.push(n[q+G].get("alias")),N+=n[q+G].get("width")+1;for(G=0;G<r-l+1;G++)M.push(o[l+G].get("alias")),O+=o[l+G].get("height")+1;for(z.set("physicsBox",{top:o[l].get("top"),left:n[q].get("left"),width:N-1,height:O-1}),z.set("occupy",{x:L,y:M}),i.add(z),G=l;G<r+1;G++)for(H=q;H<s+1;H++)C=n[H].get("alias"),D=o[G].get("alias"),void 0!==B?e.addPointRecord(C,D,"validate",B):e.deletePointRecord(C,D,"validate");E=h.getCellCoverAction([i.length-1],J),F=h.getValidateUpdateAction({startRowSort:o[l].get("sort"),endRowSort:o[r].get("sort"),startColSort:n[q].get("sort"),endColSort:n[s].get("sort")},B,K),h.addAction([E,F]),b.PackAjax({url:f.url.cell.merge,data:JSON.stringify({coordinate:v})})}}}),b("entrance/tool/splitcell",function(){var a=c("lib/underscore"),b=c("lib/backbone"),d=c("basic/tools/send"),e=c("basic/tools/cache"),f=c("spreadsheet/config"),g=c("collections/selectRegion"),h=c("basic/tools/getoperregion"),i=c("basic/tools/history"),j=c("collections/cells"),k=c("collections/headItemCol"),l=c("collections/headItemRow"),m=k.models,n=l.models;return function(c,k){function l(){d.PackAjax({url:f.url.cell.split,data:JSON.stringify({coordinate:q})})}var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=e.CellsPosition.strandX,I=[],J=[];if(y=g.getModelByType("clip"),void 0!==y&&(e.clipState="null",y.destroy()),e.protectState)return void b.trigger("event:showMsgBar:show","保护状态，不能进行该操作");if(o=h(k),p=o.operRegion,q=o.sendRegion,"MAX"!==p.endColIndex&&"MAX"!==p.endRowIndex){if(-1===p.startColIndex||-1===p.startRowIndex)return void l();for(r=p.startColIndex,s=p.startRowIndex,t=p.endColIndex,u=p.endRowIndex,v=j.getCellByVertical(r,s,t,u),z=r;z<t+1;z++)for(A=s;A<u+1;A++)C=m[z].get("alias"),D=n[A].get("alias"),(E=j.getCellByVertical(z,A)[0])&&(F=a.clone(E.attributes),w=F.occupy.x[0],x=F.occupy.y[0],w!==C||x!==D?(F.content.texts="",F.content.displayTexts=""):I.push(H[w][x]),e.cachePosition(D,C,j.length),J.push(j.length),j.createCellModel(z,A,F));for(z=0,B=v.length;z<B;z++)v[z].set("isDestroy",!0);G=i.getCellCoverAction(J,I),i.addAction(G),l()}}}),b("basic/util/aspect",function(){return{before:function(a,b,c){return this._aspect("before",a,b,c)},after:function(a,b,c){return this._aspect("after",a,b,c)},_aspect:function(a,b,c,d){var e,f,g,h=this;return"function"==typeof b?(e=b,b=null,d=c):e=b[c],g=e.orignal||e,g[a]=g[a]||[],g[a].push(d),f=g===e?b?b[c]=function(){return h._execute(arguments,b,g)}:function(){return h._execute(arguments,b,g)}:e,f.orignal=g,f},_execute:function(a,b,c){var d,e,f,g;for(f=c.before||[],g=c.after||[],d=0,e=f.length;d<e;d++)if(!f[d].apply(b,a))return!1;for(c.apply(b,a),d=g.length-1;d>-1;d--)if(!g[d].apply(b,a))return!1;return!0}}}),b("entrance/tool/protect",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("spreadsheet/config"),e=c("basic/tools/cache"),f=c("collections/cells"),g=c("basic/tools/history"),h=c("collections/headItemCol"),i=c("collections/headItemRow"),j=c("collections/selectRegion"),k=c("basic/tools/getoperregion"),l=i.models,m=h.models;return{lock:function(a,b){void 0===b&&(b=a),this._toggle(!0,b)},unlock:function(a,b){void 0===b&&(b=a),this._toggle(!1,b)},_toggle:function(c,g){var h,i,n,o,p,q,r,s,t,u,v=[],w=[];if(e.protectState)return void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作");if((h=j.getModelByType("clip"))&&(e.clipState="null",h.destroy()),i=k(g),n=i.operRegion,o=i.sendRegion,"MAX"===n.endColIndex){for(p=0,q=m.length;p<q;p++)"boolean"==typeof(u=m[p].get("operProp").locked)&&u!==c&&w.push(p);for(p=n.startRowIndex,q=n.endRowIndex+1;p<q;p++)for(l[p].set("operProp.locked",c),r=0,s=w.length;r<s;r++)t=f.createCellModel(w[r],p),t.set("locked",c);for(v=f.getCellByVertical(n),p=0,q=v.length;p<q;p++)v[p].set("locked",c)}else if("MAX"===n.endRowIndex){for(p=0,s=l.length;p<s;p++)"boolean"==typeof(u=l[p].get("operProp").locked)&&u!==c&&w.push(p);for(p=n.startColIndex,q=n.endColIndex+1;p<q;p++)for(m[p].set("operProp.locked",c),r=0,s=w.length;r<s;r++)t=f.createCellModel(p,w[r]),t.set("locked",c);for(v=f.getCellByVertical(n),p=0,q=v.length;p<q;p++)v[p].set("locked",c)}else f.oprCellsByRegion(n,function(a){a.set("locked",c)});b.PackAjax({url:d.url.cell.lock,data:JSON.stringify({coordinate:[o],lock:c})})},execute:function(a){g.clear(),e.protectState=!0,b.PackAjax({url:d.url.sheet.protect,data:JSON.stringify({password:a,protect:!0})})},cancel:function(a){var c=!1;return b.PackAjax({url:d.url.sheet.protect,data:JSON.stringify({password:a,protect:!1}),success:function(a){a&&a.isLegal&&(g.clear(),e.protectState=!1,c=!0)}}),c},interceptor:function(a){if(!e.protectState)return!1;var b,c,d,g,h,i,j,k=a.startColIndex,n=a.endColIndex||a.startColIndex,o=a.startRowIndex,p=a.endRowIndex||a.startRowIndex,q=e.CellsPosition.strandX,r=f.models,s={};if("MAX"===n||"MAX"===p)return!0;for(g=k;g<n+1;g++)for(j=m[g].get("alias"),c=m[g].get("operProp").locked,h=o;h<p+1;h++)if(i=l[h].get("alias"),d=l[h].get("operProp").locked,q[j]&&void 0!==(b=q[j][i])){if(s[b])continue;if(r[b].get("locked"))return!0;s[b]=!0}else{if(!0===c||!0===d)return!0;if(void 0===c&&void 0===d)return!0}return!1},showLockContainer:function(){if(e.protectState)return void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作");a.trigger("event:sidebarContainer:show","lock")},showProtectContainer:function(){a.trigger("event:sidebarContainer:show","protect")}}}),b("basic/util/observer.pattern",function(){var a;return a={},{subscriber:{subscribe:function(b,c,d){var e,f;void 0===(e=a[b])&&(e=a[b]={}),void 0===(f=e[c])&&(f=e[c]=[]),f.push({fn:d,master:this})},unsubscribe:function(b,c){var d,e,f,g,h;if(void 0!==(f=a[b]))for(d=f[c],g=void 0!==d?d.length:0,h=g-1;h>=0;h--)e=d[h],e.master===this&&d.splice(h,1)}},publisher:{publish:function(b,c){var d,e,f,g,h;if((d=a[b])&&void 0!==(d=d[c]))for(f=void 0!==d?d.length:0,g=0;g<f;g++)e=d[g],h=e.master[e.fn],h.apply(e.master,[].slice.call(arguments,2))}},buildPublisher:function(a){for(var b in this.publisher)this.publisher.hasOwnProperty(b)&&"function"==typeof this.publisher[b]&&(a[b]=this.publisher[b])},buildSubscriber:function(a){for(var b in this.subscriber)this.subscriber.hasOwnProperty(b)&&"function"==typeof this.subscriber[b]&&(a[b]=this.subscriber[b])},clearSubscriber:function(){a={}}}}),b("entrance/tool/validate",function(){var a,b=c("lib/backbone"),d=c("spreadsheet/config"),e=c("basic/tools/cache"),f=c("basic/tools/send"),g=c("basic/tools/original"),h=c("basic/util/observer.pattern"),i=c("basic/tools/strandmap"),j=c("collections/headItemCol"),k=c("collections/headItemRow"),l=c("collections/cells"),m=j.models,n=k.models,o=[];return o[d.validationType.intType]="intType",o[d.validationType.decimalType]="decimalType",o[d.validationType.sequenceType]="sequenceType",o[d.validationType.textType]="textType",a={validate:function(a,b,c,h,p){function q(a){return/^([-]){0,1}[0-9]*$/.test(a)}function r(a){return/^([-]){0,1}[0-9]+(.[0-9]*)?$/.test(a)}function s(a,b,c){return!((a=parseFloat(a))>parseFloat(b)||a<parseFloat(c))}function t(a,b,c){return!(a.length>parseFloat(b)||a.length<parseFloat(c))}function u(a,b){var c,d,e,f=[];if("object"==typeof b)for(c=l.getCellByVertical(j.getIndexByAlias(b.startColAlias),k.getIndexByAlias(b.startRowAlias),j.getIndexByAlias(b.endColAlias),k.getIndexByAlias(b.endRowAlias)),e=0,d=c.length;e<d;e++)f.push(c[e].get("content").texts);else f=b.split(",");for(e=0,d=f.length;e<d;e++)if(f[e]===a)return!0;return!1}var v,w,x,y,z=i.calcPointRecord(b,c,"validate");if(v={intType:[q,s],decimalType:[r,s],textType:[q,t],sequenceType:[u]},""===a||void 0===z)return!0;if(!(w=e.validate[z]))return function(a,b){var c=!1;return f.PackAjax({url:d.url.sheet.validateFull,async:!1,isPublic:!1,data:JSON.stringify(b),success:function(b){var d=b.rule,e=b.expResult;for(d.index=b.index,g.analysisValidateRule({rule:d}),x=0,y=e.length;x<y;x++)if(e[x]===a){c=!0;break}}}),c}(a,{oprCol:m[h].get("sort"),oprRow:n[p].get("sort")});for(v=v[o[w.validationType]],x=0,y=v.length;x<y;x++)if(!v[x](a,w.formula1,w.formula2))return!1;return!0},showValidateContainer:function(){b.trigger("event:sidebarContainer:show","validate")},deleteRowUpdateRule:function(a,b){var c,d,f,g,h=i.getTransverseRecord(a,"sourceToRuleIndex");for(g=0,f=h.length;g<f;g++)(c=e.validate[h[g]])&&(d=c.formula1,d.startRowAlias!==d.endRowAlias&&(d.startRowAlias===a?d.startRowAlias=n[b+1].get("alias"):d.endRowAlias=n[b-1].get("alias")))},deleteColUpdateRule:function(a,b){var c,d,f,g,h=i.getVerticalRecord(a,"sourceToRuleIndex");for(g=0,f=h.length;g<f;g++)(c=e.validate[h[g]])&&(d=c.formula1,d.startColAlias!==d.endColAlias&&(d.startColAlias===a?d.startColAlias=m[b+1].get("alias"):d.endColAlias=m[b-1].get("alias")))},init:function(){h.buildSubscriber(this),this.subscribe("validate","deleteColPublish","deleteColUpdateRule"),this.subscribe("validate","deleteRowPublish","deleteRowUpdateRule")}},a.init(),a}),b("entrance/tool/setcellcontent",function(){var a=c("basic/util/aspect"),b=c("basic/tools/send"),d=c("basic/tools/cache"),e=c("basic/tools/history"),f=c("basic/tools/getoperregion"),g=c("collections/selectRegion"),h=c("collections/cells"),i=c("collections/headItemCol"),j=c("collections/headItemRow"),k=c("entrance/tool/protect"),l=c("entrance/tool/validate"),m=c("spreadsheet/config"),n=i.models,o=j.models,p=function(a,c,i){var j,l,p,q,r,s,t=[];if(j=g.getModelByType("clip"),void 0!==j&&(d.clipState="null",j.destroy()),void 0===c&&(c=a),l=f(i),p=l.operRegion,q=l.sendRegion,!k.interceptor({startColIndex:p.startColIndex,startRowIndex:p.startRowIndex}))return p.endColIndex=p.startColIndex,p.endRowIndex=p.startRowIndex,q.endCol=q.startCol,q.endRow=q.startRow,h.oprCellsByRegion(p,function(a,b,d){(r=a.get("content").texts)!==c&&(t.push({colSort:b,rowSort:d,value:r}),a.set("content.texts",c))}),s=e.getCellPropUpdateAction("content.texts",c,{startColSort:n[p.startColIndex].get("sort"),startRowSort:o[p.startRowIndex].get("sort"),endColSort:n[p.endColIndex].get("sort"),endRowSort:o[p.endRowIndex].get("sort")},t),e.addAction(s),function(){b.PackAjax({url:m.url.cell.content,data:JSON.stringify({coordinate:q,content:c})})}(),!0};return p=a.before(p,function(a,b,c){var d,e,g,h,i,j;return void 0===b&&(c=b,b=a),d=f(c),e=d.operRegion,i=e.startColIndex,j=e.startRowIndex,g=n[i].get("alias"),h=o[j].get("alias"),!!l.validate(b,g,h,i,j)})}),b("entrance/tool/setcellborder",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("collections/cells"),e=c("basic/tools/cache"),f=c("spreadsheet/config"),g=c("basic/tools/history"),h=c("collections/headItemCol"),i=c("collections/headItemRow"),j=c("collections/selectRegion"),k=c("basic/tools/getoperregion"),l=c("entrance/row/rowoperation"),m=c("entrance/col/coloperation");return function(c,n,o){function p(){b.PackAjax({url:f.url.cell.border,data:JSON.stringify({coordinate:t,direction:n})})}var q,r,s,t,u=i.models,v=h.models;if(q=j.getModelByType("clip"),void 0!==q&&(e.clipState="null",q.destroy()),e.protectState)return void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作");if(r=k(o),s=r.operRegion,t=r.sendRegion,-1===s.startColIndex||-1===s.startRowIndex)return void p();switch(n){case"bottom":!function(){var a=[];"MAX"===s.endColIndex?l.rowPropOper(s.startRowIndex,s.endRowIndex,"border.bottom",!0):"MAX"===s.endRowIndex?m.colPropOper(s.startColIndex,s.endColIndex,"border.bottom",!0):(d.operBottomHeadModel(s.startColIndex,s.startRowIndex,s.endColIndex,s.endRowIndex,function(b,c,d){a.push({colSort:c,rowSort:d,value:b.get("border").bottom}),b.set("border.bottom",!0)}),g.addAction(g.getCellPropUpdateAction("border.bottom",n,{startColSort:v[s.startColIndex].get("sort"),startRowSort:u[s.startRowIndex].get("sort"),endColSort:v[s.endColIndex].get("sort"),endRowSort:u[s.endRowIndex].get("sort")},a)))}();break;case"top":!function(){var a=[];"MAX"===s.endColIndex?l.rowPropOper(s.startRowIndex,s.endRowIndex,"border.top",!0):"MAX"===s.endRowIndex?m.colPropOper(s.startColIndex,s.endColIndex,"border.top",!0):(d.operTopHeadModel(s.startColIndex,s.startRowIndex,s.endColIndex,s.endRowIndex,function(b,c,d){a.push({colSort:c,rowSort:d,value:b.get("border").top}),b.set("border.top",!0)}),g.addAction(g.getCellPropUpdateAction("border.top",n,{startColSort:v[s.startColIndex].get("sort"),startRowSort:u[s.startRowIndex].get("sort"),endColSort:v[s.endColIndex].get("sort"),endRowSort:u[s.endRowIndex].get("sort")},a)))}();break;case"left":!function(){var a=[];"MAX"===s.endColIndex?l.rowPropOper(s.startRowIndex,s.endRowIndex,"border.left",!0):"MAX"===s.endRowIndex?m.colPropOper(s.startColIndex,s.endColIndex,"border.left",!0):(d.operLeftHeadModel(s.startColIndex,s.startRowIndex,s.endColIndex,s.endRowIndex,function(b,c,d){a.push({colSort:c,rowSort:d,value:b.get("border").left}),b.set("border.left",!0)}),g.addAction(g.getCellPropUpdateAction("border.left",n,{startColSort:v[s.startColIndex].get("sort"),startRowSort:u[s.startRowIndex].get("sort"),endColSort:v[s.endColIndex].get("sort"),endRowSort:u[s.endRowIndex].get("sort")},a)))}();break;case"right":!function(){var a=[];"MAX"===s.endColIndex?l.rowPropOper(s.startRowIndex,s.endRowIndex,"border.right",!0):"MAX"===s.endRowIndex?m.colPropOper(s.startColIndex,s.endColIndex,"border.right",!0):(d.operRightHeadModel(s.startColIndex,s.startRowIndex,s.endColIndex,s.endRowIndex,function(b,c,d){a.push({colSort:c,rowSort:d,value:b.get("border").right}),b.set("border.right",!0)}),g.addAction(g.getCellPropUpdateAction("border.right",n,{startColSort:v[s.startColIndex].get("sort"),startRowSort:u[s.startRowIndex].get("sort"),endColSort:v[s.endColIndex].get("sort"),endRowSort:u[s.endRowIndex].get("sort")},a)))}();break;case"none":!function(){var a=[],b={left:!1,right:!1,bottom:!1,top:!1};"MAX"===s.endColIndex?l.rowPropOper(s.startRowIndex,s.endRowIndex,"border",b):"MAX"===s.endRowIndex?m.colPropOper(s.startColIndex,s.endColIndex,"border",b):(d.oprCellsByRegion(s,function(c,d,e){a.push({colSort:d,rowSort:e,value:c.get("border")}),c.set("border",b)}),g.addAction(g.getCellPropUpdateAction("border",b,{startColSort:v[s.startColIndex].get("sort"),startRowSort:u[s.startRowIndex].get("sort"),endColSort:v[s.endColIndex].get("sort"),endRowSort:u[s.endRowIndex].get("sort")},a)))}();break;case"all":!function(){var a=[],b={left:!0,right:!0,bottom:!0,top:!0};"MAX"===s.endColIndex?l.rowPropOper(s.startRowIndex,s.endRowIndex,"border",b):"MAX"===s.endRowIndex?m.colPropOper(s.startColIndex,s.endColIndex,"border",b):(d.oprCellsByRegion(s,function(c,d,e){a.push({colSort:d,rowSort:e,value:c.get("border")}),c.set("border",b)}),g.addAction(g.getCellPropUpdateAction("border",b,{startColSort:v[s.startColIndex].get("sort"),startRowSort:u[s.startRowIndex].get("sort"),endColSort:v[s.endColIndex].get("sort"),endRowSort:u[s.endRowIndex].get("sort")},a)))}();break;case"outer":!function(){var a=[];"MAX"===s.endColIndex?(l.rowPropOper(s.startRowIndex,s.endRowIndex,"border.top",!0),l.rowPropOper(s.startRowIndex,s.endRowIndex,"border.bottom",!0)):"MAX"===s.endRowIndex?(m.colPropOper(s.startColIndex,s.endColIndex,"border.right",!0),m.colPropOper(s.startColIndex,s.endColIndex,"border.left",!0)):(d.operOuterHeadModel(s.startColIndex,s.startRowIndex,s.endColIndex,s.endRowIndex,function(b,c,d){a.push({colSort:c,rowSort:d,value:b.get("border")})}),d.operRightHeadModel(s.startColIndex,s.startRowIndex,s.endColIndex,s.endRowIndex,function(a){a.set("border.right",!0)}),d.operLeftHeadModel(s.startColIndex,s.startRowIndex,s.endColIndex,s.endRowIndex,function(a){a.set("border.left",!0)}),d.operTopHeadModel(s.startColIndex,s.startRowIndex,s.endColIndex,s.endRowIndex,function(a){a.set("border.top",!0)}),d.operBottomHeadModel(s.startColIndex,s.startRowIndex,s.endColIndex,s.endRowIndex,function(a){a.set("border.bottom",!0)}),g.addAction(g.getCellPropUpdateAction("border",n,{startColSort:v[s.startColIndex].get("sort"),startRowSort:u[s.startRowIndex].get("sort"),endColSort:v[s.endColIndex].get("sort"),endRowSort:u[s.endRowIndex].get("sort")},a)))}()}p()}}),b("entrance/tool/setfontsize",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("collections/cells"),e=c("basic/tools/cache"),f=c("spreadsheet/config"),g=c("basic/tools/history"),h=c("collections/headItemCol"),i=c("collections/headItemRow"),j=c("collections/selectRegion"),k=c("basic/tools/getoperregion"),l=c("entrance/row/rowoperation"),m=c("entrance/col/coloperation");return function(c,n,o){function p(){b.PackAjax({url:f.url.cell.fontSize,data:JSON.stringify({coordinate:t,size:n})})}var q,r,s,t,u=i.models,v=h.models,w=[];return q=j.getModelByType("clip"),void 0!==q&&(e.clipState="null",q.destroy()),e.protectState?void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作"):(r=k(o),s=r.operRegion,t=r.sendRegion,-1===s.startColIndex||-1===s.startRowIndex?void p():("MAX"===s.endRowIndex?m.colPropOper(s.startColIndex,s.endColIndex,"content.size",n):"MAX"===s.endColIndex?l.rowPropOper(s.startRowIndex,s.endRowIndex,"content.size",n):(d.oprCellsByRegion(s,function(a,b,c){a.get("content").size!==n&&(w.push({colSort:b,rowSort:c,value:a.get("content").size}),a.set("content.size",n))}),g.addAction(g.getCellPropUpdateAction("content.size",n,{startColSort:v[s.startColIndex].get("sort"),startRowSort:u[s.startRowIndex].get("sort"),endColSort:v[s.endColIndex].get("sort"),endRowSort:u[s.endRowIndex].get("sort")},w))),void p()))}}),b("entrance/tool/setfontweight",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("basic/tools/cache"),e=c("spreadsheet/config"),f=c("collections/selectRegion"),g=c("basic/tools/getoperregion"),h=c("basic/tools/history"),i=c("collections/headItemCol"),j=c("collections/headItemRow"),k=c("collections/cells"),l=c("entrance/col/coloperation"),m=c("entrance/row/rowoperation");return function(c,n,o){function p(){b.PackAjax({url:e.url.cell.fontWeight,data:JSON.stringify({coordinate:t,weight:n})})}var q,r,s,t,u,v=j.models,w=i.models,x=[];return q=f.getModelByType("clip"),void 0!==q&&(d.clipState="null",q.destroy()),d.protectState?void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作"):(r=g(o),s=r.operRegion,t=r.sendRegion,-1===s.startColIndex||-1===s.startRowIndex?void p():(q=f.getModelByType("clip"),void 0!==q&&(d.clipState="null",q.destroy()),"bold"===n?n=!0:"normal"===n?n=!1:(u=k.getCellByVertical(s.startColIndex,s.startRowIndex,s.endColIndex,s.endRowIndex),n=0===u.length||!u[0].get("content").bd),"MAX"===s.endRowIndex?l.colPropOper(s.startColIndex,s.endColIndex,"content.bd",n):"MAX"===s.endColIndex?m.rowPropOper(s.startRowIndex,s.endRowIndex,"content.bd",n):(k.oprCellsByRegion(s,function(a,b,c){a.get("content").bd!==n&&(x.push({colSort:b,rowSort:c,value:a.get("content").bd}),a.set("content.bd",n))}),h.addAction(h.getCellPropUpdateAction("content.bd",n,{startColSort:w[s.startColIndex].get("sort"),startRowSort:v[s.startRowIndex].get("sort"),endColSort:w[s.endColIndex].get("sort"),endRowSort:v[s.endRowIndex].get("sort")},x))),void p()))}}),b("entrance/tool/setfontstyle",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("basic/tools/cache"),e=c("spreadsheet/config"),f=c("collections/selectRegion"),g=c("basic/tools/history"),h=c("collections/headItemCol"),i=c("collections/headItemRow"),j=c("collections/cells"),k=c("basic/tools/getoperregion"),l=c("entrance/row/rowoperation"),m=c("entrance/col/coloperation");return function(c,n,o){function p(){
b.PackAjax({url:e.url.cell.fontItalic,data:JSON.stringify({coordinate:t,italic:n})})}var q,r,s,t,u,v=i.models,w=h.models,x=[];return q=f.getModelByType("clip"),void 0!==q&&(d.clipState="null",q.destroy()),d.protectState?void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作"):(r=k(o),s=r.operRegion,t=r.sendRegion,-1===s.startColIndex||-1===s.startRowIndex?void p():("italic"===n?n=!0:"normal"===n?n=!1:(u=j.getCellByVertical(s.startColIndex,s.startRowIndex,s.endColIndex,s.endRowIndex),n=null===u||void 0===u||0===u.length||!u[0].get("content").italic),"MAX"===s.endColIndex?l.rowPropOper(s.startRowIndex,s.endRowIndex,"content.italic",n):"MAX"===s.endRowIndex?m.colPropOper(s.startColIndex,s.endColIndex,"content.italic",n):(j.oprCellsByRegion(s,function(a,b,c){a.get("content").italic!==n&&(x.push({colSort:b,rowSort:c,value:a.get("content").italic}),a.set("content.italic",n))}),g.addAction(g.getCellPropUpdateAction("content.italic",n,{startColSort:w[s.startColIndex].get("sort"),startRowSort:v[s.startRowIndex].get("sort"),endColSort:w[s.endColIndex].get("sort"),endRowSort:v[s.endRowIndex].get("sort")},x))),void p()))}}),b("entrance/sheet/setfrozen",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("basic/tools/cache"),e=c("spreadsheet/config"),f=c("collections/selectRegion"),g=c("collections/headItemCol"),h=c("collections/headItemRow"),i=c("basic/tools/getoperregion"),j=function(b,c,e){var g,h,j,k;if(g=f.getModelByType("clip"),void 0!==g&&(d.clipState="null",g.destroy()),d.protectState)return void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作");if(h=i(c),j=h.operRegion,k=h.sendRegion,-1!==j.startColIndex&&-1!==j.startRowIndex&&100!==k.endColIndex&&1e4!==k.endRowIndex){switch(e){case"custom":l(j);break;case"row":n();break;case"col":m();break;case"unfrozen":o();break;default:l(j)}a.trigger("event:bodyContainer:executiveFrozen")}},k=function(a){var b=g.getIndexByAlias(d.UserView.colAlias),c=h.getIndexByAlias(d.UserView.rowAlias),e=g.getIndexByAlias(d.UserView.colEndAlias),f=h.getIndexByAlias(d.UserView.rowEndAlias);return c!==f&&(a.startColIndex<b||a.startRowIndex<c||a.startColIndex>e||a.startRowIndex>f)},l=function(a){var b=h.models,c=g.models,e=c[a.startColIndex].get("alias"),f=b[a.startRowIndex].get("alias"),i=c[a.startColIndex].get("sort"),j=b[a.startRowIndex].get("sort");k(a)||(d.TempProp={isFrozen:!0,colAlias:e,rowAlias:f,rowFrozen:!0,colFrozen:!0},p(i,j))},m=function(){var a=g.getNeighborModelByAlias(d.UserView.colAlias,"RIGHT");d.TempProp={isFrozen:!0,colAlias:a.get("alias"),rowAlias:"1",colFrozen:!0},d.UserView.rowAlias="1",p(a.get("sort"),0)},n=function(){var a=h.getNeighborModelByAlias(d.UserView.rowAlias,"RIGHT");d.TempProp={isFrozen:!0,colAlias:"1",rowAlias:a.get("alias"),rowFrozen:!0},d.UserView.colAlias="1",p(0,a.get("sort"))},o=function(){if(d.protectState)return void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作");d.TempProp={isFrozen:!1,colAlias:"1",rowAlias:"1"},q()},p=function(a,c){var f=g.getModelByAlias(d.UserView.colAlias).get("sort"),i=h.getModelByAlias(d.UserView.rowAlias).get("sort");b.PackAjax({url:e.url.sheet.frozen,data:JSON.stringify({orignalCol:a,orignalRow:c,viewCol:f,viewRow:i})})},q=function(){b.PackAjax({url:e.url.sheet.unfrozen})};return j}),b("entrance/tool/setalign",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("spreadsheet/config"),e=c("basic/tools/history"),f=c("collections/headItemCol"),g=c("collections/headItemRow"),h=c("collections/selectRegion"),i=c("collections/cells"),j=c("basic/tools/cache"),k=c("basic/tools/getoperregion"),l=c("entrance/row/rowoperation"),m=c("entrance/col/coloperation");return function(c,n,o){function p(){b.PackAjax({url:q,data:JSON.stringify({coordinate:x,align:r})})}var q,r,s,t,u,v,w,x,y,z,A=[],B=g.models,C=f.models;if(u=h.getModelByType("clip"),void 0!==u&&(j.clipState="null",u.destroy()),j.protectState)return void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作");switch(v=k(o),w=v.operRegion,x=v.sendRegion,n){case"left":q=d.url.cell.alignTransverse,s="left";break;case"center":q=d.url.cell.alignTransverse,s="center";break;case"right":q=d.url.cell.alignTransverse,s="right";break;case"top":q=d.url.cell.alignVertical,t="top";break;case"middle":q=d.url.cell.alignVertical,t="middle";break;case"bottom":q=d.url.cell.alignVertical,t="bottom";break;default:return}if(-1===w.startColIndex||-1===w.startRowIndex)return void p();"MAX"===w.endColIndex?void 0!==s?l.rowPropOper(w.startRowIndex,w.endRowIndex,"content.alignRow",s):l.rowPropOper(w.startRowIndex,w.endRowIndex,"content.alignCol",t):"MAX"===w.endRowIndex?void 0!==s?m.colPropOper(w.startColIndex,w.endColIndex,"content.alignRow",s):m.colPropOper(w.startColIndex,w.endColIndex,"content.alignCol",t):(i.oprCellsByRegion(w,function(a,b,c){void 0!==s?(y="content.alignRow",z=s,a.get("content.alignRow")!==s&&(A.push({colSort:b,rowSort:c,value:a.get("content").alignRow}),a.set("content.alignRow",s))):(y="content.alignCol",z=t,a.get("content.alignCol")!==t&&(A.push({colSort:b,rowSort:c,value:a.get("content").alignCol}),a.set("content.alignCol",t)))}),e.addAction(e.getCellPropUpdateAction(y,z,{startColSort:C[w.startColIndex].get("sort"),startRowSort:B[w.startRowIndex].get("sort"),endColSort:C[w.endColIndex].get("sort"),endRowSort:B[w.endRowIndex].get("sort")},A))),r=s||t,p()}}),b("entrance/selectregion/datasourceregionoperation",function(){var a=c("lib/backbone"),b=c("collections/selectRegion");return{setDataSourceState:function(){a.trigger("event:cellsContainer:setMouseState","locatedState","dataSourceLocatedState"),a.trigger("event:colsHeadContainer:setMouseState","locatedState","dataSourceLocatedState"),a.trigger("event:rowsHeadContainer:setMouseState","locatedState","dataSourceLocatedState")},setSelectState:function(){a.trigger("event:cellsContainer:setMouseState","locatedState","selectLocatedState"),a.trigger("event:colsHeadContainer:setMouseState","locatedState","selectLocatedState"),a.trigger("event:rowsHeadContainer:setMouseState","locatedState","selectLocatedState")},destroyDataSoure:function(){void 0!==b.getModelByType("datasource")&&b.getModelByType("datasource").destroy()}}}),b("entrance/sheet/getpointbyposi",function(){var a=c("lib/backbone");return function(b,c,d){var e={};return a.trigger("event:cellsContainer:getCoordinateDisplayName",c,d,function(){return function(a){e.point=a}}()),void 0===e.point?(e.point={col:"",row:""},e):e}}),b("entrance/tool/setwordwrap",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("collections/selectRegion"),e=c("collections/cells"),f=c("basic/tools/cache"),g=c("spreadsheet/config"),h=c("basic/tools/history"),i=c("collections/headItemCol"),j=c("collections/headItemRow"),k=c("basic/tools/getoperregion"),l=c("entrance/col/coloperation"),m=c("entrance/row/rowoperation");return function(c,n,o){function p(){b.PackAjax({url:g.url.cell.wordwrap,data:JSON.stringify({coordinate:t,wordWrap:n})})}var q,r,s,t,u,v=j.models,w=i.models,x=[];return q=d.getModelByType("clip"),void 0!==q&&(f.clipState="null",q.destroy()),f.protectState?void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作"):(r=k(o),s=r.operRegion,t=r.sendRegion,-1===s.startColIndex||-1===s.startRowIndex?void p():(void 0===n&&("MAX"===s.endColIndex||"MAX"===s.endRowIndex?n=!0:(u=e.getCellByVertical(s.startColIndex,s.startRowIndex,s.endColIndex,s.endRowIndex),n=null===u||void 0===u||0===u.length||!u[0].get("wordWrap"))),"MAX"===s.endColIndex?m.rowPropOper(r.startRowIndex,"wordWrap",n):"MAX"===s.endRowIndex?l.colPropOper(r.startColIndex,r.endColIndex,"wordWrap",n):(e.oprCellsByRegion(s,function(a,b,c){a.get("wordWrap")!==n&&(x.push({colSort:b,rowSort:c,value:a.get("wordWrap")}),a.set("wordWrap",n))}),h.addAction(h.getCellPropUpdateAction("wordWrap",n,{startColSort:w[s.startColIndex].get("sort"),startRowSort:v[s.startRowIndex].get("sort"),endColSort:w[s.endColIndex].get("sort"),endRowSort:v[s.endRowIndex].get("sort")},x))),void p()))}}),b("entrance/cell/gettextbycoordinate",function(){var a=c("basic/tools/cache"),b=c("collections/cells"),d=c("collections/headItemCol"),e=c("collections/headItemRow"),f=c("basic/tools/getoperregion");return function(c,g){var h,i,j,k,l,m,n=d.models,o=e.models;return h=f(g),i=h.operRegion,k=n[i.startColIndex].get("alias"),j=o[i.startRowIndex].get("alias"),l=a.CellsPosition.strandX,void 0!==l[k]&&void 0!==l[k][j]?(m=b.models[l[k][j]],m.get("content").texts):""}}),b("entrance/sheet/adaptscreen",function(){var a=c("lib/backbone");return function(){a.trigger("call:screenContainer:adaptScreen")}}),b("entrance/sheet/getfrozenstate",function(){var a=c("basic/tools/cache");return function(){return a.TempProp.isFrozen}}),b("entrance/sheet/getselectregion",function(){var a=c("collections/selectRegion"),b=c("collections/headItemCol"),d=c("collections/headItemRow");return function(){var c,e,f,g,h,i,j,k,l,m,n={},o=[],p=[];for(c=a.findWhere({selectType:"selected"}),e=c.get("wholePosi").startX,f=c.get("wholePosi").startY,g=c.get("wholePosi").endX,h=c.get("wholePosi").endY,j=d.getIndexByAlias(f),i=b.getIndexByAlias(e),l=d.getIndexByAlias(h),k=b.getIndexByAlias(g),m=i;m<k+1;m++)o.push(b.models[m].get("displayName"));for(m=j;m<l+1;m++)p.push(d.models[m].get("displayName"));return n.col=o,n.row=p,n}}),b("entrance/sheet/reload",function(){function a(){b.trigger("event:reload")}var b=c("lib/backbone");return a}),b("entrance/tool/settexttype",function(){var a,b=c("lib/backbone"),d=c("basic/tools/send"),e=c("collections/cells"),f=c("spreadsheet/config"),g=c("basic/tools/getoperregion"),h=c("collections/selectRegion"),i=c("collections/headItemRow"),j=c("collections/headItemCol"),k=c("entrance/row/rowoperation"),l=c("entrance/col/coloperation"),m=c("basic/tools/history"),n=c("basic/tools/cache");return a={typeRecognize:function(a){var b=a.get("content").texts;"normal"===a.get("format").type&&this.isDate(b)&&(a.set("format.dateFormat",this.getDateFormat(b)),a.set("format.type","date"),this.generateDisplayText(a))},setNormal:function(a,b){var c,d,f,h;if(this,!this.before()){if(c=g(b),d=c.operRegion,f=c.sendRegion,h={type:"normal",isValid:!1,decimal:null,thousands:null,dateFormat:null,currencySign:null,currencyValid:!1},-1===d.startColIndex||-1===d.startRowIndex)return void this.sendData(h,f);"MAX"===d.endColIndex?k.rowPropOper(d.startRowIndex,d.endRowIndex,"format",h):"MAX"===d.endRowIndex?l.colPropOper(d.startColIndex,d.endColIndex,"format",h):e.oprCellsByRegion(d,function(a){a.set("format",h)}),this.sendData(h,f)}},setText:function(a,b){var c,d,f,h;if(!this.before()){if(c=g(b),d=c.operRegion,f=c.sendRegion,h={type:"text",isValid:!1,decimal:null,thousands:null,dateFormat:null,currencySign:null,currencyValid:!1},-1===d.startColIndex||-1===d.startRowIndex)return void this.sendData(h,f);"MAX"===d.endColIndex?k.rowPropOper(d.startRowIndex,d.endRowIndex,"format",h):"MAX"===d.endRowIndex?l.colPropOper(d.startColIndex,d.endColIndex,"format",h):e.oprCellsByRegion(d,function(a){a.set("format",h)}),this.sendData(h,f)}},setNum:function(a,b,c,d){var f,h,n,o,p=[],q=i.models,r=j.models;if(!this.before()){if(this,f=g(d),h=f.operRegion,n=f.sendRegion,o={type:"number",isValid:!1,decimal:c,thousands:b,dateFormat:null,currencySign:null,currencyValid:!1},-1===h.startColIndex||-1===h.startRowIndex)return void this.sendData(o,n);"MAX"===h.endColIndex?k.rowPropOper(h.startRowIndex,h.endRowIndex,"format",o):"MAX"===h.endRowIndex?l.colPropOper(h.startColIndex,h.endColIndex,"format",o):(e.oprCellsByRegion(h,function(a,b,c){p.push({colSort:b,rowSort:c,value:a.get("format")}),a.set("format",o)}),m.addAction(m.getCellPropUpdateAction("format",o,{startColSort:r[h.startColIndex].get("sort"),startRowSort:q[h.startRowIndex].get("sort"),endColSort:r[h.endColIndex].get("sort"),endRowSort:q[h.endRowIndex].get("sort")},p))),this.sendData(o,n)}},setDate:function(a,b,c){var d,f,h,n,o=[],p=i.models,q=j.models;if(!this.before()){if(n={type:"date",isValid:!1,decimal:null,thousands:null,dateFormat:b,currencySign:null,currencyValid:!1},d=g(c),f=d.operRegion,h=d.sendRegion,this,-1===f.startColIndex||-1===f.startRowIndex)return void this.sendData(n,h);"MAX"===f.endColIndex?k.rowPropOper(f.startRowIndex,f.endRowIndex,"format",n):"MAX"===f.endRowIndex?l.colPropOper(f.startColIndex,f.endColIndex,"format",n):(e.oprCellsByRegion(f,function(a,b,c){o.push({colSort:b,rowSort:c,value:a.get("format")}),a.set("format",n)}),m.addAction(m.getCellPropUpdateAction("format",n,{startColSort:q[f.startColIndex].get("sort"),startRowSort:p[f.startRowIndex].get("sort"),endColSort:q[f.endColIndex].get("sort"),endRowSort:p[f.endRowIndex].get("sort")},o))),this.sendData(n,h)}},setPercent:function(a,b,c){var d,f,h,n,o,p=[],q=i.models,r=j.models;if(d=this,!this.before()){if(o={type:"percent",isValid:!1,decimal:b,thousands:!1,dateFormat:null,currencySign:null,currencyValid:!1},f=g(c),h=f.operRegion,n=f.sendRegion,d=this,-1===h.startColIndex||-1===h.startRowIndex)return void this.sendData(o,n);"MAX"===h.endColIndex?k.rowPropOper(h.startRowIndex,h.endRowIndex,"format",o,function(a){d.generateDisplayText(a)}):"MAX"===h.endRowIndex?l.colPropOper(h.startColIndex,h.endColIndex,"format",o,function(a){d.generateDisplayText(a)}):(e.oprCellsByRegion(h,function(a,b,c){p.push({colSort:b,rowSort:c,value:a.get("format")}),a.set("format",o)}),m.addAction(m.getCellPropUpdateAction("format",o,{startColSort:r[h.startColIndex].get("sort"),startRowSort:q[h.startRowIndex].get("sort"),endColSort:r[h.endColIndex].get("sort"),endRowSort:q[h.endRowIndex].get("sort")},p))),this.sendData(o,n)}},setCurrency:function(a,b,c,d){var f,h,n,o,p,q=[],r=i.models,s=j.models;if(!this.before()){if(n=g(d),o=n.operRegion,p=n.sendRegion,f=this,h={type:"currency",isValid:!1,decimal:b,thousands:!1,dateFormat:null,currencySign:c,currencyValid:!1},-1===o.startColIndex||-1===o.startRowIndex)return void this.sendData(h,p);"MAX"===o.endColIndex?k.rowPropOper(o.startRowIndex,o.endRowIndex,"format",h,function(a){f.generateDisplayText(a)}):"MAX"===o.endRowIndex?l.colPropOper(o.startColIndex,o.endColIndex,"format",h,function(a){f.generateDisplayText(a)}):(e.oprCellsByRegion(o,function(a,b,c){q.push({colSort:b,rowSort:c,value:a.get("format")}),a.set("format",h)}),m.addUpdateAction("format",h,{startColSort:s[o.startColIndex].get("sort"),startRowSort:r[o.startRowIndex].get("sort"),endColSort:s[o.endColIndex].get("sort"),endRowSort:r[o.endRowIndex].get("sort")},q)),this.sendData(h,p)}},before:function(){var a;return a=h.getModelByType("clip"),void 0!==a&&(n.clipState="null",a.destroy()),!!n.protectState&&(b.trigger("event:showMsgBar:show","保护状态，不能进行该操作"),!0)},sendData:function(a,b){var c;switch(c={coordinate:b,format:a.type},a.type){case"number":c.decimalPoint=a.decimal||0,c.thousandPoint=a.thousands||!1;break;case"date":c.dateFormat=a.dateFormat||"";break;case"currency":c.decimalPoint=a.decimal||0,c.currencySymbol=a.currencySign;break;case"percent":c.decimalPoint=a.decimal||0}d.PackAjax({url:f.url.cell.format,data:JSON.stringify(c)})},isNum:function(a){var b;return""!==a&&(b=-1===a.indexOf(",")?/^(\-|\+)?[0-9]+(\.[0-9]+)?$/:/^(\-|\+)?([1-9][0-9]{0,2})+(,\d{3})*(\.[0-9]+)?$/,b.test(a))},trimZero:function(a){var b,c,d;return this.isNum(a)?(d=a.split("."),b=d[0],c=d[1],b=b.replace(/^0*/,""),b=""===b?"0":b,void 0!==c&&(c=c.replace(/0*$/,""),0!==c.length&&(b+="."),b+=c),b):a},getFormatNumber:function(a,b,c){var d,e,f,g,h,i,j,k,l="";if(!this.isNum(a))return a;if(a=this.trimZero(a),a=a.replace(/,/g,""),d=parseFloat(a),d*=Math.pow(10,c),d=Math.round(d),a=(d/Math.pow(10,c)).toString(),a=a.replace(/,/g,""),b){for(e=a.split("."),g=e[0],"-"!==g.charAt(0)&&0!==g.indexOf("+")||(l=g.charAt(0),g=g.substring(1,g.length)),j=Math.ceil(g.length/3),f=g.length%3>0?g.length%3:3,i=g,g="",k=j-1;k>-1;k--)g=0===k?i.substring(0,f)+g:","+i.substring(3*(k-1)+f,3*k+f)+g;a=l+g,void 0!==e[1]&&(a+="."+e[1])}if(e=a.split("."),c&&(void 0===e[1]||e[1].length<c)){for(g=e[0],h=e[1]||"",k=0,j=c-h.length;k<j;k++)h+="0";a=g+"."+h}return a},isDate:function(a){var b,c,d,e,f=/^\d{4}\/\d{1,2}\/\d{1,2}$/,g=/^\d{4}\u5e74\d{1,2}\u6708(\d{1,2}\u65e5)?$/;return""!==a&&(!(!f.test(a)&&!g.test(a))&&(b=a.match(/\d{4}/)[0],c=a.match(/(\/|\u5e74)\d{1,2}(\/|\u6708)/),null!==c&&(c=c[0].substring(1,c[0].length-1)),d=a.match(/\d{1,2}\u65e5/),null===d&&(d=a.match(/\d{1,2}$/)),null!==d&&(d=d[0].substring(0,d[0].length)),null!==d&&-1!==d.indexOf("日")&&(d=d.substring(0,d.length-1)),e=new Date(b+"/"+(c||"01")+"/"+(d||"01")),parseInt(b)===e.getFullYear()&&((null===c||parseInt(c)===e.getMonth()+1)&&(null===d||parseInt(d)===e.getDate()))))},getFormatDate:function(a,b){var c,d,e,g;if(!this.isDate(a)||""===a)return a;switch(c=a.match(/\d{4}/)[0],d=a.match(/(\/|\u5e74)\d{1,2}(\/|\u6708)/),d=null!==d?d[0].substring(1,d[0].length-1):"01",e=a.match(/\d{1,2}\u65e5/),null===e&&(e=a.match(/\d{1,2}$/)),null!==e&&(e=e[0].substring(0,e[0].length)),null!==e&&-1!==e.indexOf("日")&&(e=e.substring(0,e.length-1)),null===e&&(e="01"),b){case f.dateFormatType.frist:g=c+"/"+d+"/"+e;break;case f.dateFormatType.second:g=c+"/"+d;break;case f.dateFormatType.third:g=c;break;case f.dateFormatType.fourth:g=c+"年"+d+"月"+e+"日";break;case f.dateFormatType.fifth:g=c+"年"+d+"月";break;case f.dateFormatType.sixth:g=c+"年";break;default:g=a}return g},getDateFormat:function(a){var b=/^\d{4}\/\d{1,2}\/\d{1,2}$/,c=/^\d{4}\u5e74\d{1,2}\u6708$/,d=/^\d{4}\u5e74\d{1,2}\u6708\d{1,2}\u65e5$/;return b.test(a)?f.dateFormatType.frist:c.test(a)?f.dateFormatType.fifth:d.test(a)?f.dateFormatType.fourth:null},isCurrency:function(a){return"¥"!==a.charAt(0)&&"$"!==a.charAt(0)||(a=a.substring(1,a.length)),this.isNum(a)},isLossCurrency:function(a){return"¥"!==a.charAt(0)&&"$"!==a.charAt(0)||(a=a.substring(1,a.length)),"-"===a.charAt(0)},getFormatCurrency:function(a,b,c){var d=a;return""===a?a:this.isCurrency(a)?("¥"!==a.charAt(0)&&"$"!==a.charAt(0)||(a=a.substring(1,a.length)),c=c||"$",c+this.getFormatNumber(a,!0,b)):d},isPercent:function(a){return"%"===a.charAt(a.length-1)&&(a=a.substring(0,a.length-1)),this.isNum(a)},getFormatPercent:function(a,b){var c=a;if(""===a)return a;if("%"===a.charAt(a.length-1)){if(a=a.substring(0,a.length-1),this.isNum(a))return(a=this.getFormatNumber(a,!1,b))+"%"}else if(this.isNum(a))return a=a.replace(/,/g,""),a=(100*Number(a)).toString(),(a=this.getFormatNumber(a,!1,b))+"%";return c},generateDisplayText:function(b){var c,d,e=b.get("content.texts"),g=b.get("format"),h=g.type,i=g.decimal,j=g.thousands,k=g.dateFormat,l=g.currencySign;switch(h){case"normal":this.isNum(e)?(d=!0,-1!==e.indexOf(",")&&(j=!0,b.set("content.texts",e.replace(/,/g,""))),c=this.getFormatNumber(e,j,f.defaultNumberFormat.decimal),c=this.trimZero(c),b.set("content.displayTexts",c),b.get("format").thousands!==j&&b.set("format.thousands",j)):b.set("content.displayTexts",e);break;case"date":d=this.isDate(e),d?b.set("content.displayTexts",a.getFormatDate(e,k)):b.set("content.displayTexts",e);break;case"number":d=this.isNum(e),d?(-1!==e.indexOf(",")&&(j=!0,b.set("content.texts",e.replace(/,/g,""))),b.set("content.displayTexts",a.getFormatNumber(e,j,i))):b.set("content.displayTexts",e);break;case"currency":d=this.isCurrency(e),d?(-1!==e.indexOf(",")&&(j=!0,b.set("content.texts",e.replace(/,/g,""))),-1===e.indexOf("$")&&-1===e.indexOf("¥")||b.set("content.texts",e.replace(/¥/g,"")),b.set("content.displayTexts",a.getFormatCurrency(e,i,l))):b.set("content.displayTexts",e);break;case"percent":d=this.isPercent(e),d?(-1!==e.indexOf(",")&&(j=!0,b.set("content.texts",e.replace(/,/g,""))),-1!==e.indexOf("%")&&(e=e.replace(/%/g,""),e=(parseInt(e)/100).toString(),b.set("content.texts",e)),b.set("content.displayTexts",a.getFormatPercent(e,i))):b.set("content.displayTexts",e);break;default:b.set("content.displayTexts",e),d=!0}b.get("format").isValid!==d&&b.set("format.isValid",d)}}}),b("entrance/tool/addrow",function(){var a=c("lib/underscore"),b=c("lib/backbone"),d=c("spreadsheet/config"),e=c("basic/tools/cache"),f=c("collections/headItemRow"),g=c("collections/headItemCol"),h=c("basic/tools/getoperregion"),i=c("collections/cells"),j=c("collections/selectRegion"),k=c("collections/siderLineRow"),l=c("basic/tools/strandmap"),m=c("basic/tools/send"),n=f.models,o=g.models;return{add:function(a,c){var g,i,k,l,n,o;if(g=j.getModelByType("clip"),void 0!==g&&(e.clipState="null",g.destroy()),e.protectState)return void b.trigger("event:showMsgBar:show","保护状态，不能进行该操作");!0!==e.TempProp.isFrozen&&(i=h(c),k=i.operRegion,l=i.sendRegion,"MAX"!==k.endRowIndex&&(o=k.startRowIndex,n=f.models[o].get("top"),f.models[o].get("height"),this._adaptHeadRowItem(o),this._adaptSelectRegion(o),this._adaptCells(o),this._fillCells(o),m.PackAjax({url:d.url.row.plus,data:JSON.stringify({sheetId:"1",row:l.startRow})}),b.trigger("event:mainContainer:adaptRowHeightChange",n,d.User.cellHeight+1)))},_adaptHeadRowItem:function(a){var b,c,g,h,i,j=a+1;for(b=f.models[a],f.add({sort:b.get("sort"),alias:e.aliasGenerator(),top:b.get("top"),displayName:b.get("displayName")},{at:a}),c=d.User.cellHeight,i=f.length;j<i;j++)b=f.models[j],h=b.get("top")+c,g=b.get("sort")+1,b.set("top",h),b.set("displayName",(g+1).toString()),b.set("sort",g)},_adaptSelectRegion:function(a){var b,c,e,g,h,i,l;b=j.getModelByType("selected"),c=b.get("wholePosi").startY,e=b.get("wholePosi").endY,g=f.getIndexByAlias(c),(l=f.getIndexByAlias(e))<a||(g>=a&&(i=b.get("physicsBox").top,i+=d.User.cellHeight,b.set("physicsBox.top",i),k.models[0].set("top",i),g++),g<a&&l>=a&&(h=b.get("physicsBox").height,h+=d.User.cellHeight,b.set("physicsBox.height",h),k.models[0].set("height",h),f.models[a].set("activeState",!0)))},_adaptCells:function(b){var c,h,j,k,m,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=e.CellsPosition.strandY;for(q=f.models[b].get("alias"),m=f.models[b+1].get("alias"),p=b>0?g.models[b-1].get("alias"):null,u=i.getCellByRow(b+1,f.length-1),B=0,z=u.length;B<z;B++)if(v=u[B],k=v.get("occupy").y,-1===(r=k.indexOf(m))||0===r)c=v.get("physicsBox").top,c+=d.User.cellHeight,v.set("physicsBox.top",c);else{for(k.splice(r,0,q),h=v.get("physicsBox").height,h+=d.User.cellHeight,j=v.get("occupy").x,w=D[m][j[0]],C=0,A=j.length;C<A;C++)e.cachePosition(q,j[C],w);v.set("physicsBox.height",h),v.set("occupy.y",k)}if(p)for(t=n[b-1].get("alias"),B=0,z=o.length;B<z;B++)s=o[B].get("alias"),y=l.getPointRecord(s,t),y&&l.addPointRecord(s,q,y),(v=i.getCellByVertical(B,b-1)[0])&&(k=v.get("occupy").y).indexOf(p)===k.length-1&&(x=a.clone(v.attributes),x.content.texts="",x.content.displayTexts="",i.createCellModel(B,b,x))},_fillCells:function(a){var b,c,d,h,j,k,l,m=0;for(b=g.models,l=g.length,h=f.models[a].get("alias"),d=e.CellsPosition.strandX;m<l;m++)c=b[m],k=c.get("operProp"),function(a){var b;for(b in a)return!1;return!0}(k)||(j=c.get("alias"),void 0!==d[j]&&void 0!==d[j][h]||i.createCellModel(m,a,k))}}}),b("entrance/tool/addcol",function(){var a=c("lib/underscore"),b=c("lib/backbone"),d=c("spreadsheet/config"),e=c("basic/tools/cache"),f=c("collections/headItemCol"),g=c("collections/headItemRow"),h=c("basic/tools/getdisplayname"),i=c("basic/tools/getoperregion"),j=c("collections/cells"),k=c("collections/selectRegion"),l=c("collections/siderLineCol"),m=c("basic/tools/send"),n=c("basic/tools/strandmap"),o=f.models,p=g.models;return{add:function(a,c){var f,g,h,j;if(f=k.getModelByType("clip"),void 0!==f&&(e.clipState="null",f.destroy()),e.protectState)return void b.trigger("event:showMsgBar:show","保护状态，不能进行该操作");!0!==e.TempProp.isFrozen&&this._isAbleAdd()&&(g=i(c),h=g.operRegion,j=g.sendRegion,"MAX"!==h.endColIndex&&(this._adaptHeadColItem(h.startColIndex),this._adaptSelectRegion(h.startColIndex),this._adaptCells(h.startColIndex),this._removeLastColItem(),m.PackAjax({url:d.url.col.plus,data:JSON.stringify({sheetId:"1",col:j.startCol})})))},_isAbleAdd:function(){var a,b=f.length-1;return a=j.getCellsByColIndex(b),!(a.length>0)},_removeLastColItem:function(){var a,b=f.length-1;a=f.models[b],f.remove(a),a.destroy()},_adaptHeadColItem:function(a){var b,c,g,i,j,k=a+1;for(b=f.models[a],c=d.User.cellWidth,f.add({sort:b.get("sort"),alias:e.aliasGenerator("col"),left:b.get("left"),width:c-1,displayName:b.get("displayName")},{at:a}),j=f.length;k<j;k++)b=f.models[k],i=b.get("left")+c,g=b.get("sort")+1,b.set("left",i),b.set("displayName",h.getColDisplayName(g)),b.set("sort",g)},_adaptSelectRegion:function(a){var b,c,e,g,h,i,j,m,n;if(b=k.getModelByType("selected"),e=b.get("wholePosi").startX,g=b.get("wholePosi").endX,h=f.getIndexByAlias(e),i=f.getIndexByAlias(g),c=f.models[a],j=f.length-1,!(i<a)){if(j===i)return void(h===i?(n=c.get("left"),m=c.get("width"),e=c.get("alias"),b.set("physicsBox.left",n),b.set("physicsBox.width",m),b.set("wholePosi.startX",e),b.set("wholePosi.endX",e),l.models[0].set("left",n),l.models[0].set("width",m),f.models[j-1].set("activeState",!0)):(n=b.get("physicsBox").left,n+=d.User.cellWidth,m=b.get("physicsBox").width,m-=f.models[j].get("width"),g=c.get("alias"),b.set("physicsBox.left",n),b.set("physicsBox.width",m),g=f.models[i-1].get("alias"),b.set("wholePosi.endX",g),l.models[0].set("left",n),l.models[0].set("width",m)));n=b.get("physicsBox").left,n+=d.User.cellWidth,b.set("physicsBox.left",n),l.models[0].set("left",n)}},_adaptCells:function(b){var c,g,h,i,k,l,m,q,r,s,t,u,v,w,x,y,z,A,B,C=e.CellsPosition.strandX;for(m=f.models[b].get("alias"),k=f.models[b+1].get("alias"),l=b>0?f.models[b-1].get("alias"):null,t=j.getCellsByColIndex(b+1,f.length-1),A=0,y=t.length;A<y;A++)if(u=t[A],h=u.get("occupy").x,-1===(q=h.indexOf(k))||0===q)c=u.get("physicsBox").left,c+=d.User.cellWidth,u.set("physicsBox.left",c);else{for(h.splice(q,0,m),g=u.get("physicsBox").width,g+=d.User.cellWidth,i=u.get("occupy").y,v=C[k][i[0]],B=0,z=i.length;B<z;B++)e.cachePosition(i[B],m,v);u.set("physicsBox.width",g),u.set("occupy.x",h)}if(l)for(r=o[b-1].get("alias"),A=0,y=p.length;A<y;A++)s=p[A].get("alias"),x=n.getPointRecord(r,s),x&&n.addPointRecord(m,s,x),(u=j.getCellByVertical(b-1,A)[0])&&(h=u.get("occupy").x).indexOf(l)===h.length-1&&(w=a.clone(u.attributes),w.content.texts="",w.content.displayTexts="",j.createCellModel(b,A,w))}}}),b("entrance/tool/deleterow",function(){var a,b=c("lib/backbone"),d=c("basic/util/observer.pattern"),e=c("basic/tools/cache"),f=c("spreadsheet/config"),g=c("collections/headItemRow"),h=c("collections/cells"),i=c("basic/tools/getoperregion"),j=c("collections/selectRegion"),k=c("collections/siderLineRow"),l=c("basic/tools/send");return a={deleteRow:function(a,c){function d(){l.PackAjax({url:f.url.row.reduce,data:JSON.stringify({row:n.startRow})})}var h,k,m,n,o,p,q;if(h=j.getModelByType("clip"),void 0!==h&&(e.clipState="null",h.destroy()),e.protectState)return void b.trigger("event:showMsgBar:show","保护状态，不能进行该操作");if(!0!==e.TempProp.isFrozen&&(k=i(c),m=k.operRegion,n=k.sendRegion,"MAX"!==m.endRowIndex||void 0!==c)){if(-1===m.startRowIndex)return void d();o=m.startRowIndex,this.publish("validate","deleteRowPublish",g.models[o].get("alias"),o),p=g.models[o].get("top"),q=g.models[o].get("height"),this._adaptCells(o),this._adaptSelectRegion(o),this._adaptHeadRowItem(o),d(),b.trigger("event:cellsContainer:adaptHeight"),b.trigger("event:rowsAllHeadContainer:adaptHeight"),b.trigger("event:mainContainer:adaptRowHeightChange",p,-q-1)}},_adaptHeadRowItem:function(a){var b,c,d,e,f,h=a;for(b=g.models[a],c=b.get("height"),g.remove(b),b.destroy(),f=g.length;h<f;h++)b=g.models[h],e=b.get("top")-c-1,d=b.get("sort")-1,b.set("top",e),b.set("displayName",(d+1).toString()),b.set("sort",d)},_adaptSelectRegion:function(a){var b,c,d,e,f,h,i;b=j.getModelByType("selected"),c=b.get("wholePosi").startY,d=b.get("wholePosi").endY,h=b.get("physicsBox").top,f=b.get("physicsBox").height,e=g.getIndexByAlias(c),(i=g.getIndexByAlias(d))<a||(e===a&&(i===e?(f=g.models[a+1].get("height"),d=g.models[a+1].get("alias"),b.set("wholePosi.endY",d),b.set("wholePosi.startY",d),g.models[a+1].set("activeState",!0)):f=f-g.models[a].get("height")-1,c=g.models[a+1].get("alias"),b.set("wholePosi.startY",c),b.set("physicsBox.height",f)),i!==e&&i===a&&(f=b.get("physicsBox").height,f=f-g.models[a].get("height")-1,d=g.models[a-1].get("alias"),b.set("wholePosi.endY",d)),e<a&&i>a&&(f=b.get("physicsBox").height,f=f-g.models[a].get("height")-1,b.set("physicsBox.height",f)),e>a&&(h=h-g.models[a].get("height")-1,b.set("physicsBox.top",h)),k.models[0].set("height",f))},_adaptCells:function(a){var b,c,d,f,i,j,k,l,m,n,o,p,q=0;for(k=h.getCellByRow(a,g.length-1),c=g.models[a].get("alias"),m=k.length;q<m;q++)for(o=k[q],f=o.get("occupy").y,i=o.get("occupy").x,l=i.length,d=f[0],j=g.getIndexByAlias(d),j===a&&1===f.length?o.set("isDestroy",!0):j<=a?(b=o.get("physicsBox").height,b-=g.models[a].get("height"),o.set("physicsBox.height",b-1),f.splice(a-j,1),o.set("occupy.y",f)):j>a&&(p=o.get("physicsBox").top,p=p-g.models[a].get("height")-1,o.set("physicsBox.top",p)),n=0;n<l;n++)e.deletePosi(c,i[n])}},d.buildPublisher(a),a}),b("entrance/tool/deletecol",function(){var a,b=c("lib/backbone"),d=c("basic/util/observer.pattern"),e=c("basic/tools/cache"),f=c("spreadsheet/config"),g=c("collections/headItemCol"),h=c("basic/tools/getoperregion"),i=c("basic/tools/getdisplayname"),j=c("collections/cells"),k=c("collections/selectRegion"),l=c("collections/siderLineCol"),m=c("basic/tools/send");return a={deleteCol:function(a,c){function d(){m.PackAjax({url:f.url.col.reduce,data:JSON.stringify({col:n.startCol})})}var i,j,l,n,o;if(i=k.getModelByType("clip"),void 0!==i&&(e.clipState="null",i.destroy()),e.protectState)return void b.trigger("event:showMsgBar:show","保护状态，不能进行该操作");if(!0!==e.TempProp.isFrozen&&(j=h(c),l=j.operRegion,n=j.sendRegion,"MAX"!==l.endColIndex||void 0!==c)){if(-1===l.startRowIndex)return void d();o=l.startColIndex,this.publish("validate","deleteColPublish",g.models[o].get("alias"),o),this._addColItem(),this._adaptCells(o),this._adaptSelectRegion(o),this._adaptHeadColItem(o),d(),b.trigger("event:cellsContainer:adaptWidth"),b.trigger("event:colsAllHeadContainer:adaptWidth")}},_addColItem:function(){var a=g.length,b=g.models[a-1];g.add({sort:b.get("sort")+1,alias:e.aliasGenerator("col"),left:b.get("left")+b.get("width")+1})},_adaptHeadColItem:function(a){var b,c,d,e,f,h=a;for(b=g.models[a],c=b.get("width"),g.remove(b),b.destroy(),f=g.length;h<f;h++)b=g.models[h],e=b.get("left")-c-1,d=b.get("sort")-1,b.set("left",e),b.set("displayName",i.getColDisplayName(h)),b.set("sort",d)},_adaptSelectRegion:function(a){var b,c,d,e,f,h,i;b=k.getModelByType("selected"),c=b.get("wholePosi").startX,d=b.get("wholePosi").endX,e=g.getIndexByAlias(c),f=g.getIndexByAlias(d),i=b.get("physicsBox").left,h=b.get("physicsBox").width,f<a||(e===a&&(f===e?(h=g.models[a+1].get("width"),d=g.models[a+1].get("alias"),b.set("wholePosi.endX",d),b.set("wholePosi.startX",d),g.models[a+1].set("activeState",!0)):h=h-g.models[a].get("width")-1,c=g.models[a+1].get("alias"),b.set("wholePosi.startX",c),b.set("physicsBox.width",h)),f!==e&&f===a&&(h=b.get("physicsBox").width,h=h-g.models[a].get("width")-1,d=g.models[a-1].get("alias"),b.set("wholePosi.endX",d)),e<a&&f>a&&(h=b.get("physicsBox").width,h=h-g.models[a].get("width")-1,b.set("physicsBox.width",h)),e>a&&(i=i-g.models[a].get("width")-1,b.set("physicsBox.left",i)),l.models[0].set("width",h))},_adaptCells:function(a){var b,c,d,f,h,i,k,l,m,n,o,p,q=0;for(l=j.getCellsByColIndex(a,g.length-1),d=g.models[a].get("alias"),n=l.length;q<n;q++)for(p=l[q],h=p.get("occupy").y,i=p.get("occupy").x,m=h.length,f=i[0],k=g.getIndexByAlias(f),k===a&&1===i.length?p.set("isDestroy",!0):k<=a?(b=p.get("physicsBox").width,b-=g.models[a].get("width"),p.set("physicsBox.width",b-1),i.splice(a-k,1),p.set("occupy.x",i)):k>a&&(c=p.get("physicsBox").left,c=c-g.models[a].get("width")-1,p.set("physicsBox.left",c)),o=0;o<m;o++)e.deletePosi(h[o],d)}},d.buildPublisher(a),a}),b("entrance/tool/regiondel",function(){var a=c("basic/tools/send"),b=c("collections/selectRegion"),d=c("basic/tools/getoperregion"),e=c("basic/tools/cache"),f=c("collections/cells");return function(c,g){function h(){a.PackAjax({url:"text.htm?m=data_del",data:JSON.stringify({coordinate:l})})}var i,j,k,l;if(i=b.getModelByType("clip"),void 0!==i&&(e.clipState="null",
i.destroy()),j=d(g),k=j.operRegion,l=j.sendRegion,-1===k.startColIndex||-1===k.startRowIndex)return void h();f.oprCellsByRegion(k,function(a){a.set("content.texts",""),a.set("content.displayTexts","")}),h()}}),b("entrance/col/colhide",function(){var a=c("basic/tools/send"),b=c("spreadsheet/config"),d=c("collections/selectRegion"),e=c("collections/headItemCol"),f=c("collections/headItemRow"),g=c("collections/siderLineCol"),h=c("lib/backbone"),i=c("collections/cells"),j=c("basic/tools/cache"),k=c("basic/tools/getoperregion");return{hide:function(c,f){var g,i,l,m,n,o;if(g=d.getModelByType("clip"),void 0!==g&&(j.clipState="null",g.destroy()),j.protectState)return void h.trigger("event:showMsgBar:show","保护状态，不能进行该操作");j.TempProp.isFrozen||(i=k(f),"MAX"!==i.operRegion.endRowIndex&&void 0===f||(n=e.models,o=n.length,l=i.operRegion.startColIndex,i.sendRegion.startColSort,n[l].get("hidden")||(m=n[l].get("width"),0===n[o-1].get("left")||n[o-1].get("left")===m+1&&n[o-1].get("hidden")||(this._adjustHideHeadItemCols(l,m),this._adjustHideCells(l,m),this._adjustHideSelectRegion(l,m),h.trigger("event:cellsContainer:adaptWidth"),a.PackAjax({url:b.url.col.hide,data:JSON.stringify({sheetId:"1",col:n[l].get("sort")})})))))},_adjustHideCells:function(a){var b,c,d,f,g,h,j,k,l;for(b=i.getCellByVertical(a,0,"MAX","MAX"),h=e.models[a].get("alias"),g=e.models[a].get("originalWidth"),l=b.length,k=0;k<l;k++)c=b[k],d=c.get("occupy").x,1===d.length?d[0]===h?(c.set("physicsBox.width",0),c.set("hidden",!0)):(j=c.get("physicsBox").left,c.set("physicsBox.left",j-g-1)):-1!==d.indexOf(h)?(f=c.get("physicsBox").width,f===g?(c.set("physicsBox.width",0),c.set("hidden",!0)):c.set("physicsBox.width",f-g-1)):(j=c.get("physicsBox").left,c.set("physicsBox.left",j-g-1))},_adjustHideSelectRegion:function(a){var b,c,g,h,i=e.models,j=f.models,k=i.length,l=j.length;if(g=d.getModelByType("selected"),c=i[k-1].get("left"),i[a].get("left"),0===c)for(h=a+1;i[h].get("hidden");)h++;else for(h=a-1;h>-1&&i[h].get("hidden");)h--;if(-1===h)for(h=a+1;i[h].get("hidden");)h++;b=i[h],b.set("activeState",!0),b.get("alias"),j[0].get("alias"),j[l-1].get("top"),j[l-1].get("height"),b.get("width"),b.get("left"),g.set("tempPosi",{initColIndex:h,initRowIndex:0,mouseColIndex:h,mouseRowIndex:"MAX"})},_adjustHideHeadItemCols:function(a){var b,c,d,f=e.models,g=f.length;for(a>0&&f[a-1].set("isRightAjacentHide",!0),b=f[a].get("width"),f[a].set("hidden",!0),f[a].set("width",0),f[a].set("activeState",!1),c=f[a].get("left"),f[g-1].get("left"),a<g-1&&(c=f[a+1].get("left"),f[a+1].set("left",c-b-1),f[a+1].set("isLeftAjacentHide",!0)),d=a+2;d<g;d++)c=f[d].get("left"),f[d].set("left",c-b-1)},cancelHide:function(){var c,f,g,k,l,m,n,o,p,q,r=e.models,s=r.length,t=0,u=0;if(!j.TempProp.isFrozen){if(c=d.getModelByType("clip"),void 0!==c&&(j.clipState="null",c.destroy()),j.protectState)return void h.trigger("event:showMsgBar:show","保护状态，不能进行该操作");for(h.trigger("event:restoreHideCellView"),h.trigger("event:restoreHideCols");u<s;u++)if(o=r[u].get("alias"),r[u].get("hidden")){for(u>0&&r[u-1].set("isRightAjacentHide",!1),u<s-1&&r[u+1].set("isLeftAjacentHide",!1),p=r[u].get("originalWidth"),g=i.getCellByVertical(u,0,u,"MAX"),k=g.length,r[u].set("width",p),n=r[u].get("left"),r[u].set("left",n+t),r[u].set("hidden",!1),q=0;q<k;q++)l=g[q].get("physicsBox").width,f=g[q].get("hidden"),f?(g[q].set("physicsBox.width",l+p),g[q].set("hidden",!1)):g[q].set("physicsBox.width",l+p+1),o===g[q].get("occupy").x[0]&&(m=g[q].get("physicsBox").left,g[q].set("physicsBox.left",m+t));t+=p+1}else if(0!==t){for(g=i.getCellByVertical(u,0,u,"MAX"),k=g.length,q=0;q<k;q++)o===g[q].get("occupy").x[0]&&(m=g[q].get("physicsBox").left,g[q].set("physicsBox.left",m+t));n=r[u].get("left"),r[u].set("left",n+t)}this._adjustCancelHideSelectRegion(),h.trigger("event:cellsContainer:adaptWidth"),h.trigger("event:colsAllHeadContainer:adaptWidth"),a.PackAjax({sheetId:"1",url:b.url.col.show})}},_adjustCancelHideSelectRegion:function(){var a,b,c,f,h=e.models,i=0;c=d.getModelByType("selected"),a=e.getIndexByAlias(c.get("wholePosi").startX),b=e.getIndexByAlias(c.get("wholePosi").endX),f=h[a].get("left");for(var j=a;j<b+1;j++)i+=h[j].get("width")+1;c.set("physicsBox.width",i-1),c.set("physicsBox.left",f),g.models[0].set("left",f),g.models[0].set("width",i-1)}}}),b("entrance/tool/batchsetbg",function(){var a,b=c("lib/backbone"),d=c("basic/tools/send"),e=c("basic/tools/cache"),f=c("spreadsheet/config"),g=c("collections/cells"),h=c("collections/headItemCol"),i=c("collections/headItemRow"),j=c("entrance/row/rowoperation"),k=c("entrance/col/coloperation");return{set:function(a,c,h){function i(a,b,c,d){a.get("customProp").background!==d&&a.set("customProp.background",d)}var l,m,n,o,p,q=/^rgb\(((25[0-5]|2[0-4][0-9]|[0-1]?[0-9]?[0-9]),){2}(25[0-5]|2[0-4][0-9]|[0-1]?[0-9]?[0-9])\)$/;if(arguments.length<3&&(h=c,c=a),c=c.replace(/\s/g,""),e.protectState)return void b.trigger("event:showMsgBar:show","保护状态，不能进行该操作");if(!q.test(c))throw new Error("非法参数");for(l=this._parse(h),o=l.oper,p=l.send,m=0,n=o.length;m<n;m++)-1===o[m].endColIndex?j.rowPropOper(o[m].endRowIndex,"customProp.background",c):-1===o[m].endRowIndex?k.colPropOper(o[m].endColIndex,"customProp.background",c):g.oprCellsByRegion(o[m],i,c);d.PackAjax({url:f.url.cell.bgBatch,data:JSON.stringify({coordinate:p,color:c})})},_getWeight:function(){var a,b,c,d,e={},f=1;for(a="A B C D E F G H I J K L M N O P Q R S T U V W X Y Z ",a+="a b c d e f g h i j k l m n o p q r s t u v w x y z",b=a.split(" "),d=0,c=b.length;d<c;d++,f++)e[b[d]]=f,25===d&&(f=0);return e},_parse:function(b){function c(b){var c,d,e=-1;for(c=0,d=b.length;c<d;c++)e+=a[b[c]]*Math.pow(26,d-c-1);return e}function d(a){return Number(a)-1}var e,g,j,k,l,m,n,o,p=/^[a-zA-Z]+$/,q=/^[1-9]\d*$/,r=f.User.maxRowNum,s=f.User.maxColNum,t=[],u=[];for(a||(a=this._getWeight()),"[object Array]"!==Object.prototype.toString.call(b)&&(b=[b]),o=0,n=b.length;o<n;o++){if("string"==typeof(l=b[o])){if(p.test(l)&&(e=c(l))<=s){u.push({startCol:e,endCol:e,startRow:0,endRow:-1}),e=h.getIndexBySort(e),t.push({startColIndex:e,endColIndex:e,startRowIndex:0,endRowIndex:-1});continue}if(q.test(l)&&(g=d(l))<=r){u.push({startCol:0,endCol:-1,startRow:g,endRow:g}),g=i.getIndexBySort(g),t.push({startColIndex:0,endColIndex:-1,startRowIndex:g,endRowIndex:g});continue}throw new Error("非法参数")}if(l.endRow=void 0===l.endRow?l.startRow:l.endRow,l.endCol=void 0===l.endCol?l.startCol:l.endCol,void 0===(e=l.startCol)||!p.test(e)||(e=c(e))>=s)throw new Error("非法参数");if(j=l.endCol,(j=c(j))>s)throw new Error("非法参数");if(e>j&&(m=e,e=j,j=m),void 0===(g=l.startRow)||!q.test(g)||(g=d(g))>=r)throw new Error("非法参数");if(k=l.endRow,(k=d(k))>r)throw new Error("非法参数");g>k&&(m=g,g=k,k=m),u.push({startCol:e,startRow:g,endCol:j,endRow:k}),e=h.getIndexBySort(e),g=i.getIndexBySort(g),j=h.getIndexBySort(j),k=i.getIndexBySort(k),t.push({startColIndex:e,startRowIndex:g,endColIndex:j,endRowIndex:k})}return{send:u,oper:t}}}}),b("entrance/tool/comment",function(){var a=c("basic/tools/send"),b=c("collections/cells"),d=c("lib/backbone"),e=c("spreadsheet/config"),f=c("collections/selectRegion"),g=c("basic/tools/getoperregion"),h=c("basic/tools/history"),i=c("collections/headItemCol"),j=c("collections/headItemRow"),k=c("entrance/row/rowoperation"),l=c("entrance/col/coloperation"),m=c("basic/tools/cache");return{before:function(){var a=f.getModelByType("clip");if(void 0!==a&&(m.clipState="null",a.destroy()),m.protectState)return d.trigger("event:showMsgBar:show","保护状态，不能进行该操作"),!0},modifyComment:function(a,c,d){var f,m,n,o=j.models,p=i.models,q=[];if(!this.before()){if(f=g(d),m=f.operRegion,n=f.sendRegion,-1===m.startColIndex||-1===m.startRowIndex)return void(null===c?this.sendData(n,null,e.url.cell.commentDel):this.sendData(n,c,e.url.cell.commentPlus));"MAX"===m.endColIndex?k.rowPropOper(m.startRowIndex,m.endRowIndex,"customProp.comment",c):"MAX"===m.endRowIndex?l.colPropOper(m.startColIndex,m.endColIndex,"customProp.comment",c):(b.oprCellsByRegion(m,function(a,b,d){a.get("customProp").comment!==c&&(q.push({colSort:b,rowSort:d,value:a.get("customProp").comment}),a.set("customProp.comment",c))}),h.addAction(h.getCellPropUpdateAction("customProp.comment",c,{startColSort:p[m.startColIndex].get("sort"),startRowSort:o[m.startRowIndex].get("sort"),endColSort:p[m.endColIndex].get("sort"),endRowSort:o[m.endRowIndex].get("sort")},q))),null===c?this.sendData(n,null,e.url.cell.commentDel):this.sendData(n,c,e.url.cell.commentPlus)}},createAddCommentView:function(){this.before()||d.trigger("event:bodyContainer:handleComment",{action:"add"})},createEditComment:function(){this.before()||d.trigger("event:bodyContainer:handleComment",{action:"edit"})},deleteComment:function(a){this.before()||this.modifyComment("1",null,a)},sendData:function(b,c,d){var e={coordinate:b};null!==c&&(e.comment=c),a.PackAjax({url:d,data:JSON.stringify(e)})}}}),b("lib/handlebars",function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){function d(){var a=r();return a.compile=function(b,c){return k.compile(b,c,a)},a.precompile=function(b,c){return k.precompile(b,c,a)},a.AST=i.default,a.Compiler=k.Compiler,a.JavaScriptCompiler=m.default,a.Parser=j.parser,a.parse=j.parse,a}var e=c(1).default;b.__esModule=!0;var f=c(2),g=e(f),h=c(21),i=e(h),j=c(22),k=c(27),l=c(28),m=e(l),n=c(25),o=e(n),p=c(20),q=e(p),r=g.default.create,s=d();s.create=d,q.default(s),s.Visitor=o.default,s.default=s,b.default=s,a.exports=b.default},function(a,b){b.default=function(a){return a&&a.__esModule?a:{default:a}},b.__esModule=!0},function(a,b,c){function d(){var a=new h.HandlebarsEnvironment;return n.extend(a,h),a.SafeString=j.default,a.Exception=l.default,a.Utils=n,a.escapeExpression=n.escapeExpression,a.VM=p,a.template=function(b){return p.template(b,a)},a}var e=c(3).default,f=c(1).default;b.__esModule=!0;var g=c(4),h=e(g),i=c(18),j=f(i),k=c(6),l=f(k),m=c(5),n=e(m),o=c(19),p=e(o),q=c(20),r=f(q),s=d();s.create=d,r.default(s),s.default=s,b.default=s,a.exports=b.default},function(a,b){b.default=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b},b.__esModule=!0},function(a,b,c){function d(a,b,c){this.helpers=a||{},this.partials=b||{},this.decorators=c||{},i.registerDefaultHelpers(this),j.registerDefaultDecorators(this)}var e=c(1).default;b.__esModule=!0,b.HandlebarsEnvironment=d;var f=c(5),g=c(6),h=e(g),i=c(7),j=c(15),k=c(17),l=e(k);b.VERSION="4.0.5";b.COMPILER_REVISION=7;var m={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};b.REVISION_CHANGES=m;d.prototype={constructor:d,logger:l.default,log:l.default.log,registerHelper:function(a,b){if("[object Object]"===f.toString.call(a)){if(b)throw new h.default("Arg not supported with multiple helpers");f.extend(this.helpers,a)}else this.helpers[a]=b},unregisterHelper:function(a){delete this.helpers[a]},registerPartial:function(a,b){if("[object Object]"===f.toString.call(a))f.extend(this.partials,a);else{if(void 0===b)throw new h.default('Attempting to register a partial called "'+a+'" as undefined');this.partials[a]=b}},unregisterPartial:function(a){delete this.partials[a]},registerDecorator:function(a,b){if("[object Object]"===f.toString.call(a)){if(b)throw new h.default("Arg not supported with multiple decorators");f.extend(this.decorators,a)}else this.decorators[a]=b},unregisterDecorator:function(a){delete this.decorators[a]}};var n=l.default.log;b.log=n,b.createFrame=f.createFrame,b.logger=l.default},function(a,b){function c(a){return k[a]}function d(a){for(var b=1;b<arguments.length;b++)for(var c in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function e(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}function f(a){if("string"!=typeof a){if(a&&a.toHTML)return a.toHTML();if(null==a)return"";if(!a)return a+"";a=""+a}return m.test(a)?a.replace(l,c):a}function g(a){return!a&&0!==a||!(!p(a)||0!==a.length)}function h(a){var b=d({},a);return b._parent=a,b}function i(a,b){return a.path=b,a}function j(a,b){return(a?a+".":"")+b}b.__esModule=!0,b.extend=d,b.indexOf=e,b.escapeExpression=f,b.isEmpty=g,b.createFrame=h,b.blockParams=i,b.appendContextPath=j;var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},l=/[&<>"'`=]/g,m=/[&<>"'`=]/,n=Object.prototype.toString;b.toString=n;var o=function(a){return"function"==typeof a};o(/x/)&&(b.isFunction=o=function(a){return"function"==typeof a&&"[object Function]"===n.call(a)}),b.isFunction=o;var p=Array.isArray||function(a){return!(!a||"object"!=typeof a)&&"[object Array]"===n.call(a)};b.isArray=p},function(a,b){function c(a,b){var e=b&&b.loc,f=void 0,g=void 0;e&&(f=e.start.line,g=e.start.column,a+=" - "+f+":"+g);for(var h=Error.prototype.constructor.call(this,a),i=0;i<d.length;i++)this[d[i]]=h[d[i]];Error.captureStackTrace&&Error.captureStackTrace(this,c),e&&(this.lineNumber=f,this.column=g)}b.__esModule=!0;var d=["description","fileName","lineNumber","message","name","number","stack"];c.prototype=new Error,b.default=c,a.exports=b.default},function(a,b,c){function d(a){g.default(a),i.default(a),k.default(a),m.default(a),o.default(a),q.default(a),s.default(a)}var e=c(1).default;b.__esModule=!0,b.registerDefaultHelpers=d;var f=c(8),g=e(f),h=c(9),i=e(h),j=c(10),k=e(j),l=c(11),m=e(l),n=c(12),o=e(n),p=c(13),q=e(p),r=c(14),s=e(r)},function(a,b,c){b.__esModule=!0;var d=c(5);b.default=function(a){a.registerHelper("blockHelperMissing",function(b,c){var e=c.inverse,f=c.fn;if(!0===b)return f(this);if(!1===b||null==b)return e(this);if(d.isArray(b))return b.length>0?(c.ids&&(c.ids=[c.name]),a.helpers.each(b,c)):e(this);if(c.data&&c.ids){var g=d.createFrame(c.data);g.contextPath=d.appendContextPath(c.data.contextPath,c.name),c={data:g}}return f(b,c)})},a.exports=b.default},function(a,b,c){var d=c(1).default;b.__esModule=!0;var e=c(5),f=c(6),g=d(f);b.default=function(a){a.registerHelper("each",function(a,b){function c(b,c,f){j&&(j.key=b,j.index=c,j.first=0===c,j.last=!!f,k&&(j.contextPath=k+b)),i+=d(a[b],{data:j,blockParams:e.blockParams([a[b],b],[k+b,null])})}if(!b)throw new g.default("Must pass iterator to #each");var d=b.fn,f=b.inverse,h=0,i="",j=void 0,k=void 0;if(b.data&&b.ids&&(k=e.appendContextPath(b.data.contextPath,b.ids[0])+"."),e.isFunction(a)&&(a=a.call(this)),b.data&&(j=e.createFrame(b.data)),a&&"object"==typeof a)if(e.isArray(a))for(var l=a.length;h<l;h++)h in a&&c(h,h,h===a.length-1);else{var m=void 0;for(var n in a)a.hasOwnProperty(n)&&(void 0!==m&&c(m,h-1),m=n,h++);void 0!==m&&c(m,h-1,!0)}return 0===h&&(i=f(this)),i})},a.exports=b.default},function(a,b,c){var d=c(1).default;b.__esModule=!0;var e=c(6),f=d(e);b.default=function(a){a.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new f.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},a.exports=b.default},function(a,b,c){b.__esModule=!0;var d=c(5);b.default=function(a){a.registerHelper("if",function(a,b){return d.isFunction(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||d.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){return a.helpers.if.call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})})},a.exports=b.default},function(a,b){b.__esModule=!0,b.default=function(a){a.registerHelper("log",function(){for(var b=[void 0],c=arguments[arguments.length-1],d=0;d<arguments.length-1;d++)b.push(arguments[d]);var e=1;null!=c.hash.level?e=c.hash.level:c.data&&null!=c.data.level&&(e=c.data.level),b[0]=e,a.log.apply(a,b)})},a.exports=b.default},function(a,b){b.__esModule=!0,b.default=function(a){a.registerHelper("lookup",function(a,b){return a&&a[b]})},a.exports=b.default},function(a,b,c){b.__esModule=!0;var d=c(5);b.default=function(a){a.registerHelper("with",function(a,b){d.isFunction(a)&&(a=a.call(this));var c=b.fn;if(d.isEmpty(a))return b.inverse(this);var e=b.data;return b.data&&b.ids&&(e=d.createFrame(b.data),e.contextPath=d.appendContextPath(b.data.contextPath,b.ids[0])),c(a,{data:e,blockParams:d.blockParams([a],[e&&e.contextPath])})})},a.exports=b.default},function(a,b,c){function d(a){g.default(a)}var e=c(1).default;b.__esModule=!0,b.registerDefaultDecorators=d;var f=c(16),g=e(f)},function(a,b,c){b.__esModule=!0;var d=c(5);b.default=function(a){a.registerDecorator("inline",function(a,b,c,e){var f=a;return b.partials||(b.partials={},f=function(e,f){var g=c.partials;c.partials=d.extend({},g,b.partials);var h=a(e,f);return c.partials=g,h}),b.partials[e.args[0]]=e.fn,f})},a.exports=b.default},function(a,b,c){b.__esModule=!0;var d=c(5),e={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(a){if("string"==typeof a){var b=d.indexOf(e.methodMap,a.toLowerCase());a=b>=0?b:parseInt(a,10)}return a},log:function(a){if(a=e.lookupLevel(a),"undefined"!=typeof console&&e.lookupLevel(e.level)<=a){var b=e.methodMap[a];console[b]||(b="log");for(var c=arguments.length,d=Array(c>1?c-1:0),f=1;f<c;f++)d[f-1]=arguments[f];console[b].apply(console,d)}}};b.default=e,a.exports=b.default},function(a,b){function c(a){this.string=a}b.__esModule=!0,c.prototype.toString=c.prototype.toHTML=function(){return""+this.string},b.default=c,a.exports=b.default},function(a,b,c){function d(a){var b=a&&a[0]||1,c=r.COMPILER_REVISION;if(b!==c){if(b<c){var d=r.REVISION_CHANGES[c],e=r.REVISION_CHANGES[b];throw new q.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new q.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function e(a,b){function c(c,d,e){e.hash&&(d=o.extend({},d,e.hash),e.ids&&(e.ids[0]=!0)),c=b.VM.resolvePartial.call(this,c,d,e);var f=b.VM.invokePartial.call(this,c,d,e);if(null==f&&b.compile&&(e.partials[e.name]=b.compile(c,a.compilerOptions,b),f=e.partials[e.name](d,e)),null!=f){if(e.indent){for(var g=f.split("\n"),h=0,i=g.length;h<i&&(g[h]||h+1!==i);h++)g[h]=e.indent+g[h];f=g.join("\n")}return f}throw new q.default("The partial "+e.name+" could not be compiled when running in runtime-only mode")}function d(b){function c(b){return""+a.main(e,b,e.helpers,e.partials,g,i,h)}var f=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],g=f.data;d._setup(f),!f.partial&&a.useData&&(g=j(b,g));var h=void 0,i=a.useBlockParams?[]:void 0;return a.useDepths&&(h=f.depths?b!==f.depths[0]?[b].concat(f.depths):f.depths:[b]),(c=k(a.main,c,e,f.depths||[],g,i))(b,f)}if(!b)throw new q.default("No environment passed to template");if(!a||!a.main)throw new q.default("Unknown template object: "+typeof a);a.main.decorator=a.main_d,b.VM.checkRevision(a.compiler);var e={strict:function(a,b){if(!(b in a))throw new q.default('"'+b+'" not defined in '+a);return a[b]},lookup:function(a,b){for(var c=a.length,d=0;d<c;d++)if(a[d]&&null!=a[d][b])return a[d][b]},lambda:function(a,b){return"function"==typeof a?a.call(b):a},escapeExpression:o.escapeExpression,invokePartial:c,fn:function(b){var c=a[b];return c.decorator=a[b+"_d"],c},programs:[],program:function(a,b,c,d,e){var g=this.programs[a],h=this.fn(a);return b||e||d||c?g=f(this,a,h,b,c,d,e):g||(g=this.programs[a]=f(this,a,h)),g},data:function(a,b){for(;a&&b--;)a=a._parent;return a},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c=o.extend({},b,a)),c},noop:b.VM.noop,compilerInfo:a.compiler};return d.isTop=!0,d._setup=function(c){c.partial?(e.helpers=c.helpers,e.partials=c.partials,e.decorators=c.decorators):(e.helpers=e.merge(c.helpers,b.helpers),a.usePartial&&(e.partials=e.merge(c.partials,b.partials)),(a.usePartial||a.useDecorators)&&(e.decorators=e.merge(c.decorators,b.decorators)))},d._child=function(b,c,d,g){if(a.useBlockParams&&!d)throw new q.default("must pass block params");if(a.useDepths&&!g)throw new q.default("must pass parent depths");return f(e,b,a[b],c,0,d,g)},d}function f(a,b,c,d,e,f,g){function h(b){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],h=g;return g&&b!==g[0]&&(h=[b].concat(g)),c(a,b,a.helpers,a.partials,e.data||d,f&&[e.blockParams].concat(f),h)}return h=k(c,h,a,g,d,f),h.program=b,h.depth=g?g.length:0,h.blockParams=e||0,h}function g(a,b,c){return a?a.call||c.name||(c.name=a,a=c.partials[a]):a="@partial-block"===c.name?c.data["partial-block"]:c.partials[c.name],a}function h(a,b,c){c.partial=!0,c.ids&&(c.data.contextPath=c.ids[0]||c.data.contextPath);var d=void 0;if(c.fn&&c.fn!==i&&(c.data=r.createFrame(c.data),d=c.data["partial-block"]=c.fn,d.partials&&(c.partials=o.extend({},c.partials,d.partials))),void 0===a&&d&&(a=d),void 0===a)throw new q.default("The partial "+c.name+" could not be found");if(a instanceof Function)return a(b,c)}function i(){return""}function j(a,b){return b&&"root"in b||(b=b?r.createFrame(b):{},b.root=a),b}function k(a,b,c,d,e,f){if(a.decorator){var g={};b=a.decorator(b,g,c,d&&d[0],e,f,d),o.extend(b,g)}return b}var l=c(3).default,m=c(1).default;b.__esModule=!0,b.checkRevision=d,b.template=e,b.wrapProgram=f,b.resolvePartial=g,b.invokePartial=h,b.noop=i;var n=c(5),o=l(n),p=c(6),q=m(p),r=c(4)},function(b,c){(function(d){c.__esModule=!0,c.default=function(b){var c=void 0!==d?d:a,e=c.Handlebars;b.noConflict=function(){return c.Handlebars===b&&(c.Handlebars=e),b}},b.exports=c.default}).call(c,function(){return this}())},function(a,b){b.__esModule=!0;var c={helpers:{helperExpression:function(a){return"SubExpression"===a.type||("MustacheStatement"===a.type||"BlockStatement"===a.type)&&!!(a.params&&a.params.length||a.hash)},scopedId:function(a){return/^\.|this\b/.test(a.original)},simpleId:function(a){return 1===a.parts.length&&!c.helpers.scopedId(a)&&!a.depth}}};b.default=c,a.exports=b.default},function(a,b,c){function d(a,b){return"Program"===a.type?a:(h.default.yy=n,n.locInfo=function(a){return new n.SourceLocation(b&&b.srcName,a)},new j.default(b).accept(h.default.parse(a)))}var e=c(1).default,f=c(3).default;b.__esModule=!0,b.parse=d;var g=c(23),h=e(g),i=c(24),j=e(i),k=c(26),l=f(k),m=c(5);b.parser=h.default;var n={};m.extend(n,l)},function(a,b){var c=function(){function a(){this.yy={}}var b={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition_plus0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,1],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(a,b,c,d,e,f,g){var h=f.length-1;switch(e){case 1:return f[h-1];case 2:this.$=d.prepareProgram(f[h]);break;case 3:case 4:case 5:case 6:case 7:case 8:this.$=f[h];break;case 9:this.$={type:"CommentStatement",value:d.stripComment(f[h]),strip:d.stripFlags(f[h],f[h]),loc:d.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:f[h],value:f[h],loc:d.locInfo(this._$)};break;case 11:this.$=d.prepareRawBlock(f[h-2],f[h-1],f[h],this._$);break;case 12:this.$={path:f[h-3],params:f[h-2],hash:f[h-1]};break;case 13:this.$=d.prepareBlock(f[h-3],f[h-2],f[h-1],f[h],!1,this._$);break;case 14:this.$=d.prepareBlock(f[h-3],f[h-2],f[h-1],f[h],!0,this._$);break;case 15:this.$={open:f[h-5],path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 16:case 17:this.$={path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 18:this.$={strip:d.stripFlags(f[h-1],f[h-1]),program:f[h]};break;case 19:var i=d.prepareBlock(f[h-2],f[h-1],f[h],f[h],!1,this._$),j=d.prepareProgram([i],f[h-1].loc);j.chained=!0,this.$={strip:f[h-2].strip,program:j,chain:!0};break;case 20:this.$=f[h];break;case 21:this.$={path:f[h-1],strip:d.stripFlags(f[h-2],f[h])};break;case 22:case 23:this.$=d.prepareMustache(f[h-3],f[h-2],f[h-1],f[h-4],d.stripFlags(f[h-4],f[h]),this._$);break;case 24:this.$={type:"PartialStatement",name:f[h-3],params:f[h-2],hash:f[h-1],indent:"",strip:d.stripFlags(f[h-4],f[h]),loc:d.locInfo(this._$)};break;case 25:this.$=d.preparePartialBlock(f[h-2],f[h-1],f[h],this._$);break;case 26:this.$={path:f[h-3],params:f[h-2],hash:f[h-1],strip:d.stripFlags(f[h-4],f[h])};break;case 27:case 28:this.$=f[h];break;case 29:this.$={type:"SubExpression",path:f[h-3],params:f[h-2],hash:f[h-1],loc:d.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:f[h],loc:d.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:d.id(f[h-2]),value:f[h],loc:d.locInfo(this._$)};break;case 32:this.$=d.id(f[h-1]);break;case 33:case 34:this.$=f[h];break;case 35:this.$={type:"StringLiteral",value:f[h],original:f[h],loc:d.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(f[h]),original:Number(f[h]),loc:d.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===f[h],original:"true"===f[h],loc:d.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:d.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:d.locInfo(this._$)};break;case 40:case 41:this.$=f[h];break;case 42:this.$=d.preparePath(!0,f[h],this._$);break;case 43:this.$=d.preparePath(!1,f[h],this._$);break;case 44:f[h-2].push({part:d.id(f[h]),original:f[h],separator:f[h-1]}),this.$=f[h-2];break;case 45:this.$=[{part:d.id(f[h]),original:f[h]}];break;case 46:this.$=[];break;case 47:f[h-1].push(f[h]);break;case 48:this.$=[f[h]];break;case 49:f[h-1].push(f[h]);break;case 50:this.$=[];break;case 51:f[h-1].push(f[h]);break;case 58:this.$=[];break;case 59:f[h-1].push(f[h]);break;case 64:this.$=[];break;case 65:f[h-1].push(f[h]);break;case 70:this.$=[];break;case 71:f[h-1].push(f[h]);break;case 78:this.$=[];break;case 79:f[h-1].push(f[h]);break;case 82:this.$=[];break;case 83:f[h-1].push(f[h]);break;case 86:this.$=[];break;case 87:f[h-1].push(f[h]);break;case 90:this.$=[];break;case 91:f[h-1].push(f[h]);break;case 94:this.$=[];break;case 95:f[h-1].push(f[h]);break;case 98:this.$=[f[h]];break;case 99:f[h-1].push(f[h]);break;case 100:this.$=[f[h]];break;case 101:f[h-1].push(f[h])}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{13:40,15:[1,20],17:39},{20:42,56:41,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:45,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:48,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:42,56:49,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:50,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{
23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,51]},{72:[1,35],86:52},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:53,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:54,38:56,39:[1,58],43:57,44:[1,59],45:55,47:[2,54]},{28:60,43:61,44:[1,59],47:[2,56]},{13:63,15:[1,20],18:[1,62]},{15:[2,48],18:[2,48]},{33:[2,86],57:64,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:65,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:66,47:[1,67]},{30:68,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:69,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:70,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:71,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:75,33:[2,80],50:72,63:73,64:76,65:[1,44],69:74,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,80]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,51]},{20:75,53:81,54:[2,84],63:82,64:76,65:[1,44],69:83,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:84,47:[1,67]},{47:[2,55]},{4:85,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:86,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:87,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:88,47:[1,67]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:75,33:[2,88],58:89,63:90,64:76,65:[1,44],69:91,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:92,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:93,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,31:94,33:[2,60],63:95,64:76,65:[1,44],69:96,70:77,71:78,72:[1,79],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,66],36:97,63:98,64:76,65:[1,44],69:99,70:77,71:78,72:[1,79],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,22:100,23:[2,52],63:101,64:76,65:[1,44],69:102,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,92],62:103,63:104,64:76,65:[1,44],69:105,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,106]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:107,72:[1,108],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,109],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,110]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:56,39:[1,58],43:57,44:[1,59],45:112,46:111,47:[2,76]},{33:[2,70],40:113,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,114]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:75,63:116,64:76,65:[1,44],67:115,68:[2,96],69:117,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,118]},{32:119,33:[2,62],74:120,75:[1,121]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:122,74:123,75:[1,121]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,124]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,125]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,109]},{20:75,63:126,64:76,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:75,33:[2,72],41:127,63:128,64:76,65:[1,44],69:129,70:77,71:78,72:[1,79],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,130]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,131]},{33:[2,63]},{72:[1,133],76:132},{33:[1,134]},{33:[2,69]},{15:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:135,74:136,75:[1,121]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,138],77:[1,137]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,139]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],55:[2,55],57:[2,20],61:[2,57],74:[2,81],83:[2,85],87:[2,18],91:[2,89],102:[2,53],105:[2,93],111:[2,19],112:[2,77],117:[2,97],120:[2,63],123:[2,69],124:[2,12],136:[2,75],137:[2,32]},parseError:function(a,b){throw new Error(a)},parse:function(a){var b=this,c=[0],d=[null],e=[],f=this.table,g="",h=0,i=0,j=0;this.lexer.setInput(a),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var k=this.lexer.yylloc;e.push(k);var l=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var m,n,o,p,q,r,s,t,u,v={};;){if(o=c[c.length-1],this.defaultActions[o]?p=this.defaultActions[o]:(null!==m&&void 0!==m||(m=function(){var a;return a=b.lexer.lex()||1,"number"!=typeof a&&(a=b.symbols_[a]||a),a}()),p=f[o]&&f[o][m]),void 0===p||!p.length||!p[0]){var w="";if(!j){u=[];for(r in f[o])this.terminals_[r]&&r>2&&u.push("'"+this.terminals_[r]+"'");w=this.lexer.showPosition?"Parse error on line "+(h+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+u.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(h+1)+": Unexpected "+(1==m?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(w,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:k,expected:u})}}if(p[0]instanceof Array&&p.length>1)throw new Error("Parse Error: multiple actions possible at state: "+o+", token: "+m);switch(p[0]){case 1:c.push(m),d.push(this.lexer.yytext),e.push(this.lexer.yylloc),c.push(p[1]),m=null,n?(m=n,n=null):(i=this.lexer.yyleng,g=this.lexer.yytext,h=this.lexer.yylineno,k=this.lexer.yylloc,j>0&&j--);break;case 2:if(s=this.productions_[p[1]][1],v.$=d[d.length-s],v._$={first_line:e[e.length-(s||1)].first_line,last_line:e[e.length-1].last_line,first_column:e[e.length-(s||1)].first_column,last_column:e[e.length-1].last_column},l&&(v._$.range=[e[e.length-(s||1)].range[0],e[e.length-1].range[1]]),void 0!==(q=this.performAction.call(v,g,i,h,this.yy,p[1],d,e)))return q;s&&(c=c.slice(0,-1*s*2),d=d.slice(0,-1*s),e=e.slice(0,-1*s)),c.push(this.productions_[p[1]][0]),d.push(v.$),e.push(v._$),t=f[c[c.length-2]][c[c.length-1]],c.push(t);break;case 3:return!0}}return!0}},c=function(){var a={EOF:1,parseError:function(a,b){if(!this.yy.parser)throw new Error(a);this.yy.parser.parseError(a,b)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var a=this._input[0];return this.yytext+=a,this.yyleng++,this.offset++,this.match+=a,this.matched+=a,a.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-b-1),this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var e=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b},this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-b]),this},more:function(){return this._more=!0,this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=new Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d,e;this._more||(this.yytext="",this.match="");for(var f=this._currentRules(),g=0;g<f.length&&(!(c=this._input.match(this.rules[f[g]]))||b&&!(c[0].length>b[0].length)||(b=c,d=g,this.options.flex));g++);return b?(e=b[0].match(/(?:\r\n?|\n).*/g),e&&(this.yylineno+=e.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:e?e[e.length-1].length-e[e.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,f[d],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),a||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return void 0!==a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)}};return a.options={},a.performAction=function(a,b,c,d){function e(a,c){return b.yytext=b.yytext.substr(a,b.yyleng-c)}switch(c){case 0:if("\\\\"===b.yytext.slice(-2)?(e(0,1),this.begin("mu")):"\\"===b.yytext.slice(-1)?(e(0,1),this.begin("emu")):this.begin("mu"),b.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(b.yytext=b.yytext.substr(5,b.yyleng-9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(b.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return b.yytext=e(1,2).replace(/\\"/g,'"'),80;case 32:return b.yytext=e(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return b.yytext=b.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},a.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^\/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],a.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},a}();return b.lexer=c,a.prototype=b,b.Parser=a,new a}();b.__esModule=!0,b.default=c},function(a,b,c){function d(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=a}function e(a,b,c){void 0===b&&(b=a.length);var d=a[b-1],e=a[b-2];return d?"ContentStatement"===d.type?(e||!c?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(d.original):void 0:c}function f(a,b,c){void 0===b&&(b=-1);var d=a[b+1],e=a[b+2];return d?"ContentStatement"===d.type?(e||!c?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(d.original):void 0:c}function g(a,b,c){var d=a[null==b?0:b+1];if(d&&"ContentStatement"===d.type&&(c||!d.rightStripped)){var e=d.value;d.value=d.value.replace(c?/^\s+/:/^[ \t]*\r?\n?/,""),d.rightStripped=d.value!==e}}function h(a,b,c){var d=a[null==b?a.length-1:b-1];if(d&&"ContentStatement"===d.type&&(c||!d.leftStripped)){var e=d.value;return d.value=d.value.replace(c?/\s+$/:/[ \t]+$/,""),d.leftStripped=d.value!==e,d.leftStripped}}var i=c(1).default;b.__esModule=!0;var j=c(25),k=i(j);d.prototype=new k.default,d.prototype.Program=function(a){var b=!this.options.ignoreStandalone,c=!this.isRootSeen;this.isRootSeen=!0;for(var d=a.body,i=0,j=d.length;i<j;i++){var k=d[i],l=this.accept(k);if(l){var m=e(d,i,c),n=f(d,i,c),o=l.openStandalone&&m,p=l.closeStandalone&&n,q=l.inlineStandalone&&m&&n;l.close&&g(d,i,!0),l.open&&h(d,i,!0),b&&q&&(g(d,i),h(d,i)&&"PartialStatement"===k.type&&(k.indent=/([ \t]+$)/.exec(d[i-1].original)[1])),b&&o&&(g((k.program||k.inverse).body),h(d,i)),b&&p&&(g(d,i),h((k.inverse||k.program).body))}}return a},d.prototype.BlockStatement=d.prototype.DecoratorBlock=d.prototype.PartialBlockStatement=function(a){this.accept(a.program),this.accept(a.inverse);var b=a.program||a.inverse,c=a.program&&a.inverse,d=c,i=c;if(c&&c.chained)for(d=c.body[0].program;i.chained;)i=i.body[i.body.length-1].program;var j={open:a.openStrip.open,close:a.closeStrip.close,openStandalone:f(b.body),closeStandalone:e((d||b).body)};if(a.openStrip.close&&g(b.body,null,!0),c){var k=a.inverseStrip;k.open&&h(b.body,null,!0),k.close&&g(d.body,null,!0),a.closeStrip.open&&h(i.body,null,!0),!this.options.ignoreStandalone&&e(b.body)&&f(d.body)&&(h(b.body),g(d.body))}else a.closeStrip.open&&h(b.body,null,!0);return j},d.prototype.Decorator=d.prototype.MustacheStatement=function(a){return a.strip},d.prototype.PartialStatement=d.prototype.CommentStatement=function(a){var b=a.strip||{};return{inlineStandalone:!0,open:b.open,close:b.close}},b.default=d,a.exports=b.default},function(a,b,c){function d(){this.parents=[]}function e(a){this.acceptRequired(a,"path"),this.acceptArray(a.params),this.acceptKey(a,"hash")}function f(a){e.call(this,a),this.acceptKey(a,"program"),this.acceptKey(a,"inverse")}function g(a){this.acceptRequired(a,"name"),this.acceptArray(a.params),this.acceptKey(a,"hash")}var h=c(1).default;b.__esModule=!0;var i=c(6),j=h(i);d.prototype={constructor:d,mutating:!1,acceptKey:function(a,b){var c=this.accept(a[b]);if(this.mutating){if(c&&!d.prototype[c.type])throw new j.default('Unexpected node type "'+c.type+'" found when accepting '+b+" on "+a.type);a[b]=c}},acceptRequired:function(a,b){if(this.acceptKey(a,b),!a[b])throw new j.default(a.type+" requires "+b)},acceptArray:function(a){for(var b=0,c=a.length;b<c;b++)this.acceptKey(a,b),a[b]||(a.splice(b,1),b--,c--)},accept:function(a){if(a){if(!this[a.type])throw new j.default("Unknown type: "+a.type,a);this.current&&this.parents.unshift(this.current),this.current=a;var b=this[a.type](a);return this.current=this.parents.shift(),!this.mutating||b?b:!1!==b?a:void 0}},Program:function(a){this.acceptArray(a.body)},MustacheStatement:e,Decorator:e,BlockStatement:f,DecoratorBlock:f,PartialStatement:g,PartialBlockStatement:function(a){g.call(this,a),this.acceptKey(a,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:e,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(a){this.acceptArray(a.pairs)},HashPair:function(a){this.acceptRequired(a,"value")}},b.default=d,a.exports=b.default},function(a,b,c){function d(a,b){if(b=b.path?b.path.original:b,a.path.original!==b){var c={loc:a.path.loc};throw new q.default(a.path.original+" doesn't match "+b,c)}}function e(a,b){this.source=a,this.start={line:b.first_line,column:b.first_column},this.end={line:b.last_line,column:b.last_column}}function f(a){return/^\[.*\]$/.test(a)?a.substr(1,a.length-2):a}function g(a,b){return{open:"~"===a.charAt(2),close:"~"===b.charAt(b.length-3)}}function h(a){return a.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function i(a,b,c){c=this.locInfo(c);for(var d=a?"@":"",e=[],f=0,g="",h=0,i=b.length;h<i;h++){var j=b[h].part,k=b[h].original!==j;if(d+=(b[h].separator||"")+j,k||".."!==j&&"."!==j&&"this"!==j)e.push(j);else{if(e.length>0)throw new q.default("Invalid path: "+d,{loc:c});".."===j&&(f++,g+="../")}}return{type:"PathExpression",data:a,depth:f,parts:e,original:d,loc:c}}function j(a,b,c,d,e,f){var g=d.charAt(3)||d.charAt(2),h="{"!==g&&"&"!==g;return{type:/\*/.test(d)?"Decorator":"MustacheStatement",path:a,params:b,hash:c,escaped:h,strip:e,loc:this.locInfo(f)}}function k(a,b,c,e){d(a,c),e=this.locInfo(e);var f={type:"Program",body:b,strip:{},loc:e};return{type:"BlockStatement",path:a.path,params:a.params,hash:a.hash,program:f,openStrip:{},inverseStrip:{},closeStrip:{},loc:e}}function l(a,b,c,e,f,g){e&&e.path&&d(a,e);var h=/\*/.test(a.open);b.blockParams=a.blockParams;var i=void 0,j=void 0;if(c){if(h)throw new q.default("Unexpected inverse block on decorator",c);c.chain&&(c.program.body[0].closeStrip=e.strip),j=c.strip,i=c.program}return f&&(f=i,i=b,b=f),{type:h?"DecoratorBlock":"BlockStatement",path:a.path,params:a.params,hash:a.hash,program:b,inverse:i,openStrip:a.strip,inverseStrip:j,closeStrip:e&&e.strip,loc:this.locInfo(g)}}function m(a,b){if(!b&&a.length){var c=a[0].loc,d=a[a.length-1].loc;c&&d&&(b={source:c.source,start:{line:c.start.line,column:c.start.column},end:{line:d.end.line,column:d.end.column}})}return{type:"Program",body:a,strip:{},loc:b}}function n(a,b,c,e){return d(a,c),{type:"PartialBlockStatement",name:a.path,params:a.params,hash:a.hash,program:b,openStrip:a.strip,closeStrip:c&&c.strip,loc:this.locInfo(e)}}var o=c(1).default;b.__esModule=!0,b.SourceLocation=e,b.id=f,b.stripFlags=g,b.stripComment=h,b.preparePath=i,b.prepareMustache=j,b.prepareRawBlock=k,b.prepareBlock=l,b.prepareProgram=m,b.preparePartialBlock=n;var p=c(6),q=o(p)},function(a,b,c){function d(){}function e(a,b,c){if(null==a||"string"!=typeof a&&"Program"!==a.type)throw new k.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+a);b=b||{},"data"in b||(b.data=!0),b.compat&&(b.useDepths=!0);var d=c.parse(a,b),e=(new c.Compiler).compile(d,b);return(new c.JavaScriptCompiler).compile(e,b)}function f(a,b,c){function d(){var d=c.parse(a,b),e=(new c.Compiler).compile(d,b),f=(new c.JavaScriptCompiler).compile(e,b,void 0,!0);return c.template(f)}function e(a,b){return f||(f=d()),f.call(this,a,b)}if(void 0===b&&(b={}),null==a||"string"!=typeof a&&"Program"!==a.type)throw new k.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+a);"data"in b||(b.data=!0),b.compat&&(b.useDepths=!0);var f=void 0;return e._setup=function(a){return f||(f=d()),f._setup(a)},e._child=function(a,b,c,e){return f||(f=d()),f._child(a,b,c,e)},e}function g(a,b){if(a===b)return!0;if(l.isArray(a)&&l.isArray(b)&&a.length===b.length){for(var c=0;c<a.length;c++)if(!g(a[c],b[c]))return!1;return!0}}function h(a){if(!a.path.parts){var b=a.path;a.path={type:"PathExpression",data:!1,depth:0,parts:[b.original+""],original:b.original+"",loc:b.loc}}}var i=c(1).default;b.__esModule=!0,b.Compiler=d,b.precompile=e,b.compile=f;var j=c(6),k=i(j),l=c(5),m=c(21),n=i(m),o=[].slice;d.prototype={compiler:d,equals:function(a){var b=this.opcodes.length;if(a.opcodes.length!==b)return!1;for(var c=0;c<b;c++){var d=this.opcodes[c],e=a.opcodes[c];if(d.opcode!==e.opcode||!g(d.args,e.args))return!1}b=this.children.length;for(var c=0;c<b;c++)if(!this.children[c].equals(a.children[c]))return!1;return!0},guid:0,compile:function(a,b){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=b,this.stringParams=b.stringParams,this.trackIds=b.trackIds,b.blockParams=b.blockParams||[];var c=b.knownHelpers;if(b.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},c)for(var d in c)d in c&&(b.knownHelpers[d]=c[d]);return this.accept(a)},compileProgram:function(a){var b=new this.compiler,c=b.compile(a,this.options),d=this.guid++;return this.usePartial=this.usePartial||c.usePartial,this.children[d]=c,this.useDepths=this.useDepths||c.useDepths,d},accept:function(a){if(!this[a.type])throw new k.default("Unknown type: "+a.type,a);this.sourceNode.unshift(a);var b=this[a.type](a);return this.sourceNode.shift(),b},Program:function(a){this.options.blockParams.unshift(a.blockParams);for(var b=a.body,c=b.length,d=0;d<c;d++)this.accept(b[d]);return this.options.blockParams.shift(),this.isSimple=1===c,this.blockParams=a.blockParams?a.blockParams.length:0,this},BlockStatement:function(a){h(a);var b=a.program,c=a.inverse;b=b&&this.compileProgram(b),c=c&&this.compileProgram(c);var d=this.classifySexpr(a);"helper"===d?this.helperSexpr(a,b,c):"simple"===d?(this.simpleSexpr(a),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("emptyHash"),this.opcode("blockValue",a.path.original)):(this.ambiguousSexpr(a,b,c),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(a){var b=a.program&&this.compileProgram(a.program),c=this.setupFullMustacheParams(a,b,void 0),d=a.path;this.useDecorators=!0,this.opcode("registerDecorator",c.length,d.original)},PartialStatement:function(a){this.usePartial=!0;var b=a.program;b&&(b=this.compileProgram(a.program));var c=a.params;if(c.length>1)throw new k.default("Unsupported number of partial arguments: "+c.length,a);c.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):c.push({type:"PathExpression",parts:[],depth:0}));var d=a.name.original,e="SubExpression"===a.name.type;e&&this.accept(a.name),this.setupFullMustacheParams(a,b,void 0,!0);var f=a.indent||"";this.options.preventIndent&&f&&(this.opcode("appendContent",f),f=""),this.opcode("invokePartial",e,d,f),this.opcode("append")},PartialBlockStatement:function(a){this.PartialStatement(a)},MustacheStatement:function(a){this.SubExpression(a),a.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(a){this.DecoratorBlock(a)},ContentStatement:function(a){a.value&&this.opcode("appendContent",a.value)},CommentStatement:function(){},SubExpression:function(a){h(a);var b=this.classifySexpr(a);"simple"===b?this.simpleSexpr(a):"helper"===b?this.helperSexpr(a):this.ambiguousSexpr(a)},ambiguousSexpr:function(a,b,c){var d=a.path,e=d.parts[0],f=null!=b||null!=c;this.opcode("getContext",d.depth),this.opcode("pushProgram",b),this.opcode("pushProgram",c),d.strict=!0,this.accept(d),this.opcode("invokeAmbiguous",e,f)},simpleSexpr:function(a){var b=a.path;b.strict=!0,this.accept(b),this.opcode("resolvePossibleLambda")},helperSexpr:function(a,b,c){var d=this.setupFullMustacheParams(a,b,c),e=a.path,f=e.parts[0];if(this.options.knownHelpers[f])this.opcode("invokeKnownHelper",d.length,f);else{if(this.options.knownHelpersOnly)throw new k.default("You specified knownHelpersOnly, but used the unknown helper "+f,a);e.strict=!0,e.falsy=!0,this.accept(e),this.opcode("invokeHelper",d.length,e.original,n.default.helpers.simpleId(e))}},PathExpression:function(a){this.addDepth(a.depth),this.opcode("getContext",a.depth);var b=a.parts[0],c=n.default.helpers.scopedId(a),d=!a.depth&&!c&&this.blockParamIndex(b);d?this.opcode("lookupBlockParam",d,a.parts):b?a.data?(this.options.data=!0,this.opcode("lookupData",a.depth,a.parts,a.strict)):this.opcode("lookupOnContext",a.parts,a.falsy,a.strict,c):this.opcode("pushContext")},StringLiteral:function(a){this.opcode("pushString",a.value)},NumberLiteral:function(a){this.opcode("pushLiteral",a.value)},BooleanLiteral:function(a){this.opcode("pushLiteral",a.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(a){var b=a.pairs,c=0,d=b.length;for(this.opcode("pushHash");c<d;c++)this.pushParam(b[c].value);for(;c--;)this.opcode("assignToHash",b[c].key);this.opcode("popHash")},opcode:function(a){this.opcodes.push({opcode:a,args:o.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(a){a&&(this.useDepths=!0)},classifySexpr:function(a){var b=n.default.helpers.simpleId(a.path),c=b&&!!this.blockParamIndex(a.path.parts[0]),d=!c&&n.default.helpers.helperExpression(a),e=!c&&(d||b);if(e&&!d){var f=a.path.parts[0],g=this.options;g.knownHelpers[f]?d=!0:g.knownHelpersOnly&&(e=!1)}return d?"helper":e?"ambiguous":"simple"},pushParams:function(a){for(var b=0,c=a.length;b<c;b++)this.pushParam(a[b])},pushParam:function(a){var b=null!=a.value?a.value:a.original||"";if(this.stringParams)b.replace&&(b=b.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),a.depth&&this.addDepth(a.depth),this.opcode("getContext",a.depth||0),this.opcode("pushStringParam",b,a.type),"SubExpression"===a.type&&this.accept(a);else{if(this.trackIds){var c=void 0;if(!a.parts||n.default.helpers.scopedId(a)||a.depth||(c=this.blockParamIndex(a.parts[0])),c){var d=a.parts.slice(1).join(".");this.opcode("pushId","BlockParam",c,d)}else b=a.original||b,b.replace&&(b=b.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",a.type,b)}this.accept(a)}},setupFullMustacheParams:function(a,b,c,d){var e=a.params;return this.pushParams(e),this.opcode("pushProgram",b),this.opcode("pushProgram",c),a.hash?this.accept(a.hash):this.opcode("emptyHash",d),e},blockParamIndex:function(a){for(var b=0,c=this.options.blockParams.length;b<c;b++){var d=this.options.blockParams[b],e=d&&l.indexOf(d,a);if(d&&e>=0)return[b,e]}}}},function(a,b,c){function d(a){this.value=a}function e(){}function f(a,b,c,d){var e=b.popStack(),f=0,g=c.length;for(a&&g--;f<g;f++)e=b.nameLookup(e,c[f],d);return a?[b.aliasable("container.strict"),"(",e,", ",b.quotedString(c[f]),")"]:e}var g=c(1).default;b.__esModule=!0;var h=c(4),i=c(6),j=g(i),k=c(5),l=c(29),m=g(l);e.prototype={nameLookup:function(a,b){return e.isValidJavaScriptVariableName(b)?[a,".",b]:[a,"[",JSON.stringify(b),"]"]},depthedLookup:function(a){return[this.aliasable("container.lookup"),'(depths, "',a,'")']},compilerInfo:function(){var a=h.COMPILER_REVISION;return[a,h.REVISION_CHANGES[a]]},appendToBuffer:function(a,b,c){return k.isArray(a)||(a=[a]),a=this.source.wrap(a,b),this.environment.isSimple?["return ",a,";"]:c?["buffer += ",a,";"]:(a.appendToBuffer=!0,a)},initializeBuffer:function(){return this.quotedString("")},compile:function(a,b,c,d){this.environment=a,this.options=b,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!d,this.name=this.environment.name,this.isChild=!!c,this.context=c||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(a,b),
this.useDepths=this.useDepths||a.useDepths||a.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||a.useBlockParams;var e=a.opcodes,f=void 0,g=void 0,h=void 0,i=void 0;for(h=0,i=e.length;h<i;h++)f=e[h],this.source.currentLocation=f.loc,g=g||f.loc,this[f.opcode].apply(this,f.args);if(this.source.currentLocation=g,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new j.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend("var decorators = container.decorators;\n"),this.decorators.push("return fn;"),d?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators=this.decorators.merge()));var k=this.createFunctionContext(d);if(this.isChild)return k;var l={compiler:this.compilerInfo(),main:k};this.decorators&&(l.main_d=this.decorators,l.useDecorators=!0);var m=this.context,n=m.programs,o=m.decorators;for(h=0,i=n.length;h<i;h++)n[h]&&(l[h]=n[h],o[h]&&(l[h+"_d"]=o[h],l.useDecorators=!0));return this.environment.usePartial&&(l.usePartial=!0),this.options.data&&(l.useData=!0),this.useDepths&&(l.useDepths=!0),this.useBlockParams&&(l.useBlockParams=!0),this.options.compat&&(l.compat=!0),d?l.compilerOptions=this.options:(l.compiler=JSON.stringify(l.compiler),this.source.currentLocation={start:{line:1,column:0}},l=this.objectLiteral(l),b.srcName?(l=l.toStringWithSourceMap({file:b.destName}),l.map=l.map&&l.map.toString()):l=l.toString()),l},preamble:function(){this.lastContext=0,this.source=new m.default(this.options.srcName),this.decorators=new m.default(this.options.srcName)},createFunctionContext:function(a){var b="",c=this.stackVars.concat(this.registers.list);c.length>0&&(b+=", "+c.join(", "));var d=0;for(var e in this.aliases){var f=this.aliases[e];this.aliases.hasOwnProperty(e)&&f.children&&f.referenceCount>1&&(b+=", alias"+ ++d+"="+e,f.children[0]="alias"+d)}var g=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&g.push("blockParams"),this.useDepths&&g.push("depths");var h=this.mergeSource(b);return a?(g.push(h),Function.apply(this,g)):this.source.wrap(["function(",g.join(","),") {\n  ",h,"}"])},mergeSource:function(a){var b=this.environment.isSimple,c=!this.forceBuffer,d=void 0,e=void 0,f=void 0,g=void 0;return this.source.each(function(a){a.appendToBuffer?(f?a.prepend("  + "):f=a,g=a):(f&&(e?f.prepend("buffer += "):d=!0,g.add(";"),f=g=void 0),e=!0,b||(c=!1))}),c?f?(f.prepend("return "),g.add(";")):e||this.source.push('return "";'):(a+=", buffer = "+(d?"":this.initializeBuffer()),f?(f.prepend("return buffer + "),g.add(";")):this.source.push("return buffer;")),a&&this.source.prepend("var "+a.substring(2)+(d?"":";\n")),this.source.merge()},blockValue:function(a){var b=this.aliasable("helpers.blockHelperMissing"),c=[this.contextName(0)];this.setupHelperArgs(a,0,c);var d=this.popStack();c.splice(1,0,d),this.push(this.source.functionCall(b,"call",c))},ambiguousBlockValue:function(){var a=this.aliasable("helpers.blockHelperMissing"),b=[this.contextName(0)];this.setupHelperArgs("",0,b,!0),this.flushInline();var c=this.topStack();b.splice(1,0,c),this.pushSource(["if (!",this.lastHelper,") { ",c," = ",this.source.functionCall(a,"call",b),"}"])},appendContent:function(a){this.pendingContent?a=this.pendingContent+a:this.pendingLocation=this.source.currentLocation,this.pendingContent=a},append:function(){if(this.isInline())this.replaceStack(function(a){return[" != null ? ",a,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var a=this.popStack();this.pushSource(["if (",a," != null) { ",this.appendToBuffer(a,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(a){this.lastContext=a},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(a,b,c,d){var e=0;d||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(a[e++])),this.resolvePath("context",a,e,b,c)},lookupBlockParam:function(a,b){this.useBlockParams=!0,this.push(["blockParams[",a[0],"][",a[1],"]"]),this.resolvePath("context",b,1)},lookupData:function(a,b,c){a?this.pushStackLiteral("container.data(data, "+a+")"):this.pushStackLiteral("data"),this.resolvePath("data",b,0,!0,c)},resolvePath:function(a,b,c,d,e){var g=this;if(this.options.strict||this.options.assumeObjects)return void this.push(f(this.options.strict&&e,this,b,a));for(var h=b.length;c<h;c++)this.replaceStack(function(e){var f=g.nameLookup(e,b[c],a);return d?[" && ",f]:[" != null ? ",f," : ",e]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(a,b){this.pushContext(),this.pushString(b),"SubExpression"!==b&&("string"==typeof a?this.pushString(a):this.pushStackLiteral(a))},emptyHash:function(a){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(a?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var a=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(a.ids)),this.stringParams&&(this.push(this.objectLiteral(a.contexts)),this.push(this.objectLiteral(a.types))),this.push(this.objectLiteral(a.values))},pushString:function(a){this.pushStackLiteral(this.quotedString(a))},pushLiteral:function(a){this.pushStackLiteral(a)},pushProgram:function(a){null!=a?this.pushStackLiteral(this.programExpression(a)):this.pushStackLiteral(null)},registerDecorator:function(a,b){var c=this.nameLookup("decorators",b,"decorator"),d=this.setupHelperArgs(b,a);this.decorators.push(["fn = ",this.decorators.functionCall(c,"",["fn","props","container",d])," || fn;"])},invokeHelper:function(a,b,c){var d=this.popStack(),e=this.setupHelper(a,b),f=c?[e.name," || "]:"",g=["("].concat(f,d);this.options.strict||g.push(" || ",this.aliasable("helpers.helperMissing")),g.push(")"),this.push(this.source.functionCall(g,"call",e.callParams))},invokeKnownHelper:function(a,b){var c=this.setupHelper(a,b);this.push(this.source.functionCall(c.name,"call",c.callParams))},invokeAmbiguous:function(a,b){this.useRegister("helper");var c=this.popStack();this.emptyHash();var d=this.setupHelper(0,a,b),e=this.lastHelper=this.nameLookup("helpers",a,"helper"),f=["(","(helper = ",e," || ",c,")"];this.options.strict||(f[0]="(helper = ",f.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",f,d.paramsInit?["),(",d.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",d.callParams)," : helper))"])},invokePartial:function(a,b,c){var d=[],e=this.setupParams(b,1,d);a&&(b=this.popStack(),delete e.name),c&&(e.indent=JSON.stringify(c)),e.helpers="helpers",e.partials="partials",e.decorators="container.decorators",a?d.unshift(b):d.unshift(this.nameLookup("partials",b,"partial")),this.options.compat&&(e.depths="depths"),e=this.objectLiteral(e),d.push(e),this.push(this.source.functionCall("container.invokePartial","",d))},assignToHash:function(a){var b=this.popStack(),c=void 0,d=void 0,e=void 0;this.trackIds&&(e=this.popStack()),this.stringParams&&(d=this.popStack(),c=this.popStack());var f=this.hash;c&&(f.contexts[a]=c),d&&(f.types[a]=d),e&&(f.ids[a]=e),f.values[a]=b},pushId:function(a,b,c){"BlockParam"===a?this.pushStackLiteral("blockParams["+b[0]+"].path["+b[1]+"]"+(c?" + "+JSON.stringify("."+c):"")):"PathExpression"===a?this.pushString(b):"SubExpression"===a?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:e,compileChildren:function(a,b){for(var c=a.children,d=void 0,e=void 0,f=0,g=c.length;f<g;f++){d=c[f],e=new this.compiler;var h=this.matchExistingProgram(d);null==h?(this.context.programs.push(""),h=this.context.programs.length,d.index=h,d.name="program"+h,this.context.programs[h]=e.compile(d,b,this.context,!this.precompile),this.context.decorators[h]=e.decorators,this.context.environments[h]=d,this.useDepths=this.useDepths||e.useDepths,this.useBlockParams=this.useBlockParams||e.useBlockParams):(d.index=h,d.name="program"+h,this.useDepths=this.useDepths||d.useDepths,this.useBlockParams=this.useBlockParams||d.useBlockParams)}},matchExistingProgram:function(a){for(var b=0,c=this.context.environments.length;b<c;b++){var d=this.context.environments[b];if(d&&d.equals(a))return b}},programExpression:function(a){var b=this.environment.children[a],c=[b.index,"data",b.blockParams];return(this.useBlockParams||this.useDepths)&&c.push("blockParams"),this.useDepths&&c.push("depths"),"container.program("+c.join(", ")+")"},useRegister:function(a){this.registers[a]||(this.registers[a]=!0,this.registers.list.push(a))},push:function(a){return a instanceof d||(a=this.source.wrap(a)),this.inlineStack.push(a),a},pushStackLiteral:function(a){this.push(new d(a))},pushSource:function(a){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),a&&this.source.push(a)},replaceStack:function(a){var b=["("],c=void 0,e=void 0,f=void 0;if(!this.isInline())throw new j.default("replaceStack on non-inline");var g=this.popStack(!0);if(g instanceof d)c=[g.value],b=["(",c],f=!0;else{e=!0;var h=this.incrStack();b=["((",this.push(h)," = ",g,")"],c=this.topStack()}var i=a.call(this,c);f||this.popStack(),e&&this.stackSlot--,this.push(b.concat(i,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var a=this.inlineStack;this.inlineStack=[];for(var b=0,c=a.length;b<c;b++){var e=a[b];if(e instanceof d)this.compileStack.push(e);else{var f=this.incrStack();this.pushSource([f," = ",e,";"]),this.compileStack.push(f)}}},isInline:function(){return this.inlineStack.length},popStack:function(a){var b=this.isInline(),c=(b?this.inlineStack:this.compileStack).pop();if(!a&&c instanceof d)return c.value;if(!b){if(!this.stackSlot)throw new j.default("Invalid stack pop");this.stackSlot--}return c},topStack:function(){var a=this.isInline()?this.inlineStack:this.compileStack,b=a[a.length-1];return b instanceof d?b.value:b},contextName:function(a){return this.useDepths&&a?"depths["+a+"]":"depth"+a},quotedString:function(a){return this.source.quotedString(a)},objectLiteral:function(a){return this.source.objectLiteral(a)},aliasable:function(a){var b=this.aliases[a];return b?(b.referenceCount++,b):(b=this.aliases[a]=this.source.wrap(a),b.aliasable=!0,b.referenceCount=1,b)},setupHelper:function(a,b,c){var d=[];return{params:d,paramsInit:this.setupHelperArgs(b,a,d,c),name:this.nameLookup("helpers",b,"helper"),callParams:[this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : {}")].concat(d)}},setupParams:function(a,b,c){var d={},e=[],f=[],g=[],h=!c,i=void 0;h&&(c=[]),d.name=this.quotedString(a),d.hash=this.popStack(),this.trackIds&&(d.hashIds=this.popStack()),this.stringParams&&(d.hashTypes=this.popStack(),d.hashContexts=this.popStack());var j=this.popStack(),k=this.popStack();(k||j)&&(d.fn=k||"container.noop",d.inverse=j||"container.noop");for(var l=b;l--;)i=this.popStack(),c[l]=i,this.trackIds&&(g[l]=this.popStack()),this.stringParams&&(f[l]=this.popStack(),e[l]=this.popStack());return h&&(d.args=this.source.generateArray(c)),this.trackIds&&(d.ids=this.source.generateArray(g)),this.stringParams&&(d.types=this.source.generateArray(f),d.contexts=this.source.generateArray(e)),this.options.data&&(d.data="data"),this.useBlockParams&&(d.blockParams="blockParams"),d},setupHelperArgs:function(a,b,c,d){var e=this.setupParams(a,b,c);return e=this.objectLiteral(e),d?(this.useRegister("options"),c.push("options"),["options=",e]):c?(c.push(e),""):e}},function(){for(var a="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),b=e.RESERVED_WORDS={},c=0,d=a.length;c<d;c++)b[a[c]]=!0}(),e.isValidJavaScriptVariableName=function(a){return!e.RESERVED_WORDS[a]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(a)},b.default=e,a.exports=b.default},function(a,b,c){function d(a,b,c){if(f.isArray(a)){for(var d=[],e=0,g=a.length;e<g;e++)d.push(b.wrap(a[e],c));return d}return"boolean"==typeof a||"number"==typeof a?a+"":a}function e(a){this.srcFile=a,this.source=[]}b.__esModule=!0;var f=c(5),g=void 0;g||(g=function(a,b,c,d){this.src="",d&&this.add(d)},g.prototype={add:function(a){f.isArray(a)&&(a=a.join("")),this.src+=a},prepend:function(a){f.isArray(a)&&(a=a.join("")),this.src=a+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),e.prototype={isEmpty:function(){return!this.source.length},prepend:function(a,b){this.source.unshift(this.wrap(a,b))},push:function(a,b){this.source.push(this.wrap(a,b))},merge:function(){var a=this.empty();return this.each(function(b){a.add(["  ",b,"\n"])}),a},each:function(a){for(var b=0,c=this.source.length;b<c;b++)a(this.source[b])},empty:function(){var a=this.currentLocation||{start:{}};return new g(a.start.line,a.start.column,this.srcFile)},wrap:function(a){var b=arguments.length<=1||void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return a instanceof g?a:(a=d(a,this,b),new g(b.start.line,b.start.column,this.srcFile,a))},functionCall:function(a,b,c){return c=this.generateList(c),this.wrap([a,b?"."+b+"(":"(",c,")"])},quotedString:function(a){return'"'+(a+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(a){var b=[];for(var c in a)if(a.hasOwnProperty(c)){var e=d(a[c],this);"undefined"!==e&&b.push([this.quotedString(c),":",e])}var f=this.generateList(b);return f.prepend("{"),f.add("}"),f},generateList:function(a){for(var b=this.empty(),c=0,e=a.length;c<e;c++)c&&b.add(","),b.add(d(a[c],this));return b},generateArray:function(a){var b=this.generateList(a);return b.prepend("["),b.add("]"),b}},b.default=e,a.exports=b.default}])}),b("basic/tools/template",function(){function a(a){var c;return(c=e[a])?c:c=e[a]=b.compile(d[a])}var b=c("lib/handlebars"),d={},e={};return d.BODYTEMPLATE='<div class="main-layout">',d.BODYTEMPLATE+='<table class="cui-grid" cellspacing="0" cellpadding="0" id="tableContainer">',d.BODYTEMPLATE+='<tbody><tr><td><div class="left-corner"></div></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody>',d.BODYTEMPLATE+="</table></div>",d.BODYTEMPLATE+='<div class="sheet-layout"><div class="sheet-body">',d.BODYTEMPLATE+='<div class="sheet-cf-box glyphicons glyphicon-plus"></div>',d.BODYTEMPLATE+='<div class="sheet-cf-box active glyphicons glyphicon-th-list"></div>',d.BODYTEMPLATE+='<div class="sheet-cf-list"></div></div></div>',d.BODYTEMPLATE+='<div class="mask"><div class="mask-bg"></div>',d.BODYTEMPLATE+='<div class="mask-text">加载中..&nbsp;. &nbsp;. &nbsp;&nbsp;.</div></div>',d.BODYTEMPLATE+="</div>",d.SHEETTEMPLATE="<span>{{name}}</span>",d.ROWHEADTEMPLATE='<div class="item">{{displayName}}</div>',d.COLHEADTEMPLATE='<div class="item">{{displayName}}</div>',d.INPUTTEMPLATE='<div class="textarea"><textarea class="input-container"></textarea><div>',d.SELECTTEMPLATE='<div class="box"><div class="expand"></div><div class="bg"></div></div>',d.CELLTEMPLATE='<div class="bg" style="display:table-cell;"></div>',d.COLGRIDTEMPLATE='<div class="col" style="left:{{left}}px;"></div>',d.ROWGRIDTEMPLATE='<div class="row" style="top:{{top}}px;"></div>',d.COMMENTTEMPLAET="<div></div>",d.SIDERBARTEMPLATE='<div class="siderbar-title"><span>{{title}}</span>',d.SIDERBARTEMPLATE+='<a href="#" class="fui-cf-bg-extend2-ico ico-close close" title="关闭"></a></div>',d.SIDERBARTEMPLATE+='<div class="siderbar-body"></div></div>',d.LOCKCONTAINER='<div class="siderbar-item clearfix"><div class="lock-content">',d.LOCKCONTAINER+='<div class="title"><span>锁定</span><div class="checkbox lock-toggle"></div></div>',d.LOCKCONTAINER+='<div class="content"><label>所选区域：</label><input type="text" disabled="disabled"></div>',d.LOCKCONTAINER+='<div class="oper"><a href="#" class="confirm">确定</a><a href="#" class="cancel">取消</a></div></div></div>',d.PROTECTCONTAINER='<div class="siderbar-item clearfix"><div class="protect-content">',d.PROTECTCONTAINER+='<div class="content"><label>密码：</label><input type="password"></div>',d.PROTECTCONTAINER+='<div class="oper"><a href="#" class="confirm">确定</a><a href="#" class="cancel">取消</a></div></div></div>',d.VALIDATETEMPLATE='<div class="siderbar-item clearfix"><div class="validate-title">验证条件:</div>',d.VALIDATETEMPLATE+='<form class="validate-content"><div><label>类型:</label><select name="type" class=""><option class="default" value="default">任意值</option>',d.VALIDATETEMPLATE+='<option value="intType" class="intType">整数</option><option value="decimalType" class="decimalType">小数</option><option value="textType" class="textType">文本长度</option>',d.VALIDATETEMPLATE+='<option value="sequenceType">序列</option>',d.VALIDATETEMPLATE+="</select></div>",d.VALIDATETEMPLATE+='<div class="range"><label>最小值:</label><input type="text" name="min" class="min"><br><label>最大值:</label><input type="text" name="max" class="max"></div>',d.VALIDATETEMPLATE+='<div class="source"><label>来源:</label><input type="text" class="source-data" maxlength="50" name="source"><div class="select-out"></div></div></form>',d.VALIDATETEMPLATE+='<div class="error">选中区域内包含多种验证规则</div>',d.VALIDATETEMPLATE+='<div class="oper"><a href="#" class="confirm">确定</a><a href="#" class="cancel">取消</a></div></div>',d.MSGCONTAINER='<div class="msg"><span class="msg-content">{{msg}}</span></div>',d.SEQUENCETEMPLATE='<div class="sequence-btn"><div class="sequence-btn-arrow"></div></div>',d.SEQUENCETEMPLATE+='<ul class="sequence-list"></ul>',d.SEQUENCEITEMTEMPLATE='<li class="sequence-list-item"><a href="">{{content}}</a></li>',a}),b("views/sheetContainer",function(){var a=(c("lib/jquery"),c("lib/backbone")),b=c("basic/tools/template");return a.View.extend({tagName:"li",initialize:function(a){var c=this.model.toJSON();this.listenTo(this.model,"destroy",this.destroy),this.template=b("SHEETTEMPLATE"),this.$el.html(this.template(c)),!0===a.active&&this.$el.addClass("active")},render:function(){return this},destroy:function(){this.remove()}})}),b("views/sheetsContainer",function(){var a=c("lib/backbone"),b=c("collections/sheets"),d=c("views/sheetContainer");return a.View.extend({tagName:"ul",className:"sheet-list",initialize:function(a){b.length<1&&b.add({name:"Sheet1",sort:0})},render:function(){var a,c,e;for(a=0;a<b.length;a++)e=0===a,c=new d({model:b.models[a],active:e}),this.$el.append(c.render().el);return this},destroy:function(){this.remove()}})}),b("basic/util/clone",function(){var a={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1};return{clone:function(b){if("object"==typeof b&&null!==b){var c=b;if(b instanceof Array){c=[];for(var d=0,e=b.length;d<e;d++)c[d]=this.clone(b[d])}else if(!a[Object.prototype.toString.call(b)]){c={};for(var f in b)b.hasOwnProperty(f)&&(c[f]=this.clone(b[f]))}return c}return b}}}),b("views/gridLineRowContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=c("collections/headItemRow"),d=c("basic/tools/cache"),e=c("basic/util/clone");c("spreadsheet/config");return a.View.extend({className:"row",initialize:function(a){this.offsetTop=d.TempProp.isFrozen?a.frozenTop||0:0,this.endIndex=a.endIndex,this.listenTo(this.model,"change:top",this.changeTop),this.listenTo(this.model,"change:height",this.changeHeight),this.listenTo(this.model,"destroy",this.remove),this.currentRule=e.clone(d.CurrentRule),!0===d.TempProp.isFrozen&&void 0!==this.endIndex||this.listenTo(this.model,"change:isView",this.destroy)},render:function(){return this.changeTop(),this.changeHeight(),this},changeTop:function(){var a,c=0;d.TempProp.isFrozen&&(a=b.getModelByAlias(d.UserView.rowAlias),c=a.toJSON().top),this.$el.css({top:this.model.toJSON().top-this.offsetTop-c})},changeHeight:function(){this.$el.css({height:this.model.toJSON().height})},destroy:function(){this.remove()}})}),b("views/rowsGridContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=c("basic/util/observer.pattern"),d=c("spreadsheet/config"),e=c("basic/tools/cache"),f=c("collections/headItemRow"),g=(c("collections/cells"),c("views/gridLineRowContainer"));return a.View.extend({className:"row-container",initialize:function(c){this.rowNumber=0,this.currentRule=e.CurrentRule,void 0===this.currentRule.displayPosition.endRowIndex&&(this.listenTo(f,"add",this.addGridLineRow),b.buildSubscriber(this),this.subscribe("mainContainer","restoreRowView","restoreRowView")),a.on("call:rowsGridContainer",this.rowsGridContainer,this)},rowsGridContainer:function(a){a(this)},render:function(){var a,b,c,d=0;for(a=b=f.models,e.TempProp.isFrozen&&(b=void 0!==this.currentRule.displayPosition.endRowIndex?a.slice(this.currentRule.displayPosition.startRowIndex,this.currentRule.displayPosition.endRowIndex):a.slice(this.currentRule.displayPosition.startRowIndex)),c=b.length;d<c;d++)this.addGridLineRow(b[d]),this.rowNumber++;return this},restoreRowView:function(a,b){this.addGridLineRow(a,b)},addGridLineRow:function(a,b){var c=new g({model:a,frozenTop:this.currentRule.displayPosition.offsetTop,endIndex:this.currentRule.displayPosition.endRowIndex});"down"!==b?this.$el.append(c.render().el):this.$el.prepend(c.render().el)},newAttrRow:function(){return{alias:(this.rowNumber+1).toString(),top:this.rowNumber*d.User.cellHeight,height:d.User.cellHeight-1,displayName:app.basic.getRowDisplayName(this.rowNumber)}},destroy:function(){this.remove()}})}),b("views/gridLineColContainer",function(){var a=c("lib/backbone"),b=c("collections/headItemCol"),d=c("basic/tools/cache");c("spreadsheet/config"),c("basic/util/clone");return a.View.extend({className:"col",initialize:function(){var a,c;this.offsetLeft=0,this.listenTo(this.model,"change:isView",this.destroy),this.listenTo(this.model,"change:hidden",this.destroy),this.listenTo(this.model,"change:left",this.changeLeft),this.listenTo(this.model,"change:width",this.changeWidth),this.listenTo(this.model,"destroy",this.remove),a=b,c=a.getModelByAlias(d.TempProp.colAlias),this.userViewLeft=d.TempProp.isFrozen?a.getModelByAlias(d.UserView.colAlias).get("left"):0,this.offsetLeft=d.TempProp.isFrozen&&d.CurrentRule.autoColAlign?c.get("left")-this.userViewLeft||0:0},render:function(){return this.changeLeft(),this.changeWidth(),this},changeLeft:function(){this.$el.css({left:this.model.toJSON().left-this.offsetLeft-this.userViewLeft})},changeWidth:function(){this.$el.css({width:this.model.toJSON().width})},destroy:function(){this.model.get("isView")&&!this.model.get("hidden")||this.remove()}})}),b("views/colsGridContainer",function(){var a=c("lib/backbone"),b=c("spreadsheet/config"),d=(c("basic/util/binary"),c("basic/tools/cache")),e=c("collections/headItemCol"),f=c("basic/tools/getdisplayname"),g=c("views/gridLineColContainer");return a.View.extend({className:"col-container",initialize:function(b){this.colNumber=0,this.listenTo(e,"add",this.addGridLineCol),a.on("event:restoreHideCols",this.restoreHideCols,this)},render:function(){var a,b,c=0;for(a=e.models,d.TempProp.isFrozen&&(this.currentRule=d.CurrentRule,a=void 0!==this.currentRule.displayPosition.endColIndex?e.models.slice(this.currentRule.displayPosition.startColIndex,this.currentRule.displayPosition.endColIndex):e.models.slice(this.currentRule.displayPosition.startColIndex)),b=a.length;c<b;c++)a[c].get("hidden")||this.addGridLineCol(a[c]),this.colNumber++;return this},restoreHideCols:function(){for(var a=e.models,b=a.length,c=0;c<b;c++)a[c].get("hidden")&&this.addGridLineCol(a[c])},addGridLineCol:function(a){var b=new g({model:a,frozenLeft:0});this.$el.append(b.render().el)},createGridLineCol:function(){e.add(this.newAttrCol())},newAttrCol:function(){return{alias:(this.colNumber+1).toString(),left:this.colNumber*b.User.cellWidth,width:b.User.cellWidth-1,displayName:f.getColDisplayName(this.colNumber)}},destroy:function(){a.off("event:restoreHideCols"),this.remove()}})}),b("views/gridLineContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=c("views/rowsGridContainer"),d=c("views/colsGridContainer");return a.View.extend({className:"line-container",initialize:function(){},render:function(){return this.rowsGridContainer=new b,this.$el.append(this.rowsGridContainer.render().el),this.colsGridContainer=new d,this.$el.append(this.colsGridContainer.render().el),this},destroy:function(){this.rowsGridContainer.destroy(),this.colsGridContainer.destroy(),this.remove()}})}),b("basic/tools/gettextbox",function(){var a=c("lib/jquery");return{getTextHeight:function(b,c,d){var e,f,g,h,i="",j=0;for(g=b.split("\n"),h=g.length;j<h;j++)i+=g[j]+"<br>";return i=i.replace(/\u0020/g,"&nbsp;"),e=a("<div/>").html(i),e.css({display:"none","font-size":c+"pt",wordBreak:"break-word"}),void 0!==d&&e.css({width:d}),a("body").append(e),f=parseInt(e.height()),e.remove(),f},getInputHeight:function(b,c,d){var e,f;return e=a("<textarea>"),e.css({visibility:"hidden","font-size":c+"pt",height:0,width:d+"px",overflow:"scroll"}),a("body").append(e),e.val(b),f=parseInt(e[0].scrollHeight),e.remove(),f},getInputWidth:function(b,c){var d,e;return d=a("<textarea>"),d.css({position:"absolute",visibility:"hidden","font-size":c+"pt",height:0,width:0,overflow:"scroll"}),d.attr("wrap","off"),a("body").append(d),d.val(b),e=parseInt(d[0].scrollWidth),d.remove(),e}}}),b("views/cellContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=c("basic/tools/template"),e=(c("basic/util/binary"),c("collections/headItemRow")),f=c("collections/headItemCol"),g=(c("collections/selectRegion"),c("basic/tools/cache")),h=c("spreadsheet/config"),i=c("basic/tools/gettextbox"),j=c("entrance/cell/setcellheight"),k=c("entrance/tool/settexttype");f.models;return b.View.extend({className:"item",initialize:function(a){var b=e,c=f;this.listenTo(this.model,"change:physicsBox.width",this.changeWidth),this.listenTo(this.model,"change:physicsBox.height",this.changeHeight),this.listenTo(this.model,"change:physicsBox.left",this.changeLeft),this.listenTo(this.model,"change:physicsBox.top",this.changeTop),this.listenTo(this.model,"change:content.size",this.changeFontSize),this.listenTo(this.model,"change:content.family",this.changeFontFamily),this.listenTo(this.model,"change:content.italic",this.changeItalic),this.listenTo(this.model,"change:content.bd",this.changeBold),this.listenTo(this.model,"change:content.underline",this.changeUnderline),this.listenTo(this.model,"change:content.color",this.changeColor),this.listenTo(this.model,"change:content.alignRow",this.changeTransverseAlign),this.listenTo(this.model,"change:content.alignCol",this.changeVerticalAlign),this.listenTo(this.model,"change:content.texts",this.generateDisplayText),this.listenTo(this.model,"change:border.left",this.changeLeftBorder),this.listenTo(this.model,"change:border.right",this.changeRightBorder),this.listenTo(this.model,"change:border.top",this.changeTopBorder),this.listenTo(this.model,"change:border.bottom",this.changeBottomBorder),this.listenTo(this.model,"change:customProp.background",this.changeBackground),this.listenTo(this.model,"change:customProp.comment",this.showCommentSign),this.listenTo(this.model,"change:format",this.generateDisplayText),this.listenTo(this.model,"change:wordWrap",this.changeWordWrap),this.currentRule=a.currentRule,!0===g.TempProp.isFrozen&&void 0!==this.currentRule.displayPosition.endRowIndex||this.listenTo(this.model,"change:showState",this.destroy),this.listenTo(this.model,"change:isDestroy",this.destroy),this.listenTo(this.model,"change:hidden",this.destroy),this.listenTo(this.model,"destroy",this.remove),this.offsetLeft=g.TempProp.isFrozen?this.currentRule.displayPosition.offsetLeft||0:0,this.offsetTop=g.TempProp.isFrozen?this.currentRule.displayPosition.offsetTop||0:0,this.userViewLeft=g.TempProp.isFrozen?c.getModelByAlias(g.UserView.colAlias).get("left"):0,this.userViewTop=g.TempProp.isFrozen?b.getModelByAlias(g.UserView.rowAlias).get("top"):0},render:function(){var b=this.model.attributes;return this.template=d("CELLTEMPLATE"),this.$el.html(this.template()),this.$contentBody=a(".bg",this.$el),this.$contentBody[0].innerText=b.content.displayTexts,this.changeFontFamily(b),this.changeFontSize(b),this.changeColor(b),this.changeWidth(b),this.changeHeight(b),this.changeLeft(b),this.changeTop(b),this.changeItalic(b),this.changeBold(b),this.changeTransverseAlign(b),this.changeVerticalAlign(b),this.changeTopBorder(b),this.changeLeftBorder(b),this.changeBottomBorder(b),this.changeRightBorder(b),this.changeUnderline(b),this.changeBackground(b),this.changeWordWrap(b),this.showCommentSign(b),this},changeWidth:function(a){a.attributes&&(a=this.model.attributes),this.$el.css({width:a.physicsBox.width})},changeHeight:function(a){a.attributes&&(a=this.model.attributes),this.$el.css({height:a.physicsBox.height})},changeLeft:function(a){a.attributes&&(a=this.model.attributes),this.$el.css({left:a.physicsBox.left-this.offsetLeft-this.userViewLeft-1})},changeTop:function(a){a.attributes&&(a=this.model.attributes),this.$el.css({top:a.physicsBox.top-this.offsetTop-this.userViewTop-1})},changeBold:function(a){a.attributes&&(a=this.model.attributes),a.content.bd?this.$contentBody.css({fontWeight:"bold"}):this.$contentBody.css({fontWeight:"normal"})},changeUnderline:function(a){a.attributes&&(a=this.model.attributes),a.content.underline?this.$contentBody.css({textDecoration:"underline"}):this.$contentBody.css({textDecoration:"none"})},changeItalic:function(a){a.attributes&&(a=this.model.attributes),a.content.italic?this.$contentBody.css({fontStyle:"italic"}):this.$contentBody.css({fontStyle:"normal"})},changeTransverseAlign:function(a){a.attributes&&(a=this.model.attributes);var b=a.format,c=b.isValid,d=b.type,e=a.content.texts,f=a.content.alignRow;return f?void this.$contentBody.css({textAlign:f}):"text"!==d&&"normal"!==d&&!0===c?void this.$contentBody.css({textAlign:"right"}):"normal"===d&&k.isNum(e)?void this.$contentBody.css({textAlign:"right"}):void this.$contentBody.css({textAlign:"left"})},changeVerticalAlign:function(a){a.attributes&&(a=this.model.attributes),this.$contentBody.css({verticalAlign:this.model.attributes.content.alignCol})},changeTopBorder:function(a){a.attributes&&(a=this.model.attributes),a.border.top?this.$el.css({borderTopColor:"#000"}):this.$el.css({borderTopColor:"transparent"})},changeBottomBorder:function(a){a.attributes&&(a=this.model.attributes),a.border.bottom?this.$el.css({borderBottomColor:"#000"}):this.$el.css({borderBottomColor:"transparent"})},changeLeftBorder:function(a){var b;a.attributes&&(a=this.model.attributes),a.border.left?(b=f.getModelByAlias(a.occupy.x[0]),b.attributes.isLeftAjacentHide?this.$el.css({borderLeftColor:"transparent"}):this.$el.css({borderLeftColor:"#000"})):this.$el.css({borderLeftColor:"transparent"})},changeRightBorder:function(a){var b,c
;a.attributes&&(a=this.model.attributes),c=a.occupy.x,a.border.right?(b=f.getModelByAlias(c[c.length-1]),b.attributes.isRightAjacentHide?this.$el.css({borderRightColor:"transparent"}):this.$el.css({borderRightColor:"#000"})):this.$el.css({borderRightColor:"transparent"})},changeBackground:function(a){a.attributes&&(a=this.model.attributes),""!==a.customProp.background?this.$contentBody.css({backgroundColor:a.customProp.background}):this.$contentBody.css({backgroundColor:"#fff"})},changeWordWrap:function(a){a.attributes&&(a=this.model.attributes),!0===a.wordWrap?this.$contentBody.css({wordBreak:"break-word",whiteSpace:"pre-line"}):this.$contentBody.css({whiteSpace:"pre"})},showCommentSign:function(a){if(a.attributes&&(a=this.model.attributes),null!==a.customProp.comment&&void 0!==a.customProp.comment)this.$el.prepend('<div class="comment-ico"><div class="triangle"></div></div>');else{this.$el.find(".comment-ico").remove()}},generateDisplayText:function(){k.typeRecognize(this.model),k.generateDisplayText(this.model);var a=this.model.attributes;this.changeTransverseAlign(a),this.$contentBody[0].innerText=a.content.displayTexts},changeFontFamily:function(){this.$contentBody.css({fontFamily:this.model.attributes.content.family})},changeFontSize:function(){this.$contentBody.css({fontSize:this.model.attributes.content.size+"pt"})},changeColor:function(){this.$contentBody.css({color:this.model.attributes.content.color})},adaptCellHight:function(){var a,c,d,k,l,m,n,o;if(l=h.User.cellHeight,d=this.model.get("occupy").y,k=this.model.get("occupy").x,o=this.model.get("content").size,!0===this.model.get("wordWrap")&&1===k.length&&1===d.length)return m=e.getModelByAlias(d[0]),n=f.getModelByAlias(k[0]),a=this.model.get("content").displayTexts,void((c=i.getTextHeight(a,o,n.get("width")))>l&&m.get("height")<c&&(j("sheetId",m.get("displayName"),c),g.TempProp.isFrozen&&b.trigger("event:bodyContainer:executiveFrozen")));o>11&&(m=e.getModelByAlias(d[0]),(c=i.getTextHeight("",o,200))>l&&m.get("height")<c&&(j("sheetId",m.get("displayName"),c),g.TempProp.isFrozen&&b.trigger("event:bodyContainer:executiveFrozen")))},destroy:function(){var a=this.model.attributes;(a.hidden||!a.showState||a.isDestroy)&&this.remove()}})}),b("views/contentCellsContainer",function(){var a=c("lib/backbone"),b=c("basic/tools/cache"),d=c("spreadsheet/config"),e=c("basic/util/clone"),f=c("basic/tools/send"),g=c("basic/util/observer.pattern"),h=c("basic/tools/loadrecorder"),i=c("basic/tools/original"),j=c("collections/headItemCol"),k=c("collections/headItemRow"),l=c("collections/cells"),m=c("views/cellContainer"),n=k.models,o=j.models;return a.View.extend({className:"content-list",initialize:function(){this.currentRule=e.clone(b.CurrentRule),a.on("event:restoreHideCellView",this.restoreHideCellView,this),a.on("event:contentCellsContainer:reloadCells",this.reloadCells,this),a.on("event:contentCellsContainer:restoreCell",this.addCell,this),a.on("event:contentCellsContainer:destroy"),this.listenTo(l,"add",this.addCell),void 0===this.currentRule.displayPosition.endIndex&&(g.buildSubscriber(this),this.subscribe("mainContainer","restoreCellView","restoreCellView"))},render:function(){return this.fillCells(),this},fillCells:function(){var a,b,c=l.models;for(a=c.length,b=0;b<a;b++)c[b].get("isDestroy")||this.addCell(c[b])},reloadCells:function(){for(var a,c,d=0,e=l.length;d<e;d++)l.models[0].destroy();b.CellsPosition.strandX={},b.CellsPosition.strandY={},b.cellRegionPosi.vertical=[],l.reset(),a=b.viewRegion.top,c=b.viewRegion.bottom,this.getCells(a,c)},restoreHideCellView:function(){var a,c,d,e,f,g,h,i,m,n=j.models,o=k.models,p=n.length,q=0;for(c=k.getIndexByPosi(b.viewRegion.top),d=k.getIndexByPosi(b.viewRegion.bottom),g=b.CellsPosition.strandX,i=d>c?d+1:k.length;q<p;q++)if(a=n[q],!0===a.get("hidden"))for(e=a.get("alias"),m=c;m<i;m++)f=o[m].get("alias"),void 0!==g[e]&&void 0!==g[e][f]&&(h=l.models[g[e][f]],!0===h.get("hidden")&&this.addCell(h))},getCells:function(a,c){f.PackAjax({url:d.url.sheet.load,isPublic:!1,async:!1,data:JSON.stringify({sheetId:"1",top:a,bottom:c}),success:function(d){if(""!==d){d=d.returndata;var e=d.spreadSheet[0].sheet.cells;i.analysisCellData(e),h.insertPosi(a,c,b.cellRegionPosi.vertical)}}})},restoreCellView:function(a){this.addCell(a)},addCell:function(a){if(b.TempProp.isFrozen){var c,d,e,f,g=this.currentRule.displayPosition,h=g.startRowIndex,i=g.startColIndex,j=g.endRowIndex,k=g.endColIndex,l=a.get("physicsBox");if(c=l.top,e=c+l.height,d=l.left,f=d+l.width,e<n[h].get("top")||f<o[i].get("left"))return;if("number"==typeof j&&((j-=1)<0||c>n[j].get("top")))return;if("number"==typeof k&&((k-=1)<0||d>o[k].get("left")))return}this.cellView=new m({model:a,currentRule:this.currentRule}),this.$el.append(this.cellView.render().el)},destroy:function(){a.tigger("event:cellConainer:destroy"),a.off("event:contentCellsContainer:reloadCells"),a.off("event:contentCellsContainer:restoreCell"),a.off("event:restoreHideCellView"),a.off("event:contentCellsContainer:destroy"),this.remove()}})}),b("views/selectRegion",function(){var a=(c("lib/jquery"),c("lib/backbone")),b=c("basic/tools/template"),d=c("basic/util/clone"),e=(c("basic/util/binary"),c("basic/tools/cache")),f=c("spreadsheet/config"),g=(c("basic/tools/send"),c("models/cell"),c("basic/util/listener")),h=c("collections/headItemRow"),i=c("collections/headItemCol"),j=c("collections/siderLineRow"),k=c("collections/siderLineCol"),l=c("collections/cells"),m=c("entrance/tool/protect"),n=h.models,o=i.models;return a.View.extend({className:"selected-container",events:{dblclick:"editState"},initialize:function(b){this.viewCellsContainer=b.parentView,"selected"===this.model.get("selectType")&&a.on("event:selectRegion:patchOprCell",this.patchOprCell,this),a.on("event:selectRegionContainer:adapt",this.adapt,this),this.listenTo(this.model,"change:tempPosi",this.changePosi),this.listenTo(this.model,"change:physicsBox",this.changeBox),this.listenTo(this.model,"destroy",this.destroy),void 0!==b.currentRule?this.currentRule=b.currentRule:this.currentRule=d.clone(e.CurrentRule),this.userViewTop=e.TempProp.isFrozen?h.getModelByAlias(e.UserView.rowAlias).get("top"):0,this.userViewLeft=e.TempProp.isFrozen?i.getModelByAlias(e.UserView.colAlias).get("left"):0,this.offsetLeft=e.TempProp.isFrozen?this.currentRule.displayPosition.offsetLeft||0:0,this.offsetTop=e.TempProp.isFrozen?this.currentRule.displayPosition.offsetTop||0:0},render:function(){return this.template=b("SELECTTEMPLATE"),this.$el.html(this.template()),this.changeBox(),this},changeBox:function(){var a=this.model.toJSON(),b=a.physicsBox.height,c=a.physicsBox.width,d=a.physicsBox.left,e=a.physicsBox.top;a.showState;0===d?(d-=1,c-=1):c-=2,0===e?(e-=1,b-=1):b-=2,this.$el.css({width:c,height:b,left:d-this.offsetLeft-this.userViewLeft,top:e-this.offsetTop-this.userViewTop})},callView:function(a){var b=this;return function(c){b[a]=c}},changePosi:function(){var a,b,c,d,e,f,h,i,m,p=this.model.toJSON(),q=[],r=[],s={};if(e=l.getFullOperationRegion(p.tempPosi.initColIndex,p.tempPosi.initRowIndex,p.tempPosi.mouseColIndex,p.tempPosi.mouseRowIndex),a=e.startColIndex,b=e.startRowIndex,c=e.endColIndex,d=e.endRowIndex,f=o[c].get("width")+o[c].get("left")-o[a].get("left"),h=n[d].get("height")+n[d].get("top")-n[b].get("top"),"selected"===this.model.get("selectType")&&(this.changeHeadLineModel(a,b,c,d),j.models[0].set({top:n[b].get("top"),height:h}),k.models[0].set({left:o[a].get("left"),width:f})),this.model.set("physicsBox",{top:n[b].get("top"),left:o[a].get("left"),width:f,height:h}),i={startX:o[a].get("alias"),startY:n[b].get("alias"),endX:o[c].get("alias"),endY:n[d].get("alias")},"MAX"===p.tempPosi.mouseColIndex||"MAX"===p.tempPosi.initColIndex)i.endX="MAX",q.push("1"),q.push("MAX"),r.push(n[b].get("displayName")),r.push(n[d].get("displayName"));else if("MAX"===p.tempPosi.mouseRowIndex||"MAX"===p.tempPosi.initRowIndex)i.endY="MAX",r.push("1"),r.push("MAX"),q.push(o[a].get("displayName")),q.push(o[c].get("displayName"));else{for(m=a;m<c+1;m++)q.push(o[m].get("displayName"));for(m=b;m<d+1;m++)r.push(n[m].get("displayName"))}this.model.set("wholePosi",i),s.point={col:q,row:r},g.excute("regionChange",s),"selected"===p.selectType?g.excute("selectRegionChange",s):g.excute("dataSourceRegionChange",s)},changeHeadLineModel:function(a,b,c,d){var e,f,g,j,k,l=this.model.toJSON();for(e=h.getIndexByAlias(l.wholePosi.startY),f=i.getIndexByAlias(l.wholePosi.startX),g=h.getIndexByAlias(l.wholePosi.endY),j=i.getIndexByAlias(l.wholePosi.endX),g="MAX"!==g?g:h.length-1,j="MAX"!==j?j:i.length-1,k=e;k<=g;k++)n[k].set({activeState:!1});for(k=f;k<=j;k++)o[k].set({activeState:!1});for(k=b;k<=d;k++)n[k].set({activeState:!0});for(k=a;k<=c;k++)o[k].set({activeState:!0})},patchOprCell:function(a,b){function c(){return f=void 0===b.cellModel?l.getCellsByWholeSelectRegion():b.cellModel}var d,f,g,h,i,j,k=0;b=void 0===b||null===b?{cellModel:void 0,headModel:void 0}:b,c(),a=void 0===a||null===a?function(){}:a,g=void 0===b.headModel?l.getHeadModelByWholeSelectRegion():b.headModel,h=f.length;for(new Date;k<h;k++)d=c()[k],i=g[k],null===d&&(l.add({occupy:{x:[i.occupy.x],y:[i.occupy.y]},physicsBox:{top:i.physicsBox.top,left:i.physicsBox.left,width:i.physicsBox.width,height:i.physicsBox.height}}),e.cachePosition(i.occupy.y,i.occupy.x,l.length-1),j=l.models,d=j[j.length-1]),a(d)},editState:function(){var b,c,d,g,j=this.model.toJSON();e.mouseOperateState===f.mouseOperateState.select&&(b=h.getIndexByAlias(j.wholePosi.startY),c=i.getIndexByAlias(j.wholePosi.startX),d=h.getIndexByAlias(j.wholePosi.endY),g=i.getIndexByAlias(j.wholePosi.endX),m.interceptor({startRowIndex:b,startColIndex:c,endColIndex:g,endRowIndex:d})||a.trigger("event:InputContainer:show",!0))},destroy:function(){"selected"===this.model.get("selectType")&&a.off("event:selectRegion:patchOprCell"),a.off("event:selectRegionContainer:adapt"),this.remove()}})}),b("views/cellsContainer",function(){var a=c("lib/jquery"),b=c("lib/underscore"),d=c("lib/backbone"),e=c("basic/util/binary"),f=c("basic/tools/cache"),g=c("spreadsheet/config"),h=c("basic/util/clone"),i=c("models/cell"),j=c("basic/util/listener"),k=c("models/selectRegion"),l=c("collections/headItemCol"),m=c("collections/headItemRow"),n=c("collections/selectRegion"),o=c("collections/cells"),p=c("views/gridLineContainer"),q=c("views/contentCellsContainer"),r=c("views/selectRegion"),s=l.models,t=m.models;return d.View.extend({className:"cells-container",events:{mousedown:"mouseDownHandle",mousemove:"mouseMoveHandle",mouseout:"outHandle"},locatedState:null,moveState:null,initialize:function(a){d.on("event:cellsContainer:adaptWidth",this.adaptWidth,this),d.on("event:cellsContainer:adaptHeight",this.adaptHeight,this),d.on("event:cellsContainer:unBindDrag",this.unBindDragSelect,this),d.on("event:cellsContainer:bindDrag",this.bindDragSelect,this),d.on("event:cellsContainer:getCoordinateDisplayName",this.getCoordinateDisplayName,this),d.on("event:cellsContainer:destroy",this.destroy,this),d.on("event:cellsContainer:setMouseState",this.setMouseState,this),this.currentRule=h.clone(f.CurrentRule),!0===f.TempProp.isFrozen?(this.userViewTop=m.getModelByAlias(f.UserView.rowAlias).get("top"),this.userViewLeft=l.getModelByAlias(f.UserView.colAlias).get("left"),this.offsetTop=this.currentRule.displayPosition.offsetTop,this.offsetLeft=this.currentRule.displayPosition.offsetLeft):(this.userViewTop=0,this.userViewLeft=0,this.offsetTop=0,this.offsetLeft=0),this.listenTo(n,"add",this.addSelectRegionView),b.bindAll(this,"mouseDownHandle","mouseMoveHandle"),this.boxAttributes=a.boxAttributes,this.parentView=a.parentView,(!f.TempProp.isFrozen||this.currentRule.displayPosition.endRowIndex&&this.currentRule.displayPosition.endColIndex)&&d.on("event:cellsContainer:moveSelectRegion",this.moveSelectRegion,this),this.locatedState=this.selectLocatedState,this.moveState=this.commonMoveState,this.mouseCoordinate={},this.mouseLastCell=null,this.mouseOverEventId=null},mouseDownHandle:function(b){var c=a(".comment");c.length&&void 0===c.attr("disabled")||"edit-frame"!==a(b.target).attr("class")&&(f.commentEditState||this.locatedState(b))},mouseMoveHandle:function(b){var c=a(".comment");c.length&&void 0===c.attr("disabled")||"edit-frame"!==a(b.target).attr("class")&&this.moveState(b)},outHandle:function(){var b=a(".comment");b.length&&void 0===b.attr("disabled")||(clearTimeout(this.mouseOverEventId),this.mouseCoordinate={},this.mouseLastCell=null,d.trigger("event:bodyContainer:handleComment",{action:"hide"}))},render:function(){var a,b,c=n.models;for(this.$el.css({width:this.boxAttributes.width,height:this.boxAttributes.height}),this.gridLineContainer=new p,this.contentCellsContainer=new q,this.$el.append(this.gridLineContainer.render().el),this.$el.append(this.contentCellsContainer.render().el),a=c.length,b=0;b<a;b++)this.addSelectRegionView(c[b]);return this},adaptWidth:function(){var a,b,c=0,d=0;for(a=this.currentRule.displayPosition.endColIndex||s.length-1,b=a;b>-1;b--)if(!s[b].get("hidden")){d=s[b].get("left"),c=s[b].get("width");break}this.$el.css("width",d+c)},adaptHeight:function(){var a,b,c=this.userViewTop,d=this.offsetTop,e=0,f=0;for(a=this.currentRule.displayPosition.endRowIndex||t.length-1,b=a;b>-1;b--)if(!t[b].get("hidden")){f=t[b].get("top"),e=t[b].get("height");break}this.$el.css("height",f+e-c-d)},setMouseState:function(a,b){this[a]=this[b]},selectLocatedState:function(a){var b=n.getModelByType("selected");this.located(a.clientX,a.clientY,b,a.shiftKey),d.trigger("event:cellsContainer:setMouseState","moveState","selectMoveState"),d.trigger("event:colsHeadContainer:setMouseState","moveState",null)},dataSourceLocatedState:function(a){var b=n.getModelByType("datasource");void 0===b&&(b=new k,b.set("selectType","datasource"),n.add(b)),this.located(a.clientX,a.clientY,b,a.shiftKey),d.trigger("event:cellsContainer:setMouseState","moveState","dataSourceMoveState"),d.trigger("event:colsHeadContainer:setMouseState","moveState",null)},ruleSourceLocatedState:function(a){var b=n.getModelByType("rulesource");void 0===b&&(b=new k,b.set("selectType","rulesource"),n.add(b)),this.located(a.clientX,a.clientY,b,a.shiftKey),d.trigger("event:cellsContainer:setMouseState","moveState","ruleSourceMoveState"),d.trigger("event:colsHeadContainer:setMouseState","moveState",null)},selectMoveState:function(a){var b=n.getModelByType("selected");this.select(a.clientX,a.clientY,b)},dataSourceMoveState:function(a){var b=n.getModelByType("datasource");this.select(a.clientX,a.clientY,b)},ruleSourceMoveState:function(a){var b=n.getModelByType("rulesource");this.select(a.clientX,a.clientY,b)},commonMoveState:function(a){var b,c,e,f,g,h,i,j,k,l;h=this.getCoordinateByMouseEvent(a),e=h.rowIndex,c=h.colIndex,g=t[e].get("alias"),f=s[c].get("alias"),this.mouseCoordinate.colAlias===f&&this.mouseCoordinate.rowAlias===g||(b=o.getCellByVertical(c,e)[0],b=b||null,this.mouseLastCell!==b&&(this.mouseLastCell=b,b&&null!==(l=b.get("customProp").comment)&&void 0!==l?(j=b.get("occupy").x,k=b.get("occupy").y,i={colIndex:c+j.length-j.indexOf(f)-1,rowIndex:e-k.indexOf(g),comment:b.get("customProp").comment,action:"show"}):i={action:"hide"},clearTimeout(this.mouseOverEventId),"hide"===i.action?d.trigger("event:bodyContainer:handleComment",i):this.mouseOverEventId=setTimeout(function(){d.trigger("event:bodyContainer:handleComment",i)},400),this.mouseCoordinate={colAlias:f,rowAlias:g}))},getCoordinate:function(b,c){var d,h,i,j,k,l,m,n,o,p,q=f.containerId;if(d=b-g.System.outerLeft-a("#"+q).offset().left,h=c-g.System.outerTop-a("#"+q).offset().top,!0===f.TempProp.isFrozen){if(k=this.currentRule.displayPosition.endColIndex,l=this.currentRule.displayPosition.endRowIndex,m=k&&s[k].get("left")+s[k].get("width")-this.userViewLeft,n=l&&t[l].get("top")+t[l].get("height")-this.userViewTop,d<this.offsetLeft||k&&d>m)return;if(h<this.offsetTop||l&&h>n)return}return i=d+this.parentView.el.scrollLeft+this.userViewLeft,j=h+this.parentView.el.scrollTop+this.userViewTop,o=e.modelBinary(i,s,"left","width"),p=e.modelBinary(j,t,"top","height"),{colIndex:o,rowIndex:p,relativeRowPosi:j,relativeColPosi:i}},getCoordinateByMouseEvent:function(a){var b=a.clientX,c=a.clientY;return this.getCoordinate(b,c)},getCoordinateDisplayName:function(b,c,d){var e,h,i,j,k=f.containerId,l=this.currentRule.displayPosition,m=0,n=0;if(m=s[l.startColIndex].get("left"),n=t[l.startRowIndex].get("top"),void 0!==l.endColIndex&&(j=s[l.endColIndex].get("left")+s[l.endColIndex].get("width")),void 0!==l.endRowIndex&&(n=t[l.endRowIndex].get("top")+t[l.endRowIndex].get("height")),h=b-g.System.outerLeft-a("#"+k).offset().left,i=c-g.System.outerTop-a("#"+k).offset().top,!(h>j||h<m||i>void 0||i<n)){var e=this.getCoordinate(b,c);"function"==typeof d&&void 0!==e&&d({col:s[e.colIndex].get("displayName"),row:t[e.rowIndex].get("displayName")})}},moveSelectRegion:function(a){switch(a){case"LEFT":case"RIGHT":case"UP":break;case"DOWN":this.downSelectRegion()}},downSelectRegion:function(){var a,b,c;c=n.getModelByType("selected"),a=m.getIndexByAlias(c.get("wholePosi").endY),b=l.getIndexByAlias(c.get("wholePosi").startX),a!==m.length-1&&(c.set("tempPosi",{initColIndex:b,initRowIndex:a+1,mouseColIndex:b,mouseRowIndex:a+1}),d.trigger("event:mainContainer:showSelectRegion","DOWN"))},addSelectRegionView:function(a){var b,c;b=a.get("selectType")+"-container",c=new r({model:a,className:b,currentRule:this.currentRule,parentView:this}),this.$el.append(c.render().el)},located:function(a,b,c,d){d?this.select(a,b,c):this.changePosi(a,b,c)},changePosi:function(a,b,c){var d,e,g,h,k,l,n,p,q,r,u,v=f.CellsPosition.strandX,w=[],x=[],y="";g=this.getCoordinate(a,b),n=k=g.colIndex,p=l=g.rowIndex,q=s[k].get("alias"),r=t[l].get("alias"),v[q]&&void 0!==v[q][r]&&(h=o.models[v[q][r]],d=h.get("occupy").x,e=h.get("occupy").y,k-=d.indexOf(q),l-=e.indexOf(r),n=n+d.length-d.indexOf(q)-1,p=p+e.length-e.indexOf(r)-1,p=p<m.length?p:m.length-1,y=h.get("content.texts")),c.set("tempPosi",{initColIndex:k,initRowIndex:l,mouseColIndex:n,mouseRowIndex:p});var z={};for(u=k;u<n+1;u++)w.push(s[u].get("displayName"));for(u=l;u<p+1;u++)x.push(t[u].get("displayName"));z.point={col:w,row:x},z.text=y,z.property=function(a){var b;return void 0===a&&(a=new i),b=a.toJSON(),{size:b.content.size,family:b.content.family,bd:b.content.bd,italic:b.content.italic,color:b.content.color,alignRow:b.content.alignRow,alignCol:b.content.alignCol,background:b.customProp.background,format:b.customProp.format,wordWrap:b.wordWrap}}(h),j.excute("mousedown",z)},select:function(a,b,c){var d,e,f,g,h,i,c,j;j=this.getCoordinate(a,b),h=j.colIndex,i=j.rowIndex,d=c.get("tempPosi").initColIndex,e=c.get("tempPosi").initRowIndex,f=c.get("tempPosi").mouseColIndex,g=c.get("tempPosi").mouseRowIndex,f===h&&g===i||c.set("tempPosi",{initColIndex:d,initRowIndex:e,mouseColIndex:h,mouseRowIndex:i})},destroy:function(){var a,b,c=0;for(d.off("event:cellsContainer:destroy"),d.off("event:cellsContainer:adaptWidth"),d.off("event:cellsContainer:adaptHeight"),d.off("event:cellsContainer:moveSelectRegion"),d.off("event:cellsContainer:setMouseState"),d.trigger("event:contentCellsContainer:destroy"),b=n.models,a=b.length;c<a;c++)"selected"!==b[c].get("selectType")&&b[c].destroy();this.remove()}})}),b("views/mainContainer",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("basic/util/binary"),e=c("basic/tools/cache"),f=c("spreadsheet/config"),g=c("basic/tools/original"),h=c("basic/util/clone"),i=c("basic/tools/send"),j=c("basic/tools/loadrecorder"),k=c("collections/headItemCol"),l=c("collections/headItemRow"),m=c("collections/siderLineRow"),n=c("collections/cells"),o=c("collections/selectRegion"),p=c("views/cellsContainer"),q=l.models,r=k.models;return b.View.extend({initialize:function(a){var c,d,f,g,i,j,k,m,n;b.on("event:mainContainer:destroy",this.destroy,this),this.currentRule=h.clone(e.CurrentRule),!0===e.TempProp.isFrozen?(this.offsetTop=this.currentRule.displayPosition.offsetTop,this.userViewTop=l.getModelByAlias(e.UserView.rowAlias).get("top")):(this.offsetTop=0,this.userViewTop=0),this.boxModel={},this.boxAttributes=this.currentRule.boxAttributes,c=q,d=r,i=this.currentRule.displayPosition.startRowIndex,j=this.currentRule.displayPosition.startColIndex,k=this.currentRule.displayPosition.endRowIndex,m=this.currentRule.displayPosition.endColIndex,this.parentNode=a.parentNode,e.TempProp.isFrozen&&(c=k?c.slice(i,k):c.slice(i),d=m?d.slice(j,m):d.slice(j)),(n=c.length)?(f=c[n-1],this.boxModel.height=f.get("top")+f.get("height")-c[0].get("top")):this.boxModel.height=0,(n=d.length)?(g=d[n-1],this.boxModel.width=g.get("left")+g.get("width")-d[0].get("left")):this.boxModel.width=0,void 0===k&&b.on("event:changeSidebarContainer",this.shrink,this),this.currentRule.eventScroll?(this.delegateEvents({scroll:"syncScroll"}),b.on("call:mainContainer",this.callMainContainer,this),b.on("event:mainContainer:showSelectRegion",this.showSelectRegion,this),b.on("event:mainContainer:adaptRowHeightChange",this.adaptRowHeightChange,this),e.viewRegion.top=c[0].get("top"),e.viewRegion.bottom=f.get("top")+f.get("height"),e.viewRegion.scrollTop=0,e.viewRegion.scrollLeft=0,this.loadRowState="FULFILL"):b.on("event:mainContainer:appointPosition",this.appointPosition,this)},addBackGround:function(a){void 0!==this.currentRule.displayPosition.endColAlias&&void 0!==this.currentRule.displayPosition.endRowAlias?(this.$el.append('<div style="position:absolute;width:inherit;height:inherit;background-color:white;top:0;left:0;z-index:13"></div>'),a.$el.css({"z-index":"14"})):void 0===this.currentRule.displayPosition.endColAlias&&void 0===this.currentRule.displayPosition.endRowAlias||(this.$el.append('<div style="position:absolute;width:inherit;height:inherit;background-color:white;top:0;left:0;z-index:10"></div>'),a.$el.css({"z-index":"11"}))},render:function(){this.attributesRender(this.boxAttributes);var a=new p({boxAttributes:{height:this.boxModel.height,width:this.boxModel.width},parentView:this});return this.$el.append(a.render().el),this.addBackGround(a),this},shrink:function(){e.sidebarState?this.$el.width(this.boxAttributes.width-f.sidebarWidth):this.$el.width(this.boxAttributes.width)},subscribeScroll:function(a,b){this.appointPosition(a,b)},appointPosition:function(a,b){this.isPreventScroll=!1,"TRANSVERSE"===b&&this.$el.scrollLeft(a),"VERTICAL"===b&&this.$el.scrollTop(a)},callMainContainer:function(a){a(this)},attributesRender:function(a){var b=a.width;void 0===this.currentRule.displayPosition.endColIndex&&e.sidebarState&&(b-=f.sidebarWidth,b=b<0?0:b),this.$el.css({width:b,height:a.height}),a.style&&this.$el.addClass(a.style)},showSelectRegion:function(a){switch(a){case"LEFT":case"RIGHT":case"UP":break;case"DOWN":this.downScroll()}},downScroll:function(){var a,b,c,d;c=o.getModelByType("selected"),b=l.getModelByAlias(c.get("wholePosi").startY),a=b.get("top")+b.get("height"),(d=a-this.offsetTop-this.userViewTop-this.el.scrollTop-this.el.offsetHeight)>0&&(this.el.scrollTop+=d+17)},syncScroll:function(a,b){var c,d=e.viewRegion.scrollTop,f=e.viewRegion.scrollLeft,g=e.viewRegion.top,h=e.viewRegion.bottom;e.viewRegion.scrollTop=this.el.scrollTop,e.viewRegion.scrollLeft=this.el.scrollLeft,c=d-this.el.scrollTop,(c>0||"up"===b)&&(this.addTop(g),this.deleteBottom(h),this.publish("mainContainer","verticalPublish",this.el.scrollTop,"VERTICAL")),(c<0||"down"===b)&&(this.addBottom(h),this.deleteTop(g),this.publish("mainContainer","verticalPublish",this.el.scrollTop,"VERTICAL")),f!==this.el.scrollLeft&&this.publish("mainContainer","transversePublish",this.el.scrollLeft,"TRANSVERSE"),this.updateUserView()},deleteTop:function(a){var b,c,g,h,i,j,k,m,o,p,q=l.models;if(k=this.offsetTop,m=this.userViewTop,c=this.el.scrollTop-f.System.prestrainHeight+k+m,a<0&&(a=0),c<0&&(c=0),b=d.indexModelBinary(c,q,"top","height"),!((h=d.indexModelBinary(a,q,"top","height"))>=b)){for(o=h;o<b;o++)q[o].destroyView();for(i=n.getCellByRow(h,b-1),g=q[o].get("alias"),o=0,p=i.length;o<p;o++)j=i[o].get("occupy").y,-1===j.indexOf(g)&&i[o].hide();e.viewRegion.top=q[b].get("top")}},addTop:function(a){function b(a,b){var c,f,g,h,i,l,m;for(h=d.indexModelBinary(a,j,"top","height"),i=d.indexModelBinary(b,j,"top","height"),m=i;m>=h;m--)c=j[m],!1===c.get("isView")&&(c.set("isView",!0),k.publish("mainContainer","restoreRowView",c,"up"));for(g=n.getCellByRow(h,i),m=0,l=g.length;m<l;m++)f=g[m],!1===f.get("showState")&&(f.set("showState",!0),k.publish("mainContainer","restoreCellView",f));k.adjustColPropCell(h,i),e.viewRegion.top=j[h].get("top")}var c,g,h,i,j=l.models,k=this;h=this.offsetTop,i=this.userViewTop,c=this.el.scrollTop-f.System.prestrainHeight+h+i,c=c<0?0:c,g=this.el.scrollTop+this.el.offsetHeight+f.System.prestrainHeight+h+i,g=a<g?a:g,this.loadRegion(c,g,b)},deleteBottom:function(a){var b,c,g,h,i,j,k,m,o,p,q=l.models;if("PENDING"!==this.loadRowState){for(k=this.offsetTop,m=this.userViewTop,c=d.indexModelBinary(a,q,"top","height"),g=this.el.scrollTop+this.el.offsetHeight+f.System.prestrainHeight+k+m,h=d.indexModelBinary(g,q,"top","height"),i=q[h].get("alias"),o=h+1;o<=c;o++)q[o].set("isView",!1);for(j=n.getCellByRow(h+1,c),o=0,p=j.length;o<p;o++)b=j[o].get("occupy").y,-1===b.indexOf(i)&&j[o].hide();e.viewRegion.bottom=q[h].get("top")+q[h].get("height")}},addBottom:function(a){function b(a,b){var c,f,g,h,i,k,m,o;for(h=l.getMaxDistanceHeight(),h=h<b?h:b,i=d.indexModelBinary(a,q,"top","height"),k=d.indexModelBinary(h,q,"top","height"),m=i;m<=k;m++)c=q[m],!1===c.get("isView")&&(c.set("isView",!0),j.publish("mainContainer","restoreRowView",c,"down"));for(f=n.getCellByRow(i,k),m=0,o=f.length;m<o;m++)g=f[m],!1===g.get("showState")&&(g.set("showState",!0),j.publish("mainContainer","restoreCellView",g));h<b&&(b=j.addRows(b),k=d.indexModelBinary(b,q,"top","height")),j.adjustColPropCell(i,k),j.adaptSelectRegion(),e.viewRegion.bottom=q[k].get("top")+q[k].get("height"),j.adjustContainerHeight()}var c,g,h,i,j=this;"PENDING"!==this.loadRowState&&(h=this.offsetTop,i=this.userViewTop,c=this.el.scrollTop-f.System.prestrainHeight+h+i,g=c+this.el.offsetHeight+2*f.System.prestrainHeight,a>=g||(c=a+1>c?a+1:c,this.loadRegion(c,g,b)))},loadRegion:function(a,b,c){var d;if(a>e.localRowPosi||0===e.localRowPosi)return void c.call(this,a,b);b=b<e.localRowPosi?b:e.localRowPosi,d=j.isUnloadPosi(a,b,e.rowRegionPosi),d?this.doRequest(a,b,c):c.call(this,a,b)},doRequest:function(a,b,c){function h(f){var h,i,l,m,n,o;f&&(i=f.dataRowStartIndex,e.localRowPosi=f.maxRowPixel,l=f.returndata.spreadSheet[0].sheet.glY,m=f.returndata.spreadSheet[0].sheet.cells,n=f.returndata.spreadSheet[0].validate,g.analysisRowData(l,i),g.analysisCellData(m),g.analysisValidateRule(n.rules),o=d.indexModelBinary(a,q,"top","height"),h=d.indexModelBinary(b,q,"top","height"),a=q[o].get("top"),b=q[h].get("top")+q[h].get("height"),j.insertPosi(a,b,e.rowRegionPosi),c.call(k,a,b),k.loadRowState="FULFILL")}var k=this;this.loadRowState="PENDING",b+=e.scrollBufferHeight,i.PackAjax({url:f.url.sheet.load,isPublic:!1,dataType:"json",data:JSON.stringify({top:a,bottom:b}),success:h})},adaptSelectRegion:function(){var a,b,c,e,f,g=o.getModelByType("selected"),h=l.models,i=g.get("wholePosi").endX,j=g.get("wholePosi").endY;if("MAX"===i||"MAX"===j)for("MAX"===j&&(b=g.get("physicsBox").height,a=d.modelBinary(b-1,h,"top","height",0,h.length-1),c=l.length,f=l.models[c-1],b=f.get("top")+f.get("height")-1,g.set("physicsBox.height",b),m.models[0].set({height:b})),e=a+1;e<c;e++)h[e].set("activeState",!0)},adaptRowHeightChange:function(a,b){0!==e.localRowPosi&&(e.localRowPosi+=b,j.adaptPosi(a,b,e.rowRegionPosi)),e.viewRegion.top>a&&(e.viewRegion.top+=b,b>0?this.addTop(e.viewRegion.top):this.deleteTop(e.viewRegion.top)),e.viewRegion.bottom>a&&(e.viewRegion.bottom+=b,e.viewRegion.bottom<e.viewRegion.top&&(e.viewRegion.top=e.viewRegion.bottom),b>0?this.deleteBottom(e.viewRegion.bottom):this.addBottom(e.viewRegion.bottom)),this.updateUserView()},updateUserView:function(){if(!e.TempProp.isFrozen){var a,b,c,d;a=l.getModelByPosition(this.el.scrollTop),b=l.getModelByPosition(this.el.scrollTop+this.el.offsetHeight),e.UserView.rowAlias=a.get("alias"),e.UserView.rowEndAlias=b.get("alias"),c=k.getModelByPosition(e.viewRegion.scrollLeft),d=k.getModelByPosition(e.viewRegion.scrollLeft+this.el.offsetWidth),e.UserView.colAlias=c.get("alias"),e.UserView.colEndAlias=d.get("alias")}},addRows:function(a){var b,c=l.getMaxDistanceHeight(),d=e.localRowPosi,g=l.length;return a<=c||a<=d?a:(c=c>d?c:d,b=Math.ceil((a+e.scrollBufferHeight-c)/f.User.cellHeight),l.generate(b),i.PackAjax({url:f.url.row.plusBatch,data:JSON.stringify({num:b})}),this.adjustColPropCell(g,g+b-1),a=l.getMaxDistanceHeight())},adjustColPropCell:function(b,c){var d,f,g,h,i,j,k,l=0;for(j=r.length,h=e.CellsPosition.strandX;l<j;l++)if(d=r[l],i=d.get("operProp"),!a.isEmptyObject(i))for(k=b;k<c+1;k++)f=r[l].get("alias"),g=q[k].get("alias"),void 0!==h[f]&&void 0!==h[f][g]||n.createCellModel(l,k,i)},adjustContainerHeight:function(){b.trigger("event:cellsContainer:adaptHeight"),b.trigger("event:rowsAllHeadContainer:adaptHeight")},destroy:function(){this.unsubscribe&&(this.unsubscribe("mainContainer","transversePublish"),this.unsubscribe("mainContainer","verticalPublish")),b.trigger("event:cellsContainer:destroy"),b.off("call:mainContainer"),b.off("event:mainContainer:destroy"),b.off("event:mainContainer:adaptRowHeightChange"),b.off("event:mainContainer:showSelectRegion"),b.off("event:mainContainer:appointPosition"),b.off("event:changeSidebarContainer"),this.remove()}})}),b("views/headItemColContainer",function(){var a=(c("lib/jquery"),c("lib/backbone")),b=c("basic/tools/template"),d=c("collections/headItemCol"),e=c("basic/tools/cache"),f=c("basic/util/clone");return a.View.extend({className:"col-head-item",initialize:function(){this.listenTo(this.model,"change:activeState",this.toggleActive),this.listenTo(this.model,"change:isView",this.destroy),this.listenTo(this.model,"change:hidden",this.destroy),this.listenTo(this.model,"change:left",this.changeLeft),this.listenTo(this.model,"change:width",this.changeWidth),this.listenTo(this.model,"change:displayName",this.changeDisplayName),this.listenTo(this.model,"change:isLeftAjacentHide",this.changeLeftAjacentHide),this.listenTo(this.model,"change:isRightAjacentHide",this.changeRightAjacentHide),this.listenTo(this.model,"destroy",this.remove),this.currentRule=f.clone(e.CurrentRule),this.offsetLeft=e.TempProp.isFrozen?this.currentRule.displayPosition.offsetLeft||0:0},render:function(){return this.template=b("COLHEADTEMPLATE"),this.changeLeft(),this.changeRightAjacentHide(),this.$el.html(this.template(this.model.toJSON())).data("alias",this.model.get("alias")),this.toggleActive(),this},toggleActive:function(){this.$el.toggleClass("active",this.model.toJSON().activeState)},changeLeft:function(){var a,b=this.model.toJSON(),c=b.left,f=0;this.currentRule.reduceUserView&&(a=d.getModelByAlias(e.UserView.colAlias),f=a.toJSON().left),b.isLeftAjacentHide&&c++,this.$el.css({left:c-this.offsetLeft-f})},changeWidth:function(){var a=this.model.toJSON(),b=a.width;a.isLeftAjacentHide&&b--,a.isRightAjacentHide&&b--,this.$el.css({width:b})},changeRightAjacentHide:function(){this.model.toJSON().isRightAjacentHide?(this.changeWidth(),this.$el.css({"border-right":"3px double #d4d4d4"})):(this.changeWidth(),this.$el.removeAttr("border-right"))},changeLeftAjacentHide:function(){this.changeWidth(),this.changeLeft()},changeDisplayName:function(){this.$el.children(".item").html(this.model.get("displayName"))},changeView:function(){!1===this.model.toJSON().isView&&this.destroy()},destroy:function(){this.model.get("isView")&&!this.model.get("hidden")||this.remove()}})}),b("views/colsSpaceLineContainer",function(){var a=c("lib/backbone");return a.View.extend({className:"col-space-container",initialize:function(b){a.on("call:colsSpaceLineContainer",this.callColsSpaceLineContainer,this),a.on("event:colsSpaceLineContainer:destroy",this.destroy,this),this.boxAttributes=b.boxAttributes},render:function(){
return this.attributesRender(this.boxAttributes),this},callColsSpaceLineContainer:function(a){a(this)},attributesRender:function(a){this.$el.css({left:a.left})},destroy:function(){this.remove()}})}),b("views/colsHeadContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=c("spreadsheet/config"),e=c("basic/util/binary"),f=c("basic/tools/cache"),g=c("basic/tools/send"),h=c("basic/tools/getdisplayname"),i=c("models/selectRegion"),j=c("collections/headItemRow"),k=c("collections/headItemCol"),l=c("collections/cells"),m=c("collections/selectRegion"),n=(c("collections/siderLineRow"),c("collections/siderLineCol")),o=c("views/headItemColContainer"),p=c("views/colsSpaceLineContainer"),q=(j.models,k.models);return b.View.extend({className:"col-head-panel",locatedState:null,moveState:null,initialize:function(){f.TempProp.isFrozen||this.delegateEvents({"mousedown .col-head-item":"locatedHandle","mousemove .col-head-item":"moveHandle"}),b.on("event:colsHeadContainer:relaseSpaceEffect",this.relaseSpaceEffect,this),b.on("event:colWidthAdjust",this.colWidthAdjust,this),b.on("event:restoreHideCols",this.restoreHideCols,this),b.on("event:colsHeadContainer:setMouseState",this.setMouseState,this),this.colNumber=0,this.listenTo(k,"add",this.addColsHeadContainer),this.moveState=this.commonMoveState,this.locatedState=this.selectLocatedState},render:function(){var a,b,c,d,e=0,g=k;for(a=b=g.models,f.TempProp.isFrozen&&(this.currentRule=f.CurrentRule,b=void 0!==this.currentRule.displayPosition.endIndex?a.slice(this.currentRule.displayPosition.startIndex,this.currentRule.displayPosition.endColIndex):a.slice(this.currentRule.displayPosition.startIndex)),c=b.length;e<c;e++)b[e].get("hidden")||this.addColsHeadContainer(b[e]),this.colNumber++;return d=g.where({activeState:!0}),0===d.length&&a[0].set("activeState",!0),this},moveHandle:function(a){this.moveState&&this.moveState(a)},locatedHandle:function(a){this.locatedState(a)},setMouseState:function(a,b){this[a]=null!==b?this[b]:null},selectLocatedState:function(a){if(this._isAdjustable(a)&&!a.shiftKey&&!f.protectState)return void this.spaceEffect(a);var c,d=m.getModelByType("selected");f.containerId;c=this._getRelativePosi(event.clientX),this.adjustLocatedModel(c,d,a.shiftKey),b.trigger("event:cellsContainer:setMouseState","moveState","selectMoveState"),b.trigger("event:colsHeadContainer:setMouseState","moveState","selectMoveState")},dataSourceLocatedState:function(a){var c,d=m.getModelByType("datasource");void 0===d&&(d=new i,d.set("selectType","datasource"),m.add(d)),c=this._getRelativePosi(a.clientX),this.adjustLocatedModel(c,d,a.shiftKey),b.trigger("event:cellsContainer:setMouseState","moveState","dataSourceMoveState"),b.trigger("event:colsHeadContainer:setMouseState","moveState","dataSourceMoveState")},ruleSourceLocatedState:function(a){var c,d=m.getModelByType("rulesource");void 0===d&&(d=new i,d.set("selectType","rulesource"),m.add(d)),c=this._getRelativePosi(a.clientX),this.adjustLocatedModel(c,d,a.shiftKey),b.trigger("event:cellsContainer:setMouseState","moveState","ruleSourceMoveState"),b.trigger("event:colsHeadContainer:setMouseState","moveState","ruleSourceMoveState")},selectMoveState:function(a){var b,c,d=m.getModelByType("selected");b=this._getRelativePosi(a.clientX),c=e.modelBinary(b,q,"left","width"),d.set("tempPosi.mouseColIndex",c)},dataSourceMoveState:function(a){var b,c,d=m.getModelByType("datasource");b=this._getRelativePosi(a.clientX),c=e.modelBinary(b,q,"left","width"),d.set("tempPosi.mouseColIndex",c)},ruleSourceMoveState:function(a){var b,c,d=m.getModelByType("rulesource");b=this._getRelativePosi(a.clientX),c=e.modelBinary(b,q,"left","width"),d.set("tempPosi.mouseColIndex",c)},commonMoveState:function(a){a.currentTarget.style.cursor=!0!==this._isAdjustable(a)||f.protectState?"":"col-resize"},adjustLocatedModel:function(a,b,c){var d,f,g;f=e.modelBinary(a,q,"left","width"),g=b.get("wholePosi"),d=c?k.getIndexByAlias(g.startX):f,b.set("tempPosi",{initColIndex:d,initRowIndex:"MAX",mouseColIndex:f,mouseRowIndex:0})},_isAdjustable:function(b){var c=this.itemEl||b.currentTarget;return b.pageX-a(c).offset().left>c.clientWidth-d.System.effectDistanceCol},_getRelativePosi:function(b){var c=f.containerId;return b-a("#"+c).offset().left-d.System.outerLeft+f.viewRegion.scrollLeft},spaceEffect:function(c){this.itemEl=c.currentTarget,this.$itemEl=a(this.itemEl),this.cacheItemElOffsetWidth=this.itemEl.offsetWidth,this.$lockData=a(".col-head-item:gt("+this.$itemEl.index()+")",this.el),this.$tempSpaceContainer=a("<div/>").addClass("temp-space-container").html(this.$lockData),this.$el.append(this.$tempSpaceContainer),b.trigger("event:screenContainer:mouseMoveHeadContainer",{spaceMouse:this.itemEl.clientWidth-c.offsetX,offsetleftByRight:this.itemEl.clientWidth+this.$itemEl.offset().left,self:this},this.moveEvent),this.colsSpaceLineContainer=new p({boxAttributes:{left:this.itemEl.offsetLeft+this.itemEl.clientWidth}}),a(".line-container").append(this.colsSpaceLineContainer.render().el)},relaseSpaceEffect:function(a){var b,c,d;this.$lockData&&(b=k.getIndexByAlias(this.$itemEl.data("alias")),d=this.itemEl.offsetWidth-this.cacheItemElOffsetWidth,c=d+k.models[b].get("width"),this.colWidthAdjust(b,c),this.$el.append(this.$lockData),this.$tempSpaceContainer.remove(),this.itemEl=this.$itemEl=this.$lockData=null)},colWidthAdjust:function(a,c){var d=c-k.models[a].get("width");this.adjustHeadLine(a,d),this.adjustCells(a,d),this.adjustSelectRegion(a,d),this.requstAdjust(a,c),b.trigger("event:cellsContainer:adaptWidth"),b.trigger("event:colsAllHeadContainer:adaptWidth")},restoreHideCols:function(){for(var a=k.models,b=a.length,c=0;c<b;c++)a[c].get("hidden")&&this.addColsHeadContainer(a[c])},requstAdjust:function(a,b){var c=k.models[a].get("sort");g.PackAjax({url:d.url.col.adjust,data:JSON.stringify({sheetId:"1",col:c,offset:b})})},moveEvent:function(a){var b=a.data,c=a.pageX+b.spaceMouse,e=parseInt(c-b.self.$itemEl.offset().left,0);e<d.System.effectDistanceCol||(b.self.$itemEl.css("width",e),b.self.$tempSpaceContainer.css("left",parseInt(c-b.offsetleftByRight,0)),b.self.colsSpaceLineContainer.attributesRender({left:parseInt(c-b.self.$el.offset().left,0)}))},addColsHeadContainer:function(a){this.headItemColContainer=new o({model:a}),this.$el.append(this.headItemColContainer.render().el)},createHeadItemCol:function(){k.add(this.newAttrCol())},newAttrCol:function(){return{alias:(this.colNumber+1).toString(),left:this.colNumber*d.User.cellWidth,width:d.User.cellWidth-1,displayName:h.getColDisplayName(this.colNumber)}},callView:function(a){var b=this;return function(c){b[a]=c}},adjustHeadLine:function(a,b){var c,d,e,f,g;for(e=k.models,f=e[a].get("width"),e[a].set("width",f+b),d=e.length,c=a+1;c<d;c++)g=e[c].get("left"),e[c].set("left",g+b)},adjustCells:function(a,b){var c,d,e,f,g,h;for(c=l.getCellsByColIndex(a,a),h=c.length,e=0;e<h;e++)c[e].set("physicsBox.width",c[e].get("physicsBox").width+b);for(g=k.length,d=l.getCellsInStartColRegion(a+1,g-1),h=d.length,f=0;f<h;f++)d[f].set("physicsBox.left",d[f].get("physicsBox").left+b)},adjustSelectRegion:function(a,b){var c,d,e,f,g,h,i,j;g=m.models[0],c=g.get("wholePosi").startX,d=g.get("wholePosi").endX,e=k.getIndexByAlias(c),(f=k.getIndexByAlias(d))<a||(h=n.models[0],e<=a?(i=g.get("physicsBox").width,g.set("physicsBox.width",i+b),h.set("width",i+b)):(j=g.get("physicsBox").left,g.set("physicsBox.left",j+b),h.set("left",j+b)))},destroy:function(){b.off("call:colsHeadContainer"),b.off("event:colsHeadContainer:relaseSpaceEffect"),b.off("event:colWidthAdjust"),b.off("event:restoreHideCols"),b.off("event:colsHeadContainer:setMouseState"),this.undelegateEvents(),this.headItemColContainer.destroy(),this.remove()}})}),b("views/siderLineColContainer",function(){var a=c("lib/backbone"),b=c("basic/tools/cache"),d=c("basic/util/clone"),e=c("collections/headItemCol");return a.View.extend({className:"col-head-line",initialize:function(){var a;this.listenTo(this.model,"change",this.render),this.currentRule=d.clone(b.CurrentRule),a=e,this.userViewLeft=b.TempProp.isFrozen?a.getModelByAlias(b.UserView.colAlias).get("left"):0,this.offsetLeft=b.TempProp.isFrozen?this.currentRule.displayPosition.offsetLeft||0:0},render:function(){var a=this.model.toJSON();return this.$el.css({left:a.left-this.offsetLeft-this.userViewLeft,width:a.width-2}),this},destroy:function(){this.remove()}})}),b("views/colsAllHeadContainer",function(){var a=c("lib/backbone"),b=c("collections/siderLineCol"),d=c("collections/headItemCol"),e=c("spreadsheet/config"),f=c("views/colsHeadContainer"),g=c("views/siderLineColContainer");return a.View.extend({className:"col-head-bg col-head-height",initialize:function(c){a.on("call:colsAllHeadContainer",this.callColsAllHeadContainer,this),a.on("event:colsAllHeadContainer:adaptWidth",this.adaptWidth,this),this.listenTo(b,"add",this.addSiderLineCol),this.boxAttributes=c.boxAttributes},render:function(){var a,c=b.models,d=c.length;if(this.colsHeadContainer=new f,this.attributesRender(this.boxAttributes),this.$el.append(this.colsHeadContainer.render().el),0===d)this.createSiderLineCol();else for(a=d-1;a>=0;a--)this.addSiderLineCol(c[a]);return this},callColsAllHeadContainer:function(a){a(this)},attributesRender:function(a){-1!==a.width&&this.$el.css({width:a.width})},adaptWidth:function(){var a=d.length,b=d.models[a-1].get("width"),c=d.models[a-1].get("left");this.$el.css({width:c+b})},addSiderLineCol:function(a){this.siderLineColContainer=new g({model:a}),this.$el.append(this.siderLineColContainer.render().el)},createSiderLineCol:function(){b.add({left:0,width:e.User.cellWidth-1})},destroy:function(){a.off("call:colsAllHeadContainer"),a.off("event:colsAllHeadContainer:adaptWidth"),this.colsHeadContainer.destroy(),this.remove()}})}),b("views/colsPanelContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=c("basic/tools/cache"),d=c("spreadsheet/config"),e=(c("basic/util/clone"),c("collections/headItemCol")),f=c("views/colsAllHeadContainer");return a.View.extend({className:"col-head-container",initialize:function(c){var d,f,g,h;if(a.on("call:colsPanelContainer",this.colsPanelContainer,this),a.on("event:colsPanelContainer:destroy",this.destroy,this),a.trigger("event:colsPanelContainer:adjustWidth",this.adjustWidth,this),this.boxModel={},this.cacheDiffDistance=0,this.currentRule=b.CurrentRule,this.boxAttributes=this.currentRule.boxAttributes,f=d=e.models,b.TempProp.isFrozen&&(f=this.currentRule.displayPosition.endIndex?d.slice(this.currentRule.displayPosition.startIndex,this.currentRule.displayPosition.endIndex):d.slice(this.currentRule.displayPosition.startIndex)),0===(h=f.length))return void(this.boxModel.width=0);void 0===this.currentRule.displayPosition.endRowIndex&&a.on("event:changeSidebarContainer",this.shrink,this),g=f[h-1],this.boxModel.width=this.currentRule.autoScroll?g.get("left")+g.get("width")-f[0].get("left"):-1},render:function(){return this.colsAllHeadContainer=new f({boxAttributes:{width:this.boxModel.width}}),this.attributesRender(this.boxAttributes),this.$el.html(this.colsAllHeadContainer.render().el),this},colsPanelContainer:function(a){a(this)},attributesRender:function(a){-1===a.width?this.$el.css({width:0}):this.$el.css({width:a.width}),a.style&&this.$el.addClass(a.style)},shrink:function(){b.sidebarState?this.$el.width(this.boxAttributes.width-d.sidebarWidth):this.$el.width(this.boxAttributes.width)},scrollToPosition:function(a){this.$el.scrollLeft(a)},destroy:function(){this.unsubscribe&&this.unsubscribe("mainContainer","transversePublish"),a.off("call:colsPanelContainer"),a.off("event:colsPanelContainer:destroy"),this.colsAllHeadContainer.destroy(),this.remove()}})}),b("views/rowsSpaceLineContainer",function(){var a=c("lib/backbone");return a.View.extend({className:"row-space-container",initialize:function(b){a.on("call:rowsSpaceLineContainer",this.callRowsSpaceLineContainer,this),a.on("event:rowsSpaceLineContainer:destroy",this.destroy,this),this.boxAttributes=b.boxAttributes},render:function(){return this.attributesRender(this.boxAttributes),this},callRowsSpaceLineContainer:function(a){a(this)},attributesRender:function(a){this.$el.css({top:a.top})},destroy:function(){this.remove()}})}),b("views/headItemRowContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=c("basic/tools/template"),d=c("collections/headItemRow"),e=c("basic/tools/cache");c("basic/util/clone"),c("spreadsheet/config");return a.View.extend({className:"row-head-item",initialize:function(a){this.listenTo(this.model,"change:activeState",this.toggleActive),this.listenTo(this.model,"change:top",this.changeTop),this.listenTo(this.model,"change:height",this.changeHeight),this.listenTo(this.model,"change:displayName",this.changeDisplayName),this.listenTo(this.model,"destroy",this.remove),this.offsetTop=e.TempProp.isFrozen?a.frozenTop||0:0,this.reduceUserView=a.reduceUserView,this.endIndex=a.endIndex,!0===e.TempProp.isFrozen&&void 0!==this.endIndex||this.listenTo(this.model,"change:isView",this.destroy)},render:function(){return this.template=b("ROWHEADTEMPLATE"),this.changeTop(),this.changeHeight(),this.$el.html(this.template(this.model.toJSON())).data("alias",this.model.get("alias")),this.toggleActive(),this},toggleActive:function(){this.$el.toggleClass("active",this.model.toJSON().activeState)},changeTop:function(){var a,b=0;e.TempProp.isFrozen&&(a=d.getModelByAlias(e.UserView.rowAlias),b=a.toJSON().top),this.$el.css({top:this.model.toJSON().top-this.offsetTop-b})},changeHeight:function(){this.$el.css({height:this.model.toJSON().height})},changeDisplayName:function(){this.$el.children(".item").html(this.model.get("displayName"))},destroy:function(){this.remove()}})}),b("views/rowsHeadContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=c("spreadsheet/config"),e=c("basic/tools/cache"),f=c("basic/util/binary"),g=c("basic/tools/send"),h=c("basic/tools/getdisplayname"),i=c("collections/headItemRow"),j=c("collections/headItemCol"),k=c("collections/cells"),l=c("collections/selectRegion"),m=c("collections/siderLineRow"),n=(c("collections/siderLineCol"),c("views/rowsSpaceLineContainer")),o=c("views/headItemRowContainer"),p=c("models/selectRegion"),q=c("basic/util/observer.pattern"),r=(c("basic/tools/loadrecorder"),i.models);j.models;return b.View.extend({className:"row-head-panel",initialize:function(a){e.TempProp.isFrozen||this.delegateEvents({"mousedown .row-head-item":"locatedHandle","mousemove .row-head-item":"moveHandle"}),b.on("event:rowsHeadContainer:relaseSpaceEffect",this.relaseSpaceEffect,this),b.on("event:rowHeightAdjust",this.rowHeightAdjust,this),b.on("event:rowsHeadContainer:setMouseState",this.setMouseState,this),b.on("event:rowsHeadContainer:destroy",this.destroy,this),this.rowNumber=0,this.currentRule=e.CurrentRule,void 0===this.currentRule.displayPosition.endIndex&&(this.listenTo(i,"add",this.addRowsHeadContainer),q.buildSubscriber(this),this.subscribe("mainContainer","restoreRowView","restoreRowView")),this.moveState=this.commonMoveState,this.locatedState=this.selectLocatedState},render:function(){var a,b,c,d,f=0,g=i;for(a=b=g.models,e.TempProp.isFrozen&&(b=void 0!==this.currentRule.displayPosition.endIndex?a.slice(this.currentRule.displayPosition.startIndex,this.currentRule.displayPosition.endIndex):a.slice(this.currentRule.displayPosition.startIndex)),c=b.length;f<c;f++)this.addRowsHeadContainer(b[f]),this.rowNumber++;return d=g.where({activeState:!0}),0===d.length&&a[0].set("activeState",!0),this},moveHandle:function(a){this.moveState&&this.moveState(a)},locatedHandle:function(a){this.locatedState(a)},setMouseState:function(a,b){this[a]=null!==b?this[b]:null},selectLocatedState:function(a){if(this._isAdjustable(a)&&!a.shiftKey&&!e.protectState)return void this.spaceEffect(a);var c,d=l.getModelByType("selected");e.containerId;c=this._getRelativePosi(event.clientY),this.adjustLocatedModel(c,d,a.shiftKey),b.trigger("event:cellsContainer:setMouseState","moveState","selectMoveState"),b.trigger("event:rowsHeadContainer:setMouseState","moveState","selectMoveState")},dataSourceLocatedState:function(a){var c,d=l.getModelByType("datasource");void 0===d&&(d=new p,d.set("selectType","datasource"),l.add(d)),c=this._getRelativePosi(a.clientY),this.adjustLocatedModel(c,d,a.shiftKey),b.trigger("event:cellsContainer:setMouseState","moveState","dataSourceMoveState"),b.trigger("event:rowsHeadContainer:setMouseState","moveState","dataSourceMoveState")},ruleSourceLocatedState:function(){var a,c=l.getModelByType("rulesource");void 0===c&&(c=new p,c.set("selectType","rulesource"),l.add(c)),a=this._getRelativePosi(event.clientY),this.adjustLocatedModel(a,c,event.shiftKey),b.trigger("event:cellsContainer:setMouseState","moveState","ruleSourceMoveState"),b.trigger("event:rowsHeadContainer:setMouseState","moveState","ruleSourceMoveState")},selectMoveState:function(a){var b,c,d=l.getModelByType("selected");b=this._getRelativePosi(a.clientY),c=f.modelBinary(b,r,"top","height"),d.set("tempPosi.mouseRowIndex",c)},dataSourceMoveState:function(a){var b,c,d=l.getModelByType("datasource");b=this._getRelativePosi(a.clientY),c=f.modelBinary(b,r,"top","height"),d.set("tempPosi.mouseRowIndex",c)},ruleSourceMoveState:function(a){var b,c,d=l.getModelByType("rulesource");b=this._getRelativePosi(a.clientY),c=f.modelBinary(b,r,"top","height"),d.set("tempPosi.mouseRowIndex",c)},commonMoveState:function(a){a.currentTarget.style.cursor=!0!==this._isAdjustable(a)||e.protectState?"":"row-resize"},adjustLocatedModel:function(a,b,c){var d,e,g;e=f.modelBinary(a,r,"top","height"),g=b.get("wholePosi"),d=c?i.getIndexByAlias(g.startY):e,b.set("tempPosi",{initColIndex:"MAX",initRowIndex:d,mouseColIndex:0,mouseRowIndex:e})},_isAdjustable:function(b){var c=this.itemEl||b.currentTarget;return b.pageY-a(c).offset().top>c.clientHeight-d.System.effectDistanceRow},_getRelativePosi:function(b){var c=e.containerId;return b-a("#"+c).offset().top-d.System.outerTop+e.viewRegion.scrollTop},spaceEffect:function(c){this.itemEl=c.currentTarget,this.cacheItemElOffsetHeight=this.itemEl.offsetHeight,this.$itemEl=a(this.itemEl),this.$lockData=a(".row-head-item:gt("+this.$itemEl.index()+")",this.el),this.$tempSpaceContainer=a("<div/>").addClass("temp-space-container").html(this.$lockData),this.$el.append(this.$tempSpaceContainer),b.trigger("event:screenContainer:mouseMoveHeadContainer",{spaceMouse:this.itemEl.clientHeight-c.offsetY,offsetTopByBottom:this.itemEl.clientHeight+this.$itemEl.offset().top,self:this},this.moveEvent),this.rowsSpaceLineContainer=new n({boxAttributes:{top:this.itemEl.offsetTop+this.itemEl.clientHeight}}),a(".line-container").append(this.rowsSpaceLineContainer.render().el)},moveEvent:function(a){var b=a.data,c=a.pageY+b.spaceMouse,e=parseInt(c-b.self.$itemEl.offset().top,0);e<d.System.effectDistanceRow||(b.self.$itemEl.css("height",e),b.self.$tempSpaceContainer.css("top",parseInt(c-b.offsetTopByBottom,0)),b.self.rowsSpaceLineContainer.attributesRender({top:parseInt(c-b.self.$el.offset().top,0)}))},relaseSpaceEffect:function(a){var b,c,d,e;this.$lockData&&(c=i.models,c.length,d=i.getIndexByAlias(this.$itemEl.data("alias")),e=this.itemEl.offsetHeight-this.cacheItemElOffsetHeight,b=e+i.models[d].get("height"),this.$el.append(this.$lockData),this.$tempSpaceContainer.remove(),this.itemEl=this.$itemEl=this.$lockData=null,this.rowHeightAdjust(d,b))},rowHeightAdjust:function(a,c){var d=c-i.models[a].get("height"),e=i.models[a].get("top");this.adjustHeadLine(a,d),this.adjustCells(a,d),this.adjustSelectRegion(a,d),this.requstAdjust(a,c),b.trigger("event:rowsAllHeadContainer:adaptHeight"),b.trigger("event:cellsContainer:adaptHeight"),b.trigger("event:mainContainer:adaptRowHeightChange",e,d)},requstAdjust:function(a,b){var c=i.models[a].get("sort");g.PackAjax({url:d.url.row.adjust,data:JSON.stringify({sheetId:"1",row:c,offset:b})})},restoreRowView:function(a,b){var c=this.currentRule.displayPosition.endIndex,d=this.currentRule.displayPosition.startIndex,f=i.models,g=a.get("top");if(e.TempProp.isFrozen){if(g<f[d].get("top"))return;if("number"==typeof c){if(0===c)return;if(g>f[c-1].get("top"))return}}this.addRowsHeadContainer(a,b)},addRowsHeadContainer:function(a,b){this.headItemRowContainer=new o({model:a,frozenTop:this.currentRule.displayPosition.offsetTop,reduceUserView:this.currentRule.reduceUserView,endIndex:this.currentRule.displayPosition.endIndex}),"up"!==b?this.$el.append(this.headItemRowContainer.render().el):this.$el.prepend(this.headItemRowContainer.render().el)},createHeadItemRow:function(){i.add(this.newAttrRow())},newAttrRow:function(){return{alias:(this.rowNumber+1).toString(),top:20*this.rowNumber,height:19,displayName:h.getRowDisplayName(this.rowNumber)}},adjustHeadLine:function(a,b){var c,d,e,f,g;for(e=i.models,f=e[a].get("height"),e[a].set("height",f+b),d=e.length,c=a+1;c<d;c++)g=e[c].get("top"),e[c].set("top",g+b)},adjustCells:function(a,b){var c,d,e,f,g,h,j=k;for(c=j.getCellByRow(a,a),h=c.length,e=0;e<h;e++)c[e].set("physicsBox.height",c[e].get("physicsBox").height+b);for(g=i.length,d=j.getCellsInStartRowRegion(a+1,g-1),h=d.length,f=0;f<h;f++)d[f].set("physicsBox.top",d[f].get("physicsBox").top+b)},adjustSelectRegion:function(a,b){var c,d,e,f,g,h,j,k;g=l.models[0],e=g.get("wholePosi").startY,f=g.get("wholePosi").endY,c=i.getIndexByAlias(e),(d=i.getIndexByAlias(f))<a||(h=m.models[0],c<=a?(j=g.get("physicsBox").height,g.set("physicsBox.height",j+b),h.set("height",j+b)):(k=g.get("physicsBox").top,g.set("physicsBox.top",k+b),h.set("top",k+b)))},destroy:function(){b.off("event:rowsHeadContainer:destroy"),b.off("call:rowsHeadContainer"),b.off("event:rowsHeadContainer:relaseSpaceEffect"),b.off("event:rowsHeadContainer:setMouseState"),b.off("event:rowHeightAdjust"),this.undelegateEvents(),this.remove()}})}),b("views/siderLineRowContainer",function(){var a=c("lib/backbone"),b=c("basic/tools/cache"),d=c("basic/util/clone"),e=c("collections/headItemRow");return a.View.extend({className:"row-head-line",initialize:function(){var a;this.listenTo(this.model,"change",this.render),this.currentRule=d.clone(b.CurrentRule),a=e,this.userViewTop=b.TempProp.isFrozen?a.getModelByAlias(b.UserView.rowAlias).get("top"):0,this.offsetTop=b.TempProp.isFrozen?this.currentRule.displayPosition.offsetTop||0:0},render:function(){var a=this.model.toJSON();return this.$el.css({top:a.top-this.offsetTop-this.userViewTop,height:a.height-2}),this},destroy:function(){this.remove()}})}),b("views/rowsAllHeadContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("basic/util/clone")),b=c("basic/tools/cache"),d=c("lib/backbone"),e=c("collections/headItemRow"),f=c("collections/siderLineRow"),g=c("views/rowsHeadContainer"),h=c("views/siderLineRowContainer"),i=e.models;return d.View.extend({className:"row-head-bg row-head-width",initialize:function(c){d.on("call:rowsAllHeadContainer",this.callRowsAllHeadContainer,this),d.on("event:rowsAllHeadContainer:adaptHeight",this.adaptHeight,this),this.currentRule=a.clone(b.CurrentRule),!0===b.TempProp.isFrozen?(this.userViewTop=e.getModelByAlias(b.UserView.rowAlias).get("top"),this.offsetTop=this.currentRule.displayPosition.offsetTop):(this.userViewTop=0,this.offsetTop=0),this.listenTo(f,"add",this.addSiderLineRow),this.boxAttributes=c.boxAttributes},render:function(){var a,b,c=f.models,d=c.length;if(a=new g,this.attributesRender(this.boxAttributes),this.$el.append(a.render().el),0===d)this.createSiderLineRow();else for(b=d-1;b>=0;b--)this.addSiderLineRow(c[b]);return this},adaptHeight:function(){var a,b,c=this.currentRule.displayPosition.endIndex,b=this.currentRule.displayPosition.startIndex,d=0,e=0;for(void 0===c&&(c=i.length-1),b=b||0,a=c-1;a>=b;a--)if(!i[a].get("hidden")){e=i[a].get("top")+i[a].get("height"),d=i[b].get("top"),this.$el.css({height:e-d-this.userViewTop});break}},callRowsAllHeadContainer:function(a){a(this)},attributesRender:function(a){-1!==a.height&&this.$el.css({height:a.height})},addSiderLineRow:function(a){this.siderLineRowContainer=new h({model:a}),this.$el.append(this.siderLineRowContainer.render().el)},createSiderLineRow:function(){f.add({top:0,height:config.User.cellHeight-1})},destroy:function(){d.trigger("event:rowsHeadContainer:destroy"),d.off("call:rowsAllHeadContainer"),this.siderLineRowContainer.destroy(),this.remove()}})}),b("views/rowsPanelContainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=c("basic/tools/cache"),d=(c("spreadsheet/config"),c("basic/util/clone")),e=c("collections/headItemRow"),f=c("views/rowsAllHeadContainer");return a.View.extend({className:"row-head-container",initialize:function(c){var f,g,h,i;if(a.on("call:rowsPanelContainer",this.rowsPanelContainer,this),a.on("event:rowsPanelContainer:destroy",this.destroy,this),this.boxModel={},this.currentRule=d.clone(b.CurrentRule),this.boxAttributes=this.currentRule.boxAttributes,g=f=e.models,b.TempProp.isFrozen&&(g=this.currentRule.displayPosition.endIndex?f.slice(this.currentRule.displayPosition.startIndex,this.currentRule.displayPosition.endIndex):f.slice(this.currentRule.displayPosition.startIndex)),0===(i=g.length))return void(this.boxModel.height=0);h=f[i-1],this.boxModel.height=this.currentRule.autoScroll?h.get("top")+h.get("height")-f[0].get("top"):-1},render:function(){return this.rowsAllHeadContainer=new f({boxAttributes:{height:this.boxModel.height},startY:this.startY,endY:this.endY}),this.attributesRender(this.boxAttributes),this.$el.html(this.rowsAllHeadContainer.render().el),this},rowsPanelContainer:function(a){a(this)},attributesRender:function(a){-1===a.height?this.$el.css({height:0}):this.$el.css({height:a.height}),a.style&&this.$el.addClass(a.style)},scrollToPosition:function(a){this.$el.scrollTop(a)},destroy:function(){this.unsubscribe&&this.unsubscribe("mainContainer","verticalPublish"),a.off("call:rowsPanelContainer"),a.off("event:rowsPanelContainer:destroy"),this.rowsAllHeadContainer.destroy(),this.remove()},adjustHeadItemContainer:function(a){this.rowsAllHeadContainer.$el.css({height:a})},addHeadItemView:function(a){this.rowsAllHeadContainer.rowsHeadContainer.addRowsHeadContainer(a)}})}),b("entrance/cell/setcelltext",function(){var a=c("basic/tools/send"),b=c("collections/cells"),d=c("basic/tools/cache"),e=c("spreadsheet/config"),f=c("basic/tools/history"),g=c("collections/headItemCol"),h=c("collections/headItemRow"),i=c("collections/selectRegion"),j=c("basic/tools/getoperregion");return{set:function(a){var c,e,k,l,m,n=h.models,o=g.models,p=[];if(c=i.getModelByType("clip"),void 0!==c&&(d.clipState="null",c.destroy()),e=j(),k=e.operRegion,l=e.sendRegion,"MAX"!==k.endRowIndex&&"MAX"!==k.endColIndex)return b.oprCellsByRegion(k,function(b,c,d){(m=b.get("content").texts)!==a&&(p.push({colSort:c,rowSort:d,value:m}),b.set("content.texts",a))}),f.addUpdateAction("content.texts",a,{startColSort:o[k.startColIndex].get("sort"),startRowSort:n[k.startRowIndex].get("sort"),endColSort:o[k.endColIndex].get("sort"),endRowSort:n[k.endRowIndex].get("sort")},p),l},clear:function(){var b=this.set("");b&&a.PackAjax({url:e.url.cell.clear,data:JSON.stringify({coordinate:[b]})})}}}),b("entrance/sheet/shortcut",function(){var a=c("lib/jquery"),b=c("basic/tools/cache"),d=c("collections/selectRegion"),e=c("collections/headItemRow"),f=c("collections/headItemCol"),g=c("collections/cells"),h=c("entrance/cell/setcelltext"),i=e.models,j=f.models;return{altEnter:function(a){this._insertAtCursor("\n",a)},backspace:function(){h.clear("")},arrow:function(a){var c,h,k,l,m,n,o,p,q,r,s=b.shortcut.select,t=f.length-1,u=e.length-1;switch(c=d.getModelByType("selected"),m=c.get("wholePosi").startX,n=c.get("wholePosi").startY,l=e.getIndexByAlias(n),k=f.getIndexByAlias(m),h=g.getCellByVertical(k,l)[0],a){case"LEFT":o=k<1?0:k-1,p=e.getIndexByAlias(s.rowAlias),-1===p&&(p=l),s.colAlias=j[o].get("alias");break;case"RIGHT":h?(q=h.get("occupy").x,o=k+q.length-q.indexOf(m),o=o<t?o:t):o=k<t?k+1:t,p=e.getIndexByAlias(s.rowAlias),-1===p&&(p=l),s.colAlias=j[o].get("alias");break;case"UP":p=l<1?0:l-1,o=f.getIndexByAlias(s.colAlias),-1===o&&(o=k),s.rowAlias=i[p].get("alias");break;case"DOWN":h?(r=h.get("occupy").y,p=l+r.length-r.indexOf(n),p=p<u?p:u):p=l<u?l+1:u,o=f.getIndexByAlias(s.colAlias),-1===o&&(o=k),s.rowAlias=i[p].get("alias");break;default:return}c.set("tempPosi",{initColIndex:o,initRowIndex:p,mouseColIndex:o,mouseRowIndex:p})},_insertAtCursor:function(b,c){var d,e=a(c);if(document.selection)e.focus(),d=document.selection.createRange(),d.text=b,e.focus();else if("number"==typeof c.selectionStart&&"number"==typeof c.selectionEnd){var f=c.selectionStart,g=c.selectionEnd,h=c.scrollTop;c.value=c.value.substring(0,f)+b+c.value.substring(g,c.value.length),e.focus(),c.selectionStart=f+b.length,c.selectionEnd=f+b.length,c.scrollTop=h}else c.value+=b,e.focus()}}}),b("entrance/tool/clipselectoperate",function(){function b(b,c){var k,l,m,n,o,p,q,r,s,t,u,v="";if(q=g.getModelByType("clip"),void 0!==q&&q.destroy(),l=g.getModelByType("selected"),"MAX"!==l.get("wholePosi").endX&&"MAX"!==l.get("wholePosi").endY){if(q=l.clone(),q.set("selectType","clip"),g.add(q),m=e.getIndexByAlias(q.get("wholePosi").startX),n=f.getIndexByAlias(q.get("wholePosi").startY),o=e.getIndexByAlias(q.get("wholePosi").endX),p=f.getIndexByAlias(q.get("wholePosi").endY),"cut"===b&&h.interceptor({startColIndex:m,startRowIndex:n,endColIndex:o,endRowIndex:p}))return d.trigger("event:showMsgBar:show","保护状态，不能进行该操作"),void q.destroy();if("copy"===b)j.clipState="copy";else{if("cut"!==b)return;j.clipState="cut"}for(t=n;t<p+1;t++)for(u=m;u<o+1;u++)r=e.models[u].get("alias"),s=f.models[t].get("alias"),k=i.getCellByAlias(r,s),null!==k&&(v+=function(a){var b,c='"',d='"';if(b=a.get("content").texts,-1===b.indexOf("\n"))return b;for(;;){if(0!==b.indexOf('"'))break;b=b.substring(1),c+='""'}for(;;){if(!(b.lastIndexOf('"')===b.length-1&&b.length>1))break;b=b.substring(0,b.length-1),d+='""'}return b=c+b+d}(k)),v+=u!==o?"\t":"\r\n";void 0!==c&&(c.preventDefault(),a.clipboardData?a.clipboardData.setData("Text",v):c.originalEvent.clipboardData.setData("Text",v),j.clipboardData=v)}}var d=c("lib/backbone"),e=c("collections/headItemCol"),f=c("collections/headItemRow"),g=c("collections/selectRegion"),h=c("entrance/tool/protect"),i=c("collections/cells"),j=c("basic/tools/cache");return b}),b("entrance/tool/clippasteoperate",function(){function b(a){var b=i.clipboardData;null!==i.clipState&&b===a?d(i.clipState):g(a)}function d(b){function c(){var a,c,d,h,j,m,q,B,D,E={},F=[],G=[],H=[],I=[],J=[],K=p.length,L=o.length,M=z+(x-r),N=A+(y-w),O=i.CellsPosition.strandX,P=[];for(M=M>o.length-1?o.length-1:M,N=N>p.length-1?p.length-1:N,a=w;a<=y;a++)for(c=r;c<=x;c++)h=u[c].get("alias"),j=t[a].get("alias"),O[h]&&void 0!==(B=O[h][j])&&(E[B]||(D=v[B],F.push({relativeCol:c-r,relativeRow:a-w,model:D.clone()}),"cut"===b&&(D.set("isDestroy",!0),I.push(B)),E[B]=1),"cut"===b&&f(h,j)),void 0!==(d=s.getPointRecord(h,j,"validate"))&&(G.push({relativeCol:c-r,relativeRow:a-w,ruleIndex:d}),"cut"===b&&(H.push({colAlias:u[c].get("alias"),rowAlias:t[a].get("alias"),index:d}),s.deletePointRecord(h,j,"validate")));for(E={},a=A;a<=N;a++)for(c=z;c<=M;c++)a>=K||c>=L||(h=u[c].get("alias"),j=t[a].get("alias"),O[h]&&void 0!==(B=O[h][j])&&!E[B]&&(E[B]=1,D=v[B],D.set("isDestroy",!0),-1!==I.indexOf(B)&&I.push(B),f(h,j)),void 0!==(d=s.getPointRecord(h,j,"validate"))&&(H.push({colAlias:h,rowAlias:j,index:d}),s.deletePointRecord(h,j,"validate")));for(a=0;a<F.length;a++)m=F[a],(D=e(m.model,m.relativeCol,m.relativeRow))&&(C.push(k.length),k.push(D));for(a=0;a<G.length;a++)q=G[a],h=u[z+q.relativeCol].get("alias"),j=t[A+q.relativeRow].get("alias"),J.push({colAlias:h,rowAlias:j,index:q.ruleIndex}),s.addPointRecord(h,j,"validate",q.ruleIndex);P.push(n.getCellCoverAction(C,I)),P.push(n.getValidateCoverAction(J,H)),n.addAction(P),l.set("tempPosi",{initColIndex:z,initRowIndex:A,mouseColIndex:M<L?M:L-1,mouseRowIndex:N<K?N:K-1}),(A>y||z>x||N<w||M<r)&&"copy"===b||(i.clipState="null",
i.clipboardData=null,g.destroy())}var d,g,l,r,w,x,y,z,A,B,C=[];g=q.getModelByType("clip"),l=q.getModelByType("selected"),d=g.get("wholePosi"),r=o.getIndexByAlias(d.startX),w=p.getIndexByAlias(d.startY),x=o.getIndexByAlias(d.endX),y=p.getIndexByAlias(d.endY),d=l.get("wholePosi"),z=o.getIndexByAlias(d.startX),A=p.getIndexByAlias(d.startY),B="cut"===b?j.url.sheet.cut:j.url.sheet.copy,m.PackAjax({url:B,async:!1,data:JSON.stringify({excelId:a.SPREADSHEET_AUTHENTIC_KEY,sheetId:"1",orignal:{startCol:u[r].get("sort"),endCol:u[x].get("sort"),startRow:t[w].get("sort"),endRow:t[y].get("sort")},target:{oprCol:u[z].get("sort"),oprRow:t[A].get("sort")}}),success:function(a){a&&a.isLegal?c():h.trigger("event:showMsgBar:show","该区域不能进行此操作")}})}function e(a,b,c){var d,e,f,g,h,j,l,m,n,r,s=[],v=[],w=0,x=0;if(f=q.getModelByType("selected"),d=o.getIndexByAlias(f.get("wholePosi").startX),e=p.getIndexByAlias(f.get("wholePosi").startY),d+b>=o.length||e+c>=p.length)return!1;for(m=a.get("occupy").x.length||1,n=a.get("occupy").x.length||1,r=0;r<m;r++)h=e+c+r,v.push(t[h].get("alias")),x+=t[h].get("height")+1,0===r&&(l=t[h].get("top"));for(r=0;r<n;r++)g=d+b+r,s.push(u[g].get("alias")),w+=u[g].get("width")+1,0===r&&(j=u[g].get("left"));return a.set("isDestroy",!1),a.set("occupy",{x:s,y:v}),a.set("physicsBox",{top:l,left:j,width:w-1,height:x-1}),function(){var a,b,c,d,e=k.length;for(c=0,a=v.length;c<a;c++)for(d=0,b=s.length;d<b;d++)i.cachePosition(v[c],s[d],e)}(),a}function f(a,b){var c=i.CellsPosition,d=c.strandX,e=c.strandY;d[a]&&void 0!==d[a][b]&&(delete d[a][b],Object.getOwnPropertyNames(d[a]).length||delete d[a]),e[b]&&void 0!==e[b][a]&&(delete e[b][a],Object.getOwnPropertyNames(e[b]).length||delete e[b])}function g(a){function b(){var a,b,c,d,h=i.CellsPosition.strandX,j=[],m=[],q=[],v=[];for(B=f;B<f+z;B++)for(C=g;C<g+A;C++)B>=p.length||C>=o.length||(a=t[B].get("alias"),b=u[C].get("alias"),c=k.getCellByVertical(C,B)[0],c&&!1===c.get("isDestroy")&&(j.push(h[b][a]),c.set("isDestroy",!0)),i.deletePosi(a,b),void 0!==(d=s.getPointRecord(b,a,"validate"))&&(q.push({colAlias:b,rowAlias:a,index:d}),s.deletePointRecord(b,a,"validate")));for(B=0;B<E.length;B++)c=new l,c.set("content.texts",E[B].text),(c=e(c,E[B].relativeColIndex,E[B].relativeRowIndex))&&(r.typeRecognize(c),r.generateDisplayText(c),k.add(c),m.push(k.length-1));v.push(n.getCellCoverAction(m,j)),v.push(n.getValidateCoverAction([],q)),n.addAction(v)}function c(a){var b="",c="";if(-1===a.indexOf("%0A"))return a;for(a=a.substring(3,a.length-3);;){if(0!==a.indexOf("%22%22"))break;a=a.substring(6),b+="%22"}for(;;){if(!(a.lastIndexOf("%22%22")===a.length-6&&a.length>6))break;a=a.substring(0,a.length-6),c+="%22"}return a=b+a+c}var d,f,g,v,w,x,y,z,A,B,C,D=[],E=[],F=[],G=[];for(w=q.getModelByType("clip"),null!==w&&void 0!==w&&w.destroy(),i.clipState="null",d=encodeURI(a),D=d.split("%0D%0A"),z=D.length-1,""!==D[z]&&z++,A=D[0].split("%09").length,v=q.getModelByType("selected"),f=p.getIndexByAlias(v.get("wholePosi").startY),g=o.getIndexByAlias(v.get("wholePosi").startX),y=t[f].get("sort"),x=u[g].get("sort"),B=0;B<z;B++)for(G=D[B].split("%09"),C=0;C<G.length;C++)""!==G[C]&&(F.push({col:x+C,row:y+B,content:decodeURI(c(G[C]))}),E.push({relativeColIndex:C,relativeRowIndex:B,text:decodeURI(c(G[C]))}));m.PackAjax({url:j.url.sheet.paste,async:!1,data:JSON.stringify({sheetId:"1",oprCol:u[g].get("sort"),oprRow:t[f].get("sort"),colLen:A,rowLen:z,pasteData:F}),success:function(a){a&&a.isLegal?b():h.trigger("event:showMsgBar:show","该区域不能进行此操作")}})}var h=c("lib/backbone"),i=c("basic/tools/cache"),j=c("spreadsheet/config"),k=c("collections/cells"),l=c("models/cell"),m=c("basic/tools/send"),n=c("basic/tools/history"),o=c("collections/headItemCol"),p=c("collections/headItemRow"),q=c("collections/selectRegion"),r=c("entrance/tool/settexttype"),s=c("basic/tools/strandmap"),t=p.models,u=o.models,v=k.models;return b}),b("basic/tools/selectvalidate",function(){var a,b=c("basic/util/observer.pattern");return a={_ruleIndex:null,set:function(a){this._ruleIndex!==a&&(this._ruleIndex=a,this.publish("validate","changeRulePublish"))},get:function(){return this._ruleIndex},addSubscriber:function(a){b.buildSubscriber(a),a.subscribe("validate","changeRulePublish","changeRule")}},b.buildPublisher(a),a}),b("entrance/sheet/redoundo",function(){var a=c("lib/backbone"),b=c("basic/tools/history"),d=c("basic/tools/cache"),e=c("basic/tools/send"),f=c("spreadsheet/config"),g=c("collections/headItemCol"),h=c("collections/headItemRow"),i=c("collections/cells"),j=c("basic/tools/strandmap"),k=c("basic/tools/selectvalidate"),l=c("collections/selectRegion"),m=h.models,n=g.models,o=i.models;return{redo:function(){var a,c,d,e=b.next();if(e){for("object"==typeof e&&"[object Array]"!==Object.prototype.toString.call(e)&&(e=[e]),c=0,d=e.length;c<d;c++)a="_redo"+e[c].type[0].toUpperCase()+e[c].type.substring(1),this[a]&&this[a](e[c]);this.sendData(f.url.sheet.redo)}},undo:function(){var a,c,d,e=b.previous();if(e){for("object"==typeof e&&"[object Array]"!==Object.prototype.toString.call(e)&&(e=[e]),c=0,d=e.length;c<d;c++)a="_undo"+e[c].type[0].toUpperCase()+e[c].type.substring(1),this[a]&&this[a](e[c]);this.sendData(f.url.sheet.undo)}},_redoUpdateCellProp:function(a){var b,c,d,e,f=a.propName,j=a.propValue,k=a.region;b=g.getIndexBySort(k.startColSort),c=h.getIndexBySort(k.startRowSort),d=g.getIndexBySort(k.endColSort),e=h.getIndexBySort(k.endRowSort),i.oprCellsByRegion({startColIndex:b,startRowIndex:c,endColIndex:d,endRowIndex:e},function(a){a.set(f,j)})},_redoCoverCellModel:function(b){var c,e,f,g,h,i,j,k,l,m=b.originalModelIndexs,n=b.currentModelIndexs;for(j=0,i=m.length;j<i;j++)for(h=m[j],o[h].set("isDestroy",!0),c=o[h].get("occupy").x,e=o[h].get("occupy").y,k=0,f=c.length;k<f;k++)for(l=0,g=e.length;l<g;l++)d.deletePosi(e[l],c[k]);for(j=0,i=n.length;j<i;j++)for(h=n[j],o[h].set("isDestroy",!1),a.trigger("event:contentCellsContainer:restoreCell",o[h]),c=o[h].get("occupy").x,e=o[h].get("occupy").y,k=0,f=c.length;k<f;k++)for(l=0,g=e.length;l<g;l++)d.cachePosition(e[l],c[k],h)},_redoUpdateValidateRule:function(a){var b,c,d,e=a.region,f=a.currentRuleIndex,i=h.getIndexBySort(e.startRowSort),o=g.getIndexBySort(e.startColSort),p=h.getIndexBySort(e.endRowSort),q=g.getIndexBySort(e.endColSort);for(c=o;c<q+1;c++)for(d=i;d<p+1;d++)j.addPointRecord(n[c].get("alias"),m[d].get("alias"),"validate",f);b=l.getModelByType("selected"),k.set(j.calcPointRecord(b.get("wholePosi").startX,b.get("wholePosi").startY,"validate"))},_redoCoverValidateRule:function(a){var b,c,d=a.currentData,e=a.originalData;for(b=0,c=e.length;b<c;b++)j.deletePointRecord(e[b].colAlias,e[b].rowAlias,"validate");for(b=0,c=d.length;b<c;b++)j.addPointRecord(d[b].colAlias,d.colAlias[b],"validate",d[b].index)},_undoUpdateCellProp:function(a){var b,c,d,e,f,j=a.originalData,k=a.propName;for(f=0,e=j.length;f<e;f++)c=g.getIndexBySort(j[f].colSort),d=h.getIndexBySort(j[f].rowSort),void 0!==(b=i.getCellByVertical(c,d)[0])&&b.set(k,j[f].value)},_undoCoverCellModel:function(b){var c,e,f,g,h,i,j,k,l,m=b.originalModelIndexs,n=b.currentModelIndexs;for(i=0,h=n.length;i<h;i++)for(l=n[i],o[l].set("isDestroy",!0),c=o[l].get("occupy").x,e=o[l].get("occupy").y,j=0,f=c.length;j<f;j++)for(k=0,g=e.length;k<g;k++)d.deletePosi(e[k],c[j]);for(i=0,h=m.length;i<h;i++)for(l=m[i],o[l].set("isDestroy",!1),a.trigger("event:contentCellsContainer:restoreCell",o[l]),c=o[l].get("occupy").x,e=o[l].get("occupy").y,j=0,f=c.length;j<f;j++)for(k=0,g=e.length;k<g;k++)d.cachePosition(e[k],c[j],l)},_undoUpdateValidateRule:function(a){var b,c,d,e,f,i,o=a.originalData;for(f=0,i=o.length;f<i;f++)d=h.getIndexBySort(o[f].rowSort),c=g.getIndexBySort(o[f].colSort),e=o[f].originalIndex,void 0!==e?j.addPointRecord(n[c].get("alias"),m[d].get("alias"),"validate",e):j.deletePointRecord(n[c].get("alias"),m[d].get("alias"),"validate");b=l.getModelByType("selected"),k.set(j.calcPointRecord(b.get("wholePosi").startX,b.get("wholePosi").startY,"validate"))},_undoCoverValidateRule:function(a){var b,c,d=a.currentData,e=a.originalData;for(b=0,c=d.length;b<c;b++)j.deletePointRecord(d[b].colAlias,d[b].colAlias,"validate");for(b=0,c=e.length;b<c;b++)j.addPointRecord(e[b].colAlias,e.rowAlias[b],"validate",e[b].index)},sendData:function(a){e.PackAjax({url:a})}}}),b("views/inputContainer",function(){var b=c("lib/backbone"),d=c("basic/tools/cache"),e=c("basic/tools/gettextbox"),f=(c("basic/tools/history"),c("spreadsheet/config")),g=c("basic/tools/send"),h=(c("models/cell"),c("collections/headItemRow")),i=c("collections/headItemCol"),j=c("collections/selectRegion"),k=c("collections/cells"),l=c("entrance/sheet/shortcut"),m=c("entrance/tool/clipselectoperate"),n=c("entrance/tool/clippasteoperate"),o=c("entrance/tool/setcellcontent"),p=c("entrance/sheet/redoundo"),q=c("entrance/tool/protect"),r=h.models,s=i.models;return b.View.extend({tagName:"textarea",className:"edit-frame",events:{keydown:"keydownHandle",blur:"hide",copy:"copyData",paste:"pasteData",cut:"cutData"},initialize:function(){b.on("event:InputContainer:show",this.show,this)},show:function(a){var c,e,f,g,l,m,n,o,p,r,s;n=j.getModelByType("selected"),g=n.get("wholePosi").startX,l=i.getIndexByAlias(g),f=n.get("wholePosi").startY,m=h.getIndexByAlias(f),q.interceptor({startColIndex:l,startRowIndex:m})||(o=j.getModelByType("clip"),void 0!==o&&(d.clipState="null",o.destroy()),b.trigger("call:mainContainer",function(a){c=a}),this.rowIndex=m,this.colIndex=l,this.mainContainer=c,s=k.getRegionCells(l,m)[0],s||(s=k.createCellModel(l,m)),this.model=s,p=this.getAbsoluteLeft(),r=this.getAbsoluteTop(),this.adjustZIndex(),this.showState=!0,e=s.toJSON(),a?this.$el.val(e.content.texts):this.model.set("content.texts",""),!0===e.content.bd?this.$el.css({fontWeight:"bold"}):this.$el.css({fontWeight:"normal"}),!0===e.content.italic?this.$el.css({fontStyle:"italic"}):this.$el.css({fontStyle:"normal"}),e.content.underline?this.$el.css({textDecoration:"underline"}):this.$el.css({textDecoration:"none"}),this.$el.css({color:e.content.color,fontSize:e.content.size+"pt",fontFamily:e.content.family,left:p,top:r}),this.adjustWidth(!0),this.adjustHeight())},pasteData:function(b){if(!1===this.showState&&f.shortcuts.clip){b.preventDefault();var c;c=a.clipboardData&&a.clipboardData.getData?a.clipboardData.getData("Text"):b.originalEvent.clipboardData.getData("Text"),n(c)}},copyData:function(a){!1===this.showState&&f.shortcuts.clip&&m("copy",a)},cutData:function(a){!1===this.showState&&f.shortcuts.clip&&m("cut",a)},hide:function(){var a,c,d,e,f,g=this.model;if(!0===this.showState){if(c=r[this.rowIndex].get("displayName"),d=s[this.colIndex].get("displayName"),a=g.get("content").texts,f=this.$el.val(),!o("sheetId",f,d.toUpperCase()+c))return b.trigger("event:showMsgBar:show","输入值非法，用户已限定了输入的数值"),e=j.getModelByType("selected"),e.set("tempPosi",{initColIndex:this.colIndex,initRowIndex:this.rowIndex,mouseColIndex:this.colIndex,mouseRowIndex:this.rowIndex}),this.$el.val(a),void this.$el.focus();this.$el.css({left:-1e3,top:-1e3,width:0,height:0,"z-index":-100})}this.$el.val(""),this.showState=!1},transverseScroll:function(){var a;!0===this.showState&&(a=this.getAbsoluteLeft(),this.$el.css({left:a}))},verticalScroll:function(){var a;!0===this.showState&&(a=this.getAbsoluteTop(),this.$el.css({top:a}))},autoScrollLeft:function(){var a,b,c,d,e;a=this.mainContainer.$el[0].offsetWidth-this.mainContainer.$el[0].clientWidth,b=this.$el.position().left+this.$el.width(),c=this.$el.parent()[0].clientWidth-a,(e=c-b)<0&&(d=this.mainContainer.$el.scrollLeft(),this.mainContainer.$el.scrollLeft(d-e))},autoScrollTop:function(){var a,b,c,d,e;a=this.mainContainer.$el[0].offsetHeight-this.mainContainer.$el[0].clientHeight,b=this.$el.position().top+this.$el.height(),c=this.$el.parent()[0].clientHeight-a,(e=c-b)<0&&(d=this.mainContainer.$el.scrollTop()-e,this.mainContainer.$el.scrollTop(d))},getAbsoluteLeft:function(){var a,b,c,e,g,h,j,k;return k=this.colIndex,j=this.mainContainer,a=f.System.outerLeft,b=j.$el.scrollLeft(),h=i.models[k].get("left"),d.TempProp.colFrozen?(g=i.getIndexByAlias(d.TempProp.colAlias),g>k&&(b=0),e=i.getIndexByAlias(d.UserView.colAlias),c=i.models[e].get("left"),h-c+a-b+1):h+a-b+1},getAbsoluteTop:function(){var a,b,c,e,g,i,j,k;return j=this.rowIndex,i=this.mainContainer,a=f.System.outerTop,b=i.$el.scrollTop(),k=h.models[j].get("top"),d.TempProp.colFrozen?(g=h.getIndexByAlias(d.TempProp.rowAlias),g>j&&(b=0),e=h.getIndexByAlias(d.UserView.rowAlias),c=h.models[e].get("top"),k-c+a-b+1):k+a-b+1},adjustZIndex:function(){var a,b,c,e;a=this.colIndex,b=this.rowIndex,d.TempProp.colFrozen&&d.TempProp.rowFrozen?(c=i.getIndexByAlias(d.TempProp.colAlias),e=h.getIndexByAlias(d.TempProp.rowAlias),c>a&&e>b?this.$el.css({"z-index":"15"}):c>a||e>b?this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"9"})):d.TempProp.colFrozen?(c=i.getIndexByAlias(d.TempProp.colAlias),c>a?this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"9"})):d.TempProp.rowFrozen?(e=h.getIndexByAlias(d.TempProp.rowAlias),e>b?this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"9"})):this.$el.css({"z-index":"9"})},render:function(){return this.hide(),this},adapt:function(){!0===this.showState&&(this.adjustWidth(),this.adjustHeight())},adjustHeight:function(){var a,b,c,d,f,g,h;return b=this.mainContainer.$el[0].offsetHeight-this.mainContainer.$el[0].clientHeight,c=this.$el.parent().height()-this.$el.position().top-b,d=this.model.get("physicsBox").height,h=this.$el.val(),f=this.model.get("content").size,g=this.$el.width(),a=e.getInputHeight(h,f,g),a=a>d?a:d,a<c?(this.$el.height(a),a):(this.$el.height(c),a)},adjustWidth:function(a){var b,c,d,f,g,h,i;return d=this.mainContainer.$el[0].offsetWidth-this.mainContainer.$el[0].clientWidth,h=this.$el.parent().width()-this.$el.position().left-d,i=this.model.get("physicsBox").width-1,!0===this.model.get("wordWrap")?void this.$el.width(i):(c=this.$el.val(),g=this.model.get("content").size,f=this.$el.width(),b=e.getInputWidth(c,g)+20,b=b>i?b:i,a||(b=b>f?b:f),b<h?(this.$el.width(b),b):(this.$el.width(h),h))},sendWordWrap:function(a,b){g.PackAjax({url:f.url.cell.wordwrap,data:JSON.stringify({coordinate:{startCol:a,startRow:b,endCol:a,endRow:b},wordWrap:!0})})},sendChangeText:function(a,b,c){var c;g.PackAjax({url:f.url.cell.content,data:JSON.stringify({coordinate:{startRow:b,startCol:a,endRow:b,endCol:a},content:encodeURIComponent(c)})})},keydownHandle:function(a){var b=f.shortcuts,c=a.key,d=/^[a-zA-Z0-9]$/;if(229===a.keyCode&&(!1===this.showState&&(this.$el.val(""),this.show()),this.adapt()),"Enter"===c)return void(b.alt_enter&&this.showState&&a.altKey?(l.altEnter(this.el),this.adjustHeight(),a.preventDefault()):b.enter&&!a.altKey&&(!0===this.showState?this.hide():l.arrow("DOWN")));if(b.delete&&"Delete"===c&&!this.showState)return void l.backspace();if(b.arrow&&0===c.indexOf("Arrow")&&!this.showState)return void l.arrow(c.substring("5").toUpperCase());if(!this.showState&&a.ctrlKey){if(b.redo&&"Y"===c.toUpperCase())return void p.redo();if(b.undo&&"Z"===c.toUpperCase())return void p.undo()}this.showState||!d.test(c)||a.ctrlKey||a.altKey||(this.$el.val(""),this.show()),this.showState&&this.adjustWidth()},destroy:function(){b.off("event:InputContainer:show"),this.remove()}})}),b("views/commentcontainer",function(){var a=c("lib/backbone"),b=c("collections/headItemCol"),d=c("collections/headItemRow"),e=c("collections/selectRegion"),f=c("spreadsheet/config"),g=c("collections/cells"),h=c("basic/tools/cache"),i=c("entrance/tool/comment");return a.View.extend({tagName:"textarea",className:"comment",isTransverseScroll:!1,isVerticalScroll:!1,events:{blur:"close"},initialize:function(a){this.parentNode=a.parentNode},render:function(){return this.$el.css({left:-1e3,top:-1e3,width:f.User.commentWidth+"px",height:f.User.commentHeight+"px"}),this},add:function(a){this.edit(a),this.$el.val("")},edit:function(a){this.show(a),this.$el.removeAttr("disabled"),this.$el.focus()},show:function(a){var c,f,i,j,k=a.colIndex,l=a.rowIndex,m=a.comment;void 0===k&&(i=e.getModelByType("selected"),k=b.getIndexByAlias(i.get("wholePosi").endX),l=d.getIndexByAlias(i.get("wholePosi").startY),j=g.getCellByVertical(k,l),1===j.length&&(m=j[0].get("customProp").comment)),this.colIndex=k,this.rowIndex=l,c=h.TempProp.colFrozen&&b.getIndexByAlias(h.TempProp.colAlias),f=h.TempProp.rowFrozen&&d.getIndexByAlias(h.TempProp.rowAlias),this.isTransverseScroll=!(c&&c>k),this.isVerticalScroll=!(f&&f>l),this.setBoxModel(),this.adjustZIndex(k,l),this.$el.attr("disabled","disabled"),this.$el.css("display","block"),this.$el.val(m)},setBoxModel:function(){var a,b,c,d,e,g;if(e=this.getAbsoluteLeft(),g=this.getAbsoluteTop(),c=f.System.comment.height,d=f.System.comment.width,a=this.parentNode.el.clientHeight-f.System.outerBottom-h.scrollbarWidth-(this.$el.outerHeight()-this.$el.height()),b=this.parentNode.el.clientWidth-h.scrollbarWidth,g>=a||e>=b)return void this.$el.css({left:-200,top:-200});g+c>a&&(c=a-g),e+d>b&&(b-e>60?d=b-e:e=b-d-5),this.$el.css({left:e+5,top:g,height:c,width:d})},hide:function(){this.$el.css("display","none"),this.$el.attr("disabled","disabled"),this.isTransverseScroll=!1,this.isVerticalScroll=!1},transverseScroll:function(){this.isTransverseScroll&&this.setBoxModel()},verticalScroll:function(){this.isVerticalScroll&&this.setBoxModel()},getAbsoluteLeft:function(){var a,c=this.colIndex,d=f.System.outerLeft;return"MAX"===c?d:(a=b.models[c],d+=a.get("left")+a.get("width"),h.TempProp.colFrozen&&(d-=b.getModelByAlias(h.UserView.colAlias).get("left")),this.isTransverseScroll&&(d-=h.viewRegion.scrollLeft),d)},getAbsoluteTop:function(){var a,b=this.rowIndex,c=f.System.outerTop;return"MAX"===b?c:(a=d.models[b],c+=a.get("top"),h.TempProp.rowFrozen&&(c-=d.getModelByAlias(h.UserView.rowAlias).get("top")),this.isVerticalScroll&&(c-=h.viewRegion.scrollTop),c)},adjustZIndex:function(){var a=this.isTransverseScroll,b=this.isVerticalScroll;h.TempProp.colFrozen&&h.TempProp.rowFrozen?a||b?a&&b?this.$el.css({"z-index":"9"}):this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"15"}):h.TempProp.colFrozen?a?this.$el.css({"z-index":"9"}):this.$el.css({"z-index":"12"}):h.TempProp.rowFrozen?b?this.$el.css({"z-index":"9"}):this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"9"})},close:function(){var a;a=this.$el.val(),a=a||"",i.modifyComment("1",a),this.hide()}})}),b("views/lockcontainer",function(){var a=c("lib/backbone"),b=c("basic/tools/template"),d=c("basic/tools/getdisplayname"),e=c("collections/selectRegion"),f=c("entrance/tool/protect"),g=c("collections/selectRegion"),h=c("collections/headItemCol"),i=c("collections/headItemRow"),j=c("collections/cells"),k=c("basic/tools/cache"),l=h.models,m=i.models,n=j.models;return a.View.extend({events:{"click .lock-toggle":"toggle","click .confirm":"confirm","click .cancel":"close"},initialize:function(){var a=e.getModelByType("selected");this.listenTo(a,"change:wholePosi",this.listenToSelect),this.lockState=null},render:function(){var a,c,f,g,h,i,k,l,m=b("LOCKCONTAINER");for(h=this.parseSelect(),a=d.getColDisplayName(h.startColIndex),c=d.getRowDisplayName(h.startRowIndex),f=d.getColDisplayName(h.endColIndex),g=d.getRowDisplayName(h.endRowIndex),i=j.getCellByVertical(h),k=0,l=i.length;k<l;k++)i[k].get("lock")||!1;return this.parseText({col:[a,f],row:[c,g]}),this.$el.html(m()),this.listenToSelect(e.getModelByType("selected")),this},listenToSelect:function(a){var b,c,d,e,f=a.get("wholePosi");b=h.getIndexByAlias(f.startX),d=i.getIndexByAlias(f.startY),c=h.getIndexByAlias(f.endX),e=i.getIndexByAlias(f.endY),this.onLock(b,d,c,e),this.onContent(b,d,c,e)},onLock:function(a,b,c,d){var e,f,g,h,i,j,o,p,q,r=!1,s=!1,t=k.CellsPosition.strandX,u={},v={};if("MAX"===c)for(e=b,g=d+1;e<g&&(r=(o=!(!1===m[e].get("operProp").locked))||r,s=!o||s,!r||!s);e++);else if("MAX"===d)for(e=a,g=c+1;e<g&&(r=(o=!(!1===l[e].get("operProp").locked))||r,s=!o||s,!r||!s);e++);else a:for(e=a,g=c+1;e<g;e++)for(q=l[e].get("operProp").locked,q=void 0===q||q,f=b,h=d+1;f<h;f++)if(i=m[f].get("alias"),j=l[e].get("alias"),void 0===v[f]?(p=void 0===(p=m[f].get("operProp").locked)||p,v[f]=p):p=v[f],t[j]&&void 0!==(o=t[j][i])?u[o]||(o=n[o].get("locked"),s=!o||s,r=o||r):p&&q?r=!0:s=!0,r&&s)break a;r&&s?(this.lockState="half-locked",this.$el.find(".checkbox").removeClass("checked"),this.$el.find(".checkbox").addClass("half-checked")):r?(this.lockState="locked",this.$el.find(".checkbox").removeClass("half-checked"),this.$el.find(".checkbox").addClass("checked")):(this.lockState="unlocked",this.$el.find(".checkbox").removeClass("checked"),this.$el.find(".checkbox").removeClass("half-checked"))},onContent:function(a,b,c,d){this.$el.find("input[type=text]").val(this.parseText(l[a].get("displayName"),m[b].get("displayName"),"MAX"===c?"MAX":l[c].get("displayName"),"MAX"===d?"MAX":m[d].get("displayName")))},parseText:function(a,b,c,d){return"MAX"===c?b!==d?b+":"+d:b:"MAX"===d?a!==c?a+":"+c:a:b===d&&a===c?a+b:a+b+":"+c+d},parseSelect:function(){var a,b,c,d,e=g.getModelByType("selected"),f=e.get("wholePosi");return a=h.getIndexByAlias(f.startX),c=i.getIndexByAlias(f.startY),b=h.getIndexByAlias(f.endX),d=i.getIndexByAlias(f.endY),{startColIndex:a,endColIndex:b,startRowIndex:c,endRowIndex:d}},toggle:function(){"locked"===this.lockState||"half-locked"===this.lockState?(this.lockState="unlocked",this.$el.find(".checkbox").removeClass("checked"),this.$el.find(".checkbox").removeClass("half-checked")):(this.lockState="locked",this.$el.find(".checkbox").removeClass("half-checked"),this.$el.find(".checkbox").addClass("checked"))},confirm:function(a){a.preventDefault(),"half-locked"!==this.lockState&&("locked"===this.lockState?f.lock():f.unlock(),this.destroy())},close:function(a){a.preventDefault(),this.destroy()},destroy:function(){this.remove(),a.trigger("event:sidebarContainer:remove")}})}),b("views/validatecontainer",function(){var a=c("lib/backbone"),b=c("basic/tools/original"),d=c("basic/tools/history"),e=c("basic/tools/template"),f=c("collections/selectRegion"),g=c("basic/tools/strandmap"),h=c("basic/tools/selectvalidate"),i=c("basic/tools/cache"),j=c("spreadsheet/config"),k=c("collections/headItemCol"),l=c("collections/headItemRow"),m=c("basic/tools/send"),n=c("basic/tools/text2sort"),o=k.models,p=l.models;return a.View.extend({events:{"change select":"changeType","click .confirm":"confirm","click .select-out":"toggleSelectState","click .cancel":"close"},initialize:function(){var a=f.getModelByType("selected");this.listenTo(a,"change:wholePosi",this.listenToSelect)},render:function(){var a=e("VALIDATETEMPLATE");return this.$el.html(a()),this.select=this.$el.find("select"),this.range=this.$el.find(".range"),this.source=this.$el.find(".source"),this.min=this.$el.find(".min"),this.max=this.$el.find(".max"),this.sourceData=this.$el.find(".source-data"),this.sourceBtn=this.$el.find(".select-out"),this.error=this.$el.find(".error"),this.listenToSelect(f.getModelByType("selected")),this},changeType:function(a){switch(a.target.value){case"default":this._toggleDefault();break;case"intType":this._toggleIntType();break;case"decimalType":this._toggleDecimalType();break;case"sequenceType":this._toggleSequenceType();break;case"textType":this._toggleTextType();break;default:this._toggleDefault()}},toggleSelectState:function(){this.selectSourceState=!this.selectSourceState,this.selectSourceState?(this.sourceBtn.addClass("on"),this.startSelectSource()):(this.sourceBtn.removeClass("on"),this.endSelectSource())},startSelectSource:function(){var b;f.each(function(a){"selected"!==a.get("selectType")&&a.destroy()}),b=f.add({selectType:"rulesource",physicsBox:{width:0,height:0,top:-100,left:-100}}),this.listenTo(b,"change:wholePosi",this.bindSourceSelect),i.mouseOperateState=j.mouseOperateState.ruleSource,a.trigger("event:cellsContainer:setMouseState","locatedState","ruleSourceLocatedState"),a.trigger("event:colsHeadContainer:setMouseState","locatedState","ruleSourceLocatedState"),a.trigger("event:rowsHeadContainer:setMouseState","locatedState","ruleSourceLocatedState")},endSelectSource:function(){var b=f.getModelByType("rulesource");b&&(this.stopListening(b),b.destroy()),i.mouseOperateState=j.mouseOperateState.select,a.trigger("event:cellsContainer:setMouseState","locatedState","selectLocatedState"),a.trigger("event:colsHeadContainer:setMouseState","locatedState","selectLocatedState"),a.trigger("event:rowsHeadContainer:setMouseState","locatedState","selectLocatedState")},bindSourceSelect:function(a){var b,c,d,e,f=a.get("wholePosi");b=k.getIndexByAlias(f.startX),d=l.getIndexByAlias(f.startY),c=k.getIndexByAlias(f.endX),e=l.getIndexByAlias(f.endY),this.sourceData.val(this.parseText(o[b].get("displayName"),p[d].get("displayName"),"MAX"===c?"MAX":o[c].get("displayName"),"MAX"===e?"MAX":p[e].get("displayName")))},parseText:function(a,b,c,d){var e="=";return e+="MAX"===c?"$"+b+":$"+d:"MAX"===d?"$"+a+":$"+c:b===d&&a===c?"$"+a+"$"+b:"$"+a+"$"+b+":$"+c+"$"+d},inputValidator:function(b,c,d){function e(a,b){var c=/^([-]){0,1}[0-9]*$/;if(!c.test(a)||!c.test(b))return"输入内容格式错误"}function f(a,b){var c=/^([-]){0,1}[0-9]+(.[0-9]*)?$/;if(!c.test(a)||!c.test(b))return"输入内容格式错误"}function g(a,b){if(a=a.split(".")[0],b=b.split(".")[0],a.length>9||b.length>9)return"整数位数不能超过9位"}function h(a,b){if(a=a.split(".")[1],b=b.split(".")[1],void 0!==a&&a.length>6||void 0!==b&&b.length>6)return"小数位数不能超过6位"}function i(a){var b;if(0===a.indexOf("="))return b=n(a),b?b.startRowSort>9999||"MAX"!==b.endRowSort&&b.endRowSort>9999||b.startColSort>25||"MAX"!==b.endColSort&&b.endColSort>25?"来源范围超出最大支持":b.startRowSort!==b.endRowSort&&b.startColSort!==b.endColSort?"来源只能选择单行单列":void 0:"输入来源格式错误"}function j(a,b){if(parseFloat(a)>parseFloat(b))return"最大值不能小于最小值"}var k,l,m,o;if(k={intType:[e,g,j],decimalType:[f,g,h,j],textType:[e,j],sequenceType:[i]},void 0!==(k=k[b]))for(o=0,m=k.length;o<m;o++)if(void 0!==(l=k[o](c,d)))return a.trigger("event:showMsgBar:show",l),!1;return!0},confirm:function(){var a,b,c,d=this.select.val(),e=this.max.val(),f=this.min.val(),g=this.sourceData.val(),h={};switch(d){case"default":a=j.validationType.defaultType;break;case"intType":a=j.validationType.intType,b=f,c=e;break;case"decimalType":a=j.validationType.decimalType,b=f,c=e;break;case"sequenceType":a=j.validationType.sequenceType,b=g;break;case"textType":a=j.validationType.textType,b=f,c=e;break;default:a=j.validationType.defaultType}this.inputValidator(d,b,c)&&(h.validationType=a,void 0!==b&&(h.formula1=b),void 0!==c&&(h.formula2=c),this.insertRule(h),this.close())},insertRule:function(a){function b(a,c){var d,e,f;if("object"!=typeof a||null===a)return a===c;for(d in a){if(e=a[d],!c)return!1;if(f=c[d],"object"!=typeof e){if(e!==f)return!1}else if(!b(e,f))return!1}return!0}var c,e,m,n,q,r,s,t,u,v,w=f.getModelByType("selected"),x=w.get("wholePosi"),y=k.getIndexByAlias(x.startX),z=l.getIndexByAlias(x.startY),A=k.getIndexByAlias(x.endX),B=l.getIndexByAlias(x.endY),C=i.validate,D=[];a.validationType===j.validationType.sequenceType&&(m=a.formula1,a.formula1=this.getRegionAlias(m));for(v in C)if(b(C[v],a)){e=parseInt(v);break}if(void 0===e&&(e=i.validateCounter,i.validateCounter++,i.validate[e]=a),h.set(e),"MAX"===A)for(t=z;t<B+1;t++)g.addRowRecord(p[t].get("alias"),"validate",e);else if("MAX"===B)for(t=y;t<A+1;t++)g.addColRecord(o[t].get("alias"),"validate",e);else{for(t=y;t<A+1;t++)for(u=z;u<B+1;u++)q=o[t].get("alias"),r=p[u].get("alias"),c=g.getPointRecord(q,r,"validate"),e!==c&&(D.push({colSort:o[t].get("sort"),rowSort:p[u].get("sort"),originalIndex:c}),g.addPointRecord(q,r,"validate",e));s=d.getValidateUpdateAction({startColSort:o[y].get("sort"),startRowSort:p[z].get("sort"),endColSort:o[A].get("sort"),endRowSort:p[B].get("sort")},e,D),d.addAction(s)}a.validationType===j.validationType.sequenceType&&"object"==typeof a.formula1&&"MAX"!==a.formula1.endRowAlias&&"MAX"!==a.formula1.endColAlias&&(n=a.formula1,g.addPointRecord(n.startColAlias,n.startRowAlias,"sourceToRuleIndex",e),g.addPointRecord(n.endColAlias,n.endRowAlias,"sourceToRuleIndex",e)),this._sendData(a,y,z,A,B,m)},getRegionAlias:function(a){if(0!==a.indexOf("="))return a;var b=n(a),c=k.getIndexBySort(b.endColSort),d=l.getIndexBySort(b.endRowSort);return{startColAlias:o[k.getIndexBySort(b.startColSort)].get("alias"),startRowAlias:p[l.getIndexBySort(b.startRowSort)].get("alias"),endColAlias:"MAX"===c?"MAX":o[c].get("alias"),endRowAlias:"MAX"===d?"MAX":p[d].get("alias")}},_sendData:function(a,b,c,d,e,f){var g=o[b].get("sort"),h=p[c].get("sort"),i="MAX"===d?-1:o[d].get("sort"),k="MAX"===e?-1:p[e].get("sort");m.PackAjax({url:j.url.sheet.validate,data:JSON.stringify({coordinate:[{startCol:g,startRow:h,endRow:k,endcol:i}],rule:{formula1:void 0===f?a.formula1:f,formula2:a.formula2,validationType:a.validationType}})})},listenToSelect:function(a){var b,c,d,e,f,h,j,m,n,q,r,s=a.get("wholePosi"),t=!1,u=[];if(b=k.getIndexByAlias(s.startX),d=l.getIndexByAlias(s.startY),c=k.getIndexByAlias(s.endX),e=l.getIndexByAlias(s.endY),"MAX"===c)for(q=d;q<e+1&&u.length<3;q++)n=p[q].get("alias"),h=g.getRowRecord(n,"validate"),void 0===h||0===i.validate[h].validationType?t=!0:f!==h&&(j=i.validate[h],j||(j=this.getSequenceRule(-1,p[d].get("sort"))),u.push(j),f=h);else if("MAX"===e)for(q=b;q<c+1&&u.length<3;q++)m=o[q].get("alias"),h=g.getColRecord(m,"validate"),void 0===h||0===i.validate[h].validationType?t=!0:f!==h&&(j=i.validate[h],j||(j=this.getSequenceRule(o[b].get("sort"),-1)),u.push(j),f=h);else a:for(q=b;q<c+1;q++)for(r=d;r<e+1;r++)if(m=o[q].get("alias"),n=p[r].get("alias"),h=g.calcPointRecord(m,n,"validate"),void 0===h||(j=i.validate[h])&&0===j.validationType?t=!0:f!==h&&(j=i.validate[h],j||(j=this.getSequenceRule(o[b].get("sort"),p[d].get("sort"))),u.push(j),f=h),u.length>1)break a;this.onRule(u,t)},onRule:function(a,b){if(a.length>1)this._toggleDefault(),this._showError(!0,"选中区域内包含多种校验规则");else if(1===a.length){switch(a[0].validationType){case j.validationType.defaultType:this._toggleDefault();break;case j.validationType.intType:this._toggleIntType(a[0].formula1,a[0].formula2);break;case j.validationType.decimalType:this._toggleDecimalType(a[0].formula1,a[0].formula2);break;case j.validationType.sequenceType:this._toggleSequenceType(this.getShowText(a[0].formula1));break;case j.validationType.textType:this._toggleTextType(a[0].formula1,a[0].formula2);break;default:this._toggleDefault()}b?this._showError(!0,"选中区域内包含未设置校验规则单元格"):this._showError(!1)}else this._toggleDefault(),this._showError(!1)},getShowText:function(a){var b,c,d,e;return"string"==typeof a?a:(c=k.getIndexByAlias(a.startColAlias),e=k.getIndexByAlias(a.endColAlias),b=l.getIndexByAlias(a.startRowAlias),d=l.getIndexByAlias(a.endRowAlias),this.parseText(o[c].get("displayName"),p[b].get("displayName"),"MAX"===e?"MAX":o[e].get("displayName"),"MAX"===d?"MAX":p[d].get("displayName")))},getSequenceRule:function(a,c){var d;return m.PackAjax({url:j.url.sheet.validateFull,isPublic:!1,data:JSON.stringify({oprCol:a,oprRow:c}),success:function(a){var c=a.rule;c.index=a.index,c.validationType=j.validationType.sequenceType,b.analysisValidateRule({rule:c}),d=c}}),d},_showError:function(a,b){a?this.error.text(b).addClass("active"):this.error.text(b).removeClass("active")},_toggleDefault:function(){this.select.val("default"),this.range.removeClass("active"),this.source.removeClass("active")},_toggleIntType:function(a,b){this.select.val("intType"),this.range.addClass("active"),this.source.removeClass("active"),this.min.val(void 0===a?"":a),this.max.val(void 0===b?"":b)},_toggleDecimalType:function(a,b){this.select.val("decimalType"),this.range.addClass("active"),this.source.removeClass("active"),this.min.val(void 0===a?"":a),this.max.val(void 0===b?"":b)},_toggleSequenceType:function(a){this.select.val("sequenceType"),this.source.addClass("active"),this.range.removeClass("active"),this.sourceData.val(void 0===a?"":a)},_toggleTextType:function(a,b){this.select.val("textType"),this.range.addClass("active"),this.source.removeClass("active"),this.min.val(void 0===a?"":a),this.max.val(void 0===b?"":b)},
close:function(){this.endSelectSource(),this.destroy()},destroy:function(){this.remove(),a.trigger("event:sidebarContainer:remove")}})}),b("views/protectcontainer",function(){var a=c("lib/backbone"),b=c("basic/tools/template"),d=(c("basic/tools/getdisplayname"),c("basic/util/listener"),c("entrance/tool/protect")),e=(c("collections/selectRegion"),c("collections/headItemCol"),c("collections/headItemRow"),c("collections/cells"),c("basic/tools/cache"));return a.View.extend({events:{"click .confirm":"confirm","click .cancel":"close"},render:function(){var a=b("PROTECTCONTAINER");return this.$el.html(a()),this},confirm:function(b){b.preventDefault();var c=this.$el.find("input[type=password]").val();if(e.protectState){if(!d.cancel(c))return void a.trigger("event:showMsgBar:show","输入密码错误!")}else d.execute(c);this.close()},close:function(b){b&&b.preventDefault(),this.remove(),a.trigger("event:sidebarContainer:remove")}})}),b("views/sidebarcontainer",function(){var a=c("lib/backbone"),b=c("basic/tools/template"),d=c("basic/tools/cache"),e=c("spreadsheet/config"),f=c("views/lockcontainer"),g=c("views/validatecontainer"),h=c("views/protectcontainer");return a.View.extend({className:"siderbar",events:{"click .close":"close"},initialize:function(a){this.type=a.type},render:function(){var a,c=b("SIDERBARTEMPLATE"),i="";switch(this.type){case"lock":i="单元格锁定",a=new f;break;case"protect":i=d.protectState?"撤销保护工作簿":"保护工作薄",a=new h;break;case"validate":i="数据验证",a=new g}return this.$el.html(c({title:i})),a&&this.$el.find(".siderbar-body").append(a.render().el),this.$el.css({width:e.sidebarWidth}),this},close:function(b){b.preventDefault(),a.trigger("event:sidebarContainer:remove")},destroy:function(){this.remove()}})}),b("views/sequencecontainer",function(){var a=c("lib/backbone"),b=c("basic/tools/strandmap"),d=c("basic/tools/template"),e=c("basic/tools/cache"),f=c("basic/tools/send"),g=c("basic/tools/selectvalidate"),h=c("entrance/tool/setcellcontent"),i=(c("basic/tools/text2sort"),c("collections/selectRegion")),j=c("basic/tools/original"),k=c("collections/headItemCol"),l=c("collections/headItemRow"),m=c("collections/cells"),n=c("spreadsheet/config"),o=k.models,p=l.models;return a.View.extend({className:"sequence",events:{"click .sequence-btn":"toggleSequenceList","click .sequence-list":"clickHandle"},initialize:function(){var a=this.select=i.getModelByType("selected");this.cacheUserViewCol={},this.cacheUserViewRow={},this.listenTo(a,"change:wholePosi",this.local)},render:function(){var a=d("SEQUENCETEMPLATE");return this.childTemplate=d("SEQUENCEITEMTEMPLATE"),this.$el.html(a()),this.$list=this.$el.find(".sequence-list"),this.$btn=this.$el.find(".sequence-btn"),g.addSubscriber(this),this.local(),this},local:function(){var a,c=this.select,d=c.get("wholePosi").startX,f=c.get("wholePosi").startY,h=b.calcPointRecord(d,f,"validate");void 0===h?this.hide():(a=e.validate[h])&&a.validationType!==n.validationType.sequenceType?this.hide():(g.set(h),this.show())},changeRule:function(){var a,b=g.get();null!==b&&void 0!==b?(a=e.validate[b])&&a.validationType!==n.validationType.sequenceType||this.show():this.hide()},show:function(){var a,b,c,d=i.getModelByType("selected"),f=d.get("wholePosi").startX,g=d.get("wholePosi").startY,h=k.getIndexByAlias(f),j=l.getIndexByAlias(g);c=m.getCellByVertical(h,j)[0],this.colIndex=c?h+c.get("occupy").x.length-1:h,this.rowIndex=j,a=e.TempProp.colFrozen&&k.getIndexByAlias(e.TempProp.colAlias),b=e.TempProp.rowFrozen&&l.getIndexByAlias(e.TempProp.rowAlias),this.isTransverseScroll=!(a&&a>h),this.isVerticalScroll=!(b&&b>j),this.adjustZIndex(h,j),this.adjustWidth(j),this.adjustBtnPosi(h),this.hideSequenceList(),this.$el.css("display","block"),this.$el.css("left",this.getAbsoluteLeft()),this.$el.css("top",this.getAbsoluteTop())},hide:function(){this.isTransverseScroll=!1,this.isVerticalScroll=!1,this.hideSequenceList(),this.$el.css("display","none")},clickHandle:function(a){a.preventDefault();var b=a.target.innerText;h("sheetId",b),this.hide()},transverseScroll:function(){this.isTransverseScroll&&this.$el.css("left",this.getAbsoluteLeft())},verticalScroll:function(){this.isVerticalScroll&&this.$el.css("top",this.getAbsoluteTop())},toggleSequenceList:function(){this.listState?this.hideSequenceList():this.openSequenceList()},openSequenceList:function(){function a(a){var b,c,d=[];for(b=0,c=a.length;b<c;b++)a[b]&&d.push(a[b]);if(0!==d.length)for(r.listState=!r.listState,r.$list.empty(),r.$list.addClass("active"),b=0,c=d.length;b<c;b++)r.$list.append(r.childTemplate({content:d[b]}))}var b,c,d,h,i=g.get(),q=e.validate[i],r=this,s=[];if(q){if("object"==typeof(b=q.formula1))for(c=m.getCellByVertical(k.getIndexByAlias(b.startColAlias),l.getIndexByAlias(b.startRowAlias),k.getIndexByAlias(b.endColAlias),l.getIndexByAlias(b.endRowAlias)),h=0,d=c.length;h<d;h++)s.push(c[h].get("content").texts);else s=b.split(",");a(s)}else!function(){f.PackAjax({url:n.url.sheet.validateFull,isPublic:!1,data:JSON.stringify({oprCol:o[r.colIndex].get("sort"),oprRow:p[r.rowIndex].get("sort")}),success:function(b){var c=b.rule,d=b.expResult;c.index=b.index,j.analysisValidateRule({rule:c}),a(d)}})}()},hideSequenceList:function(){this.listState=!1,this.$list.removeClass("active")},getAbsoluteLeft:function(){var a,b=this.colIndex,c=n.System.outerLeft,d=e.UserView.colAlias;return c+=o[b].get("left"),e.TempProp.colFrozen&&((a=void 0===this.cacheUserViewCol[d])&&(a=k.getIndexByAlias(d),this.cacheUserViewCol[d]=a),c-=o[a].get("left")),this.isTransverseScroll&&(c-=e.viewRegion.scrollLeft),c},getAbsoluteTop:function(a){var b,a=this.rowIndex,c=n.System.outerTop,d=e.UserView.rowAlias;return c+=p[a].get("top")+p[a].get("height"),e.TempProp.rowFrozen&&((b=void 0===this.cacheUserViewRow[d])&&(b=l.getIndexByAlias(d),this.cacheUserViewCol[userViewColAlias]=b),c-=p[b].get("top")),this.isVerticalScroll&&(c-=e.viewRegion.scrollTop),c},adjustWidth:function(){var a=this.colIndex,b=o[a].get("width");this.$el.width(b)},adjustBtnPosi:function(a){a!==k.length-1?(this.$btn.addClass("sequence-btn-right"),this.$btn.removeClass("sequence-btn-left")):(this.$btn.addClass("sequence-btn-left"),this.$btn.removeClass("sequence-btn-right"))},adjustZIndex:function(){var a=this.isTransverseScroll,b=this.isVerticalScroll;e.TempProp.colFrozen&&e.TempProp.rowFrozen?a||b?a&&b?this.$el.css({"z-index":"9"}):this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"15"}):e.TempProp.colFrozen?a?this.$el.css({"z-index":"9"}):this.$el.css({"z-index":"12"}):e.TempProp.rowFrozen?b?this.$el.css({"z-index":"9"}):this.$el.css({"z-index":"12"}):this.$el.css({"z-index":"9"})},destory:function(){this.remove()}})}),b("views/bodyContainer",function(){var b=c("lib/jquery"),d=c("lib/backbone"),e=c("spreadsheet/config"),f=c("basic/tools/cache"),g=c("basic/tools/template"),h=c("basic/util/observer.pattern"),i=c("collections/headItemRow"),j=c("collections/headItemCol"),k=c("collections/selectRegion"),l=c("collections/siderLineCol"),m=c("collections/siderLineRow"),n=c("collections/cells"),o=c("basic/tools/original"),p=c("views/sheetsContainer"),q=c("views/mainContainer"),r=c("views/colsPanelContainer"),s=c("views/rowsPanelContainer"),t=c("views/inputContainer"),u=c("views/commentcontainer"),v=c("views/sidebarcontainer"),w=c("views/sequencecontainer");return d.View.extend({events:{mousemove:"mouseInfo",mouseup:"getFocus"},initialize:function(){d.on("event:bodyContainer:executiveFrozen",this.executiveFrozen,this),d.on("event:bodyContainer:handleComment",this.handleComment,this),d.on("event:sidebarContainer:show",this.showSiderBar,this),d.on("event:sidebarContainer:remove",this.removeSiderBar,this),d.on("event:showMsgBar:show",this.showMsgBar,this),d.on("event:reload",this.reload,this),this.commentContainer=null},render:function(){var a=g("BODYTEMPLATE"),b=this.inputContainer=new t,c=new w;h.buildSubscriber(c),c.subscribe("mainContainer","transversePublish","transverseScroll"),c.subscribe("mainContainer","verticalPublish","verticalScroll"),h.buildSubscriber(b),b.subscribe("mainContainer","transversePublish","transverseScroll"),b.subscribe("mainContainer","verticalPublish","verticalScroll"),this.$el.html(a()),this.$el.find(".main-layout").append(c.render().el),this.$el.find(".main-layout").append(b.render().el),this.calculation(),this.adaptScreen(),this.generateSheet(),this.$el.css({overflow:"hidden",position:"relative"}),b.$el.focus()},showMsgBar:function(a){var b=g("MSGCONTAINER"),c=this;this.$el.find(".main-layout").append(b({msg:a})),setTimeout(function(){c.$el.find(".msg").remove()},1500)},showSiderBar:function(a){this.removeSiderBar(),f.protectState&&"protect"!==a||(this.SidebarContainer=new v({type:a}),this.$el.find(".main-layout").append(this.SidebarContainer.render().el),f.sidebarState=!0,d.trigger("event:changeSidebarContainer"))},removeSiderBar:function(){this.SidebarContainer&&(this.SidebarContainer.destroy(),this.SidebarContainer=null),f.sidebarState=!1,d.trigger("event:changeSidebarContainer")},handleComment:function(a){var b,c=a.action;this.commentContainer||(b=this.commentContainer=new u({parentNode:this}),h.buildSubscriber(b),this.$el.find(".main-layout").append(b.render().el),b.subscribe("mainContainer","transversePublish","transverseScroll"),b.subscribe("mainContainer","verticalPublish","verticalScroll")),"hide"===c?this.commentContainer.hide():"edit"===c?this.commentContainer.edit(a):"add"===c?this.commentContainer.add(a):this.commentContainer.show(a)},generateSheet:function(){var a=new p;this.sheetsView=a,this.$el.find(".sheet-cf-list").append(a.render().el)},getFocus:function(a){var c=this.inputContainer.el,d=b(":focus")[0];c!==d&&(d||c.focus())},saveUserView:function(){a.SPREADSHEET_AUTHENTIC_KEY,b("#sheetId").val(),f.UserView.rowAlias,f.UserView.colAlias},adaptScreen:function(){this.executiveFrozen()},clearFrozenRule:function(){f.FrozenRules={main:[],row:[],col:[]}},executiveFrozen:function(){function a(a){var b,c,d,e=f.CurrentRule;if(b=e.isSubscribe||!1,e.isPublisher&&h.buildPublisher(a),b)for(c=b.length,h.buildSubscriber(a),d=0;d<c;d++)a.subscribe(b[d].publisherName,b[d].action,b[d].behavior)}var c,e,g,i="#"+this.el.id;if(this.clearFrozenRule(),this.ruleRow(),this.ruleCol(),this.ruleMain(),d.trigger("event:colsPanelContainer:destroy"),d.trigger("event:rowsPanelContainer:destroy"),d.trigger("event:mainContainer:destroy"),f.TempProp.colFrozen&&!f.TempProp.rowFrozen)for(e=f.FrozenRules.main.length,c=e-1;c>=0;c--)f.CurrentRule=f.FrozenRules.main[c],g=new q({parentNode:this}),b("tr:eq(1) td:eq("+(c+1)+")",i).prepend(g.render().el),a(g);else if(!f.TempProp.colFrozen&&f.TempProp.rowFrozen)for(e=f.FrozenRules.main.length,c=e-1;c>=0;c--)f.CurrentRule=f.FrozenRules.main[c],g=new q({parentNode:this}),b("tr:eq(1) td:eq(2)",i).prepend(g.render().el),a(g);else if(f.TempProp.colFrozen&&f.TempProp.rowFrozen){var j;for(c=4;c>0;c--)j=c%2?1:2,f.CurrentRule=f.FrozenRules.main[c-1],g=new q({parentNode:this}),b("tr:eq(1) td:eq("+j+")",i).prepend(g.render().el),a(g)}else f.TempProp.colFrozen||f.TempProp.rowFrozen||(f.CurrentRule=f.FrozenRules.main[0],g=new q({parentNode:this}),b("tr:eq(1) td:eq(2)",i).append(g.render().el),a(g));for(e=f.FrozenRules.col.length,c=0;c<e;c++){f.CurrentRule=f.FrozenRules.col[c];var k=new r;b("tr:eq(0) td:eq("+(3-e+c)+")",i).append(k.render().el),a(k)}for(e=f.FrozenRules.row.length,c=e-1;c>=0;c--){f.CurrentRule=f.FrozenRules.row[c];var l=new s;b("tr:eq(1) td:eq(0)",i).prepend(l.render().el),a(l)}},ruleCol:function(){var a,b,c,d,e,g,h;d=j,a=d.getIndexByAlias(f.TempProp.colAlias),-1===a&&(a=0),b=d.models[a],c=b.toJSON().left,g=d.getModelByAlias(f.UserView.colAlias),h=d.getIndexByAlias(f.UserView.colAlias),f.TempProp.isFrozen&&f.TempProp.colFrozen?(e={displayPosition:{offsetLeft:0,startIndex:h,startAlias:f.UserView.colAlias,endAlias:f.TempProp.colAlias,endIndex:a},boxAttributes:{width:c-g.toJSON().left-1,style:"frozen-right-border"},autoScroll:!1,reduceUserView:!0},f.FrozenRules.col.push(e)):c=0,e={displayPosition:{offsetLeft:c,startAlias:f.TempProp.colAlias,startIndex:a},boxAttributes:{width:this.scrollWidth-this.scrollbarWidth-c},autoScroll:!0,isSubscribe:[{publisherName:"mainContainer",behavior:"scrollToPosition",action:"transversePublish"}]},f.TempProp.isFrozen&&f.TempProp.colFrozen&&(e.displayPosition.offsetLeft-=g.get("left"),e.boxAttributes.width+=g.toJSON().left,e.reduceUserView=!0),f.FrozenRules.col.push(e)},ruleRow:function(){var a,b,c,d,e,g,h;a=i,b=a.getIndexByAlias(f.TempProp.rowAlias),-1===b?e=0:(c=a.models[b],e=c.toJSON().top),h=a.getIndexByAlias(f.UserView.rowAlias),g=a.models[h],f.TempProp.isFrozen&&f.TempProp.rowFrozen?(d={displayPosition:{offsetTop:0,startAlias:f.UserView.rowAlias,endAlias:f.TempProp.rowAlias,startIndex:h,endIndex:b},boxAttributes:{height:e-g.toJSON().top-1,style:"frozen-bottom-border"},autoScroll:!1,reduceUserView:!0},f.FrozenRules.row.push(d)):e=0,d={displayPosition:{offsetTop:e,startIndex:b,startAlias:f.TempProp.rowAlias},boxAttributes:{height:this.scrollHeight-this.scrollbarWidth-e},autoScroll:!0,isSubscribe:[{publisherName:"mainContainer",behavior:"scrollToPosition",action:"verticalPublish"}]},f.TempProp.isFrozen&&f.TempProp.rowFrozen&&(d.displayPosition.offsetTop-=g.get("top"),d.boxAttributes.height+=g.toJSON().top,d.reduceUserView=!0),f.FrozenRules.row.push(d)},ruleMain:function(){var a,b,c,d,e,g,h,k,l,m,n,o=i,p=j;d=o.getIndexByAlias(f.TempProp.rowAlias),e=p.getIndexByAlias(f.TempProp.colAlias),-1===d?g=0:(b=o.models[d],g=b.get("top")),-1===e?h=0:(c=p.models[e],h=c.get("left")),k=o.getModelByAlias(f.UserView.rowAlias),m=o.getIndexByAlias(f.UserView.rowAlias),l=p.getModelByAlias(f.UserView.colAlias),n=p.getIndexByAlias(f.UserView.colAlias),f.TempProp.isFrozen?(f.TempProp.rowFrozen&&f.TempProp.colFrozen&&(a={boxAttributes:{height:g-k.toJSON().top-1,width:h-l.toJSON().left-1,style:"container frozen-right-border frozen-bottom-border"},displayPosition:{startColIndex:n,endColIndex:e,startRowIndex:m,endRowIndex:d,startColAlias:f.UserView.colAlias,startRowAlias:f.UserView.rowAlias,endColAlias:f.TempProp.colAlias,endRowAlias:f.TempProp.rowAlias,offsetTop:0,offsetLeft:0}},f.FrozenRules.main.push(a)),f.TempProp.rowFrozen&&(a={boxAttributes:{height:g-k.toJSON().top-1,width:this.scrollWidth-this.scrollbarWidth-h,style:"container frozen-bottom-border"},displayPosition:{startRowIndex:m,endRowIndex:d,startColIndex:e,startColAlias:f.TempProp.colAlias,startRowAlias:f.UserView.rowAlias,endRowAlias:f.TempProp.rowAlias,offsetLeft:h,offsetTop:0},autoScroll:!0,autoColAlign:!0,isSubscribe:[{publisherName:"mainContainer",behavior:"subscribeScroll",action:"transversePublish",args:{direction:"TRANSVERSE"}}]},f.TempProp.colFrozen&&(a.boxAttributes.width+=l.toJSON().left,a.displayPosition.offsetLeft-=l.get("left")),f.FrozenRules.main.push(a)),f.TempProp.colFrozen&&(a={boxAttributes:{height:this.scrollHeight-this.scrollbarWidth-g,width:h-l.toJSON().left-1,style:"container frozen-right-border"},displayPosition:{startColIndex:n,endColIndex:e,startRowIndex:d,startColAlias:f.UserView.colAlias,startRowAlias:f.TempProp.rowAlias,endColAlias:f.TempProp.colAlias,offsetLeft:0,offsetTop:g},autoScroll:!0,autoRowAlign:!0,isSubscribe:[{publisherName:"mainContainer",behavior:"subscribeScroll",action:"verticalPublish",args:{direction:"VERTICAL"}}]},f.TempProp.rowFrozen&&(a.boxAttributes.height+=k.toJSON().top,a.displayPosition.offsetTop-=k.get("top")),f.FrozenRules.main.push(a))):(g=0,h=0),a={boxAttributes:{height:this.scrollHeight-g,width:this.scrollWidth-h,style:"scroll-container"},displayPosition:{startColIndex:e,startRowIndex:d,startColAlias:f.TempProp.colAlias,startRowAlias:f.TempProp.rowAlias,offsetLeft:h,offsetTop:g},autoRowAlign:!0,autoColAlign:!0,autoScroll:!0,eventScroll:!0,isPublisher:!0,publisherName:"mainContainer"},f.TempProp.rowFrozen&&(a.boxAttributes.height+=k.toJSON().top,a.displayPosition.offsetTop-=k.get("top")),f.TempProp.colFrozen&&(a.boxAttributes.width+=l.toJSON().left,a.displayPosition.offsetLeft-=l.get("left")),f.FrozenRules.main.push(a)},calculation:function(){this.scrollWidth=this.el.offsetWidth-e.System.outerLeft,this.scrollHeight=this.el.offsetHeight-e.System.outerTop-e.System.outerBottom,this.scrollbarWidth=this.getScrollbarWidth(),f.scrollbarWidth=this.scrollbarWidth},addressing:function(a,b){return!(!a.length||a!==b)||!(!a.parents(b).length||a.parents(b)!==b)},reload:function(){var b,c,e=n.models,g=i.models,h=j.models,p=k.models,q=l.models,r=m.models;for(f.CellsPosition.strandX={},f.CellsPosition.strandY={},f.rowRegionPosi=[],f.sendQueueStep=1,b=0,c=e.length;b<c;b++)e[0].destroy();for(b=0,c=g.length;b<c;b++)g[0].destroy();for(b=0,c=h.length;b<c;b++)h[0].destroy();for(b=0,c=p.length;b<c;b++)p[0].destroy();for(b=0,c=q.length;b<c;b++)q[0].destroy();for(b=0,c=r.length;b<c;b++)r[0].destroy();d.trigger("event:colsPanelContainer:destroy"),d.trigger("event:rowsPanelContainer:destroy"),d.trigger("event:mainContainer:destroy"),a.SPREADSHEET_BUILD_STATE="false",f.TempProp={isFrozen:!1,rowFrozen:!1,colFrozen:!1},o.restoreExcel(this.el.id),this.executiveFrozen()},mouseInfo:function(a){this.mousePageX=a.pageX-this.$el.offset().left,this.mousePageY=a.pageY-this.$el.offset().top},getScrollbarWidth:function(){function a(){return parseInt(b("div",c).innerWidth(),0)}var c,d,e;return c=b("<div/>").css({width:50,height:50,overflow:"hidden",position:"absolute",top:-200,left:-200}).html('<div style="height:1000px;">'),this.$el.append(c),d=a(),c.css("overflow-y","auto"),e=a(),b(c).remove(),d-e},destroy:function(){d.off("event:bodyContainer:executiveFrozen"),d.off("event:commentContainer:show"),d.off("event:commentContainer:remove"),d.off("event:SidebarContainer:show"),d.off("event:SidebarContainer:remove"),d.trigger("event:colsPanelContainer:destroy"),d.trigger("event:rowsPanelContainer:destroy"),d.trigger("event:mainContainer:destroy"),this.sheetsView.destroy(),this.remove()}})}),b("views/screen",function(){var b=c("lib/jquery"),d=c("lib/underscore"),e=c("lib/backbone"),f=c("views/bodyContainer");c("basic/tools/send"),c("basic/tools/cache"),c("spreadsheet/config"),c("basic/util/listener"),c("entrance/tool/clipselectoperate"),c("entrance/tool/clippasteoperate");return e.View.extend({el:a,events:{resize:"attributesRender",mouseup:"realseDrag",beforeunload:"closeWindow",mousedown:"transAction"},initialize:function(a){e.on("call:screenContainer",this.screenContainer,this),e.on("event:screenContainer:destroy",this.destroy,this),e.on("event:screenContainer:mouseMoveHeadContainer",this.mouseMoveHeadContainer,this),e.on("call:screenContainer:adaptScreen",this.attributesRender,this),d.bindAll(this,"callView"),this.render(a)},render:function(a){this.bodyContainer=new f({el:"#"+a}),this.bodyContainer.render(),this.triggerCallback()},transAction:function(a){this.toolbar(a)},toolbar:function(a){var c,d,e,f,g,h=0;if(b(a.target).length&&(f=b(a.target)),b(a.target).parents("[data-toolbar]").length&&(f=b(a.target).parents("[data-toolbar]")),g=f.length,d=b(".widget-list > div"),d.removeClass("active"),b("#toolBar .fui-section,#toolBar .section,#toolBar .ico-section ").removeClass("active"),0!==g&&(e=d.length,void 0!==(c=f.data("toolbar")))){for(;h<e;h++){var i=d.eq(h);if(c===i.data("widget")){var j=0;j=f[0].offsetHeight>f[0].clientHeight?parseInt((f[0].offsetHeight-f[0].clientHeight)/2,0)+f[0].clientHeight:f.outerHeight(),i.css({left:f.offset().left,top:f.offset().top+j}).addClass("active")}}f.addClass("active")}},triggerCallback:function(){e.trigger("call:rowsPanelContainer",this.callView("viewRowsPanelContainer")),e.trigger("call:colsPanelContainer",this.callView("viewColsPanelContainer")),e.trigger("call:mainContainer",this.callView("viewMainContainer")),e.trigger("call:cellsContainer",this.callView("viewCellsContainer")),e.trigger("call:colsHeadContainer",this.callView("viewColsHeadContainer")),e.trigger("call:rowsHeadContainer",this.callView("viewRowsHeadContainer"))},closeWindow:function(){},screenContainer:function(a){a(this)},attributesRender:function(){this.bodyContainer.calculation(),e.trigger("event:bodyContainer:executiveFrozen")},callView:function(a){var b=this;return function(c){b[a]=c}},realseDrag:function(a){this.triggerCallback(),e.trigger("event:cellsContainer:setMouseState","moveState","commonMoveState"),e.trigger("event:colsHeadContainer:setMouseState","moveState","commonMoveState"),e.trigger("event:rowsHeadContainer:setMouseState","moveState","commonMoveState"),e.trigger("event:colsHeadContainer:relaseSpaceEffect"),e.trigger("event:rowsHeadContainer:relaseSpaceEffect"),e.trigger("event:colsSpaceLineContainer:destroy"),this.$el.off("mousemove"),e.trigger("event:rowsSpaceLineContainer:destroy")},mouseMoveHeadContainer:function(a,b){this.$el.on("mousemove",a,b)},destroy:function(){e.off("call:screenContainer"),e.off("call:screenContainer:adaptScreen"),this.bodyContainer.destroy(),this.remove()}})}),b("widgets/clipboard/shearPlateContainer",function(){var a=c("lib/jquery"),b=c("lib/underscore"),d=c("basic/tools/cache"),e=c("lib/backbone"),f=c("entrance/tool/clipselectoperate"),g=c("entrance/tool/clippasteoperate");return e.View.extend({el:"#shearPlateContainer",initialize:function(){b.bindAll(this,"pasteData"),e.on("event:pasteData",this.pasteData)},events:{"mousedown div":"pasteAction"},pasteAction:function(b){switch(a(b.currentTarget).data("toolbar")){case"paste":this.pasteData();break;case"copy":this.copyData();break;case"cut":this.cutData()}},copyData:function(){f("copy")},cutData:function(){f("cut")},pasteData:function(a){"null"!==d.clipState&&g(a)}})}),b("widgets/font/fontFamilyContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=(c("basic/tools/send"),c("collections/cells"),c("collections/selectRegion"),c("entrance/tool/setfontfamily"));return b.View.extend({el:"#font",events:{"mousedown li":"setFontFamily"},setFontFamily:function(b){var c,e,f;this.$el.removeClass("active"),f=a(b.currentTarget),e=f.data("family"),c=f.text(),a("#fontShow").text(c),d("1",e)}})}),b("widgets/font/fontSizeContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=(c("basic/tools/send"),c("collections/selectRegion"),c("entrance/tool/setfontsize"));c("entrance/cell/setcellheight");return b.View.extend({el:"#fontSize",events:{"mousedown li":"setFontSize"},setFontSize:function(b){var c,e,f;f=a(b.currentTarget),this.$el.removeClass("active"),c=f.data("size"),e=f.text(),a("#fontSizeShow").text(e),d("1",c)}})}),b("widgets/celloperation/borderContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=(c("basic/tools/send"),c("collections/cells"),c("collections/selectRegion"),c("entrance/tool/setcellborder"));return b.View.extend({el:"#funcBorder",events:{"mousedown li":"transAction"},initialize:function(){},render:function(){},transAction:function(b){var c=a(b.currentTarget).data("border");d("1",c)}})}),b("widgets/celloperation/fillColorContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=c("entrance/tool/setfillcolor");return b.View.extend({el:"#fillColor",events:{"mousedown .color-body":"setFillColor"},setFillColor:function(b){this.$el.removeClass("active");var c=a(b.currentTarget).css("background-color");d("1",c)}})}),b("widgets/font/fontColorContainer",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=(c("basic/tools/send"),c("collections/selectRegion"),c("entrance/tool/setfontcolor"));return b.View.extend({el:"#fontColor",events:{"mousedown .color-body":"setFontColor"},setFontColor:function(b){this.$el.removeClass("active");var c=a(b.currentTarget).css("background-color");d("1",c)}})}),b("widgets/align/contentAlignContainer",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("entrance/tool/setalign");return b.View.extend({el:"#contentAlignContainer",events:{"click span[data-align]":"setAlignAction"},setAlignAction:function(b){var c;c=a(b.currentTarget).data("align"),d("1",c)}})}),b("widgets/cellformat/textFormatContainer",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("spreadsheet/config"),e=c("entrance/tool/settexttype");return b.View.extend({el:"#contentFormat",events:{"mousedown li":"setContentFormat"},setContentFormat:function(b){switch(this.$el.removeClass("active"),a(b.currentTarget).data("format")){case"normal":e.setNormal("1");break;case"text":e.setText("1");break;case"number-0":e.setNum("1",!1,0);break;case"number-1":e.setNum("1",!1,1);break;case"number-2":e.setNum("1",!1,2);break;case"number-3":e.setNum("1",!1,3);break;case"number-4":e.setNum("1",!1,4);break;case"date-1":e.setDate("1",d.dateFormatType.frist);break;case"date-2":e.setDate("1",d.dateFormatType.fourth);break;case"date-3":e.setDate("1",d.dateFormatType.fifth);break;case"percent":e.setPercent("1",2);break;case"coin-1":e.setCurrency("1",2,"$");break;case"coin-2":e.setCurrency("1",2,"¥");break;default:e.setText("1")}}})}),b("widgets/celloperation/mergeCellContainer",function(){var a=c("lib/jquery"),b=c("lib/underscore"),d=c("lib/backbone"),e=(c("basic/tools/send"),c("basic/tools/cache")),f=(c("basic/util/binary"),c("collections/selectRegion"),c("collections/headItemCol"),c("collections/headItemRow"),c("collections/cells"),c("entrance/tool/mergecell")),g=c("entrance/tool/splitcell");return d.View.extend({el:"#mergeCellContainer",events:{"click div[data-toolbar]":"transAction"},initialize:function(){b.bindAll(this,"splitCell")},transAction:function(b){switch(a(b.currentTarget).data("toolbar")){case"merge":this.mergeCell(b);break;case"split":this.splitCell(b)}},mergeCell:function(){f("1")},splitCell:function(){g("1")},splitCreateCell:function(a){},deletePosi:function(a,b){var c=e.CellsPosition,d=c.strandX,f=c.strandY;void 0!==d[a]&&void 0!==d[a][b]&&(delete d[a][b],Object.getOwnPropertyNames(d[a]).length||delete d[a]),void 0!==f[b]&&void 0!==f[b][a]&&(delete f[b][a],Object.getOwnPropertyNames(f[b]).length||delete f[b])},setPosi:function(a,b,c){var d={};void 0===e.CellsPosition.strandX[a]?(d={},d[b]=c,e.CellsPosition.strandX[a]=d):e.CellsPosition.strandX[a][b]=c,void 0===e.CellsPosition.strandY[b]?(d={},d[a]=c,e.CellsPosition.strandY[b]=d):e.CellsPosition.strandY[b][a]=c}})}),b("entrance/tool/setunderline",function(){var a=c("lib/backbone"),b=c("basic/tools/send"),d=c("spreadsheet/config"),e=c("basic/tools/history"),f=c("collections/headItemCol"),g=c("collections/headItemRow"),h=c("collections/selectRegion"),i=c("collections/cells"),j=c("basic/tools/cache"),k=c("basic/tools/getoperregion"),l=c("entrance/row/rowoperation"),m=c("entrance/col/coloperation"),n=f.models,o=g.models;return{set:function(b,c,d){var e,f,g=[];if("boolean"==typeof b&&(d=c,c=b),j.protectState)return void a.trigger("event:showMsgBar:show","保护状态，不能进行该操作");"boolean"!=typeof c&&(d=c),this._destroyClipRegion(),d=k(d),e=d.operRegion,void 0===c&&(f=i.getCellByVertical(e.startColIndex,e.startRowIndex)[0],c=f&&f.get("content").underline?0:1),"MAX"===e.endRowIndex?m.colPropOper(e.startColIndex,e.endColIndex,"content.underline",c):"MAX"===e.endColIndex?l.rowPropOper(e.startRowIndex,e.endRowIndex,"content.underline",c):(i.oprCellsByRegion(e,function(a,b,d){var e;(e=a.get("content").underline)!==c&&(g.push({colSort:b,rowSort:d,value:e}),a.set("content.underline",c))}),this._history("content.underline",c,e,g)),this._send(d.sendRegion,c)},_history:function(a,b,c,d){e.addAction(e.getCellPropUpdateAction(a,b,{startColSort:n[c.startColIndex].get("sort"),startRowSort:o[c.startRowIndex].get("sort"),endColSort:n[c.endColIndex].get("sort"),endRowSort:o[c.endRowIndex].get("sort")},d))},_destroyClipRegion:function(){var a=h.getModelByType("clip");a&&(j.clipState="null",a.destroy())},_send:function(a,c){b.PackAjax({url:d.url.cell.underline,data:JSON.stringify({coordinate:a,underline:c})})}}}),b("widgets/font/contentFontContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=(c("basic/tools/send"),c("collections/cells"),c("collections/selectRegion"),c("entrance/tool/setfontweight")),e=c("entrance/tool/setfontstyle"),f=c("entrance/tool/setunderline");return b.View.extend({el:"#contentFontContainer",events:{"click span":"setFontAction"},setFontAction:function(b){switch(a(b.currentTarget).data("toolbar")){case"bold":this.setCellModelBold();break;case"italic":this.setCellModelItalic();break;case"underline":this.setUnderline();break;default:return}},setCellModelBold:function(){d("1")},setCellModelItalic:function(){e("1")},setUnderline:function(){f.set()}})}),b("widgets/frozen/frozenContainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=(c("basic/tools/send"),c("basic/tools/cache")),e=(c("collections/selectRegion"),c("collections/headItemRow"),c("collections/headItemCol"),c("entrance/sheet/setfrozen"));return b.View.extend({el:"#frozen",events:{"mousedown li":"transAction"},initialize:function(){b.on("event:frozenContainer:changeState",this.changeState,this),this.unfrozenBtn=a('li[data-frozen="unfrozen"]',this.$el),this.customBtn=a('li[data-frozen="custom"]',this.$el),this.changeState()},render:function(){},changeState:function(){d.TempProp.isFrozen?(this.unfrozenBtn.show(),this.customBtn.hide()):(this.unfrozenBtn.hide(),this.customBtn.show())},transAction:function(b){var c=a(b.currentTarget).data("frozen");e("1",null,c),this.changeState()}})}),b("widgets/insert/insertoperation",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("entrance/tool/addrow"),e=c("entrance/tool/addcol");return b.View.extend({el:"#insert",events:{"mousedown li":"action"},action:function(b){"column"===a(b.currentTarget).data("type")?this.insertColumn():this.insertRow()},insertRow:function(){d.add()},insertColumn:function(){e.add()}})}),b("widgets/delete/deleteoperation",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("entrance/tool/deleterow"),e=c("entrance/tool/deletecol");return b.View.extend({el:"#delete",events:{"mousedown li":"action"},action:function(b){"column"===a(b.currentTarget).data("type")?this.deleteColumn():this.deleteRow()},deleteRow:function(){d.deleteRow()},deleteColumn:function(){e.deleteCol()}})}),b("widgets/celloperation/commentcontainer",function(){var a=c("lib/jquery"),b=(c("lib/underscore"),c("lib/backbone")),d=c("entrance/tool/comment");return b.View.extend({el:"#reviewContainer",events:{"click .fui-section":"commentAction"},commentAction:function(b){switch(a(b.currentTarget).data("toolbar")){case"addComment":d.createAddCommentView();break;case"editComment":d.createEditComment();break;case"deleteComment":d.deleteComment()}}})}),b("widgets/celloperation/wordwrapcontainer",function(){var a=(c("lib/jquery"),c("lib/underscore"),c("lib/backbone")),b=(c("basic/tools/send"),c("collections/selectRegion"),c("entrance/tool/setwordwrap"));return a.View.extend({el:"#wordWrapContainer",events:{click:"wordWrap"},wordWrap:function(a){b("1")}})}),b("widgets/hidecol/colhidecontainer",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("entrance/col/colhide");return b.View.extend({el:"#hideContainer",events:{"click .fui-section":"action"},action:function(b){"hide"===a(b.currentTarget).data("toolbar")?d.hide():d.cancelHide()}})}),b("widgets/celldel/regiondel",function(){var a=(c("lib/jquery"),c("lib/backbone")),b=c("entrance/tool/regiondel");return a.View.extend({el:"#regionDelContainer",events:{click:"action"},action:function(a){b()}})}),b("widgets/undoredo/undoredocontainer",function(){var a=c("lib/jquery"),b=(c("basic/tools/cache"),c("lib/backbone")),d=c("entrance/sheet/redoundo");return b.View.extend({el:"#undoredoContainer",events:{"click span[data-toolbar]":"undoRedo"},undoRedo:function(b){switch(a(b.currentTarget).data("toolbar")){case"redo":d.redo();break;case"undo":d.undo()}}})}),b("widgets/protect/protectcontainer",function(){var a=c("lib/jquery"),b=c("lib/backbone"),d=c("entrance/tool/protect");return b.View.extend({el:"#protectContainer",events:{"click .fui-section":"action"},action:function(b){var c=a(b.currentTarget).data("toolbar");"lock"===c?d.showLockContainer():"protect"===c&&d.showProtectContainer()}})}),
b("widgets/validate/validatecontainer",function(){var a=c("lib/backbone"),b=c("entrance/tool/validate");return a.View.extend({el:"#validateContainer",events:{"click .fui-section":"action"},action:function(){b.showValidateContainer()}})}),b("extension/highlight",function(){var a,b,d,e,f=c("lib/backbone"),g=c("basic/tools/cache"),h=c("models/selectRegion"),i=c("collections/selectRegion"),j=c("collections/headItemCol"),k=c("collections/headItemRow"),l=c("collections/cells"),m=c("views/cellsContainer"),n=c("views/selectRegion"),o=j.models,p=k.models;return d=function(a,b){var c;for(c in b)a[c]=b[c]},a={hightlightMoveState:function(){var a,b,c,d,e,f,j,k,m,n,q,r;g.CellsPosition.strandX;if(k=this.getCoordinateByMouseEvent(event),e=k.colIndex,f=k.rowIndex,c=k.relativeRowPosi,d=k.relativeColPosi,o[e].get("alias"),p[f].get("alias"),b=i.getModelByType("highlight"),void 0===(a=l.getCellByVertical(e,f)[0])||!a.get("highlight"))return g.highlightDirection="null",void(b&&b.set("highlightDirection",null));m=a.get("physicsBox").left,n=a.get("physicsBox").top,q=m+a.get("physicsBox").width,r=n+a.get("physicsBox").height,void 0===b&&(b=new h,b.set("selectType","highlight"),i.add(b)),b.set("tempPosi",{initColIndex:e,initRowIndex:f,mouseColIndex:e,mouseRowIndex:f}),j=function(){var a=q-d,b=d-m,e=c-n,f=r-c,g=a,h="right";return g>b&&(g=b,h="left"),g>e&&(g=e,h="top"),g>f&&(g=f,h="bottom"),h}(),b.set("highlightDirection",j),g.highlightDirection=j}},b={highlight:function(){var a=this.model.get("highlightDirection");this.$el.removeClass("highlight-right"),this.$el.removeClass("highlight-left"),this.$el.removeClass("highlight-top"),this.$el.removeClass("highlight-bottom"),a&&this.$el.addClass("highlight-"+a)}},d(m.prototype,a),d(n.prototype,b),e=n.prototype.initialize,n.prototype.initialize=function(a){e.call(this,a),"highlight"===this.model.get("selectType")&&this.listenTo(this.model,"change:highlightDirection",this.highlight)},{startHighlight:function(){f.trigger("event:cellsContainer:setMouseState","moveState","hightlightMoveState")},stopHighlight:function(){void 0!==i.getModelByType("highlight")&&i.getModelByType("highlight").destroy(),f.trigger("event:cellsContainer:setMouseState","moveState","commonMoveState")},getHighlightDirection:function(){return g.highlightDirection}}}),b("spreadsheet/excelbuild",function(){var a=c("basic/tools/original"),b=c("basic/util/listener"),d=c("basic/tools/cache"),e=c("entrance/tool/setfontcolor"),f=c("entrance/tool/setfillcolor"),g=c("entrance/tool/setfontfamily"),h=c("entrance/cell/setcellheight"),i=c("entrance/cell/setcellwidth"),j=c("entrance/tool/mergecell"),k=c("entrance/tool/splitcell"),l=c("entrance/tool/setcellcontent"),m=c("entrance/tool/setcellborder"),n=c("entrance/tool/setfontsize"),o=c("entrance/tool/setfontweight"),p=c("entrance/tool/setfontstyle"),q=c("entrance/sheet/setfrozen"),r=c("entrance/tool/setalign"),s=c("entrance/selectregion/datasourceregionoperation"),t=c("entrance/sheet/getpointbyposi"),u=c("entrance/tool/setwordwrap"),v=c("entrance/cell/gettextbycoordinate"),w=c("entrance/sheet/adaptscreen"),x=c("entrance/sheet/getfrozenstate"),y=c("entrance/sheet/getselectregion"),z=c("entrance/sheet/reload"),A=c("entrance/tool/settexttype"),B=c("entrance/tool/addrow"),C=c("entrance/tool/addcol"),D=c("entrance/tool/deleterow"),E=c("entrance/tool/deletecol"),F=c("entrance/tool/regiondel"),G=c("entrance/col/colhide"),H=c("entrance/tool/batchsetbg"),I=c("entrance/tool/validate"),J=c("entrance/tool/protect"),K=c("entrance/tool/comment");return{buildExcelOriginalData:function(b){a.restoreExcel(b)},buildExcelView:function(a){new(c("views/screen"))(a)},buildExcelToolbar:function(){var a=c("widgets/clipboard/shearPlateContainer"),b=c("widgets/font/fontFamilyContainer"),d=c("widgets/font/fontSizeContainer"),e=c("widgets/celloperation/borderContainer"),f=c("widgets/celloperation/fillColorContainer"),g=c("widgets/font/fontColorContainer"),h=c("widgets/align/contentAlignContainer"),i=c("widgets/cellformat/textFormatContainer"),j=c("widgets/celloperation/mergeCellContainer"),k=c("widgets/font/contentFontContainer"),l=c("widgets/frozen/frozenContainer"),m=c("widgets/insert/insertoperation"),n=c("widgets/delete/deleteoperation"),o=c("widgets/celloperation/commentcontainer"),p=c("widgets/celloperation/wordwrapcontainer"),q=c("widgets/hidecol/colhidecontainer"),r=c("widgets/celldel/regiondel"),s=c("widgets/undoredo/undoredocontainer"),t=c("widgets/protect/protectcontainer"),u=c("widgets/validate/validatecontainer");new a,new b,new d,new e,new f,new g,new h,new i,new j,new k,new l,new o,new m,new n,new p,new r,new q,new s,new t,new u},buildExcelPublicAPI:function(a){a.prototype.setFontColor=e,a.prototype.setFillColor=f,a.prototype.setFontFamily=g,a.prototype.mergeCell=j,a.prototype.splitCell=k,a.prototype.setCellBorder=m,a.prototype.setCellContent=l,a.prototype.setAlign=r,a.prototype.setColWidth=i,a.prototype.setRowHeight=h,a.prototype.setFontSize=n,a.prototype.setFontStyle=p,a.prototype.setFontWeight=o,a.prototype.frozen=function(a,b){q(a,b)},a.prototype.colFrozen=function(){q("temp",null,"col")},a.prototype.rowFrozen=function(){q("temp",null,"row")},a.prototype.unFrozen=function(){q("temp",null,"unfrozen")},a.prototype.setNormalType=A.setNormal.bind(A),a.prototype.setTextType=A.setText.bind(A),a.prototype.setNumType=A.setNum.bind(A),a.prototype.setDateType=A.setDate.bind(A),a.prototype.setPercentType=A.setPercent.bind(A),a.prototype.setCoinType=A.setCurrency.bind(A),a.prototype.batchFillBg=H.set.bind(H),a.prototype.modifyComment=K.modifyComment.bind(K),a.prototype.createAddCommentView=K.createAddCommentView.bind(K),a.prototype.createEditCommentView=K.createEditComment.bind(K),a.prototype.deleteComment=K.deleteComment.bind(K),a.prototype.getPointByPosi=t,a.prototype.adaptScreen=w,a.prototype.getTextByCoordinate=v,a.prototype.getFrozenState=x,a.prototype.setWordWrap=u,a.prototype.getSelectRegion=y,a.prototype.reload=z,a.prototype.addRow=B.add.bind(B),a.prototype.addCol=C.add.bind(C),a.prototype.deleteRow=D.deleteRow.bind(D),a.prototype.deleteCol=E.deleteCol.bind(E),a.prototype.regionDel=F,a.prototype.colHide=G.hide.bind(G),a.prototype.colCancelHide=G.cancelHide.bind(G),a.prototype.setValidate=I.showValidateContainer,a.prototype.setLock=J.showLockContainer,a.prototype.setProtect=J.showProtectContainer,a.prototype.getStep=function(){return d.sendQueueStep}},buildDataSourceOperation:function(a){a.prototype.setDataSourceState=s.setDataSourceState,a.prototype.setSelectState=s.setSelectState,a.prototype.destroyDataSoure=s.destroyDataSoure},buildExcelEventListener:function(a){a.prototype.addEventListener=b.addEventListener,a.prototype.removeEventListener=b.removeEventListener},buildExcelExtend:function(a){var b=c("extension/highlight");a.prototype.startHighlight=b.startHighlight,a.prototype.stopHighlight=b.stopHighlight,a.prototype.getHighlightDirection=b.getHighlightDirection}}}),b("spreadsheet/spreadsheet",function(){function a(c){if(!document.getElementById(c))throw new Error("未找到id为"+c+"容器");b.containerId=c,e.buildExcelOriginalData(c),e.buildExcelView(c),e.buildExcelToolbar(),e.buildExcelPublicAPI(a),e.buildDataSourceOperation(a),e.buildExcelEventListener(a),e.buildExcelExtend(a)}var b=(c("lib/jquery"),c("spreadsheet/config"),c("basic/tools/cache")),d=c("basic/tools/point"),e=c("spreadsheet/excelbuild");return a.Point=d,a}),c("spreadsheet/spreadsheet")});